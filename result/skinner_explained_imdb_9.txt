execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10a.sql_explained.sql
SET
SET
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=629274.70..629274.71 rows=1 width=64) (actual time=3825.684..3825.684 rows=1 loops=1)
   ->  Gather  (cost=629274.48..629274.69 rows=2 width=64) (actual time=3825.292..3832.879 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=628274.48..628274.49 rows=1 width=64) (actual time=3818.461..3818.462 rows=1 loops=3)
               ->  Hash Join  (cost=567292.56..628274.47 rows=2 width=33) (actual time=3451.453..3818.386 rows=35 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=567291.47..628273.38 rows=2 width=37) (actual time=3451.186..3818.102 rows=35 loops=3)
                           Hash Cond: (chn.id = ci.person_role_id)
                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.047..240.261 rows=1046780 loops=3)
                           ->  Parallel Hash  (cost=567291.40..567291.40 rows=5 width=25) (actual time=3449.430..3449.430 rows=37 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=516526.82..567291.40 rows=5 width=25) (actual time=3329.670..3449.298 rows=37 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.020..259.942 rows=337640 loops=3)
                                             Filter: (production_year > 2005)
                                             Rows Removed by Filter: 505131
                                       ->  Parallel Hash  (cost=516526.68..516526.68 rows=11 width=16) (actual time=3151.352..3151.352 rows=92 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=483987.14..516526.68 rows=11 width=16) (actual time=2918.049..3151.191 rows=92 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Hash Join  (cost=4733.23..37248.39 rows=6486 width=8) (actual time=22.846..297.445 rows=2930 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..154.446 rows=869710 loops=3)
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=825 width=4) (actual time=22.391..22.392 rows=454 loops=3)
                                                               Buckets: 2048  Batches: 1  Memory Usage: 112kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=825 width=4) (actual time=0.052..21.881 rows=454 loops=3)
                                                                     Filter: ((country_code)::text = '[ru]'::text)
                                                                     Rows Removed by Filter: 77879
                                                   ->  Parallel Hash  (cost=479245.16..479245.16 rows=700 width=8) (actual time=2852.650..2852.650 rows=8625 loops=3)
                                                         Buckets: 32768 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 1552kB
                                                         ->  Hash Join  (cost=1.16..479245.16 rows=700 width=8) (actual time=0.644..2720.053 rows=8625 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=8405 width=12) (actual time=0.536..2715.030 rows=10763 loops=3)
                                                                     Filter: (((note)::text ~~ '%(voice)%'::text) AND ((note)::text ~~ '%(uncredited)%'::text))
                                                                     Rows Removed by Filter: 12070685
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.026..0.029 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actor'::text)
                                                                           Rows Removed by Filter: 11
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.054..0.054 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.033..0.035 rows=4 loops=3)
 Planning Time: 8.249 ms
 Execution Time: 3833.567 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10b.sql_explained.sql
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=612898.77..612898.78 rows=1 width=64) (actual time=4341.802..4341.802 rows=1 loops=1)
   ->  Gather  (cost=612898.55..612898.76 rows=2 width=64) (actual time=4339.526..4395.091 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=611898.55..611898.56 rows=1 width=64) (actual time=4332.716..4332.716 rows=1 loops=3)
               ->  Hash Join  (cost=160692.60..611898.28 rows=55 width=33) (actual time=4332.710..4332.710 rows=0 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=160691.51..611896.89 rows=55 width=37) (actual time=4332.442..4332.520 rows=0 loops=3)
                           Hash Cond: (ci.person_role_id = chn.id)
                           ->  Hash Join  (cost=87135.83..530671.90 rows=115 width=25) (actual time=3344.203..3344.203 rows=0 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Hash Join  (cost=87134.66..530665.85 rows=1377 width=29) (actual time=1857.064..3343.968 rows=871 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=551821 width=12) (actual time=306.262..2724.714 rows=478480 loops=3)
                                             Filter: ((note)::text ~~ '%(producer)%'::text)
                                             Rows Removed by Filter: 11602968
                                       ->  Parallel Hash  (cost=87121.90..87121.90 rows=1021 width=29) (actual time=565.653..565.653 rows=420 loops=3)
                                             Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                             ->  Parallel Hash Join  (cost=37329.47..87121.90 rows=1021 width=29) (actual time=304.442..565.093 rows=420 loops=3)
                                                   Hash Cond: (t.id = mc.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.021..241.991 rows=130555 loops=3)
                                                         Filter: (production_year > 2010)
                                                         Rows Removed by Filter: 712215
                                                   ->  Parallel Hash  (cost=37248.39..37248.39 rows=6486 width=8) (actual time=302.046..302.046 rows=2930 loops=3)
                                                         Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                         ->  Parallel Hash Join  (cost=4733.23..37248.39 rows=6486 width=8) (actual time=24.106..300.326 rows=2930 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.010..154.748 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=825 width=4) (actual time=23.603..23.603 rows=454 loops=3)
                                                                     Buckets: 2048  Batches: 1  Memory Usage: 112kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=825 width=4) (actual time=0.072..23.088 rows=454 loops=3)
                                                                           Filter: ((country_code)::text = '[ru]'::text)
                                                                           Rows Removed by Filter: 77879
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=3)
                                             Filter: ((role)::text = 'actor'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=631.112..631.112 rows=1046780 loops=3)
                                 Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                 ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.053..291.022 rows=1046780 loops=3)
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.055..0.056 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.030..0.032 rows=4 loops=3)
 Planning Time: 8.061 ms
 Execution Time: 4397.710 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10c.sql_explained.sql
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=652016.30..652016.31 rows=1 width=64) (actual time=5005.618..5005.618 rows=1 loops=1)
   ->  Gather  (cost=652016.08..652016.29 rows=2 width=64) (actual time=5001.961..5095.751 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=651016.08..651016.09 rows=1 width=64) (actual time=4995.255..4995.256 rows=1 loops=3)
               ->  Hash Join  (cost=609518.31..650122.02 rows=178812 width=33) (actual time=4952.825..4995.221 rows=3 loops=3)
                     Hash Cond: (ci.role_id = rt.id)
                     ->  Hash Join  (cost=609517.04..649485.59 rows=178812 width=37) (actual time=4952.552..4994.946 rows=3 loops=3)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=609515.95..648517.80 rows=178812 width=41) (actual time=4952.449..4994.840 rows=3 loops=3)
                                 Hash Cond: (mc.movie_id = t.id)
                                 ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=8) (actual time=34.221..402.419 rows=384599 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.018..158.762 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=33.614..33.614 rows=28281 loops=3)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.018..19.540 rows=28281 loops=3)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=600222.44..600222.44 rows=185178 width=45) (actual time=4438.421..4438.421 rows=4 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 576kB
                                       ->  Parallel Hash Join  (cost=136144.88..600222.44 rows=185178 width=45) (actual time=4350.061..4437.236 rows=4 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Hash Join  (cost=73555.68..529520.84 rows=266824 width=24) (actual time=3659.484..3826.028 rows=5 loops=3)
                                                   Hash Cond: (ci.person_role_id = chn.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=551821 width=12) (actual time=302.951..2778.986 rows=478480 loops=3)
                                                         Filter: ((note)::text ~~ '%(producer)%'::text)
                                                         Rows Removed by Filter: 11602968
                                                   ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=657.738..657.738 rows=1046780 loops=3)
                                                         Buckets: 65536  Batches: 64  Memory Usage: 3232kB
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.064..288.144 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=49166.29..49166.29 rows=731112 width=21) (actual time=487.975..487.976 rows=583011 loops=3)
                                                   Buckets: 65536  Batches: 32  Memory Usage: 3616kB
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.028..291.852 rows=583011 loops=3)
                                                         Filter: (production_year > 1990)
                                                         Rows Removed by Filter: 259760
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.041..0.041 rows=4 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.028..0.029 rows=4 loops=3)
                     ->  Hash  (cost=1.12..1.12 rows=12 width=4) (actual time=0.050..0.050 rows=12 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on role_type rt  (cost=0.00..1.12 rows=12 width=4) (actual time=0.027..0.030 rows=12 loops=3)
 Planning Time: 7.955 ms
 Execution Time: 5096.431 ms
(44 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11a.sql_explained.sql
SET
SET
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=25460.06..25460.07 rows=1 width=96) (actual time=325.485..325.486 rows=1 loops=1)
   ->  Gather  (cost=19952.24..25460.06 rows=1 width=118) (actual time=281.244..330.291 rows=310 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Parallel Hash Join  (cost=18952.24..24459.96 rows=1 width=118) (actual time=274.393..319.780 rows=155 loops=2)
               Hash Cond: (cn.id = mc.company_id)
               ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.030..46.027 rows=24151 loops=2)
                     Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                     Rows Removed by Filter: 93348
               ->  Parallel Hash  (cost=18952.23..18952.23 rows=1 width=103) (actual time=270.570..270.570 rows=332 loops=2)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Hash Join  (cost=8687.12..18952.23 rows=1 width=103) (actual time=141.275..270.310 rows=332 loops=2)
                           Hash Cond: (mk.keyword_id = k.id)
                           ->  Merge Join  (cost=6060.98..16306.51 rows=7458 width=107) (actual time=98.261..239.247 rows=16065 loops=2)
                                 Merge Cond: (ml.movie_id = mk.movie_id)
                                 ->  Merge Join  (cost=6016.36..13086.62 rows=160 width=115) (actual time=98.175..200.586 rows=1397 loops=2)
                                       Merge Cond: (t.id = ml.movie_id)
                                       ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=379985 width=21) (actual time=0.042..100.186 rows=26100 loops=2)
                                             Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                             Rows Removed by Filter: 56295
                                       ->  Sort  (cost=6015.92..6018.59 rows=1065 width=94) (actual time=97.001..97.327 rows=4393 loops=2)
                                             Sort Key: mc.movie_id
                                             Sort Method: quicksort  Memory: 536kB
                                             Worker 0:  Sort Method: quicksort  Memory: 536kB
                                             ->  Hash Join  (cost=652.13..5962.37 rows=1065 width=94) (actual time=10.575..94.894 rows=4393 loops=2)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Merge Join  (cost=651.06..5938.28 rows=4260 width=98) (actual time=10.495..93.499 rows=5069 loops=2)
                                                         Merge Cond: (mc.movie_id = ml.movie_id)
                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.052..77.269 rows=49142 loops=2)
                                                               Filter: (note IS NULL)
                                                               Rows Removed by Filter: 50735
                                                         ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.329..10.722 rows=5369 loops=2)
                                                               Sort Key: ml.movie_id
                                                               Sort Method: quicksort  Memory: 205kB
                                                               Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                               ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.138..9.123 rows=2315 loops=2)
                                                                     Hash Cond: (ml.link_type_id = lt.id)
                                                                     ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.018..4.856 rows=29997 loops=2)
                                                                     ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.050..0.050 rows=2 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.033..0.038 rows=2 loops=2)
                                                                                 Filter: ((link)::text ~~ '%follow%'::text)
                                                                                 Rows Removed by Filter: 16
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.021..0.023 rows=1 loops=2)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                                 ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.020..26.897 rows=96539 loops=2)
                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=29.447..29.447 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.375..29.426 rows=1 loops=2)
                                       Filter: ((keyword)::text = 'sequel'::text)
                                       Rows Removed by Filter: 134169
 Planning Time: 14.097 ms
 Execution Time: 331.301 ms
(56 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=37292.30..37292.31 rows=1 width=96) (actual time=539.447..539.447 rows=1 loops=1)
   ->  Hash Join  (cost=15626.08..37292.29 rows=1 width=118) (actual time=478.992..539.425 rows=14 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=12999.94..34666.15 rows=1 width=122) (actual time=459.101..519.526 rows=56 loops=1)
               Merge Cond: (ml.movie_id = mk.movie_id)
               ->  Merge Join  (cost=12999.51..31520.71 rows=1 width=130) (actual time=430.173..490.570 rows=14 loops=1)
                     Merge Cond: (t.id = ml.movie_id)
                     ->  Gather Merge  (cost=1000.45..93601.60 rows=5 width=21) (actual time=340.400..473.506 rows=3 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=2 width=21) (actual time=158.019..408.216 rows=4 loops=3)
                                 Filter: (((title)::text ~~ '%Money%'::text) AND (production_year = 1998))
                                 Rows Removed by Filter: 306621
                     ->  Sort  (cost=11999.06..11999.54 rows=192 width=109) (actual time=89.718..89.750 rows=450 loops=1)
                           Sort Key: mc.movie_id
                           Sort Method: quicksort  Memory: 61kB
                           ->  Gather  (cost=7378.27..11991.77 rows=192 width=109) (actual time=68.019..90.813 rows=450 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Hash Join  (cost=6378.27..10972.57 rows=80 width=109) (actual time=62.870..82.170 rows=150 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=6377.21..10969.78 rows=321 width=113) (actual time=62.675..81.930 rows=153 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Merge Join  (cost=651.06..5238.97 rows=1775 width=98) (actual time=12.329..32.557 rows=692 loops=3)
                                                   Merge Cond: (mc.movie_id = ml.movie_id)
                                                   ->  Parallel Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..116330.44 rows=530595 width=12) (actual time=0.117..18.705 rows=16381 loops=3)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 16912
                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.096..12.208 rows=1516 loops=3)
                                                         Sort Key: ml.movie_id
                                                         Sort Method: quicksort  Memory: 103kB
                                                         Worker 0:  Sort Method: quicksort  Memory: 103kB
                                                         Worker 1:  Sort Method: quicksort  Memory: 103kB
                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.157..11.420 rows=1158 loops=3)
                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.031..7.284 rows=29997 loops=3)
                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.052..0.052 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.037..0.041 rows=1 loops=3)
                                                                           Filter: ((link)::text ~~ '%follows%'::text)
                                                                           Rows Removed by Filter: 17
                                             ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=48.043..48.044 rows=16101 loops=3)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.031..36.958 rows=16101 loops=3)
                                                         Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                         Rows Removed by Filter: 62232
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.069..0.069 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.047..0.049 rows=1 loops=3)
                                                   Filter: ((kind)::text = 'production companies'::text)
                                                   Rows Removed by Filter: 3
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.031..21.869 rows=69469 loops=1)
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.831..19.831 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.053..19.820 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 13.791 ms
 Execution Time: 614.282 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11c.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=26126.74..26126.75 rows=1 width=96) (actual time=594.258..594.258 rows=1 loops=1)
   ->  Hash Join  (cost=22974.01..26126.73 rows=1 width=60) (actual time=453.536..590.421 rows=6946 loops=1)
         Hash Cond: (ml.link_type_id = lt.id)
         ->  Hash Join  (cost=22972.60..26125.32 rows=1 width=64) (actual time=453.426..588.747 rows=6946 loops=1)
               Hash Cond: (mk.keyword_id = k.id)
               ->  Merge Join  (cost=20178.73..23330.26 rows=454 width=68) (actual time=236.091..483.115 rows=780776 loops=1)
                     Merge Cond: (mk.movie_id = ml.movie_id)
                     ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.046..19.624 rows=77819 loops=1)
                     ->  Sort  (cost=20178.30..20178.32 rows=10 width=76) (actual time=234.752..282.915 rows=780794 loops=1)
                           Sort Key: mc.movie_id
                           Sort Method: quicksort  Memory: 1609kB
                           ->  Gather  (cost=6420.11..20178.13 rows=10 width=76) (actual time=71.284..228.832 rows=8393 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Hash Join  (cost=5420.11..19177.13 rows=4 width=76) (actual time=63.906..220.503 rows=2798 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=5419.02..19176.02 rows=5 width=80) (actual time=63.713..219.465 rows=2801 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Merge Join  (cost=4.62..13682.01 rows=30328 width=65) (actual time=1.291..181.782 rows=34978 loops=3)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=2.03..8120.68 rows=11307 width=29) (actual time=0.794..114.396 rows=9909 loops=3)
                                                         Merge Cond: (t.id = ml.movie_id)
                                                         ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..89967.34 rows=952979 width=21) (actual time=0.118..97.184 rows=59309 loops=3)
                                                               Filter: (production_year > 1950)
                                                               Rows Removed by Filter: 2750
                                                         ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=8) (actual time=0.048..7.125 rows=29997 loops=3)
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1335700 width=36) (actual time=0.054..56.587 rows=77952 loops=3)
                                                         Filter: (note IS NOT NULL)
                                                         Rows Removed by Filter: 66955
                                             ->  Parallel Hash  (cost=5414.09..5414.09 rows=25 width=23) (actual time=32.743..32.743 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=25 width=23) (actual time=0.568..32.634 rows=30 loops=3)
                                                         Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '20th Century Fox%'::text) OR ((name)::text ~~ 'Twentieth Century Fox%'::text)))
                                                         Rows Removed by Filter: 78303
                                       ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.058..0.058 rows=3 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=3 width=4) (actual time=0.037..0.039 rows=3 loops=3)
                                                   Filter: ((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))
                                                   Rows Removed by Filter: 1
               ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=39.537..39.538 rows=3 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=1.507..39.521 rows=3 loops=1)
                           Filter: ((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))
                           Rows Removed by Filter: 134167
         ->  Hash  (cost=1.18..1.18 rows=18 width=4) (actual time=0.051..0.052 rows=18 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=4) (actual time=0.034..0.037 rows=18 loops=1)
 Planning Time: 14.743 ms
 Execution Time: 595.523 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11d.sql_explained.sql
SET
SET
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=34220.63..34220.64 rows=1 width=96) (actual time=355.692..355.692 rows=1 loops=1)
   ->  Hash Join  (cost=26974.32..34220.25 rows=51 width=60) (actual time=269.919..350.226 rows=14899 loops=1)
         Hash Cond: (cn.id = mc.company_id)
         ->  Seq Scan on company_name cn  (cost=0.00..5932.46 rows=210072 width=23) (actual time=0.049..58.227 rows=210031 loops=1)
               Filter: ((country_code)::text <> '[pl]'::text)
               Rows Removed by Filter: 24966
         ->  Hash  (cost=26973.61..26973.61 rows=57 width=45) (actual time=269.774..269.774 rows=14916 loops=1)
               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1231kB
               ->  Hash Join  (cost=21742.73..26973.61 rows=57 width=45) (actual time=224.982..263.373 rows=14916 loops=1)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Merge Join  (cost=21741.65..26972.11 rows=76 width=49) (actual time=224.888..259.659 rows=15510 loops=1)
                           Merge Cond: (mc.movie_id = ml.movie_id)
                           ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1335700 width=36) (actual time=0.025..27.271 rows=42219 loops=1)
                                 Filter: (note IS NOT NULL)
                                 Rows Removed by Filter: 41437
                           ->  Sort  (cost=21741.22..21741.29 rows=28 width=29) (actual time=224.584..225.654 rows=15913 loops=1)
                                 Sort Key: mk.movie_id
                                 Sort Method: quicksort  Memory: 159kB
                                 ->  Gather  (cost=3836.65..21740.54 rows=28 width=29) (actual time=39.138..223.939 rows=1460 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 2
                                       ->  Hash Join  (cost=2836.65..20737.74 rows=12 width=29) (actual time=35.118..212.543 rows=487 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Hash Join  (cost=2835.24..20736.30 rows=12 width=33) (actual time=34.902..212.174 rows=487 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Merge Join  (cost=41.37..16560.07 rows=526594 width=37) (actual time=0.592..176.698 rows=95464 loops=3)
                                                         Merge Cond: (ml.movie_id = mk.movie_id)
                                                         ->  Merge Join  (cost=2.03..8120.68 rows=11307 width=29) (actual time=0.327..107.744 rows=9909 loops=3)
                                                               Merge Cond: (t.id = ml.movie_id)
                                                               ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..89967.34 rows=952979 width=21) (actual time=0.019..90.374 rows=59309 loops=3)
                                                                     Filter: (production_year > 1950)
                                                                     Rows Removed by Filter: 2750
                                                               ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=8) (actual time=0.056..7.470 rows=29997 loops=3)
                                                         ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.077..39.792 rows=175267 loops=3)
                                                   ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=26.583..26.583 rows=3 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=1.094..26.568 rows=3 loops=3)
                                                               Filter: ((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))
                                                               Rows Removed by Filter: 134167
                                             ->  Hash  (cost=1.18..1.18 rows=18 width=4) (actual time=0.069..0.069 rows=18 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=4) (actual time=0.045..0.048 rows=18 loops=3)
                     ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.041..0.041 rows=3 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=3 width=4) (actual time=0.020..0.022 rows=3 loops=1)
                                 Filter: ((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))
                                 Rows Removed by Filter: 1
 Planning Time: 13.157 ms
 Execution Time: 356.656 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12a.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=346907.90..346907.91 rows=1 width=96) (actual time=3485.189..3485.189 rows=1 loops=1)
   ->  Gather  (cost=346907.78..346907.89 rows=1 width=96) (actual time=3484.865..3490.115 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=345907.78..345907.79 rows=1 width=96) (actual time=3479.438..3479.438 rows=1 loops=2)
               ->  Hash Join  (cost=340996.48..345907.77 rows=1 width=41) (actual time=3448.340..3479.228 rows=198 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=340995.42..345906.71 rows=1 width=45) (actual time=3448.035..3478.898 rows=354 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.008..25.631 rows=42422 loops=2)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 75077
                           ->  Parallel Hash  (cost=340995.41..340995.41 rows=1 width=30) (actual time=3447.556..3447.556 rows=967 loops=2)
                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                 ->  Parallel Hash Join  (cost=307257.26..340995.41 rows=1 width=30) (actual time=2909.390..3302.041 rows=967 loops=2)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.013..224.633 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=307257.25..307257.25 rows=1 width=34) (actual time=2903.832..2903.832 rows=278 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=254758.25..307257.25 rows=1 width=34) (actual time=2514.615..2903.398 rows=278 loops=2)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=186410 width=21) (actual time=0.029..372.604 rows=222930 loops=2)
                                                         Filter: ((production_year >= 2005) AND (production_year <= 2008))
                                                         Rows Removed by Filter: 1041226
                                                   ->  Parallel Hash  (cost=254758.24..254758.24 rows=1 width=13) (actual time=2496.192..2496.192 rows=972 loops=2)
                                                         Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                         ->  Parallel Hash Join  (cost=15184.50..254758.24 rows=1 width=13) (actual time=2119.746..2398.613 rows=972 loops=2)
                                                               Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                               ->  Hash Join  (cost=2.43..239572.30 rows=1028 width=4) (actual time=1896.018..2154.202 rows=136360 loops=2)
                                                                     Hash Cond: (mi.info_type_id = it1.id)
                                                                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=116213 width=8) (actual time=1315.914..2119.822 rows=137322 loops=2)
                                                                           Filter: ((info)::text = ANY ('{Drama,Horror}'::text[]))
                                                                           Rows Removed by Filter: 7280538
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.015..0.028 rows=1 loops=2)
                                                                                 Filter: ((info)::text = 'genres'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=15179.85..15179.85 rows=178 width=9) (actual time=223.498..223.499 rows=7924 loops=2)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                     ->  Hash Join  (cost=2.43..15179.85 rows=178 width=9) (actual time=0.161..196.871 rows=7924 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.050..190.593 rows=26824 loops=2)
                                                                                 Filter: ((info)::text > '8.0'::text)
                                                                                 Rows Removed by Filter: 663193
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.035 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 14.007 ms
 Execution Time: 3490.847 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12b.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348978.79..348978.80 rows=1 width=64) (actual time=3714.683..3714.683 rows=1 loops=1)
   ->  Gather  (cost=348978.68..348978.79 rows=1 width=64) (actual time=3714.413..3719.733 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347978.68..347978.69 rows=1 width=64) (actual time=3709.095..3709.095 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343067.38..347978.67 rows=1 width=60) (actual time=3690.951..3709.064 rows=5 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..24.978 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343067.37..343067.37 rows=1 width=64) (actual time=3679.471..3679.471 rows=16 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=102227.57..343067.37 rows=1 width=64) (actual time=3183.920..3679.418 rows=16 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=1501.755..2597.833 rows=60932 loops=2)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.032..1659.788 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.021..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'budget'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102225.13..102225.13 rows=1 width=33) (actual time=1075.293..1075.293 rows=16 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=86954.86..102225.13 rows=1 width=33) (actual time=1075.207..1075.221 rows=16 loops=2)
                                             Hash Cond: (mi_idx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=197.895..197.898 rows=5 loops=2)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.025..114.068 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=2)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86951.75..86951.75 rows=55 width=29) (actual time=877.239..877.239 rows=1984 loops=2)
                                                   Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 376kB
                                                   ->  Hash Join  (cost=54436.04..86951.75 rows=55 width=29) (actual time=450.548..871.341 rows=1984 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Parallel Hash Join  (cost=54434.96..86950.06 rows=111 width=33) (actual time=450.426..870.329 rows=1984 loops=2)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.013..230.314 rows=1304564 loops=2)
                                                               ->  Parallel Hash  (cost=54433.61..54433.61 rows=108 width=21) (actual time=449.460..449.460 rows=1268 loops=2)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=108 width=21) (actual time=0.672..444.486 rows=1268 loops=2)
                                                                           Filter: ((production_year > 2000) AND (((title)::text ~~ 'Birdemic%'::text) OR ((title)::text ~~ '%Movie%'::text)))
                                                                           Rows Removed by Filter: 1262888
                                                         ->  Hash  (cost=1.06..1.06 rows=2 width=4) (actual time=0.058..0.058 rows=2 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.06 rows=2 width=4) (actual time=0.037..0.039 rows=2 loops=2)
                                                                     Filter: ((kind IS NOT NULL) AND (((kind)::text = 'production companies'::text) OR ((kind)::text = 'distributors'::text)))
                                                                     Rows Removed by Filter: 2
 Planning Time: 13.808 ms
 Execution Time: 3720.479 ms
(53 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12c.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=363505.12..363505.13 rows=1 width=96) (actual time=3863.972..3863.972 rows=1 loops=1)
   ->  Gather  (cost=363505.00..363505.11 rows=1 width=96) (actual time=3863.437..3869.112 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=362505.00..362505.01 rows=1 width=96) (actual time=3858.070..3858.070 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=357593.71..362504.99 rows=1 width=41) (actual time=3824.295..3856.766 rows=2356 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.010..25.621 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=357593.68..357593.68 rows=2 width=26) (actual time=3823.660..3823.660 rows=7768 loops=2)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1208kB
                           ->  Hash Join  (cost=323855.49..357593.68 rows=2 width=26) (actual time=3589.009..3799.804 rows=7768 loops=2)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=323854.42..357592.57 rows=10 width=30) (actual time=3362.188..3795.394 rows=22503 loops=2)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.020..233.734 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=323854.40..323854.40 rows=2 width=34) (actual time=3361.923..3361.923 rows=3982 loops=2)
                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                             ->  Parallel Hash Join  (cost=270431.08..323854.40 rows=2 width=34) (actual time=2880.773..3354.768 rows=3982 loops=2)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=432897 width=21) (actual time=0.031..398.730 rows=521400 loops=2)
                                                         Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                         Rows Removed by Filter: 742756
                                                   ->  Parallel Hash  (cost=270431.01..270431.01 rows=5 width=13) (actual time=2880.107..2880.107 rows=11094 loops=2)
                                                         Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1592kB
                                                         ->  Parallel Hash Join  (cost=15354.10..270431.01 rows=5 width=13) (actual time=2499.216..2850.670 rows=11094 loops=2)
                                                               Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                               ->  Hash Join  (cost=2.43..255074.87 rows=1187 width=4) (actual time=2237.972..2550.564 rows=162628 loops=2)
                                                                     Hash Cond: (mi.info_type_id = it1.id)
                                                                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=134092 width=8) (actual time=1558.919..2509.944 rows=163656 loops=2)
                                                                           Filter: ((info)::text = ANY ('{Drama,Horror,Western,Family}'::text[]))
                                                                           Rows Removed by Filter: 7254204
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.050 rows=1 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.029 rows=1 loops=2)
                                                                                 Filter: ((info)::text = 'genres'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=15342.82..15342.82 rows=708 width=9) (actual time=261.139..261.139 rows=60786 loops=2)
                                                                     Buckets: 131072 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 6832kB
                                                                     ->  Hash Join  (cost=2.43..15342.82 rows=708 width=9) (actual time=0.165..222.615 rows=60786 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=79942 width=13) (actual time=0.060..201.067 rows=96948 loops=2)
                                                                                 Filter: ((info)::text > '7.0'::text)
                                                                                 Rows Removed by Filter: 593070
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.037 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.036..0.038 rows=1 loops=2)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
 Planning Time: 13.778 ms
 Execution Time: 3869.950 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13a.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=345137.34..345137.35 rows=1 width=96) (actual time=3283.351..3283.351 rows=1 loops=1)
   ->  Gather  (cost=345137.12..345137.33 rows=2 width=96) (actual time=3279.136..3299.481 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=344137.12..344137.13 rows=1 width=96) (actual time=3272.179..3272.180 rows=1 loops=3)
               ->  Hash Join  (cost=293653.26..344137.03 rows=11 width=65) (actual time=3087.933..3256.027 rows=37034 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=293652.16..344135.60 rows=79 width=69) (actual time=2867.533..3245.176 rows=44730 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.015..214.711 rows=842771 loops=3)
                           ->  Parallel Hash  (cost=293651.17..293651.17 rows=79 width=60) (actual time=2866.952..2866.952 rows=44730 loops=3)
                                 Buckets: 262144 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 13880kB
                                 ->  Parallel Hash Join  (cost=52811.08..293651.17 rows=79 width=60) (actual time=1149.230..2737.152 rows=44730 loops=3)
                                       Hash Cond: (mi.movie_id = mc.movie_id)
                                       ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=453.046..1906.204 rows=1012240 loops=3)
                                             Hash Cond: (mi.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.050..1133.119 rows=4945240 loops=3)
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.032..0.032 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.019..0.029 rows=1 loops=3)
                                                         Filter: ((info)::text = 'release dates'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=52805.23..52805.23 rows=274 width=13) (actual time=694.702..694.702 rows=10503 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2040kB
                                             ->  Hash Join  (cost=20112.16..52805.23 rows=274 width=13) (actual time=620.146..666.614 rows=10503 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Hash Join  (cost=20111.09..52798.24 rows=1095 width=17) (actual time=618.708..662.437 rows=27966 loops=3)
                                                         Hash Cond: (mc.movie_id = miidx.movie_id)
                                                         ->  Parallel Hash Join  (cost=4793.88..37309.04 rows=44647 width=8) (actual time=24.311..320.287 rows=49377 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..159.233 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=5677 width=4) (actual time=24.190..24.191 rows=3258 loops=3)
                                                                     Buckets: 16384  Batches: 1  Memory Usage: 544kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=5677 width=4) (actual time=0.040..22.346 rows=3258 loops=3)
                                                                           Filter: ((country_code)::text = '[de]'::text)
                                                                           Rows Removed by Filter: 75074
                                                         ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=272.845..272.845 rows=153308 loops=3)
                                                               Buckets: 131072 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 3328kB
                                                               ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.161..163.551 rows=153308 loops=3)
                                                                     Hash Cond: (miidx.info_type_id = it.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.041..77.573 rows=460012 loops=3)
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.045 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'rating'::text)
                                                                                 Rows Removed by Filter: 112
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 20.042 ms
 Execution Time: 3301.943 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13b.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348980.78..348980.79 rows=1 width=96) (actual time=4219.802..4219.802 rows=1 loops=1)
   ->  Gather  (cost=348980.66..348980.77 rows=1 width=96) (actual time=4219.563..4224.815 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347980.66..347980.67 rows=1 width=96) (actual time=4213.844..4213.844 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343069.37..347980.65 rows=1 width=41) (actual time=4184.817..4213.701 rows=186 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.009..24.719 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343069.35..343069.35 rows=1 width=26) (actual time=4183.946..4183.946 rows=313 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102229.55..343069.35 rows=1 width=26) (actual time=2415.068..4183.771 rows=313 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=668.211..2751.476 rows=1518360 loops=2)
                                       Hash Cond: (mi.info_type_id = it2.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.033..1629.111 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102227.11..102227.11 rows=1 width=38) (actual time=1286.499..1286.499 rows=58 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=86956.85..102227.11 rows=1 width=38) (actual time=1129.930..1286.411 rows=58 loops=2)
                                             Hash Cond: (miidx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.144..235.915 rows=229962 loops=2)
                                                   Hash Cond: (miidx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.018..112.795 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.043 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86954.33..86954.33 rows=7 width=29) (actual time=1026.450..1026.451 rows=178 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=54438.22..86954.33 rows=7 width=29) (actual time=899.457..1026.229 rows=178 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Hash Join  (cost=54437.16..86953.12 rows=29 width=33) (actual time=679.698..1026.012 rows=384 loops=2)
                                                               Hash Cond: (t.kind_id = kt.id)
                                                               ->  Parallel Hash Join  (cost=54436.06..86951.16 rows=202 width=37) (actual time=609.736..1025.569 rows=1330 loops=2)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.012..228.712 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=54433.61..54433.61 rows=196 width=25) (actual time=609.423..609.423 rows=1109 loops=2)
                                                                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=196 width=25) (actual time=0.188..601.132 rows=1109 loops=2)
                                                                                 Filter: (((title)::text <> ''::text) AND (((title)::text ~~ '%Champion%'::text) OR ((title)::text ~~ '%Loser%'::text)))
                                                                                 Rows Removed by Filter: 1263047
                                                               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=2)
                                                                           Filter: ((kind)::text = 'movie'::text)
                                                                           Rows Removed by Filter: 6
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.037 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
 Planning Time: 21.694 ms
 Execution Time: 4225.852 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13c.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348980.78..348980.79 rows=1 width=96) (actual time=4069.836..4069.836 rows=1 loops=1)
   ->  Gather  (cost=348980.66..348980.77 rows=1 width=96) (actual time=4069.572..4074.824 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347980.66..347980.67 rows=1 width=96) (actual time=4064.088..4064.089 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343069.37..347980.65 rows=1 width=41) (actual time=4039.490..4064.027 rows=26 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.010..24.640 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343069.35..343069.35 rows=1 width=26) (actual time=4034.655..4034.655 rows=81 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102229.55..343069.35 rows=1 width=26) (actual time=2300.365..4034.530 rows=81 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=672.328..2772.296 rows=1518360 loops=2)
                                       Hash Cond: (mi.info_type_id = it2.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.031..1652.380 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.023 rows=1 loops=2)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102227.11..102227.11 rows=1 width=38) (actual time=1118.836..1118.836 rows=16 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=86956.85..102227.11 rows=1 width=38) (actual time=1051.974..1118.788 rows=16 loops=2)
                                             Hash Cond: (miidx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.147..236.435 rows=229962 loops=2)
                                                   Hash Cond: (miidx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..113.612 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.041 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86954.33..86954.33 rows=7 width=29) (actual time=859.680..859.680 rows=40 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=54438.22..86954.33 rows=7 width=29) (actual time=757.266..859.587 rows=40 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Hash Join  (cost=54437.16..86953.12 rows=29 width=33) (actual time=549.874..859.458 rows=90 loops=2)
                                                               Hash Cond: (t.kind_id = kt.id)
                                                               ->  Parallel Hash Join  (cost=54436.06..86951.16 rows=202 width=37) (actual time=463.743..859.316 rows=184 loops=2)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.012..229.226 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=54433.61..54433.61 rows=196 width=25) (actual time=463.327..463.327 rows=147 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=196 width=25) (actual time=6.467..463.075 rows=147 loops=2)
                                                                                 Filter: (((title)::text <> ''::text) AND (((title)::text ~~ 'Champion%'::text) OR ((title)::text ~~ 'Loser%'::text)))
                                                                                 Rows Removed by Filter: 1264009
                                                               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=2)
                                                                           Filter: ((kind)::text = 'movie'::text)
                                                                           Rows Removed by Filter: 6
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
 Planning Time: 20.677 ms
 Execution Time: 4075.710 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13d.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=346725.46..346725.47 rows=1 width=96) (actual time=8915.151..8915.151 rows=1 loops=1)
   ->  Gather  (cost=346725.34..346725.45 rows=1 width=96) (actual time=8915.064..9132.649 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=345725.34..345725.35 rows=1 width=96) (actual time=8908.602..8908.602 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=340435.70..345724.28 rows=141 width=41) (actual time=8578.269..8783.534 rows=335195 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.019..25.438 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=340432.26..340432.26 rows=275 width=26) (actual time=8527.425..8527.425 rows=959748 loops=2)
                           Buckets: 65536 (originally 1024)  Batches: 64 (originally 1)  Memory Usage: 4352kB
                           ->  Hash Join  (cost=306684.12..340432.26 rows=275 width=26) (actual time=6486.065..7936.767 rows=959748 loops=2)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=306683.05..340425.77 rows=1004 width=30) (actual time=6426.980..7455.345 rows=4061793 loops=2)
                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.031..231.583 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=306680.43..306680.43 rows=210 width=34) (actual time=5841.051..5841.051 rows=362366 loops=2)
                                             Buckets: 65536 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 3680kB
                                             ->  Hash Join  (cost=256185.00..306680.43 rows=210 width=34) (actual time=4947.340..5607.426 rows=362366 loops=2)
                                                   Hash Cond: (t.kind_id = kt.id)
                                                   ->  Parallel Hash Join  (cost=256183.90..306673.14 rows=1468 width=38) (actual time=4931.604..5500.823 rows=559492 loops=2)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.037..332.635 rows=1264156 loops=2)
                                                         ->  Parallel Hash  (cost=256165.55..256165.55 rows=1468 width=13) (actual time=4106.140..4106.140 rows=559492 loops=2)
                                                               Buckets: 131072 (originally 4096)  Batches: 16 (originally 1)  Memory Usage: 4384kB
                                                               ->  Parallel Hash Join  (cost=15319.64..256165.55 rows=1468 width=13) (actual time=3538.655..3882.253 rows=559492 loops=2)
                                                                     Hash Cond: (mi.movie_id = miidx.movie_id)
                                                                     ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=670.017..2785.217 rows=1518360 loops=2)
                                                                           Hash Cond: (mi.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.035..1653.754 rows=7417860 loops=2)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.023..0.033 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=381.665..381.665 rows=229962 loops=2)
                                                                           Buckets: 131072 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 3328kB
                                                                           ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.149..240.763 rows=229962 loops=2)
                                                                                 Hash Cond: (miidx.info_type_id = it.id)
                                                                                 ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.042..113.713 rows=690018 loops=2)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.035..0.037 rows=1 loops=2)
                                                                                             Filter: ((info)::text = 'rating'::text)
                                                                                             Rows Removed by Filter: 112
                                                   ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=2)
                                                               Filter: ((kind)::text = 'movie'::text)
                                                               Rows Removed by Filter: 6
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=2)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
 Planning Time: 20.152 ms
 Execution Time: 9133.892 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14a.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=420522.53..420522.54 rows=1 width=64) (actual time=3457.622..3457.622 rows=1 loops=1)
   ->  Gather  (cost=420522.31..420522.52 rows=2 width=64) (actual time=3456.847..3462.861 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=419522.31..419522.32 rows=1 width=64) (actual time=3450.049..3450.049 rows=1 loops=3)
               ->  Hash Join  (cost=369734.11..419522.30 rows=1 width=22) (actual time=3353.268..3449.783 rows=254 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=369733.01..419521.20 rows=1 width=26) (actual time=3192.948..3449.370 rows=328 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=25) (actual time=0.021..237.807 rows=130555 loops=3)
                                 Filter: (production_year > 2010)
                                 Rows Removed by Filter: 712215
                           ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3188.268..3188.268 rows=6989 loops=3)
                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                 ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2917.775..3160.840 rows=6989 loops=3)
                                       Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                       ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.160..221.102 rows=151410 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.048..157.498 rows=447629 loops=3)
                                                   Filter: ((info)::text < '8.5'::text)
                                                   Rows Removed by Filter: 12383
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2916.982..2916.982 rows=7972 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                             ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2363.725..2870.813 rows=7972 loops=3)
                                                   Hash Cond: (mi.movie_id = mk.movie_id)
                                                   ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1805.021..2283.833 rows=204750 loops=3)
                                                         Hash Cond: (mi.info_type_id = it1.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=2.028..2232.490 rows=235558 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4709682
                                                         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.057 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.046 rows=1 loops=3)
                                                                     Filter: ((info)::text = 'countries'::text)
                                                                     Rows Removed by Filter: 112
                                                   ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=557.922..557.922 rows=12364 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=29.247..470.132 rows=12364 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.030..253.386 rows=1507977 loops=3)
                                                               ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=29.096..29.096 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.384..29.084 rows=3 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                           Rows Removed by Filter: 134167
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.039..0.040 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 12.238 ms
 Execution Time: 3463.548 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14b.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=426312.24..426312.25 rows=1 width=64) (actual time=3203.147..3203.148 rows=1 loops=1)
   ->  Gather  (cost=426312.02..426312.23 rows=2 width=64) (actual time=3202.909..3209.717 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=425312.02..425312.03 rows=1 width=64) (actual time=3196.010..3196.011 rows=1 loops=3)
               ->  Hash Join  (cost=409759.67..425312.01 rows=1 width=22) (actual time=3182.465..3196.004 rows=0 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=409758.57..425310.91 rows=1 width=26) (actual time=3124.828..3195.732 rows=1 loops=3)
                           Hash Cond: (mi_idx.movie_id = t.id)
                           ->  Hash Join  (cost=2.43..15549.59 rows=1379 width=9) (actual time=0.162..166.382 rows=86616 loops=3)
                                 Hash Cond: (mi_idx.info_type_id = it2.id)
                                 ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=155862 width=13) (actual time=0.048..140.970 rows=125612 loops=3)
                                       Filter: ((info)::text > '6.0'::text)
                                       Rows Removed by Filter: 334399
                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.041..0.041 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=3)
                                             Filter: ((info)::text = 'rating'::text)
                                             Rows Removed by Filter: 112
                           ->  Parallel Hash  (cost=409756.13..409756.13 rows=1 width=33) (actual time=3019.581..3019.581 rows=3 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=361504.10..409756.13 rows=1 width=33) (actual time=2751.132..3019.469 rows=3 loops=3)
                                       Hash Cond: (mk.movie_id = t.id)
                                       ->  Hash Join  (cost=2626.15..50878.06 rows=28 width=4) (actual time=22.634..466.136 rows=6509 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.015..258.136 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=2 width=4) (actual time=22.357..22.357 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=2 width=4) (actual time=1.303..22.340 rows=1 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title}'::text[]))
                                                         Rows Removed by Filter: 134169
                                       ->  Parallel Hash  (cost=358877.94..358877.94 rows=1 width=29) (actual time=2551.551..2551.551 rows=41 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=57070.27..358877.94 rows=1 width=29) (actual time=2102.673..2551.377 rows=41 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=57067.84..358875.48 rows=12 width=33) (actual time=319.965..2551.243 rows=49 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.004..2251.752 rows=235558 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4709682
                                                         ->  Parallel Hash  (cost=57067.27..57067.27 rows=46 width=25) (actual time=272.635..272.635 rows=152 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=46 width=25) (actual time=0.542..272.348 rows=152 loops=3)
                                                                     Filter: ((production_year > 2010) AND (((title)::text ~~ '%murder%'::text) OR ((title)::text ~~ '%Murder%'::text) OR ((title)::text ~~ '%Mord%'::text)))
                                                                     Rows Removed by Filter: 842619
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.028..0.039 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.038..0.040 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 12.769 ms
 Execution Time: 3210.430 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14c.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=421498.92..421498.93 rows=1 width=64) (actual time=3522.231..3522.231 rows=1 loops=1)
   ->  Gather  (cost=421498.70..421498.91 rows=2 width=64) (actual time=3521.437..3527.673 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=420498.70..420498.71 rows=1 width=64) (actual time=3514.692..3514.692 rows=1 loops=3)
               ->  Hash Join  (cost=369734.12..420498.70 rows=1 width=22) (actual time=3211.590..3513.562 rows=1372 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=369733.01..420497.58 rows=1 width=26) (actual time=3209.503..3512.629 rows=1710 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.043..257.477 rows=337640 loops=3)
                                 Filter: (production_year > 2005)
                                 Rows Removed by Filter: 505131
                           ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3207.245..3207.245 rows=6989 loops=3)
                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                 ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2935.255..3179.694 rows=6989 loops=3)
                                       Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                       ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.181..222.427 rows=151410 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.048..158.810 rows=447629 loops=3)
                                                   Filter: ((info)::text < '8.5'::text)
                                                   Rows Removed by Filter: 12383
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2934.549..2934.550 rows=7972 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1496kB
                                             ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2377.351..2885.120 rows=7972 loops=3)
                                                   Hash Cond: (mi.movie_id = mk.movie_id)
                                                   ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1802.455..2281.238 rows=204750 loops=3)
                                                         Hash Cond: (mi.info_type_id = it1.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.032..2229.414 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.045 rows=1 loops=3)
                                                                     Filter: ((info)::text = 'countries'::text)
                                                                     Rows Removed by Filter: 112
                                                   ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=574.500..574.500 rows=12364 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=30.343..471.679 rows=12364 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.029..253.355 rows=1507977 loops=3)
                                                               ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=30.184..30.184 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.415..30.171 rows=3 loops=3)
                                                                           Filter: ((keyword IS NOT NULL) AND ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[])))
                                                                           Rows Removed by Filter: 134167
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.063..0.063 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.039..0.042 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 12.270 ms
 Execution Time: 3528.471 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=409625.94..409625.95 rows=1 width=64) (actual time=3579.128..3579.129 rows=1 loops=1)
   ->  Gather  (cost=409625.72..409625.93 rows=2 width=64) (actual time=3578.867..3586.041 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=408625.72..408625.73 rows=1 width=64) (actual time=3571.637..3571.638 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=400362.74..408625.68 rows=8 width=60) (actual time=3519.769..3571.547 rows=109 loops=3)
                     Hash Cond: (at.movie_id = t.id)
                     ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.041..36.401 rows=120491 loops=3)
                     ->  Parallel Hash  (cost=400362.70..400362.70 rows=3 width=76) (actual time=3517.315..3517.315 rows=466 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                           ->  Parallel Hash Join  (cost=396456.49..400362.70 rows=3 width=76) (actual time=3459.343..3501.694 rows=466 loops=3)
                                 Hash Cond: (k.id = mk.keyword_id)
                                 ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.130..36.718 rows=44723 loops=3)
                                       Heap Fetches: 134170
                                 ->  Parallel Hash  (cost=396456.03..396456.03 rows=3 width=80) (actual time=3459.117..3459.117 rows=466 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=346083.67..396456.03 rows=3 width=80) (actual time=2988.734..3426.654 rows=466 loops=3)
                                             Hash Cond: (mk.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.011..249.074 rows=1507977 loops=3)
                                             ->  Parallel Hash  (cost=346083.66..346083.66 rows=1 width=72) (actual time=2988.419..2988.419 rows=220 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=294758.03..346083.66 rows=1 width=72) (actual time=2675.436..2988.074 rows=220 loops=3)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.015..260.477 rows=460484 loops=3)
                                                               Filter: (production_year > 2000)
                                                               Rows Removed by Filter: 382286
                                                         ->  Parallel Hash  (cost=294758.02..294758.02 rows=1 width=51) (actual time=2673.326..2673.326 rows=223 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Hash Join  (cost=289846.73..294758.02 rows=1 width=51) (actual time=2647.010..2673.121 rows=223 loops=3)
                                                                     Hash Cond: (mc.company_type_id = ct.id)
                                                                     ->  Parallel Hash Join  (cost=289845.64..294756.93 rows=1 width=55) (actual time=2646.896..2672.930 rows=223 loops=3)
                                                                           Hash Cond: (cn.id = mc.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.033..22.821 rows=28281 loops=3)
                                                                                 Filter: ((country_code)::text = '[us]'::text)
                                                                                 Rows Removed by Filter: 50051
                                                                           ->  Parallel Hash  (cost=289845.63..289845.63 rows=1 width=59) (actual time=2646.602..2646.602 rows=233 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=254710.18..289845.63 rows=1 width=59) (actual time=2395.645..2646.263 rows=233 loops=3)
                                                                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=7675 width=12) (actual time=0.035..246.859 rows=20555 loops=3)
                                                                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))
                                                                                             Rows Removed by Filter: 849155
                                                                                       ->  Parallel Hash  (cost=254710.16..254710.16 rows=2 width=47) (actual time=2395.010..2395.015 rows=590 loops=3)
                                                                                             Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                                             ->  Hash Join  (cost=2.43..254710.16 rows=2 width=47) (actual time=287.585..1139.587 rows=590 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=51) (actual time=287.457..1138.895 rows=590 loops=3)
                                                                                                         Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                                                                                         Rows Removed by Filter: 4944650
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.051 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'release dates'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.062..0.062 rows=4 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.037..0.038 rows=4 loops=3)
 Planning Time: 32.101 ms
 Execution Time: 3586.828 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=411365.11..411365.12 rows=1 width=64) (actual time=2431.469..2431.469 rows=1 loops=1)
   ->  Gather  (cost=411364.89..411365.10 rows=2 width=64) (actual time=2431.157..2439.347 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=410364.89..410364.90 rows=1 width=64) (actual time=2423.476..2423.477 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=402101.92..410364.87 rows=4 width=60) (actual time=2415.495..2423.456 rows=12 loops=3)
                     Hash Cond: (at.movie_id = t.id)
                     ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.041..38.718 rows=120491 loops=3)
                     ->  Parallel Hash  (cost=402101.90..402101.90 rows=2 width=76) (actual time=2368.318..2368.318 rows=50 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=147394.15..402101.90 rows=2 width=76) (actual time=1413.735..2368.180 rows=50 loops=3)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..254710.16 rows=2 width=47) (actual time=314.015..1299.876 rows=590 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=51) (actual time=313.870..1299.178 rows=590 loops=3)
                                             Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                             Rows Removed by Filter: 4944650
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.045 rows=1 loops=3)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=147391.71..147391.71 rows=1 width=29) (actual time=1067.976..1067.976 rows=144 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=143485.50..147391.71 rows=1 width=29) (actual time=1016.596..1067.762 rows=144 loops=3)
                                             Hash Cond: (k.id = mk.keyword_id)
                                             ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.056..46.091 rows=44723 loops=3)
                                                   Heap Fetches: 134170
                                             ->  Parallel Hash  (cost=143485.07..143485.07 rows=1 width=33) (actual time=1016.373..1016.373 rows=144 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=93112.71..143485.07 rows=1 width=33) (actual time=580.513..1016.182 rows=144 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.031..253.601 rows=1507977 loops=3)
                                                         ->  Parallel Hash  (cost=93112.69..93112.69 rows=1 width=25) (actual time=576.913..576.913 rows=85 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=40186.82..93112.69 rows=1 width=25) (actual time=291.908..576.697 rows=85 loops=3)
                                                                     Hash Cond: (t.id = mc.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=300243 width=21) (actual time=0.026..260.077 rows=238753 loops=3)
                                                                           Filter: ((production_year >= 2005) AND (production_year <= 2010))
                                                                           Rows Removed by Filter: 604018
                                                                     ->  Parallel Hash  (cost=40186.81..40186.81 rows=1 width=4) (actual time=288.343..288.343 rows=93 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Hash Join  (cost=5069.61..40186.81 rows=1 width=4) (actual time=24.870..288.165 rows=93 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=5068.52..40185.72 rows=1 width=8) (actual time=24.749..287.999 rows=93 loops=3)
                                                                                       Hash Cond: (mc.company_id = cn.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=7675 width=12) (actual time=0.064..261.138 rows=20555 loops=3)
                                                                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))
                                                                                             Rows Removed by Filter: 849155
                                                                                       ->  Parallel Hash  (cost=5068.50..5068.50 rows=1 width=4) (actual time=23.372..23.372 rows=0 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..5068.50 rows=1 width=4) (actual time=16.603..23.333 rows=0 loops=3)
                                                                                                   Filter: (((country_code)::text = '[us]'::text) AND ((name)::text = 'YouTube'::text))
                                                                                                   Rows Removed by Filter: 78332
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.066..0.066 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.040..0.041 rows=4 loops=3)
 Planning Time: 32.213 ms
 Execution Time: 2440.222 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15c.sql_explained.sql
SET
SET
                                                                                                                            QUERY PLAN                                                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=424524.77..424524.78 rows=1 width=64) (actual time=3667.787..3667.787 rows=1 loops=1)
   ->  Gather  (cost=424524.55..424524.76 rows=2 width=64) (actual time=3667.441..3674.451 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=423524.55..423524.56 rows=1 width=64) (actual time=3660.180..3660.180 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=419547.77..423524.17 rows=76 width=60) (actual time=3616.087..3659.790 rows=757 loops=3)
                     Hash Cond: (k.id = mk.keyword_id)
                     ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.083..38.409 rows=44723 loops=3)
                           Heap Fetches: 134170
                     ->  Parallel Hash  (cost=419546.40..419546.40 rows=76 width=64) (actual time=3615.308..3615.308 rows=757 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                           ->  Parallel Hash Join  (cost=369174.02..419546.40 rows=76 width=64) (actual time=3068.453..3496.488 rows=757 loops=3)
                                 Hash Cond: (mk.movie_id = t.id)
                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..248.760 rows=1507977 loops=3)
                                 ->  Parallel Hash  (cost=369173.97..369173.97 rows=4 width=76) (actual time=3064.270..3064.270 rows=95 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=364262.66..369173.97 rows=4 width=76) (actual time=3043.728..3064.163 rows=95 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Hash Join  (cost=364261.57..369172.86 rows=4 width=80) (actual time=3043.611..3064.012 rows=95 loops=3)
                                                   Hash Cond: (cn.id = mc.company_id)
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.008..17.513 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
                                                   ->  Parallel Hash  (cost=364261.48..364261.48 rows=7 width=84) (actual time=3043.418..3043.418 rows=133 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=330523.34..364261.48 rows=7 width=84) (actual time=2781.688..3043.218 rows=133 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.024..156.641 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=330523.33..330523.33 rows=1 width=72) (actual time=2778.559..2778.559 rows=40 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=278615.36..330523.33 rows=1 width=72) (actual time=2455.808..2778.460 rows=40 loops=3)
                                                                           Hash Cond: (t.id = at.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.020..271.574 rows=583011 loops=3)
                                                                                 Filter: (production_year > 1990)
                                                                                 Rows Removed by Filter: 259760
                                                                           ->  Parallel Hash  (cost=278615.33..278615.33 rows=2 width=51) (actual time=2446.520..2446.520 rows=40 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=270164.12..278615.33 rows=2 width=51) (actual time=2392.684..2446.407 rows=40 loops=3)
                                                                                       Hash Cond: (at.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.039..36.327 rows=120491 loops=3)
                                                                                       ->  Parallel Hash  (cost=270164.10..270164.10 rows=2 width=47) (actual time=2391.530..2391.531 rows=594 loops=3)
                                                                                             Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                                             ->  Hash Join  (cost=2.43..270164.10 rows=2 width=47) (actual time=297.918..1150.742 rows=594 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=51) (actual time=297.797..1150.046 rows=594 loops=3)
                                                                                                         Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                                         Rows Removed by Filter: 4944646
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.035..0.045 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'release dates'::text)
                                                                                                               Rows Removed by Filter: 112
                                             ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.061..0.066 rows=4 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.036..0.037 rows=4 loops=3)
 Planning Time: 31.498 ms
 Execution Time: 3675.293 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=397267.91..397267.92 rows=1 width=64) (actual time=2637.944..2637.944 rows=1 loops=1)
   ->  Gather  (cost=397267.69..397267.90 rows=2 width=64) (actual time=2636.312..2645.702 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=396267.69..396267.70 rows=1 width=64) (actual time=2628.825..2628.826 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=345880.45..396258.32 rows=1873 width=38) (actual time=2180.048..2627.610 rows=3782 loops=3)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Parallel Hash Join  (cost=341484.68..391857.62 rows=1873 width=42) (actual time=2104.076..2549.470 rows=3782 loops=3)
                           Hash Cond: (mk.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..258.464 rows=1507977 loops=3)
                           ->  Parallel Hash  (cost=341483.66..341483.66 rows=81 width=54) (actual time=2098.521..2098.521 rows=292 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Hash Join  (cost=336383.26..341483.66 rows=81 width=54) (actual time=2075.998..2098.176 rows=292 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=336382.17..341482.14 rows=81 width=58) (actual time=2075.843..2097.923 rows=292 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..18.253 rows=28281 loops=3)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 50051
                                             ->  Parallel Hash  (cost=336380.22..336380.22 rows=156 width=62) (actual time=2075.707..2075.707 rows=700 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                   ->  Parallel Hash Join  (cost=302641.96..336380.22 rows=156 width=62) (actual time=1764.293..2046.567 rows=700 loops=3)
                                                         Hash Cond: (mc.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.246..167.518 rows=869710 loops=3)
                                                         ->  Parallel Hash  (cost=302641.58..302641.58 rows=30 width=50) (actual time=1762.590..1762.590 rows=195 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=250733.50..302641.58 rows=30 width=50) (actual time=1424.979..1762.235 rows=195 loops=3)
                                                                     Hash Cond: (t.id = at.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.022..274.403 rows=583011 loops=3)
                                                                           Filter: (production_year > 1990)
                                                                           Rows Removed by Filter: 259760
                                                                     ->  Parallel Hash  (cost=250732.96..250732.96 rows=43 width=29) (actual time=1422.427..1422.427 rows=197 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=239269.32..250732.96 rows=43 width=29) (actual time=1364.824..1422.024 rows=197 loops=3)
                                                                                 Hash Cond: (at.movie_id = mi.movie_id)
                                                                                 ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=25) (actual time=0.046..37.685 rows=120491 loops=3)
                                                                                 ->  Parallel Hash  (cost=239268.80..239268.80 rows=42 width=4) (actual time=1364.476..1364.476 rows=3560 loops=3)
                                                                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                                                                       ->  Hash Join  (cost=2.43..239268.80 rows=42 width=4) (actual time=309.194..1269.926 rows=3560 loops=3)
                                                                                             Hash Cond: (mi.info_type_id = it1.id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=4774 width=8) (actual time=53.818..1267.281 rows=3603 loops=3)
                                                                                                   Filter: ((note)::text ~~ '%internet%'::text)
                                                                                                   Rows Removed by Filter: 4941637
                                                                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.045 rows=1 loops=3)
                                                                                                         Filter: ((info)::text = 'release dates'::text)
                                                                                                         Rows Removed by Filter: 112
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.074..0.074 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.049..0.051 rows=4 loops=3)
                     ->  Parallel Hash  (cost=3696.98..3696.98 rows=55904 width=4) (actual time=73.866..73.866 rows=44723 loops=3)
                           Buckets: 262144  Batches: 1  Memory Usage: 7328kB
                           ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.058..47.667 rows=44723 loops=3)
                                 Heap Fetches: 134170
 Planning Time: 30.893 ms
 Execution Time: 2646.506 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=683598.14..683598.15 rows=1 width=64) (actual time=6018.431..6018.431 rows=1 loops=1)
   ->  Gather  (cost=683597.92..683598.13 rows=2 width=64) (actual time=6017.260..6024.700 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=682597.92..682597.93 rows=1 width=64) (actual time=6010.205..6010.205 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=666037.80..682597.77 rows=31 width=33) (actual time=5898.235..6010.070 rows=128 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.086..74.639 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=666037.56..666037.56 rows=19 width=25) (actual time=5894.885..5894.885 rows=108 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=661126.21..666037.56 rows=19 width=25) (actual time=5874.500..5894.741 rows=108 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.008..17.760 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=661125.74..661125.74 rows=37 width=29) (actual time=5873.932..5873.932 rows=363 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                       ->  Parallel Hash Join  (cost=627387.45..661125.74 rows=37 width=29) (actual time=5602.782..5873.715 rows=363 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.033..157.935 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=627387.27..627387.27 rows=14 width=37) (actual time=5596.830..5596.830 rows=391 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                   ->  Parallel Hash Join  (cost=547897.96..627387.27 rows=14 width=37) (actual time=5021.780..5596.313 rows=391 loops=3)
                                                         Hash Cond: (n.id = ci.person_id)
                                                         ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.058..376.504 rows=1389164 loops=3)
                                                         ->  Parallel Hash  (cost=547897.79..547897.79 rows=14 width=33) (actual time=5018.116..5018.116 rows=391 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                               ->  Parallel Hash Join  (cost=103031.36..547897.79 rows=14 width=33) (actual time=793.732..5017.391 rows=391 loops=3)
                                                                     Hash Cond: (ci.movie_id = mk.movie_id)
                                                                     ->  Parallel Hash Join  (cost=52153.14..495500.56 rows=405052 width=29) (actual time=269.203..4430.579 rows=388676 loops=3)
                                                                           Hash Cond: (ci.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.031..2145.224 rows=12081448 loops=3)
                                                                           ->  Parallel Hash  (cost=51799.95..51799.95 rows=28255 width=21) (actual time=267.896..267.897 rows=22748 loops=3)
                                                                                 Buckets: 131072  Batches: 1  Memory Usage: 4736kB
                                                                                 ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=28255 width=21) (actual time=0.039..248.359 rows=22748 loops=3)
                                                                                       Filter: ((episode_nr >= 50) AND (episode_nr < 100))
                                                                                       Rows Removed by Filter: 820022
                                                                     ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=505.770..505.771 rows=13947 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                           ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=17.824..455.931 rows=13947 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.037..251.853 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=17.579..17.579 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.766..17.561 rows=1 loops=3)
                                                                                             Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                             Rows Removed by Filter: 134169
 Planning Time: 15.351 ms
 Execution Time: 6025.428 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16b.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=697874.98..697874.99 rows=1 width=64) (actual time=9695.121..9695.122 rows=1 loops=1)
   ->  Gather  (cost=697874.76..697874.97 rows=2 width=64) (actual time=9687.402..10026.623 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=696874.76..696874.77 rows=1 width=64) (actual time=9680.230..9680.230 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=617374.97..696869.01 rows=1150 width=33) (actual time=8444.727..9336.894 rows=1236864 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.053..375.026 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=617360.59..617360.59 rows=1150 width=41) (actual time=7516.616..7516.616 rows=1236864 loops=3)
                           Buckets: 65536 (originally 4096)  Batches: 64 (originally 1)  Memory Usage: 6368kB
                           ->  Parallel Hash Join  (cost=600795.85..617360.59 rows=1150 width=41) (actual time=6540.128..6989.615 rows=1236864 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.038..72.717 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=21) (actual time=6333.525..6333.525 rows=944185 loops=3)
                                       Buckets: 65536 (originally 2048)  Batches: 64 (originally 1)  Memory Usage: 3456kB
                                       ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=21) (actual time=1344.864..5682.441 rows=944185 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.030..2181.476 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=29) (actual time=1344.708..1344.708 rows=22772 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6776kB
                                                   ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=29) (actual time=981.485..1301.809 rows=22772 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=33) (actual time=941.577..1246.621 rows=49517 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.025..156.556 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=25) (actual time=941.234..941.234 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=25) (actual time=517.057..870.220 rows=13947 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.029..213.991 rows=842771 loops=3)
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=516.851..516.851 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=18.449..460.970 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.075..255.930 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.275..18.275 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.777..18.264 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.884..38.884 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.036..24.791 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.560 ms
 Execution Time: 10027.390 ms
(47 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16c.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=698025.50..698025.51 rows=1 width=64) (actual time=7414.259..7414.259 rows=1 loops=1)
   ->  Gather  (cost=698025.28..698025.49 rows=2 width=64) (actual time=7407.610..7559.454 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=697025.28..697025.29 rows=1 width=64) (actual time=7400.178..7400.178 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=617532.05..697023.11 rows=434 width=33) (actual time=6970.282..7367.701 rows=106644 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.050..396.796 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=617526.63..617526.63 rows=434 width=41) (actual time=6049.701..6049.701 rows=106644 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 8 (originally 1)  Memory Usage: 4256kB
                           ->  Parallel Hash Join  (cost=600964.87..617526.63 rows=434 width=41) (actual time=5853.210..5969.062 rows=106644 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.029..79.925 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=600962.51..600962.51 rows=189 width=21) (actual time=5656.981..5656.981 rows=73870 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2368kB
                                       ->  Parallel Hash Join  (cost=140625.02..600962.51 rows=189 width=21) (actual time=1307.495..5488.300 rows=73870 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.031..2285.622 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=140624.89..140624.89 rows=10 width=29) (actual time=1307.118..1307.118 rows=2846 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                                   ->  Parallel Hash Join  (cost=106886.67..140624.89 rows=10 width=29) (actual time=947.287..1233.833 rows=2846 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=101535.88..135274.04 rows=28 width=33) (actual time=904.398..1189.183 rows=3802 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=1.933..161.499 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=101535.82..101535.82 rows=5 width=25) (actual time=900.739..900.739 rows=2309 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 600kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..101535.82 rows=5 width=25) (actual time=530.693..847.411 rows=2309 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=397676 width=21) (actual time=0.028..267.203 rows=315635 loops=3)
                                                                                 Filter: (episode_nr < 100)
                                                                                 Rows Removed by Filter: 527135
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=530.446..530.446 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.328..464.868 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.040..259.321 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.182..19.183 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.809..19.171 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=41.947..41.947 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.039..25.638 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.313 ms
 Execution Time: 7560.173 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=700256.85..700256.86 rows=1 width=64) (actual time=7471.131..7471.132 rows=1 loops=1)
   ->  Gather  (cost=700256.63..700256.84 rows=2 width=64) (actual time=7467.237..7608.290 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=699256.63..699256.64 rows=1 width=64) (actual time=7459.834..7459.834 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=619764.46..699255.04 rows=318 width=33) (actual time=7035.676..7434.242 rows=83152 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.043..392.426 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=619760.48..619760.48 rows=318 width=41) (actual time=6119.944..6119.944 rows=83152 loops=3)
                           Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 3424kB
                           ->  Parallel Hash Join  (cost=603199.22..619760.48 rows=318 width=41) (actual time=5941.946..6049.727 rows=83152 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.035..82.111 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=603197.49..603197.49 rows=138 width=21) (actual time=5743.428..5743.428 rows=56424 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 1920kB
                                       ->  Parallel Hash Join  (cost=142860.13..603197.49 rows=138 width=21) (actual time=1441.097..5566.409 rows=56424 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.029..2289.086 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=142860.03..142860.03 rows=8 width=29) (actual time=1440.819..1440.819 rows=2255 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                                                   ->  Parallel Hash Join  (cost=109121.82..142860.03 rows=8 width=29) (actual time=1114.738..1406.984 rows=2255 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=103771.04..137509.19 rows=20 width=33) (actual time=1071.897..1362.663 rows=2887 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.028..167.721 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=103770.99..103770.99 rows=4 width=25) (actual time=1071.190..1071.190 rows=1795 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..103770.99 rows=4 width=25) (actual time=530.329..829.932 rows=1795 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=291411 width=21) (actual time=0.034..258.178 rows=230852 loops=3)
                                                                                 Filter: ((episode_nr >= 5) AND (episode_nr < 100))
                                                                                 Rows Removed by Filter: 611919
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=530.112..530.112 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.666..467.398 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.100..261.530 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.459..19.460 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.812..19.449 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=41.920..41.920 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4352kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.040..25.838 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.588 ms
 Execution Time: 7610.551 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17a.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=680693.62..680693.63 rows=1 width=64) (actual time=6811.810..6811.810 rows=1 loops=1)
   ->  Gather  (cost=680693.40..680693.61 rows=2 width=32) (actual time=6807.231..6875.350 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=679693.40..679693.41 rows=1 width=32) (actual time=6800.632..6800.632 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=600795.85..679693.30 rows=40 width=15) (actual time=6533.999..6782.330 rows=86096 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=140320 width=19) (actual time=7.892..436.345 rows=114466 loops=3)
                           Filter: ((name)::text ~~ 'B%'::text)
                           Rows Removed by Filter: 1274697
                     ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=4) (actual time=6038.122..6038.122 rows=944185 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4192kB
                           ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=4) (actual time=1385.392..5592.056 rows=944185 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.144..2166.305 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=12) (actual time=1385.140..1385.140 rows=22772 loops=3)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5304kB
                                       ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=12) (actual time=1024.323..1339.335 rows=22772 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=16) (actual time=984.312..1284.309 rows=49517 loops=3)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=1.040..158.419 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=981.705..981.705 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=517.250..865.645 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.026..209.389 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=517.008..517.008 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=18.484..456.370 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.045..251.016 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.336..18.336 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.791..18.311 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.126..39.126 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.034..24.869 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 9.008 ms
 Execution Time: 6877.500 ms
(44 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17b.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=64) (actual time=8032.213..8032.213 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=8030.590..8037.484 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=8023.861..8023.861 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=7672.608..8019.162 rows=17435 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.031..215.376 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=7670.888..7670.889 rows=17435 loops=3)
                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4344kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=7616.310..7654.452 rows=17435 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.035..17.405 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=7616.187..7616.188 rows=17435 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4472kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=7299.939..7588.617 rows=17435 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.030..158.106 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=7299.119..7299.119 rows=2214 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=2240.105..4689.435 rows=2214 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=1726.783..4160.264 rows=89570 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.027..2142.738 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=440.269..440.269 rows=12058 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3032kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=177.112..427.885 rows=12058 loops=3)
                                                                           Filter: ((name)::text ~~ 'Z%'::text)
                                                                           Rows Removed by Filter: 1377106
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=513.188..513.188 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=17.799..458.804 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.044..253.826 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=17.610..17.611 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.764..17.593 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.034 ms
 Execution Time: 8038.969 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17c.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=64) (actual time=5509.067..5509.067 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=5508.453..5515.566 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=5501.677..5501.677 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=5196.508..5501.436 rows=639 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.028..217.043 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=5169.584..5169.584 rows=639 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=5108.914..5137.019 rows=639 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.028..15.600 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=5108.741..5108.741 rows=639 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=4858.230..5108.254 rows=639 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.037..156.348 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=4841.111..4841.111 rows=83 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=2375.317..4840.921 rows=83 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=1870.103..4334.397 rows=4167 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.025..2177.365 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=602.489..602.489 rows=888 loops=3)
                                                                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=172.908..414.720 rows=888 loops=3)
                                                                           Filter: ((name)::text ~~ 'X%'::text)
                                                                           Rows Removed by Filter: 1388276
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=505.036..505.036 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=17.785..457.073 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.078..252.535 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=17.538..17.538 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.762..17.519 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.039 ms
 Execution Time: 5516.206 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17d.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=32) (actual time=6961.232..6961.232 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=6960.392..6968.557 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=6953.284..6953.284 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=6613.226..6952.170 rows=3846 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.021..222.813 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=6606.780..6606.780 rows=3846 loops=3)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=6567.928..6599.043 rows=3846 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.031..17.854 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=6567.807..6567.807 rows=3846 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1048kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=6230.605..6519.135 rows=3846 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.029..166.200 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=6228.001..6228.001 rows=657 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=1300.455..5105.990 rows=657 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=756.739..4588.644 rows=16097 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.370..2266.463 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=753.752..753.752 rows=1739 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=2.551..499.818 rows=1739 loops=3)
                                                                           Filter: ((name)::text ~~ '%Bert%'::text)
                                                                           Rows Removed by Filter: 1387425
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=511.375..511.375 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=18.313..459.704 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.138..254.560 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=17.997..17.997 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.792..17.977 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 8.988 ms
 Execution Time: 6969.186 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17e.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=694312.07..694312.08 rows=1 width=32) (actual time=8031.378..8031.378 rows=1 loops=1)
   ->  Gather  (cost=694311.86..694312.07 rows=2 width=32) (actual time=8025.333..8317.827 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=693311.86..693311.87 rows=1 width=32) (actual time=8018.251..8018.252 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=600795.85..693310.60 rows=501 width=15) (actual time=7187.867..7855.981 rows=944185 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.068..389.071 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=4) (actual time=6245.102..6245.102 rows=944185 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4192kB
                           ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=4) (actual time=1417.923..5795.257 rows=944185 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.047..2328.301 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=12) (actual time=1417.777..1417.777 rows=22772 loops=3)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5304kB
                                       ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=12) (actual time=1038.380..1368.412 rows=22772 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=16) (actual time=995.357..1308.890 rows=49517 loops=3)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.035..166.768 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=995.016..995.016 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=520.000..877.173 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.029..218.512 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=519.759..519.759 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.945..466.708 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=1.851..260.065 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=17.933..17.933 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.778..17.910 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=41.889..41.889 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.043..25.820 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 8.969 ms
 Execution Time: 8319.739 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17f.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=682238.58..682238.59 rows=1 width=32) (actual time=6905.937..6905.937 rows=1 loops=1)
   ->  Gather  (cost=682238.36..682238.57 rows=2 width=32) (actual time=6898.658..6983.760 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=681238.36..681238.37 rows=1 width=32) (actual time=6891.948..6891.949 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=647498.67..681237.95 rows=167 width=15) (actual time=6323.472..6826.407 rows=371040 loops=3)
                     Hash Cond: (mc.company_id = cn.id)
                     ->  Parallel Hash Join  (cost=641393.41..675132.25 rows=167 width=19) (actual time=6258.452..6664.284 rows=371040 loops=3)
                           Hash Cond: (mc.movie_id = ci.movie_id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.042..156.775 rows=869710 loops=3)
                           ->  Parallel Hash  (cost=641392.63..641392.63 rows=63 width=27) (actual time=6257.985..6257.985 rows=49831 loops=3)
                                 Buckets: 262144 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 13400kB
                                 ->  Parallel Hash Join  (cost=561705.80..641392.63 rows=63 width=27) (actual time=6053.182..6204.216 rows=49831 loops=3)
                                       Hash Cond: (n.id = ci.person_id)
                                       ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=210479 width=19) (actual time=0.057..513.893 rows=178905 loops=3)
                                             Filter: ((name)::text ~~ '%B%'::text)
                                             Rows Removed by Filter: 1210258
                                       ->  Parallel Hash  (cost=561699.31..561699.31 rows=519 width=16) (actual time=5450.084..5450.084 rows=346131 loops=3)
                                             Buckets: 65536 (originally 2048)  Batches: 16 (originally 1)  Memory Usage: 3680kB
                                             ->  Parallel Hash Join  (cost=101361.58..561699.31 rows=519 width=16) (actual time=995.238..5177.021 rows=346131 loops=3)
                                                   Hash Cond: (ci.movie_id = t.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.051..2168.816 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=995.079..995.079 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=529.360..878.146 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.022..212.172 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=529.194..529.194 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=18.541..461.179 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.074..254.356 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.366..18.367 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.791..18.345 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                     ->  Parallel Hash  (cost=4377.34..4377.34 rows=138234 width=4) (actual time=62.411..62.411 rows=78332 loops=3)
                           Buckets: 262144  Batches: 1  Memory Usage: 11296kB
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.033..22.381 rows=78332 loops=3)
 Planning Time: 8.981 ms
 Execution Time: 6984.367 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18a.sql_explained.sql
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=833190.17..833190.18 rows=1 width=96) (actual time=6152.801..6152.801 rows=1 loops=1)
   ->  Gather  (cost=833189.95..833190.16 rows=2 width=96) (actual time=6152.373..6158.932 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=832189.95..832189.96 rows=1 width=96) (actual time=6145.577..6145.577 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=781706.81..832189.94 rows=1 width=65) (actual time=5851.342..6145.303 rows=137 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.031..220.667 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=781706.80..781706.80 rows=1 width=60) (actual time=5814.637..5814.637 rows=137 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=540867.00..781706.80 rows=1 width=60) (actual time=5095.881..5814.377 rows=137 loops=3)
                                 Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=1019.149..1761.864 rows=40621 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.034..1137.552 rows=4945240 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=3)
                                                   Filter: ((info)::text = 'budget'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=540864.56..540864.56 rows=1 width=13) (actual time=4046.821..4046.821 rows=1145 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                       ->  Parallel Hash Join  (cost=525594.29..540864.56 rows=1 width=13) (actual time=3646.272..3823.214 rows=1145 loops=3)
                                             Hash Cond: (mi_idx.movie_id = ci.movie_id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.166..157.397 rows=153308 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.036..75.266 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.049 rows=1 loops=3)
                                                               Filter: ((info)::text = 'votes'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=525591.38..525591.38 rows=39 width=4) (actual time=3645.976..3645.976 rows=2240 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                   ->  Parallel Hash Join  (cost=81660.72..525591.38 rows=39 width=4) (actual time=2054.257..3444.456 rows=2240 loops=3)
                                                         Hash Cond: (ci.person_id = n.id)
                                                         ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=941346 width=8) (actual time=301.674..2629.254 rows=793090 loops=3)
                                                               Filter: ((note)::text = ANY ('{(producer),"(executive producer)"}'::text[]))
                                                               Rows Removed by Filter: 11288358
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=72 width=4) (actual time=731.046..731.051 rows=3021 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=72 width=4) (actual time=0.139..506.354 rows=3021 loops=3)
                                                                     Filter: (((name)::text ~~ '%Tim%'::text) AND ((gender)::text = 'm'::text))
                                                                     Rows Removed by Filter: 1386143
 Planning Time: 9.476 ms
 Execution Time: 6159.679 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18b.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=886874.06..886874.07 rows=1 width=96) (actual time=5534.473..5534.473 rows=1 loops=1)
   ->  Gather  (cost=886873.83..886874.04 rows=2 width=96) (actual time=5534.009..5541.259 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=885873.83..885873.84 rows=1 width=96) (actual time=5526.545..5526.545 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=832828.60..885873.82 rows=1 width=65) (actual time=5458.553..5526.522 rows=4 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=332069 width=21) (actual time=0.038..259.103 rows=261496 loops=3)
                           Filter: ((production_year >= 2008) AND (production_year <= 2014))
                           Rows Removed by Filter: 581275
                     ->  Parallel Hash  (cost=832828.59..832828.59 rows=1 width=60) (actual time=5238.510..5238.510 rows=5 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=754551.36..832828.59 rows=1 width=60) (actual time=4966.951..5238.392 rows=5 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=255610 width=4) (actual time=192.024..455.347 rows=320518 loops=3)
                                       Filter: ((gender IS NOT NULL) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1068645
                                 ->  Parallel Hash  (cost=754551.35..754551.35 rows=1 width=64) (actual time=4748.533..4748.533 rows=137 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=254530.67..754551.35 rows=1 width=64) (actual time=3593.995..4748.223 rows=137 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=182.266..3009.533 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=254530.66..254530.66 rows=1 width=56) (actual time=1689.306..1689.306 rows=244 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=15184.50..254530.66 rows=1 width=56) (actual time=1520.684..1688.409 rows=244 loops=3)
                                                         Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                         ->  Hash Join  (cost=2.43..239347.45 rows=298 width=47) (actual time=1364.187..1526.408 rows=24086 loops=3)
                                                               Hash Cond: (mi.info_type_id = it1.id)
                                                               ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=33653 width=51) (actual time=956.832..1518.116 rows=24349 loops=3)
                                                                     Filter: ((note IS NULL) AND ((info)::text = ANY ('{Horror,Thriller}'::text[])))
                                                                     Rows Removed by Filter: 4920891
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.042..0.042 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.029 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'genres'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=15179.85..15179.85 rows=178 width=9) (actual time=156.091..156.091 rows=5283 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 952kB
                                                               ->  Hash Join  (cost=2.43..15179.85 rows=178 width=9) (actual time=0.209..136.503 rows=5283 loops=3)
                                                                     Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.075..132.285 rows=17883 loops=3)
                                                                           Filter: ((info)::text > '8.0'::text)
                                                                           Rows Removed by Filter: 442129
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.071..0.071 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.043 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'rating'::text)
                                                                                 Rows Removed by Filter: 112
 Planning Time: 9.221 ms
 Execution Time: 5541.986 ms
(52 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18c.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=917260.31..917260.32 rows=1 width=96) (actual time=6494.175..6494.176 rows=1 loops=1)
   ->  Gather  (cost=917260.08..917260.29 rows=2 width=96) (actual time=6489.256..6510.293 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=916260.08..916260.09 rows=1 width=96) (actual time=6482.072..6482.072 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=865776.83..916260.00 rows=11 width=65) (actual time=6110.343..6475.228 rows=9358 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.024..228.053 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=865776.69..865776.69 rows=11 width=60) (actual time=6107.792..6107.792 rows=9358 loops=3)
                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2168kB
                           ->  Parallel Hash Join  (cost=785749.31..865776.69 rows=11 width=60) (actual time=5508.292..6055.363 rows=9358 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=4) (actual time=0.058..456.759 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=785748.97..785748.97 rows=27 width=64) (actual time=5507.638..5507.638 rows=18052 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4472kB
                                       ->  Parallel Hash Join  (cost=285728.20..785748.97 rows=27 width=64) (actual time=3692.698..5463.969 rows=18052 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=242.279..3017.464 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=285727.93..285727.93 rows=21 width=56) (actual time=2356.845..2356.845 rows=34172 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 7704kB
                                                   ->  Parallel Hash Join  (cost=15319.64..285727.93 rows=21 width=56) (actual time=2266.028..2323.155 rows=34172 loops=3)
                                                         Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                         ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1732.592..1956.632 rows=62198 loops=3)
                                                               Hash Cond: (mi.info_type_id = it1.id)
                                                               ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1090.187..1939.401 rows=62990 loops=3)
                                                                     Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                     Rows Removed by Filter: 4882250
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.031..0.032 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.028 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'genres'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=277.358..277.358 rows=153308 loops=3)
                                                               Buckets: 65536 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 2880kB
                                                               ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.174..167.212 rows=153308 loops=3)
                                                                     Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.052..81.332 rows=460012 loops=3)
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'votes'::text)
                                                                                 Rows Removed by Filter: 112
 Planning Time: 9.078 ms
 Execution Time: 6511.072 ms
(48 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19a.sql_explained.sql
SET
SET
                                                                                                            QUERY PLAN                                                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=982370.28..982370.29 rows=1 width=64) (actual time=6284.862..6284.862 rows=1 loops=1)
   ->  Gather  (cost=982370.06..982370.27 rows=2 width=64) (actual time=6284.540..6292.064 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=981370.06..981370.07 rows=1 width=64) (actual time=6276.985..6276.986 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=928667.96..981370.06 rows=1 width=32) (actual time=6076.568..6276.903 rows=61 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=240570 width=21) (actual time=0.012..252.877 rows=191519 loops=3)
                           Filter: ((production_year >= 2005) AND (production_year <= 2009))
                           Rows Removed by Filter: 651252
                     ->  Parallel Hash  (cost=928667.95..928667.95 rows=1 width=27) (actual time=6000.623..6000.623 rows=104 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=923756.66..928667.95 rows=1 width=27) (actual time=5975.229..6000.487 rows=104 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.033..22.484 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=923756.65..923756.65 rows=1 width=31) (actual time=5974.883..5974.883 rows=107 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=888167.49..923756.65 rows=1 width=31) (actual time=5701.325..5974.771 rows=107 loops=3)
                                             Hash Cond: (mc.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=131225 width=8) (actual time=0.034..292.716 rows=196998 loops=3)
                                                   Filter: ((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                                   Rows Removed by Filter: 672712
                                             ->  Parallel Hash  (cost=888167.48..888167.48 rows=1 width=23) (actual time=5661.781..5661.782 rows=68 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=833727.94..888167.48 rows=1 width=23) (actual time=5289.948..5661.686 rows=68 loops=3)
                                                         Hash Cond: (chn.id = ci.person_role_id)
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.036..244.038 rows=1046780 loops=3)
                                                         ->  Parallel Hash  (cost=833727.93..833727.93 rows=1 width=27) (actual time=5287.970..5287.970 rows=75 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=578391.87..833727.93 rows=1 width=27) (actual time=4025.977..5287.861 rows=75 loops=3)
                                                                     Hash Cond: (mi.movie_id = ci.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255330.90 rows=2019 width=4) (actual time=415.931..1737.403 rows=150346 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=178.409..1699.983 rows=150368 loops=3)
                                                                                 Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                 Rows Removed by Filter: 4794872
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.044 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=578389.42..578389.42 rows=2 width=23) (actual time=3532.908..3532.908 rows=142 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Hash Join  (cost=97799.03..578389.42 rows=2 width=23) (actual time=1605.165..3532.787 rows=142 loops=3)
                                                                                 Hash Cond: (ci.role_id = rt.id)
                                                                                 ->  Parallel Hash Join  (cost=97797.87..578388.18 rows=19 width=27) (actual time=1605.037..3532.613 rows=142 loops=3)
                                                                                       Hash Cond: (ci.person_id = n.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.045..2803.371 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=23) (actual time=687.271..687.271 rows=519 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                                             ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=23) (actual time=567.324..686.772 rows=519 loops=3)
                                                                                                   Hash Cond: (an.person_id = n.id)
                                                                                                   ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.028..74.499 rows=300448 loops=3)
                                                                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=565.804..565.805 rows=2256 loops=3)
                                                                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=215.600..511.827 rows=2256 loops=3)
                                                                                                               Filter: (((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))
                                                                                                               Rows Removed by Filter: 1386908
                                                                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.073..0.073 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                                                                             Filter: ((role)::text = 'actress'::text)
                                                                                             Rows Removed by Filter: 11
 Planning Time: 52.491 ms
 Execution Time: 6293.180 ms
(69 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=947597.06..947597.07 rows=1 width=64) (actual time=8385.164..8385.164 rows=1 loops=1)
   ->  Gather  (cost=947596.94..947597.05 rows=1 width=64) (actual time=8384.870..8390.409 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=946596.94..946596.95 rows=1 width=64) (actual time=8378.793..8378.794 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=941685.65..946596.94 rows=1 width=32) (actual time=8356.035..8378.771 rows=8 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.008..23.813 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=941685.64..941685.64 rows=1 width=36) (actual time=8350.398..8350.398 rows=8 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=903714.47..941685.64 rows=1 width=36) (actual time=8232.282..8350.331 rows=8 loops=2)
                                 Hash Cond: (mc.movie_id = t.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=41669 width=8) (actual time=0.019..405.844 rows=99260 loops=2)
                                       Filter: (((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                       Rows Removed by Filter: 1205305
                                 ->  Parallel Hash  (cost=903714.46..903714.46 rows=1 width=44) (actual time=7933.073..7933.073 rows=2 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=849274.92..903714.46 rows=1 width=44) (actual time=7844.122..7933.035 rows=2 loops=2)
                                             Hash Cond: (chn.id = ci.person_role_id)
                                             ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.027..359.158 rows=1570170 loops=2)
                                             ->  Parallel Hash  (cost=849274.91..849274.91 rows=1 width=48) (actual time=7386.278..7386.278 rows=2 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                   ->  Parallel Hash Join  (cost=833137.42..849274.91 rows=1 width=48) (actual time=7328.341..7386.227 rows=2 loops=2)
                                                         Hash Cond: (n.id = ci.person_id)
                                                         ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=23) (actual time=794.229..968.601 rows=648 loops=2)
                                                               Hash Cond: (an.person_id = n.id)
                                                               ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.020..111.609 rows=450672 loops=2)
                                                               ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=790.678..790.678 rows=2704 loops=2)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=323.133..767.091 rows=2704 loops=2)
                                                                           Filter: (((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))
                                                                           Rows Removed by Filter: 2081041
                                                         ->  Parallel Hash  (cost=751477.09..751477.09 rows=1 width=37) (actual time=6417.473..6417.473 rows=8 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=496679.24..751477.09 rows=1 width=37) (actual time=4890.898..6417.435 rows=8 loops=2)
                                                                     Hash Cond: (mi.movie_id = t.id)
                                                                     ->  Hash Join  (cost=2.43..254799.18 rows=291 width=4) (actual time=620.048..2524.149 rows=34739 loops=2)
                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=32862 width=8) (actual time=619.931..2511.928 rows=34739 loops=2)
                                                                                 Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%2007%'::text) OR ((info)::text ~~ 'USA:%2008%'::text)))
                                                                                 Rows Removed by Filter: 7383121
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.028..0.039 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=496676.80..496676.80 rows=1 width=33) (actual time=3888.399..3888.399 rows=8 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Hash Join  (cost=54434.90..496676.80 rows=1 width=33) (actual time=1653.364..3888.305 rows=8 loops=2)
                                                                                 Hash Cond: (ci.role_id = rt.id)
                                                                                 ->  Parallel Hash Join  (cost=54433.73..496675.63 rows=3 width=37) (actual time=487.601..3888.179 rows=36 loops=2)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=298009 width=16) (actual time=0.046..3483.995 rows=356914 loops=2)
                                                                                             Filter: ((note)::text = '(voice)'::text)
                                                                                             Rows Removed by Filter: 17765258
                                                                                       ->  Parallel Hash  (cost=54433.61..54433.61 rows=10 width=21) (actual time=355.783..355.783 rows=4 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=10 width=21) (actual time=29.703..355.724 rows=4 loops=2)
                                                                                                   Filter: ((production_year >= 2007) AND (production_year <= 2008) AND ((title)::text ~~ '%Kung%Fu%Panda%'::text))
                                                                                                   Rows Removed by Filter: 1264152
                                                                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=2)
                                                                                             Filter: ((role)::text = 'actress'::text)
                                                                                             Rows Removed by Filter: 11
 Planning Time: 51.875 ms
 Execution Time: 8391.376 ms
(69 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19c.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=979421.66..979421.67 rows=1 width=64) (actual time=8445.819..8445.819 rows=1 loops=1)
   ->  Gather  (cost=979421.44..979421.65 rows=2 width=64) (actual time=8445.047..8452.698 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=978421.44..978421.45 rows=1 width=64) (actual time=8437.557..8437.557 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=961861.47..978421.43 rows=2 width=32) (actual time=8320.940..8437.128 rows=1192 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.038..75.080 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=961861.46..961861.46 rows=1 width=40) (actual time=8318.334..8318.334 rows=877 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                           ->  Parallel Hash Join  (cost=956950.17..961861.46 rows=1 width=40) (actual time=8295.198..8316.381 rows=877 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.013..17.264 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=956950.15..956950.15 rows=2 width=44) (actual time=8295.082..8295.082 rows=2862 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                       ->  Parallel Hash Join  (cost=923212.00..956950.15 rows=2 width=44) (actual time=7978.166..8259.745 rows=2862 loops=3)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.032..157.513 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=923211.99..923211.99 rows=1 width=52) (actual time=7976.526..7976.526 rows=710 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                   ->  Parallel Hash Join  (cost=868772.46..923211.99 rows=1 width=52) (actual time=7551.647..7944.496 rows=710 loops=3)
                                                         Hash Cond: (chn.id = ci.person_role_id)
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=2.206..246.026 rows=1046780 loops=3)
                                                         ->  Parallel Hash  (cost=868772.44..868772.44 rows=1 width=56) (actual time=7548.448..7548.448 rows=755 loops=3)
                                                               Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                               ->  Parallel Hash Join  (cost=817446.81..868772.44 rows=1 width=56) (actual time=7198.734..7516.773 rows=755 loops=3)
                                                                     Hash Cond: (t.id = mi.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.040..263.061 rows=460484 loops=3)
                                                                           Filter: (production_year > 2000)
                                                                           Rows Removed by Filter: 382286
                                                                     ->  Parallel Hash  (cost=817446.79..817446.79 rows=2 width=35) (actual time=7197.712..7197.712 rows=840 loops=3)
                                                                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                                           ->  Parallel Hash Join  (cost=562110.73..817446.79 rows=2 width=35) (actual time=3969.345..5239.861 rows=840 loops=3)
                                                                                 Hash Cond: (mi.movie_id = ci.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..255330.90 rows=2019 width=4) (actual time=418.457..1671.790 rows=150346 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=180.464..1635.042 rows=150368 loops=3)
                                                                                             Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                             Rows Removed by Filter: 4794872
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.057 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.045 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'release dates'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=562103.89..562103.89 rows=353 width=31) (actual time=3547.177..3547.178 rows=2184 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 568kB
                                                                                       ->  Hash Join  (cost=81911.39..562103.89 rows=353 width=31) (actual time=1433.505..3374.959 rows=2184 loops=3)
                                                                                             Hash Cond: (ci.role_id = rt.id)
                                                                                             ->  Parallel Hash Join  (cost=81910.23..562087.69 rows=4234 width=35) (actual time=1433.396..3374.072 rows=2185 loops=3)
                                                                                                   Hash Cond: (ci.person_id = n.id)
                                                                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.075..2798.604 rows=289159 loops=3)
                                                                                                         Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                                         Rows Removed by Filter: 11792289
                                                                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=529.889..529.889 rows=16670 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 3328kB
                                                                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=216.936..516.719 rows=16670 loops=3)
                                                                                                               Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                                               Rows Removed by Filter: 1372493
                                                                                             ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.029..0.032 rows=1 loops=3)
                                                                                                         Filter: ((role)::text = 'actress'::text)
                                                                                                         Rows Removed by Filter: 11
 Planning Time: 51.540 ms
 Execution Time: 8453.678 ms
(67 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=992869.82..992869.83 rows=1 width=64) (actual time=9587.758..9587.759 rows=1 loops=1)
   ->  Gather  (cost=992869.60..992869.81 rows=2 width=64) (actual time=9587.747..9845.598 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=991869.60..991869.61 rows=1 width=64) (actual time=9542.820..9542.820 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=975303.84..991864.20 rows=1080 width=32) (actual time=9168.976..9388.971 rows=586882 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.042..76.236 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=975297.96..975297.96 rows=470 width=40) (actual time=8972.359..8972.359 rows=262348 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4384kB
                           ->  Parallel Hash Join  (cost=941555.37..975297.96 rows=470 width=40) (actual time=8224.445..8743.220 rows=262348 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Hash Join  (cost=936204.59..969943.78 rows=1294 width=44) (actual time=8184.963..8559.983 rows=1076352 loops=3)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.044..162.463 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=936201.50..936201.50 rows=247 width=52) (actual time=7785.956..7785.956 rows=113945 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 2624kB
                                             ->  Parallel Hash Join  (cost=884874.85..936201.50 rows=247 width=52) (actual time=7458.633..7676.314 rows=113945 loops=3)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.032..268.104 rows=460484 loops=3)
                                                         Filter: (production_year > 2000)
                                                         Rows Removed by Filter: 382286
                                                   ->  Parallel Hash  (cost=884869.20..884869.20 rows=452 width=31) (actual time=7012.695..7012.695 rows=166016 loops=3)
                                                         Buckets: 65536 (originally 2048)  Batches: 16 (originally 1)  Memory Usage: 2880kB
                                                         ->  Parallel Hash Join  (cost=636506.19..884869.20 rows=452 width=31) (actual time=6688.034..6884.653 rows=166016 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Hash Join  (cost=565505.50..808738.07 rows=934 width=35) (actual time=5919.927..6044.587 rows=182242 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Hash Join  (cost=480903.52..721760.35 rows=4089 width=16) (actual time=5121.690..5301.861 rows=182372 loops=3)
                                                                           Hash Cond: (mi.movie_id = ci.movie_id)
                                                                           ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=456.608..1908.748 rows=1012240 loops=3)
                                                                                 Hash Cond: (mi.info_type_id = it.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.050..1149.243 rows=4945240 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.046..0.047 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.043 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'release dates'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=480518.83..480518.83 rows=30581 width=12) (actual time=2961.983..2961.983 rows=92055 loops=3)
                                                                                 Buckets: 65536 (originally 131072)  Batches: 8 (originally 1)  Memory Usage: 2176kB
                                                                                 ->  Hash Join  (cost=1.16..480518.83 rows=30581 width=12) (actual time=910.771..2890.384 rows=92055 loops=3)
                                                                                       Hash Cond: (ci.role_id = rt.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.087..2827.459 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.024..0.024 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.020..0.022 rows=1 loops=3)
                                                                                                   Filter: ((role)::text = 'actress'::text)
                                                                                                   Rows Removed by Filter: 11
                                                                     ->  Parallel Hash  (cost=77318.68..77318.68 rows=396664 width=19) (actual time=550.275..550.275 rows=320518 loops=3)
                                                                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                                                                           ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=396664 width=19) (actual time=182.210..441.336 rows=320518 loops=3)
                                                                                 Filter: ((gender)::text = 'f'::text)
                                                                                 Rows Removed by Filter: 1068645
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=4) (actual time=562.590..562.590 rows=1046780 loops=3)
                                                                     Buckets: 131072  Batches: 64  Memory Usage: 3040kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.057..284.139 rows=1046780 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.655..38.655 rows=28281 loops=3)
                                       Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.038..24.768 rows=28281 loops=3)
                                             Filter: ((country_code)::text = '[us]'::text)
                                             Rows Removed by Filter: 50051
 Planning Time: 51.446 ms
 Execution Time: 9848.014 ms
(65 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=104638.31..104638.32 rows=1 width=68) (actual time=847.947..847.948 rows=1 loops=1)
   ->  Gather  (cost=104638.09..104638.30 rows=2 width=68) (actual time=847.433..853.518 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=103638.09..103638.10 rows=1 width=68) (actual time=840.867..840.867 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=53154.41..103637.73 rows=47 width=45) (actual time=731.913..840.764 rows=47 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.034..222.607 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=53153.83..53153.83 rows=47 width=32) (actual time=512.411..512.411 rows=47 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=37883.38..53153.83 rows=47 width=32) (actual time=511.953..512.107 rows=47 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mc.movie_id)
                                 ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=132.968..133.003 rows=83 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.030..77.290 rows=460012 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.043 rows=1 loops=3)
                                                   Filter: ((info)::text = 'top 250 rank'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=37857.14..37857.14 rows=1905 width=28) (actual time=378.883..378.883 rows=9552 loops=3)
                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2112kB
                                       ->  Hash Join  (cost=1.06..37857.14 rows=1905 width=28) (actual time=274.652..368.708 rows=9552 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=7618 width=32) (actual time=49.451..364.959 rows=9630 loops=3)
                                                   Filter: (((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND (((note)::text ~~ '%(co-production)%'::text) OR ((note)::text ~~ '%(presents)%'::text)))
                                                   Rows Removed by Filter: 860080
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'production companies'::text)
                                                         Rows Removed by Filter: 3
 Planning Time: 4.062 ms
 Execution Time: 854.026 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1b.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=103766.13..103766.14 rows=1 width=68) (actual time=734.008..734.008 rows=1 loops=1)
   ->  Gather  (cost=103765.91..103766.12 rows=2 width=68) (actual time=733.809..739.229 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=102765.91..102765.92 rows=1 width=68) (actual time=727.267..727.267 rows=1 loops=3)
               ->  Hash Join  (cost=68268.30..102758.62 rows=972 width=45) (actual time=712.735..727.251 rows=1 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=68267.24..102736.53 rows=3890 width=49) (actual time=545.926..726.945 rows=22 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=556503 width=32) (actual time=0.043..265.445 rows=445696 loops=3)
                                 Filter: ((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)
                                 Rows Removed by Filter: 424014
                           ->  Parallel Hash  (cost=68249.11..68249.11 rows=1450 width=29) (actual time=416.811..416.811 rows=1 loops=3)
                                 Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                 ->  Parallel Hash Join  (cost=15317.21..68249.11 rows=1450 width=29) (actual time=353.691..416.684 rows=1 loops=3)
                                       Hash Cond: (t.id = mi_idx.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=300243 width=25) (actual time=0.042..255.920 rows=238753 loops=3)
                                             Filter: ((production_year >= 2005) AND (production_year <= 2010))
                                             Rows Removed by Filter: 604018
                                       ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=4) (actual time=132.656..132.656 rows=3 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 160kB
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=132.561..132.563 rows=3 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.043..76.315 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=3)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 3.819 ms
 Execution Time: 739.727 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=101209.01..101209.02 rows=1 width=68) (actual time=708.957..708.957 rows=1 loops=1)
   ->  Gather  (cost=101208.79..101209.00 rows=2 width=68) (actual time=708.529..714.482 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=100208.79..100208.80 rows=1 width=68) (actual time=702.191..702.191 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=50420.55..100208.75 rows=5 width=45) (actual time=683.424..702.183 rows=1 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=25) (actual time=0.027..239.455 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=50420.11..50420.11 rows=35 width=32) (actual time=445.501..445.502 rows=8 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=35149.70..50420.11 rows=35 width=32) (actual time=445.185..445.265 rows=8 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mc.movie_id)
                                 ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=132.766..132.800 rows=83 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.031..77.150 rows=460012 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.042 rows=1 loops=3)
                                                   Filter: ((info)::text = 'top 250 rank'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=35129.26..35129.26 rows=1441 width=28) (actual time=312.301..312.301 rows=5937 loops=3)
                                       Buckets: 32768 (originally 4096)  Batches: 1 (originally 1)  Memory Usage: 1536kB
                                       ->  Hash Join  (cost=1.06..35129.26 rows=1441 width=28) (actual time=213.150..300.113 rows=5937 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=5762 width=32) (actual time=164.670..297.591 rows=5939 loops=3)
                                                   Filter: (((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND ((note)::text ~~ '%(co-production)%'::text))
                                                   Rows Removed by Filter: 863771
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'production companies'::text)
                                                         Rows Removed by Filter: 3
 Planning Time: 3.924 ms
 Execution Time: 715.015 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1d.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=102217.02..102217.03 rows=1 width=68) (actual time=765.575..765.575 rows=1 loops=1)
   ->  Gather  (cost=102216.80..102217.01 rows=2 width=68) (actual time=765.347..771.113 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=101216.80..101216.81 rows=1 width=68) (actual time=758.882..758.883 rows=1 loops=3)
               ->  Hash Join  (cost=66690.26..101202.81 rows=1865 width=45) (actual time=744.471..758.871 rows=1 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=66689.20..101161.42 rows=7460 width=49) (actual time=618.791..758.571 rows=26 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=556503 width=32) (actual time=0.041..266.255 rows=445696 loops=3)
                                 Filter: ((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)
                                 Rows Removed by Filter: 424014
                           ->  Parallel Hash  (cost=66654.42..66654.42 rows=2782 width=29) (actual time=447.237..447.237 rows=2 loops=3)
                                 Buckets: 8192  Batches: 1  Memory Usage: 128kB
                                 ->  Parallel Hash Join  (cost=15317.21..66654.42 rows=2782 width=29) (actual time=381.307..447.110 rows=2 loops=3)
                                       Hash Cond: (t.id = mi_idx.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.032..266.485 rows=460484 loops=3)
                                             Filter: (production_year > 2000)
                                             Rows Removed by Filter: 382286
                                       ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=4) (actual time=131.959..131.959 rows=3 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 160kB
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=131.887..131.889 rows=3 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.046..75.568 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=3)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.035 rows=1 loops=3)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 3.757 ms
 Execution Time: 771.603 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20a.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=690921.15..690921.16 rows=1 width=32) (actual time=5851.084..5851.085 rows=1 loops=1)
   ->  Hash Join  (cost=611431.78..690921.14 rows=1 width=17) (actual time=5465.788..5851.053 rows=33 loops=1)
         Hash Cond: (t.kind_id = kt.id)
         ->  Gather  (cost=611430.68..690920.04 rows=1 width=21) (actual time=5465.657..5858.167 rows=33 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=610430.68..689919.94 rows=1 width=21) (actual time=5548.300..5843.041 rows=11 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.054..390.790 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=610430.67..610430.67 rows=1 width=25) (actual time=5282.256..5282.256 rows=11 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Hash Join  (cost=557690.68..610430.67 rows=1 width=25) (actual time=5222.855..5282.156 rows=11 loops=3)
                                 Hash Cond: (t.id = cc.movie_id)
                                 ->  Parallel Hash Join  (cost=554588.26..607328.24 rows=1 width=37) (actual time=4976.996..5183.559 rows=59 loops=3)
                                       Hash Cond: (t.id = mk.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=952979 width=25) (actual time=0.051..292.594 rows=762424 loops=3)
                                             Filter: (production_year > 1950)
                                             Rows Removed by Filter: 80347
                                       ->  Parallel Hash  (cost=554588.25..554588.25 rows=1 width=12) (actual time=4816.256..4816.256 rows=59 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=111235.39..554588.25 rows=1 width=12) (actual time=1376.478..4816.106 rows=59 loops=3)
                                                   Hash Cond: (ci.movie_id = mk.movie_id)
                                                   ->  Parallel Hash Join  (cost=59349.58..502696.95 rows=1460 width=8) (actual time=619.686..4189.191 rows=185 loops=3)
                                                         Hash Cond: (ci.person_role_id = chn.id)
                                                         ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.035..2293.473 rows=12081448 loops=3)
                                                         ->  Parallel Hash  (cost=59346.31..59346.31 rows=262 width=4) (actual time=558.737..558.737 rows=10 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Seq Scan on char_name chn  (cost=0.00..59346.31 rows=262 width=4) (actual time=25.125..558.624 rows=10 loops=3)
                                                                     Filter: (((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))
                                                                     Rows Removed by Filter: 1046770
                                                   ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=4) (actual time=626.692..626.692 rows=11849 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=4) (actual time=61.884..511.816 rows=11849 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.045..261.926 rows=1507977 loops=3)
                                                               ->  Hash  (cost=3632.40..3632.40 rows=8 width=4) (actual time=61.526..61.526 rows=8 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=4) (actual time=0.222..61.509 rows=8 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                                           Rows Removed by Filter: 134162
                                 ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=98.282..98.282 rows=85941 loops=3)
                                       Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                       ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.232..71.934 rows=85941 loops=3)
                                             Hash Cond: (cc.status_id = cct2.id)
                                             ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.105..53.793 rows=85941 loops=3)
                                                   Hash Cond: (cc.subject_id = cct1.id)
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.026..23.045 rows=135086 loops=3)
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'cast'::text)
                                                               Rows Removed by Filter: 3
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.074..0.075 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.054..0.055 rows=2 loops=3)
                                                         Filter: ((kind)::text ~~ '%complete%'::text)
                                                         Rows Removed by Filter: 2
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.055..0.056 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.035..0.037 rows=1 loops=1)
                     Filter: ((kind)::text = 'movie'::text)
                     Rows Removed by Filter: 6
 Planning Time: 35.217 ms
 Execution Time: 5859.254 ms
(64 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20b.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=687335.89..687335.90 rows=1 width=32) (actual time=5418.340..5418.340 rows=1 loops=1)
   ->  Gather  (cost=687335.68..687335.89 rows=2 width=32) (actual time=5417.886..5425.289 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=686335.68..686335.69 rows=1 width=32) (actual time=5410.805..5410.805 rows=1 loops=3)
               ->  Hash Join  (cost=635010.03..686335.67 rows=1 width=17) (actual time=5360.083..5410.777 rows=6 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=635008.93..686334.57 rows=1 width=21) (actual time=5359.795..5410.487 rows=6 loops=3)
                           Hash Cond: (t.id = cc.movie_id)
                           ->  Parallel Hash Join  (cost=631906.51..683232.14 rows=1 width=33) (actual time=5266.801..5317.489 rows=17 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.038..265.249 rows=460484 loops=3)
                                       Filter: (production_year > 2000)
                                       Rows Removed by Filter: 382286
                                 ->  Parallel Hash  (cost=631906.50..631906.50 rows=1 width=8) (actual time=5005.815..5005.815 rows=17 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=583654.16..631906.50 rows=1 width=8) (actual time=4781.641..5005.685 rows=17 loops=3)
                                             Hash Cond: (mk.movie_id = ci.movie_id)
                                             ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=4) (actual time=41.783..484.503 rows=11849 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.034..255.532 rows=1507977 loops=3)
                                                   ->  Hash  (cost=3632.40..3632.40 rows=8 width=4) (actual time=41.406..41.407 rows=8 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=4) (actual time=0.169..41.388 rows=8 loops=3)
                                                               Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                               Rows Removed by Filter: 134162
                                             ->  Parallel Hash  (cost=580021.64..580021.64 rows=1 width=4) (actual time=4518.785..4518.785 rows=5 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=136670.44..580021.64 rows=1 width=4) (actual time=1344.987..4518.623 rows=5 loops=3)
                                                         Hash Cond: (ci.person_id = n.id)
                                                         ->  Parallel Hash Join  (cost=59349.58..502696.95 rows=1460 width=8) (actual time=577.565..4025.441 rows=185 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.030..2150.867 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=59346.31..59346.31 rows=262 width=4) (actual time=539.895..539.895 rows=10 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..59346.31 rows=262 width=4) (actual time=29.389..539.737 rows=10 loops=3)
                                                                           Filter: (((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))
                                                                           Rows Removed by Filter: 1046770
                                                         ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=4) (actual time=493.077..493.077 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=4) (actual time=198.000..493.017 rows=1 loops=3)
                                                                     Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                                     Rows Removed by Filter: 1389163
                           ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=92.687..92.687 rows=85941 loops=3)
                                 Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                 ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.191..66.325 rows=85941 loops=3)
                                       Hash Cond: (cc.status_id = cct2.id)
                                       ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.108..48.262 rows=85941 loops=3)
                                             Hash Cond: (cc.subject_id = cct1.id)
                                             ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.028..17.833 rows=135086 loops=3)
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.027..0.027 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'cast'::text)
                                                         Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.033..0.033 rows=2 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.020..0.022 rows=2 loops=3)
                                                   Filter: ((kind)::text ~~ '%complete%'::text)
                                                   Rows Removed by Filter: 2
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 35.140 ms
 Execution Time: 5426.266 ms
(67 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20c.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=689631.09..689631.10 rows=1 width=64) (actual time=6194.932..6194.932 rows=1 loops=1)
   ->  Gather  (cost=610141.72..689631.08 rows=1 width=32) (actual time=5609.660..6198.283 rows=5406 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Hash Join  (cost=609141.72..688630.98 rows=1 width=32) (actual time=5603.198..6180.875 rows=1802 loops=3)
               Hash Cond: (t.kind_id = kt.id)
               ->  Parallel Hash Join  (cost=609140.62..688629.88 rows=1 width=36) (actual time=5602.538..6179.619 rows=1906 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.049..375.111 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=609140.61..609140.61 rows=1 width=25) (actual time=5601.112..5601.112 rows=1906 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=557788.53..609140.61 rows=1 width=25) (actual time=5207.776..5542.880 rows=1906 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Hash Join  (cost=3102.42..54447.27 rows=1923 width=29) (actual time=93.869..433.110 rows=7852 loops=3)
                                       Hash Cond: (t.id = cc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.046..268.678 rows=460484 loops=3)
                                             Filter: (production_year > 2000)
                                             Rows Removed by Filter: 382286
                                       ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=93.353..93.353 rows=85941 loops=3)
                                             Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                             ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.212..66.584 rows=85941 loops=3)
                                                   Hash Cond: (cc.status_id = cct2.id)
                                                   ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.100..48.411 rows=85941 loops=3)
                                                         Hash Cond: (cc.subject_id = cct1.id)
                                                         ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.021..17.772 rows=135086 loops=3)
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.022..0.022 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.010..0.012 rows=1 loops=3)
                                                                     Filter: ((kind)::text = 'cast'::text)
                                                                     Rows Removed by Filter: 3
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.048..0.048 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.034..0.036 rows=2 loops=3)
                                                               Filter: ((kind)::text ~~ '%complete%'::text)
                                                               Rows Removed by Filter: 2
                                 ->  Parallel Hash  (cost=554683.94..554683.94 rows=174 width=12) (actual time=5105.645..5105.645 rows=12272 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2776kB
                                       ->  Parallel Hash Join  (cost=109433.18..554683.94 rows=174 width=12) (actual time=1104.556..4931.971 rows=12272 loops=3)
                                             Hash Cond: (ci.movie_id = mk.movie_id)
                                             ->  Parallel Hash Join  (cost=57211.57..500558.94 rows=507378 width=8) (actual time=507.499..4287.172 rows=207862 loops=3)
                                                   Hash Cond: (ci.person_role_id = chn.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.039..2168.144 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=56075.12..56075.12 rows=90916 width=4) (actual time=505.816..505.816 rows=60051 loops=3)
                                                         Buckets: 262144  Batches: 1  Memory Usage: 9152kB
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=4) (actual time=0.046..464.822 rows=60051 loops=3)
                                                               Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                                               Rows Removed by Filter: 986729
                                             ->  Parallel Hash  (cost=52219.86..52219.86 rows=140 width=4) (actual time=596.521..596.521 rows=8030 loops=3)
                                                   Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                   ->  Hash Join  (cost=3967.95..52219.86 rows=140 width=4) (actual time=46.987..485.565 rows=8030 loops=3)
                                                         Hash Cond: (mk.keyword_id = k.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.042..251.738 rows=1507977 loops=3)
                                                         ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=46.566..46.566 rows=10 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.220..46.548 rows=10 loops=3)
                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                     Rows Removed by Filter: 134160
               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.038..0.040 rows=1 loops=3)
                           Filter: ((kind)::text = 'movie'::text)
                           Rows Removed by Filter: 6
 Planning Time: 33.805 ms
 Execution Time: 6201.940 ms
(64 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21a.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=63661.87..63661.88 rows=1 width=96) (actual time=698.686..698.686 rows=1 loops=1)
   ->  Gather  (cost=63661.76..63661.87 rows=1 width=96) (actual time=698.486..703.665 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=62661.76..62661.77 rows=1 width=96) (actual time=692.925..692.925 rows=1 loops=2)
               ->  Hash Join  (cost=57154.03..62661.75 rows=1 width=118) (actual time=640.157..692.610 rows=705 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=57152.97..62660.68 rows=1 width=122) (actual time=633.744..692.275 rows=752 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.039..60.224 rows=24151 loops=2)
                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                 Rows Removed by Filter: 93348
                           ->  Parallel Hash  (cost=57152.95..57152.95 rows=1 width=107) (actual time=628.145..628.145 rows=1562 loops=2)
                                 Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                 ->  Hash Join  (cost=3473.02..57152.95 rows=1 width=107) (actual time=290.398..537.622 rows=1562 loops=2)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=846.89..54494.99 rows=12124 width=111) (actual time=53.089..516.047 rows=27148 loops=2)
                                             Merge Cond: (ml.movie_id = mk.movie_id)
                                             ->  Merge Join  (cost=651.93..51228.28 rows=260 width=123) (actual time=51.390..476.349 rows=3220 loops=2)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=651.50..46001.67 rows=102 width=111) (actual time=48.197..435.790 rows=656 loops=2)
                                                         Merge Cond: (ml.movie_id = t.id)
                                                         ->  Merge Join  (cost=651.07..37165.42 rows=282 width=90) (actual time=14.779..261.667 rows=1391 loops=2)
                                                               Merge Cond: (mi.movie_id = ml.movie_id)
                                                               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1002971.17 rows=60182 width=4) (actual time=1.286..250.300 rows=2058 loops=2)
                                                                     Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                                                                     Rows Removed by Filter: 255305
                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.206..10.453 rows=3172 loops=2)
                                                                     Sort Key: ml.movie_id
                                                                     Sort Method: quicksort  Memory: 205kB
                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.126..8.965 rows=2315 loops=2)
                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.026..4.703 rows=29997 loops=2)
                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.051..0.052 rows=2 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.031..0.036 rows=2 loops=2)
                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                       Rows Removed by Filter: 16
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=911963 width=21) (actual time=0.027..169.671 rows=51993 loops=2)
                                                               Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                                               Rows Removed by Filter: 110576
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.054..36.923 rows=40588 loops=2)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 39291
                                             ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.044..25.975 rows=102619 loops=2)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.751..18.751 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.117..18.738 rows=1 loops=2)
                                                   Filter: ((keyword)::text = 'sequel'::text)
                                                   Rows Removed by Filter: 134169
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 31.189 ms
 Execution Time: 704.478 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=61990.17..61990.18 rows=1 width=96) (actual time=507.799..507.799 rows=1 loops=1)
   ->  Gather  (cost=61990.05..61990.16 rows=1 width=96) (actual time=507.571..513.040 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=60990.05..60990.06 rows=1 width=96) (actual time=501.958..501.959 rows=1 loops=2)
               ->  Hash Join  (cost=55482.32..60990.04 rows=1 width=118) (actual time=469.768..501.919 rows=19 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=55481.26..60988.98 rows=1 width=122) (actual time=469.601..501.748 rows=19 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.042..63.332 rows=24151 loops=2)
                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                 Rows Removed by Filter: 93348
                           ->  Parallel Hash  (cost=55481.25..55481.25 rows=1 width=107) (actual time=435.022..435.022 rows=66 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                 ->  Hash Join  (cost=3474.93..55481.25 rows=1 width=107) (actual time=392.603..434.904 rows=66 loops=2)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=848.79..52824.70 rows=11587 width=111) (actual time=31.049..416.071 rows=2784 loops=2)
                                             Merge Cond: (ml.movie_id = mk.movie_id)
                                             ->  Merge Join  (cost=651.93..49563.13 rows=249 width=123) (actual time=23.412..387.520 rows=770 loops=2)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=651.50..44336.66 rows=97 width=111) (actual time=22.427..354.106 rows=338 loops=2)
                                                         Merge Cond: (ml.movie_id = t.id)
                                                         ->  Merge Join  (cost=651.07..35476.61 rows=237 width=90) (actual time=15.338..182.719 rows=544 loops=2)
                                                               Merge Cond: (mi.movie_id = ml.movie_id)
                                                               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..956609.55 rows=50482 width=4) (actual time=1.347..171.321 rows=1524 loops=2)
                                                                     Filter: ((info)::text = ANY ('{Germany,German}'::text[]))
                                                                     Rows Removed by Filter: 255930
                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.569..10.770 rows=2527 loops=2)
                                                                     Sort Key: ml.movie_id
                                                                     Sort Method: quicksort  Memory: 205kB
                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.123..9.320 rows=2315 loops=2)
                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.022..5.050 rows=29997 loops=2)
                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.048..0.049 rows=2 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.032..0.037 rows=2 loops=2)
                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                       Rows Removed by Filter: 16
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=1038952 width=21) (actual time=0.039..164.832 rows=80664 loops=2)
                                                               Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                               Rows Removed by Filter: 83756
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.046..30.073 rows=42314 loops=2)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 42471
                                             ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.038..19.616 rows=84660 loops=2)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.528..18.528 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.099..18.516 rows=1 loops=2)
                                                   Filter: ((keyword)::text = 'sequel'::text)
                                                   Rows Removed by Filter: 134169
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.031..0.033 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 31.517 ms
 Execution Time: 513.865 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21c.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=54436.16..54436.17 rows=1 width=96) (actual time=618.638..618.638 rows=1 loops=1)
   ->  Hash Join  (cost=22630.14..54436.15 rows=1 width=118) (actual time=300.543..617.785 rows=1874 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=20004.00..51778.36 rows=12060 width=122) (actual time=201.673..583.468 rows=33031 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Merge Join  (cost=208.46..1509126.58 rows=11385503 width=12) (actual time=0.127..373.897 rows=55032 loops=1)
                     Merge Cond: (mi.movie_id = mk.movie_id)
                     ->  Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1194599.22 rows=893642 width=4) (actual time=0.083..311.508 rows=28657 loops=1)
                           Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))
                           Rows Removed by Filter: 414007
                     ->  Materialize  (cost=0.43..153366.95 rows=4523930 width=8) (actual time=0.040..38.321 rows=85569 loops=1)
                           ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.028..22.396 rows=82171 loops=1)
               ->  Sort  (cost=19795.25..19795.61 rows=144 width=130) (actual time=195.861..197.951 rows=33234 loops=1)
                     Sort Key: mc.movie_id
                     Sort Method: quicksort  Memory: 203kB
                     ->  Gather  (cost=7378.71..19790.09 rows=144 width=130) (actual time=74.564..196.329 rows=1130 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Hash Join  (cost=6378.71..18775.69 rows=60 width=130) (actual time=68.768..182.786 rows=377 loops=3)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=6377.65..18773.33 rows=240 width=134) (actual time=68.581..182.473 rows=393 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Merge Join  (cost=651.50..13043.69 rows=1331 width=119) (actual time=13.782..132.506 rows=1672 loops=3)
                                             Merge Cond: (ml.movie_id = mc.movie_id)
                                             ->  Merge Join  (cost=651.07..7805.34 rows=520 width=107) (actual time=13.596..92.444 rows=749 loops=3)
                                                   Merge Cond: (t.id = ml.movie_id)
                                                   ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=789968 width=21) (actual time=0.106..75.055 rows=48445 loops=3)
                                                         Filter: ((production_year >= 1950) AND (production_year <= 2010))
                                                         Rows Removed by Filter: 13625
                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.603..12.785 rows=2315 loops=3)
                                                         Sort Key: ml.movie_id
                                                         Sort Method: quicksort  Memory: 205kB
                                                         Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                         Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.138..11.341 rows=2315 loops=3)
                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.033..7.011 rows=29997 loops=3)
                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.043..0.044 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.026..0.031 rows=2 loops=3)
                                                                           Filter: ((link)::text ~~ '%follow%'::text)
                                                                           Rows Removed by Filter: 16
                                             ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.047..36.188 rows=45348 loops=3)
                                                   Filter: (note IS NULL)
                                                   Rows Removed by Filter: 46158
                                       ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=48.551..48.551 rows=16101 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.026..38.423 rows=16101 loops=3)
                                                   Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                   Rows Removed by Filter: 62232
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=3)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=31.187..31.187 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.685..31.176 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 32.091 ms
 Execution Time: 620.640 ms
(62 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=414666.61..414666.62 rows=1 width=96) (actual time=3271.741..3271.741 rows=1 loops=1)
   ->  Gather  (cost=414666.39..414666.60 rows=2 width=96) (actual time=3270.130..3277.274 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=413666.39..413666.40 rows=1 width=96) (actual time=3262.600..3262.600 rows=1 loops=3)
               ->  Hash Join  (cost=363451.32..413666.38 rows=1 width=41) (actual time=3105.578..3262.137 rows=950 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=363450.20..413665.27 rows=1 width=45) (actual time=3049.361..3261.599 rows=1009 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=279670 width=25) (actual time=0.009..256.002 rows=220688 loops=3)
                                 Filter: (production_year > 2008)
                                 Rows Removed by Filter: 622082
                           ->  Parallel Hash  (cost=363450.19..363450.19 rows=1 width=40) (actual time=2971.725..2971.725 rows=13395 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4088kB
                                 ->  Hash Join  (cost=358450.15..363450.19 rows=1 width=40) (actual time=2911.336..2956.364 rows=13395 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=358449.06..363449.10 rows=1 width=44) (actual time=2911.236..2952.783 rows=13395 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.038..29.697 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=358449.05..358449.05 rows=1 width=29) (actual time=2911.081..2911.081 rows=14738 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3832kB
                                                   ->  Parallel Hash Join  (cost=323145.98..358449.05 rows=1 width=29) (actual time=2598.799..2885.957 rows=14738 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.015..269.913 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=323145.97..323145.97 rows=1 width=17) (actual time=2597.225..2597.225 rows=5361 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                                                               ->  Parallel Hash Join  (cost=67689.63..323145.97 rows=1 width=17) (actual time=2193.034..2571.117 rows=5361 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255449.73 rows=2405 width=4) (actual time=1368.081..1718.778 rows=196255 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=271735 width=8) (actual time=0.717..1669.014 rows=223112 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Germany,German,USA,American}'::text[]))
                                                                                 Rows Removed by Filter: 4722128
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.025 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'countries'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=67687.20..67687.20 rows=1 width=13) (actual time=824.270..824.270 rows=8267 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1752kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..67687.20 rows=1 width=13) (actual time=572.060..800.116 rows=8267 loops=3)
                                                                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..16456.75 rows=4327 width=9) (actual time=0.189..210.369 rows=108039 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=488953 width=13) (actual time=0.044..157.552 rows=390635 loops=3)
                                                                                             Filter: ((info)::text < '7.0'::text)
                                                                                             Rows Removed by Filter: 69377
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.041 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=571.106..571.106 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=38.476..480.773 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..255.032 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=38.163..38.163 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.673..38.150 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.045..0.045 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.033..0.034 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.061..0.061 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.040..0.043 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 81.055 ms
 Execution Time: 3278.590 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22b.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=414463.52..414463.53 rows=1 width=96) (actual time=3339.672..3339.672 rows=1 loops=1)
   ->  Gather  (cost=414463.29..414463.50 rows=2 width=96) (actual time=3337.719..3347.520 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=413463.29..413463.30 rows=1 width=96) (actual time=3330.020..3330.021 rows=1 loops=3)
               ->  Hash Join  (cost=363451.32..413463.29 rows=1 width=41) (actual time=3233.098..3329.989 rows=10 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=363450.20..413462.17 rows=1 width=45) (actual time=3232.791..3329.678 rows=11 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=225511 width=25) (actual time=0.011..257.768 rows=177790 loops=3)
                                 Filter: (production_year > 2009)
                                 Rows Removed by Filter: 664981
                           ->  Parallel Hash  (cost=363450.19..363450.19 rows=1 width=40) (actual time=3040.360..3040.360 rows=13395 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4088kB
                                 ->  Hash Join  (cost=358450.15..363450.19 rows=1 width=40) (actual time=2989.037..3023.950 rows=13395 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=358449.06..363449.10 rows=1 width=44) (actual time=2988.935..3020.405 rows=13395 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.014..19.154 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=358449.05..358449.05 rows=1 width=29) (actual time=2988.800..2988.800 rows=14738 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                                   ->  Parallel Hash Join  (cost=323145.98..358449.05 rows=1 width=29) (actual time=2668.227..2962.663 rows=14738 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.014..276.159 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=323145.97..323145.97 rows=1 width=17) (actual time=2666.600..2666.601 rows=5361 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                                                               ->  Parallel Hash Join  (cost=67689.63..323145.97 rows=1 width=17) (actual time=2253.402..2640.143 rows=5361 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255449.73 rows=2405 width=4) (actual time=1419.881..1778.177 rows=196255 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=271735 width=8) (actual time=0.734..1728.003 rows=223112 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Germany,German,USA,American}'::text[]))
                                                                                 Rows Removed by Filter: 4722128
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.028 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'countries'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=67687.20..67687.20 rows=1 width=13) (actual time=832.701..832.701 rows=8267 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1752kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..67687.20 rows=1 width=13) (actual time=575.212..807.645 rows=8267 loops=3)
                                                                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..16456.75 rows=4327 width=9) (actual time=0.201..213.667 rows=108039 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=488953 width=13) (actual time=0.048..160.838 rows=390635 loops=3)
                                                                                             Filter: ((info)::text < '7.0'::text)
                                                                                             Rows Removed by Filter: 69377
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.047 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=574.158..574.158 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=31.382..473.687 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.037..255.556 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=31.088..31.088 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.556..31.072 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.047..0.047 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.032..0.034 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.063..0.063 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.038..0.041 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 80.316 ms
 Execution Time: 3348.832 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22c.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=461803.15..461803.16 rows=1 width=96) (actual time=3940.685..3940.685 rows=1 loops=1)
   ->  Gather  (cost=461802.92..461803.13 rows=2 width=96) (actual time=3938.652..3946.505 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=460802.92..460802.93 rows=1 width=96) (actual time=3930.739..3930.740 rows=1 loops=3)
               ->  Hash Join  (cost=410038.34..460802.92 rows=1 width=41) (actual time=3617.417..3927.615 rows=7163 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=410037.22..460801.80 rows=1 width=45) (actual time=3606.833..3925.465 rows=7732 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.008..264.907 rows=337640 loops=3)
                                 Filter: (production_year > 2005)
                                 Rows Removed by Filter: 505131
                           ->  Parallel Hash  (cost=410037.21..410037.21 rows=1 width=40) (actual time=3601.862..3601.862 rows=21916 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6008kB
                                 ->  Hash Join  (cost=405037.17..410037.21 rows=1 width=40) (actual time=3542.617..3581.806 rows=21916 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=405036.08..410036.12 rows=1 width=44) (actual time=3542.518..3576.095 rows=21916 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.017..18.375 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=405036.07..405036.07 rows=1 width=29) (actual time=3542.412..3542.412 rows=23616 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6520kB
                                                   ->  Parallel Hash Join  (cost=369733.01..405036.07 rows=1 width=29) (actual time=3211.339..3498.187 rows=23616 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.011..265.955 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3210.812..3210.812 rows=6989 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                                               ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2928.479..3172.122 rows=6989 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.164..221.214 rows=151410 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.054..157.103 rows=447629 loops=3)
                                                                                 Filter: ((info)::text < '8.5'::text)
                                                                                 Rows Removed by Filter: 12383
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2927.759..2927.759 rows=7972 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1496kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2372.245..2878.179 rows=7972 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1801.111..2278.373 rows=204750 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.000..2226.194 rows=238737 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                                                             Rows Removed by Filter: 4706503
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.035..0.047 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'countries'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=570.802..570.803 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=30.818..469.455 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.035..251.461 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=30.600..30.600 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.542..30.587 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.044..0.044 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.032..0.033 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.058..0.059 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.037..0.040 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 83.036 ms
 Execution Time: 3947.620 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22d.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=460238.12..460238.13 rows=1 width=96) (actual time=5697.214..5697.214 rows=1 loops=1)
   ->  Gather  (cost=460238.00..460238.11 rows=1 width=96) (actual time=5696.397..5702.190 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=459238.00..459238.01 rows=1 width=96) (actual time=5690.715..5690.715 rows=1 loops=2)
               ->  Hash Join  (cost=454237.96..459238.00 rows=1 width=41) (actual time=5624.193..5681.353 rows=23140 loops=2)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=454236.84..459236.88 rows=1 width=45) (actual time=5623.949..5675.569 rows=24954 loops=2)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=454235.75..459235.79 rows=1 width=49) (actual time=5623.846..5669.439 rows=24954 loops=2)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.041..28.499 rows=63115 loops=2)
                                       Filter: ((country_code)::text <> '[us]'::text)
                                       Rows Removed by Filter: 54384
                                 ->  Parallel Hash  (cost=454235.74..454235.74 rows=1 width=34) (actual time=5623.417..5623.417 rows=35884 loops=2)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6776kB
                                       ->  Parallel Hash Join  (cost=420497.60..454235.74 rows=1 width=34) (actual time=5159.479..5586.196 rows=35884 loops=2)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.008..236.127 rows=1304564 loops=2)
                                             ->  Parallel Hash  (cost=420497.58..420497.58 rows=1 width=42) (actual time=5159.028..5159.028 rows=2566 loops=2)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                   ->  Parallel Hash Join  (cost=369733.01..420497.58 rows=1 width=42) (actual time=4675.855..5144.168 rows=2566 loops=2)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.014..397.661 rows=506460 loops=2)
                                                               Filter: (production_year > 2005)
                                                               Rows Removed by Filter: 757696
                                                         ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=4675.453..4675.453 rows=10484 loops=2)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                               ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=4291.868..4653.393 rows=10484 loops=2)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.152..328.512 rows=227115 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.039..232.818 rows=671443 loops=2)
                                                                                 Filter: ((info)::text < '8.5'::text)
                                                                                 Rows Removed by Filter: 18574
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=4291.272..4291.272 rows=11958 loops=2)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=3481.954..4242.271 rows=11958 loops=2)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=2705.408..3423.152 rows=307126 loops=2)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.461..3344.876 rows=358105 loops=2)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                                                             Rows Removed by Filter: 7059755
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.044 rows=1 loops=2)
                                                                                                   Filter: ((info)::text = 'countries'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=776.018..776.018 rows=18546 loops=2)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=31.148..687.884 rows=18546 loops=2)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.041..374.792 rows=2261965 loops=2)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=30.986..30.986 rows=3 loops=2)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.544..30.962 rows=3 loops=2)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.045..0.045 rows=4 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.033..0.035 rows=4 loops=2)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.061..0.061 rows=2 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.042..0.045 rows=2 loops=2)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 80.840 ms
 Execution Time: 5703.503 ms
(74 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23a.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=418779.45..418779.46 rows=1 width=64) (actual time=2520.298..2520.298 rows=1 loops=1)
   ->  Gather  (cost=418779.23..418779.44 rows=2 width=64) (actual time=2519.744..2528.135 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=417779.23..417779.24 rows=1 width=64) (actual time=2511.665..2511.666 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=413873.01..417779.22 rows=1 width=65) (actual time=2458.199..2511.539 rows=206 loops=3)
                     Hash Cond: (k.id = mk.keyword_id)
                     ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.115..48.456 rows=44723 loops=3)
                           Heap Fetches: 134170
                     ->  Parallel Hash  (cost=413872.58..413872.58 rows=1 width=69) (actual time=2457.309..2457.309 rows=206 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Hash Join  (cost=363500.14..413872.58 rows=1 width=69) (actual time=2402.598..2457.147 rows=206 loops=3)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Hash Join  (cost=363499.05..413871.49 rows=1 width=73) (actual time=2402.481..2456.979 rows=206 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Hash Join  (cost=363496.62..413868.99 rows=26 width=77) (actual time=2402.371..2456.821 rows=206 loops=3)
                                             Hash Cond: (mk.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.037..258.347 rows=1507977 loops=3)
                                             ->  Parallel Hash  (cost=363496.59..363496.59 rows=3 width=89) (actual time=2018.549..2018.549 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Parallel Hash Join  (cost=358585.30..363496.59 rows=3 width=89) (actual time=2013.129..2018.505 rows=2 loops=3)
                                                         Hash Cond: (cn.id = mc.company_id)
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.013..17.401 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                                                         ->  Parallel Hash  (cost=358585.24..358585.24 rows=5 width=93) (actual time=1998.334..1998.334 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=324847.09..358585.24 rows=5 width=93) (actual time=1942.873..1998.265 rows=2 loops=3)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.010..161.523 rows=869710 loops=3)
                                                                     ->  Parallel Hash  (cost=324847.07..324847.07 rows=2 width=81) (actual time=1730.119..1730.119 rows=2 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=54685.18..324847.07 rows=2 width=81) (actual time=1210.177..1730.031 rows=2 loops=3)
                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=8) (actual time=323.140..1330.582 rows=594 loops=3)
                                                                                       Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                       Rows Removed by Filter: 4944646
                                                                                 ->  Parallel Hash  (cost=54671.45..54671.45 rows=1099 width=73) (actual time=398.955..398.955 rows=344 loops=3)
                                                                                       Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                                                                       ->  Hash Join  (cost=3236.49..54671.45 rows=1099 width=73) (actual time=276.941..398.426 rows=344 loops=3)
                                                                                             Hash Cond: (t.kind_id = kt.id)
                                                                                             ->  Hash Join  (cost=3235.39..54637.93 rows=7692 width=29) (actual time=52.176..398.072 rows=694 loops=3)
                                                                                                   Hash Cond: (t.id = cc.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.026..289.958 rows=460484 loops=3)
                                                                                                         Filter: (production_year > 2000)
                                                                                                         Rows Removed by Filter: 382286
                                                                                                   ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=50.841..50.841 rows=24592 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.180..43.624 rows=24592 loops=3)
                                                                                                               Hash Cond: (cc.status_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.038..22.779 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.043..0.044 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'complete+verified'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                             ->  Hash  (cost=1.09..1.09 rows=1 width=52) (actual time=0.049..0.049 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=52) (actual time=0.034..0.036 rows=1 loops=3)
                                                                                                         Filter: ((kind)::text = 'movie'::text)
                                                                                                         Rows Removed by Filter: 6
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.044 rows=1 loops=3)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.061..0.061 rows=4 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.037..0.039 rows=4 loops=3)
 Planning Time: 84.932 ms
 Execution Time: 2529.267 ms
(71 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23b.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=400136.80..400136.81 rows=1 width=64) (actual time=4177.682..4177.682 rows=1 loops=1)
   ->  Gather  (cost=400136.69..400136.80 rows=1 width=64) (actual time=4177.381..4182.479 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=399136.69..399136.70 rows=1 width=64) (actual time=4171.688..4171.688 rows=1 loops=2)
               ->  Hash Join  (cost=394225.39..399136.68 rows=1 width=65) (actual time=4168.075..4171.677 rows=8 loops=2)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=394224.29..399135.58 rows=1 width=21) (actual time=4167.830..4171.431 rows=8 loops=2)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=394223.20..399134.49 rows=1 width=25) (actual time=4167.718..4171.316 rows=8 loops=2)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..23.957 rows=42422 loops=2)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 75077
                                 ->  Parallel Hash  (cost=394223.19..394223.19 rows=1 width=29) (actual time=4142.898..4142.898 rows=8 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Hash Join  (cost=360485.03..394223.19 rows=1 width=29) (actual time=4131.618..4142.846 rows=8 loops=2)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Parallel Hash Join  (cost=357249.64..390987.79 rows=1 width=45) (actual time=3812.163..4096.547 rows=6 loops=2)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..224.832 rows=1304564 loops=2)
                                                   ->  Parallel Hash  (cost=357249.63..357249.63 rows=1 width=33) (actual time=3712.601..3712.601 rows=5 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                         ->  Parallel Hash Join  (cost=305924.00..357249.63 rows=1 width=33) (actual time=3486.234..3712.549 rows=5 loops=2)
                                                               Hash Cond: (t.id = mi.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.008..400.187 rows=690726 loops=2)
                                                                     Filter: (production_year > 2000)
                                                                     Rows Removed by Filter: 573430
                                                               ->  Parallel Hash  (cost=305923.99..305923.99 rows=1 width=8) (actual time=3242.926..3242.926 rows=5 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                     ->  Parallel Hash Join  (cost=257671.78..305923.99 rows=1 width=8) (actual time=2917.511..3242.859 rows=5 loops=2)
                                                                           Hash Cond: (mk.movie_id = mi.movie_id)
                                                                           ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=28.968..678.442 rows=566 loops=2)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.032..375.434 rows=2261965 loops=2)
                                                                                 ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=28.769..28.769 rows=4 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.843..28.742 rows=4 loops=2)
                                                                                             Filter: ((keyword)::text = ANY ('{nerd,loner,alienation,dignity}'::text[]))
                                                                                             Rows Removed by Filter: 134166
                                                                           ->  Parallel Hash  (cost=254710.16..254710.16 rows=2 width=4) (actual time=2564.014..2564.014 rows=886 loops=2)
                                                                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                                                 ->  Hash Join  (cost=2.43..254710.16 rows=2 width=4) (actual time=423.106..1654.719 rows=886 loops=2)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=8) (actual time=422.984..1653.784 rows=886 loops=2)
                                                                                             Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                                                                             Rows Removed by Filter: 7416974
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.051 rows=1 loops=2)
                                                                                                   Filter: ((info)::text = 'release dates'::text)
                                                                                                   Rows Removed by Filter: 112
                                             ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=45.162..45.162 rows=24592 loops=2)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                   ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.131..38.063 rows=24592 loops=2)
                                                         Hash Cond: (cc.status_id = cct1.id)
                                                         ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.024..17.511 rows=135086 loops=2)
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.032..0.033 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'complete+verified'::text)
                                                                     Rows Removed by Filter: 3
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.049..0.049 rows=4 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.033..0.034 rows=4 loops=2)
                     ->  Hash  (cost=1.09..1.09 rows=1 width=52) (actual time=0.058..0.058 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=52) (actual time=0.036..0.038 rows=1 loops=2)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 81.399 ms
 Execution Time: 4183.479 ms
(72 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=419448.86..419448.87 rows=1 width=64) (actual time=2425.445..2425.445 rows=1 loops=1)
   ->  Gather  (cost=419448.64..419448.85 rows=2 width=64) (actual time=2425.123..2432.199 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=418448.64..418448.65 rows=1 width=64) (actual time=2417.534..2417.535 rows=1 loops=3)
               ->  Hash Join  (cost=414542.42..418448.63 rows=2 width=65) (actual time=2372.357..2417.420 rows=209 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=414541.33..418447.54 rows=2 width=69) (actual time=2372.087..2417.089 rows=209 loops=3)
                           Hash Cond: (k.id = mk.keyword_id)
                           ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.138..40.149 rows=44723 loops=3)
                                 Heap Fetches: 134170
                           ->  Parallel Hash  (cost=414540.87..414540.87 rows=3 width=73) (actual time=2371.389..2371.389 rows=209 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=409629.58..414540.87 rows=3 width=73) (actual time=2364.747..2371.240 rows=209 loops=3)
                                       Hash Cond: (cn.id = mc.company_id)
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.011..16.587 rows=28281 loops=3)
                                             Filter: ((country_code)::text = '[us]'::text)
                                             Rows Removed by Filter: 50051
                                       ->  Parallel Hash  (cost=409629.53..409629.53 rows=4 width=77) (actual time=2351.749..2351.749 rows=209 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Hash Join  (cost=359255.99..409629.53 rows=4 width=77) (actual time=2231.701..2351.589 rows=209 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=359253.57..409626.13 rows=360 width=81) (actual time=2231.594..2351.434 rows=209 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.023..255.795 rows=1507977 loops=3)
                                                         ->  Parallel Hash  (cost=359253.22..359253.22 rows=28 width=93) (actual time=1915.680..1915.680 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=325515.05..359253.22 rows=28 width=93) (actual time=1800.865..1915.609 rows=2 loops=3)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..155.160 rows=869710 loops=3)
                                                                     ->  Parallel Hash  (cost=325514.95..325514.95 rows=8 width=81) (actual time=1653.826..1653.826 rows=2 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=55353.07..325514.95 rows=8 width=81) (actual time=1146.208..1653.740 rows=2 loops=3)
                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=8) (actual time=307.144..1247.266 rows=594 loops=3)
                                                                                       Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                       Rows Removed by Filter: 4944646
                                                                                 ->  Parallel Hash  (cost=55283.32..55283.32 rows=5580 width=73) (actual time=405.870..405.870 rows=1684 loops=3)
                                                                                       Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                                                       ->  Hash Join  (cost=3236.54..55283.32 rows=5580 width=73) (actual time=270.289..404.035 rows=1684 loops=3)
                                                                                             Hash Cond: (t.kind_id = kt.id)
                                                                                             ->  Hash Join  (cost=3235.39..55241.01 rows=9766 width=29) (actual time=46.229..403.052 rows=2141 loops=3)
                                                                                                   Hash Cond: (t.id = cc.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=25) (actual time=0.049..290.003 rows=583011 loops=3)
                                                                                                         Filter: (production_year > 1990)
                                                                                                         Rows Removed by Filter: 259760
                                                                                                   ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=44.731..44.731 rows=24592 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.134..37.703 rows=24592 loops=3)
                                                                                                               Hash Cond: (cc.status_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.029..17.143 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.029..0.030 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'complete+verified'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                             ->  Hash  (cost=1.10..1.10 rows=4 width=52) (actual time=0.053..0.053 rows=4 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.10 rows=4 width=52) (actual time=0.038..0.041 rows=4 loops=3)
                                                                                                         Filter: ((kind)::text = ANY ('{movie,"tv movie","video movie","video game"}'::text[]))
                                                                                                         Rows Removed by Filter: 3
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.043 rows=1 loops=3)
                                                               Filter: ((info)::text = 'release dates'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.069..0.069 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.042..0.043 rows=4 loops=3)
 Planning Time: 82.770 ms
 Execution Time: 2433.206 ms
(71 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/24a.sql_explained.sql
SET
SET
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1028775.06..1028775.07 rows=1 width=96) (actual time=6966.971..6966.972 rows=1 loops=1)
   ->  Hash Join  (cost=773581.49..1028775.05 rows=1 width=48) (actual time=5936.080..6966.833 rows=275 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Gather  (cost=773579.07..1028772.62 rows=1 width=52) (actual time=5935.968..6973.083 rows=275 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=772579.07..1027772.52 rows=1 width=52) (actual time=5910.458..6958.519 rows=92 loops=3)
                     Hash Cond: (mi.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=129652 width=8) (actual time=270.376..1698.439 rows=100416 loops=3)
                           Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))
                           Rows Removed by Filter: 4844824
                     ->  Parallel Hash  (cost=772579.06..772579.06 rows=1 width=64) (actual time=5247.355..5247.355 rows=42 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=767667.77..772579.06 rows=1 width=64) (actual time=5226.894..5247.260 rows=42 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.012..20.379 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=767667.75..767667.75 rows=1 width=68) (actual time=5223.876..5223.876 rows=115 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=733929.61..767667.75 rows=1 width=68) (actual time=5077.886..5223.757 rows=115 loops=3)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.015..157.947 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=733929.60..733929.60 rows=1 width=60) (actual time=4958.818..4958.819 rows=13 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Hash Join  (cost=679490.06..733929.60 rows=1 width=60) (actual time=4705.892..4958.742 rows=13 loops=3)
                                                         Hash Cond: (ci.role_id = rt.id)
                                                         ->  Parallel Hash Join  (cost=679488.90..733928.43 rows=1 width=64) (actual time=4705.774..4958.620 rows=13 loops=3)
                                                               Hash Cond: (chn.id = ci.person_role_id)
                                                               ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.040..245.575 rows=1046780 loops=3)
                                                               ->  Parallel Hash  (cost=679488.88..679488.88 rows=1 width=52) (actual time=4587.071..4587.071 rows=13 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=663335.18..679488.88 rows=1 width=52) (actual time=4486.998..4586.954 rows=13 loops=3)
                                                                           Hash Cond: (n.id = ci.person_id)
                                                                           ->  Parallel Hash Join  (cost=81910.23..98047.67 rows=4333 width=23) (actual time=540.854..667.868 rows=3508 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.031..74.240 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=539.895..539.896 rows=16670 loops=3)
                                                                                       Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=220.815..526.461 rows=16670 loops=3)
                                                                                             Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1372493
                                                                           ->  Parallel Hash  (cost=581424.93..581424.93 rows=2 width=41) (actual time=3918.268..3918.268 rows=875 loops=3)
                                                                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                                                 ->  Parallel Hash Join  (cost=100834.61..581424.93 rows=2 width=41) (actual time=883.651..3725.156 rows=875 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=1.125..2802.239 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Parallel Hash  (cost=100834.53..100834.53 rows=7 width=25) (actual time=880.176..880.176 rows=165 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=51046.31..100834.53 rows=7 width=25) (actual time=608.803..879.939 rows=165 loops=3)
                                                                                                   Hash Cond: (t.id = mk.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.019..253.183 rows=130555 loops=3)
                                                                                                         Filter: (production_year > 2010)
                                                                                                         Rows Removed by Filter: 712215
                                                                                                   ->  Parallel Hash  (cost=51045.79..51045.79 rows=42 width=4) (actual time=605.226..605.226 rows=3232 loops=3)
                                                                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                                                                         ->  Hash Join  (cost=2793.88..51045.79 rows=42 width=4) (actual time=28.910..463.635 rows=3232 loops=3)
                                                                                                               Hash Cond: (mk.keyword_id = k.id)
                                                                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.041..252.182 rows=1507977 loops=3)
                                                                                                               ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=27.868..27.868 rows=3 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=0.073..27.853 rows=3 loops=3)
                                                                                                                           Filter: ((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat}'::text[]))
                                                                                                                           Rows Removed by Filter: 134167
                                                         ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.062..0.063 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.040..0.043 rows=1 loops=3)
                                                                     Filter: ((role)::text = 'actress'::text)
                                                                     Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.026 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 99.125 ms
 Execution Time: 6974.343 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/24b.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1031111.24..1031111.25 rows=1 width=96) (actual time=6603.559..6603.559 rows=1 loops=1)
   ->  Hash Join  (cost=775917.68..1031111.23 rows=1 width=48) (actual time=5593.899..6603.518 rows=45 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Gather  (cost=775915.25..1031108.81 rows=1 width=52) (actual time=5593.796..6609.734 rows=45 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=774915.25..1030108.71 rows=1 width=52) (actual time=5922.626..6595.182 rows=15 loops=3)
                     Hash Cond: (mi.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=129652 width=8) (actual time=339.268..1669.113 rows=100416 loops=3)
                           Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))
                           Rows Removed by Filter: 4844824
                     ->  Parallel Hash  (cost=774915.24..774915.24 rows=1 width=64) (actual time=4913.489..4913.489 rows=8 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Hash Join  (cost=720475.70..774915.24 rows=1 width=64) (actual time=4873.267..4913.394 rows=8 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Hash Join  (cost=720474.54..774914.07 rows=1 width=68) (actual time=4873.161..4913.286 rows=8 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.038..245.704 rows=1046780 loops=3)
                                       ->  Parallel Hash  (cost=720474.52..720474.52 rows=1 width=56) (actual time=4542.335..4542.335 rows=8 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=704320.82..720474.52 rows=1 width=56) (actual time=4510.393..4542.211 rows=8 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Hash Join  (cost=81910.23..98047.67 rows=4333 width=23) (actual time=544.599..670.201 rows=3508 loops=3)
                                                         Hash Cond: (an.person_id = n.id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.033..74.759 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=543.722..543.723 rows=16670 loops=3)
                                                               Buckets: 65536  Batches: 1  Memory Usage: 3328kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=222.791..529.953 rows=16670 loops=3)
                                                                     Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                     Rows Removed by Filter: 1372493
                                                   ->  Parallel Hash  (cost=622410.58..622410.58 rows=1 width=45) (actual time=3871.489..3871.489 rows=36 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=141820.27..622410.58 rows=1 width=45) (actual time=1099.380..3871.384 rows=36 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.065..2837.291 rows=289159 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                     Rows Removed by Filter: 11792289
                                                               ->  Parallel Hash  (cost=141820.25..141820.25 rows=1 width=29) (actual time=996.292..996.292 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Hash Join  (cost=108082.11..141820.25 rows=1 width=29) (actual time=945.914..996.218 rows=2 loops=3)
                                                                           Hash Cond: (mc.company_id = cn.id)
                                                                           ->  Parallel Hash Join  (cost=103013.59..136751.74 rows=1 width=33) (actual time=817.182..973.482 rows=21 loops=3)
                                                                                 Hash Cond: (mc.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.013..155.561 rows=869710 loops=3)
                                                                                 ->  Parallel Hash  (cost=103013.58..103013.58 rows=1 width=25) (actual time=709.877..709.878 rows=2 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                       ->  Hash Join  (cost=54761.74..103013.58 rows=1 width=25) (actual time=442.817..709.762 rows=2 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Hash Join  (cost=51800.14..100051.91 rows=28 width=29) (actual time=411.856..678.802 rows=29 loops=3)
                                                                                                   Hash Cond: (mk.movie_id = t.id)
                                                                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.203..251.088 rows=1507977 loops=3)
                                                                                                   ->  Parallel Hash  (cost=51799.95..51799.95 rows=15 width=21) (actual time=246.993..246.993 rows=3 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=15 width=21) (actual time=84.922..246.865 rows=3 loops=3)
                                                                                                               Filter: ((production_year > 2010) AND ((title)::text ~~ 'Kung Fu Panda%'::text))
                                                                                                               Rows Removed by Filter: 842768
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=30.896..30.896 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.079..30.877 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat,computer-animated-movie}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                                                           ->  Parallel Hash  (cost=5068.50..5068.50 rows=1 width=4) (actual time=22.666..22.666 rows=0 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..5068.50 rows=1 width=4) (actual time=17.077..22.628 rows=0 loops=3)
                                                                                       Filter: (((country_code)::text = '[us]'::text) AND ((name)::text = 'DreamWorks Animation'::text))
                                                                                       Rows Removed by Filter: 78332
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.050..0.051 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.028..0.031 rows=1 loops=3)
                                             Filter: ((role)::text = 'actress'::text)
                                             Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 99.015 ms
 Execution Time: 6610.812 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=937486.93..937486.94 rows=1 width=128) (actual time=6240.965..6240.965 rows=1 loops=1)
   ->  Gather  (cost=937486.70..937486.91 rows=2 width=128) (actual time=6239.848..6248.085 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=936486.70..936486.71 rows=1 width=128) (actual time=6232.306..6232.306 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=886003.56..936486.69 rows=1 width=80) (actual time=5943.474..6230.958 rows=1469 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.029..237.593 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=886003.55..886003.55 rows=1 width=79) (actual time=5867.359..5867.360 rows=1469 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 440kB
                           ->  Parallel Hash Join  (cost=805976.20..886003.55 rows=1 width=79) (actual time=5263.334..5801.347 rows=1469 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.058..467.378 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=805976.19..805976.19 rows=1 width=68) (actual time=5262.255..5262.255 rows=2371 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 664kB
                                       ->  Parallel Hash Join  (cost=305955.51..805976.19 rows=1 width=68) (actual time=4010.534..5183.421 rows=2371 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=205.394..3037.863 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=305955.50..305955.50 rows=1 width=60) (actual time=2091.345..2091.345 rows=3796 loops=3)
                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 984kB
                                                   ->  Parallel Hash Join  (cost=290685.23..305955.50 rows=1 width=60) (actual time=1870.923..2056.027 rows=3796 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.148..165.049 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.042..81.203 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=290682.79..290682.79 rows=1 width=51) (actual time=1869.849..1869.849 rows=4146 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                               ->  Parallel Hash Join  (cost=51384.54..290682.79 rows=1 width=51) (actual time=1717.266..1849.048 rows=4146 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..239300.13 rows=144 width=47) (actual time=1174.469..1300.589 rows=10138 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=16278 width=51) (actual time=818.684..1296.036 rows=10267 loops=3)
                                                                                 Filter: ((info)::text = 'Horror'::text)
                                                                                 Rows Removed by Filter: 4934973
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.096..0.096 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.057..0.069 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'genres'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=51381.24..51381.24 rows=70 width=4) (actual time=542.707..542.707 rows=20699 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3480kB
                                                                           ->  Hash Join  (cost=3129.33..51381.24 rows=70 width=4) (actual time=34.058..480.101 rows=20699 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.045..255.637 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=3129.26..3129.26 rows=5 width=4) (actual time=33.896..33.896 rows=5 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..3129.26 rows=5 width=4) (actual time=1.054..33.870 rows=5 loops=3)
                                                                                             Filter: ((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))
                                                                                             Rows Removed by Filter: 134165
 Planning Time: 28.966 ms
 Execution Time: 6249.003 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25b.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=938224.64..938224.65 rows=1 width=128) (actual time=5792.216..5792.216 rows=1 loops=1)
   ->  Gather  (cost=938224.41..938224.62 rows=2 width=128) (actual time=5791.895..5799.100 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=937224.41..937224.42 rows=1 width=128) (actual time=5784.323..5784.323 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=857197.05..937224.40 rows=1 width=80) (actual time=5623.346..5784.299 rows=2 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.047..464.289 rows=579860 loops=3)
                           Filter: ((gender)::text = 'm'::text)
                           Rows Removed by Filter: 809304
                     ->  Parallel Hash  (cost=857197.04..857197.04 rows=1 width=69) (actual time=5262.941..5262.941 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=617898.78..857197.04 rows=1 width=69) (actual time=5249.485..5262.817 rows=2 loops=3)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..239300.13 rows=144 width=47) (actual time=1152.851..1277.775 rows=10138 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=16278 width=51) (actual time=804.408..1273.390 rows=10267 loops=3)
                                             Filter: ((info)::text = 'Horror'::text)
                                             Rows Removed by Filter: 4934973
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.030 rows=1 loops=3)
                                                   Filter: ((info)::text = 'genres'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=617896.35..617896.35 rows=1 width=42) (actual time=3983.360..3983.360 rows=2 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=602626.08..617896.35 rows=1 width=42) (actual time=3979.050..3983.299 rows=2 loops=3)
                                             Hash Cond: (mi_idx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.184..164.773 rows=153308 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.043..82.297 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.073..0.074 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.047 rows=1 loops=3)
                                                               Filter: ((info)::text = 'votes'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=602623.64..602623.64 rows=1 width=33) (actual time=3803.724..3803.724 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                   ->  Parallel Hash Join  (cost=554371.45..602623.64 rows=1 width=33) (actual time=3797.024..3803.645 rows=2 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Hash Join  (cost=3129.33..51381.24 rows=70 width=4) (actual time=34.383..482.526 rows=20699 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.040..259.544 rows=1507977 loops=3)
                                                               ->  Hash  (cost=3129.26..3129.26 rows=5 width=4) (actual time=34.225..34.225 rows=5 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..3129.26 rows=5 width=4) (actual time=1.022..34.204 rows=5 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))
                                                                           Rows Removed by Filter: 134165
                                                         ->  Parallel Hash  (cost=551242.03..551242.03 rows=8 width=29) (actual time=3317.462..3317.462 rows=8 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=51800.14..551242.03 rows=8 width=29) (actual time=2163.546..3317.326 rows=8 loops=3)
                                                                     Hash Cond: (ci.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=267.445..3023.190 rows=414905 loops=3)
                                                                           Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                           Rows Removed by Filter: 11666543
                                                                     ->  Parallel Hash  (cost=51799.95..51799.95 rows=15 width=21) (actual time=251.367..251.367 rows=24 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=15 width=21) (actual time=8.624..251.262 rows=24 loops=3)
                                                                                 Filter: ((production_year > 2010) AND ((title)::text ~~ 'Vampire%'::text))
                                                                                 Rows Removed by Filter: 842746
 Planning Time: 30.363 ms
 Execution Time: 5799.979 ms
(62 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25c.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=968932.69..968932.70 rows=1 width=128) (actual time=6644.417..6644.417 rows=1 loops=1)
   ->  Gather  (cost=968932.46..968932.67 rows=2 width=128) (actual time=6642.134..6649.249 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=967932.46..967932.47 rows=1 width=128) (actual time=6634.941..6634.941 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=917449.32..967932.45 rows=1 width=80) (actual time=6285.747..6629.257 rows=8718 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.026..223.371 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=917449.31..917449.31 rows=1 width=79) (actual time=6279.630..6279.630 rows=8718 loops=3)
                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2648kB
                           ->  Parallel Hash Join  (cost=837421.96..917449.31 rows=1 width=79) (actual time=5736.901..6248.151 rows=8718 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.055..438.443 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=837421.95..837421.95 rows=1 width=68) (actual time=5735.930..5735.930 rows=14300 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3960kB
                                       ->  Parallel Hash Join  (cost=337401.27..837421.95 rows=1 width=68) (actual time=4549.746..5689.630 rows=14300 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=165.804..2901.930 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=337401.26..337401.26 rows=1 width=60) (actual time=2720.918..2720.918 rows=21129 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4824kB
                                                   ->  Parallel Hash Join  (cost=322130.99..337401.26 rows=1 width=60) (actual time=2480.486..2668.568 rows=21129 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.141..159.975 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.031..76.320 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.046..0.047 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.036 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=322128.55..322128.55 rows=1 width=51) (actual time=2480.084..2480.085 rows=22680 loops=3)
                                                               Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                               ->  Parallel Hash Join  (cost=51720.34..322128.55 rows=1 width=51) (actual time=2208.724..2440.708 rows=22680 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1645.251..1859.706 rows=62198 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1039.818..1842.272 rows=62990 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                 Rows Removed by Filter: 4882250
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.086..0.086 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.049..0.061 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'genres'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=563.392..563.392 rows=25571 loops=3)
                                                                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                           ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=39.243..480.800 rows=25571 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.050..251.338 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=39.060..39.060 rows=7 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.189..39.036 rows=7 loops=3)
                                                                                             Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                             Rows Removed by Filter: 134163
 Planning Time: 28.343 ms
 Execution Time: 6650.759 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26a.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=722071.79..722071.80 rows=1 width=128) (actual time=7208.706..7208.706 rows=1 loops=1)
   ->  Hash Join  (cost=706649.20..722071.78 rows=1 width=53) (actual time=7120.042..7207.698 rows=1728 loops=1)
         Hash Cond: (t.kind_id = kt.id)
         ->  Hash Join  (cost=706648.10..722070.67 rows=1 width=57) (actual time=7067.650..7207.142 rows=1844 loops=1)
               Hash Cond: (mi_idx.info_type_id = it2.id)
               ->  Gather  (cost=706645.67..722068.24 rows=1 width=61) (actual time=7067.559..7313.592 rows=2580 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Parallel Hash Join  (cost=705645.67..721068.14 rows=1 width=61) (actual time=7058.368..7194.249 rows=860 loops=3)
                           Hash Cond: (mi_idx.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=79942 width=13) (actual time=0.055..132.439 rows=64632 loops=3)
                                 Filter: ((info)::text > '7.0'::text)
                                 Rows Removed by Filter: 395380
                           ->  Parallel Hash  (cost=705645.66..705645.66 rows=1 width=68) (actual time=7051.100..7051.100 rows=1906 loops=3)
                                 Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 728kB
                                 ->  Parallel Hash Join  (cost=648661.37..705645.66 rows=1 width=68) (actual time=6502.759..6984.705 rows=1906 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.048..460.449 rows=60051 loops=3)
                                             Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                             Rows Removed by Filter: 986729
                                       ->  Parallel Hash  (cost=648661.29..648661.29 rows=6 width=56) (actual time=6502.510..6502.510 rows=69092 loops=3)
                                             Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 9560kB
                                             ->  Parallel Hash Join  (cost=569172.01..648661.29 rows=6 width=56) (actual time=6035.582..6430.896 rows=69092 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.047..382.798 rows=1389164 loops=3)
                                                   ->  Parallel Hash  (cost=569171.94..569171.94 rows=6 width=45) (actual time=5134.172..5134.172 rows=69092 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2560kB
                                                         ->  Parallel Hash Join  (cost=108834.99..569171.94 rows=6 width=45) (actual time=1010.337..4949.754 rows=69092 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.033..2167.984 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=108834.98..108834.98 rows=1 width=33) (actual time=1009.892..1009.892 rows=532 loops=3)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                     ->  Hash Join  (cost=58439.25..108834.98 rows=1 width=33) (actual time=522.038..1001.665 rows=532 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Hash Join  (cost=54471.30..104857.99 rows=3441 width=37) (actual time=468.980..943.760 rows=121797 loops=3)
                                                                                 Hash Cond: (mk.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.031..254.463 rows=1507977 loops=3)
                                                                                 ->  Parallel Hash  (cost=54447.27..54447.27 rows=1923 width=29) (actual time=468.451..468.451 rows=7852 loops=3)
                                                                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2016kB
                                                                                       ->  Hash Join  (cost=3102.42..54447.27 rows=1923 width=29) (actual time=94.720..442.398 rows=7852 loops=3)
                                                                                             Hash Cond: (t.id = cc.movie_id)
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.044..278.289 rows=460484 loops=3)
                                                                                                   Filter: (production_year > 2000)
                                                                                                   Rows Removed by Filter: 382286
                                                                                             ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=94.288..94.288 rows=85941 loops=3)
                                                                                                   Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                                                                                   ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.254..66.830 rows=85941 loops=3)
                                                                                                         Hash Cond: (cc.status_id = cct2.id)
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.138..48.613 rows=85941 loops=3)
                                                                                                               Hash Cond: (cc.subject_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.028..18.002 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.040 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.021..0.023 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'cast'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.056..0.056 rows=2 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.041..0.043 rows=2 loops=3)
                                                                                                                     Filter: ((kind)::text ~~ '%complete%'::text)
                                                                                                                     Rows Removed by Filter: 2
                                                                           ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=46.295..46.295 rows=10 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.208..46.256 rows=10 loops=3)
                                                                                       Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                                       Rows Removed by Filter: 134160
               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.035 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.025 rows=1 loops=1)
                           Filter: ((info)::text = 'rating'::text)
                           Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.024..0.026 rows=1 loops=1)
                     Filter: ((kind)::text = 'movie'::text)
                     Rows Removed by Filter: 6
 Planning Time: 85.632 ms
 Execution Time: 7317.054 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26b.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=719517.69..719517.70 rows=1 width=96) (actual time=6654.411..6654.411 rows=1 loops=1)
   ->  Hash Join  (cost=662439.50..719517.69 rows=1 width=38) (actual time=6157.996..6654.332 rows=93 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=662438.44..719516.62 rows=1 width=42) (actual time=6157.884..6654.197 rows=93 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=662437.38..719515.56 rows=1 width=46) (actual time=6157.805..6654.082 rows=180 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=658006.94..714423.11 rows=1 width=54) (actual time=6084.581..6571.766 rows=191 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=657006.94..713423.01 rows=1 width=54) (actual time=6076.412..6563.139 rows=64 loops=3)
                                 Hash Cond: (chn.id = ci.person_role_id)
                                 ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.055..476.385 rows=60051 loops=3)
                                       Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                       Rows Removed by Filter: 986729
                                 ->  Parallel Hash  (cost=657006.93..657006.93 rows=1 width=42) (actual time=6073.292..6073.292 rows=2660 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                       ->  Hash Join  (cost=577517.63..657006.93 rows=1 width=42) (actual time=5272.073..5849.473 rows=2660 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Hash Join  (cost=577515.21..657004.49 rows=6 width=46) (actual time=5271.264..5847.350 rows=5809 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.044..371.741 rows=1389164 loops=3)
                                                   ->  Parallel Hash  (cost=577515.13..577515.13 rows=6 width=50) (actual time=5270.566..5270.566 rows=5809 loops=3)
                                                         Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2136kB
                                                         ->  Parallel Hash Join  (cost=117178.19..577515.13 rows=6 width=50) (actual time=1096.743..4934.143 rows=5809 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.031..2307.388 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=117178.17..117178.17 rows=1 width=38) (actual time=1095.159..1095.159 rows=39 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=101980.10..117178.17 rows=1 width=38) (actual time=1014.579..1095.029 rows=39 loops=3)
                                                                           Hash Cond: (mi_idx.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.067..133.728 rows=17883 loops=3)
                                                                                 Filter: ((info)::text > '8.0'::text)
                                                                                 Rows Removed by Filter: 442129
                                                                           ->  Parallel Hash  (cost=101980.06..101980.06 rows=3 width=25) (actual time=957.415..957.415 rows=480 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Hash Join  (cost=51215.31..101980.06 rows=3 width=25) (actual time=843.011..956.778 rows=480 loops=3)
                                                                                       Hash Cond: (t.kind_id = kt.id)
                                                                                       ->  Parallel Hash Join  (cost=51214.21..101978.87 rows=23 width=29) (actual time=632.221..956.261 rows=1008 loops=3)
                                                                                             Hash Cond: (t.id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.038..280.826 rows=337640 loops=3)
                                                                                                   Filter: (production_year > 2005)
                                                                                                   Rows Removed by Filter: 505131
                                                                                             ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=628.921..628.921 rows=3328 loops=3)
                                                                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                                                                   ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=31.459..469.096 rows=3328 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.049..252.805 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=31.100..31.100 rows=4 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.132..31.079 rows=4 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,fight}'::text[]))
                                                                                                                     Rows Removed by Filter: 134166
                                                                                       ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=3)
                                                                                                   Filter: ((kind)::text = 'movie'::text)
                                                                                                   Rows Removed by Filter: 6
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.077..0.077 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.056..0.059 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=66.124..66.124 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.014..25.967 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.026..0.028 rows=2 loops=1)
                     Filter: ((kind)::text ~~ '%complete%'::text)
                     Rows Removed by Filter: 2
 Planning Time: 86.589 ms
 Execution Time: 6656.149 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26c.sql_explained.sql
SET
SET
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=722078.21..722078.22 rows=1 width=96) (actual time=8265.517..8265.517 rows=1 loops=1)
   ->  Hash Join  (cost=665321.10..722078.20 rows=1 width=38) (actual time=7775.256..8262.401 rows=5400 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Gather  (cost=665320.04..722077.14 rows=1 width=42) (actual time=7775.155..8413.624 rows=6359 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=664320.04..721077.04 rows=1 width=42) (actual time=7767.474..8249.478 rows=2120 loops=3)
                     Hash Cond: (chn.id = ci.person_role_id)
                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.054..462.806 rows=60051 loops=3)
                           Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                           Rows Removed by Filter: 986729
                     ->  Parallel Hash  (cost=664319.99..664319.99 rows=4 width=30) (actual time=7766.504..7766.504 rows=73556 loops=3)
                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 7416kB
                           ->  Parallel Hash Join  (cost=584830.72..664319.99 rows=4 width=30) (actual time=7344.967..7727.511 rows=73556 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.044..380.112 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=584830.67..584830.67 rows=4 width=34) (actual time=6450.094..6450.094 rows=73556 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2336kB
                                       ->  Hash Join  (cost=533504.83..584830.67 rows=4 width=34) (actual time=6141.497..6362.975 rows=73556 loops=3)
                                             Hash Cond: (t.kind_id = kt.id)
                                             ->  Parallel Hash Join  (cost=533503.73..584829.46 rows=26 width=38) (actual time=6136.342..6345.130 rows=81357 loops=3)
                                                   Hash Cond: (t.id = mk.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.040..279.947 rows=460484 loops=3)
                                                         Filter: (production_year > 2000)
                                                         Rows Removed by Filter: 382286
                                                   ->  Parallel Hash  (cost=533503.13..533503.13 rows=48 width=33) (actual time=5669.040..5669.040 rows=232511 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 3616kB
                                                         ->  Hash Join  (cost=72499.97..533503.13 rows=48 width=33) (actual time=846.304..5376.116 rows=232511 loops=3)
                                                               Hash Cond: (cc.status_id = cct2.id)
                                                               ->  Hash Join  (cost=72498.91..533501.03 rows=192 width=37) (actual time=846.203..5308.283 rows=232511 loops=3)
                                                                     Hash Cond: (mk.movie_id = cc.movie_id)
                                                                     ->  Parallel Hash Join  (cost=68068.47..528405.98 rows=138 width=25) (actual time=777.011..4905.706 rows=360905 loops=3)
                                                                           Hash Cond: (ci.movie_id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.028..2162.076 rows=12081448 loops=3)
                                                                           ->  Parallel Hash  (cost=68068.42..68068.42 rows=4 width=13) (actual time=776.832..776.833 rows=6392 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                                 ->  Hash Join  (cost=52224.04..68068.42 rows=4 width=13) (actual time=596.446..744.461 rows=6392 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Hash Join  (cost=52221.61..68064.84 rows=426 width=17) (actual time=596.313..740.945 rows=19234 loops=3)
                                                                                             Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.033..74.727 rows=460012 loops=3)
                                                                                             ->  Parallel Hash  (cost=52219.86..52219.86 rows=140 width=4) (actual time=595.748..595.748 rows=8030 loops=3)
                                                                                                   Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                                                                   ->  Hash Join  (cost=3967.95..52219.86 rows=140 width=4) (actual time=46.457..486.445 rows=8030 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.042..250.092 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=46.177..46.177 rows=10 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.200..46.147 rows=10 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                                                                     Rows Removed by Filter: 134160
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.070..0.070 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.056..0.059 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=66.382..66.382 rows=135086 loops=3)
                                                                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.029..25.387 rows=135086 loops=3)
                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.026..0.028 rows=2 loops=3)
                                                                           Filter: ((kind)::text ~~ '%complete%'::text)
                                                                           Rows Removed by Filter: 2
                                             ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'movie'::text)
                                                         Rows Removed by Filter: 6
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.023..0.025 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 84.971 ms
 Execution Time: 8420.080 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27a.sql_explained.sql
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=62724.94..62724.95 rows=1 width=96) (actual time=295.907..295.907 rows=1 loops=1)
   ->  Merge Join  (cost=26778.72..62724.94 rows=1 width=118) (actual time=295.019..295.694 rows=477 loops=1)
         Merge Cond: (mi.movie_id = ml.movie_id)
         ->  Gather Merge  (cost=1000.46..988404.79 rows=132912 width=4) (actual time=9.747..22.589 rows=2822 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..972063.42 rows=55380 width=4) (actual time=1.158..170.435 rows=1126 loops=3)
                     Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                     Rows Removed by Filter: 149267
         ->  Sort  (cost=25778.26..25778.26 rows=1 width=138) (actual time=284.704..284.735 rows=475 loops=1)
               Sort Key: t.id
               Sort Method: quicksort  Memory: 49kB
               ->  Hash Join  (cost=22622.22..25778.25 rows=1 width=138) (actual time=261.400..284.512 rows=172 loops=1)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Merge Join  (cost=19996.08..23150.40 rows=652 width=142) (actual time=238.582..264.444 rows=3278 loops=1)
                           Merge Cond: (mk.movie_id = ml.movie_id)
                           ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.031..19.833 rows=69431 loops=1)
                           ->  Sort  (cost=19995.65..19995.68 rows=14 width=134) (actual time=235.703..235.910 rows=3270 loops=1)
                                 Sort Key: t.id
                                 Sort Method: quicksort  Memory: 62kB
                                 ->  Hash Join  (cost=19698.66..19995.38 rows=14 width=134) (actual time=232.514..235.469 rows=269 loops=1)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Hash Join  (cost=19697.58..19994.16 rows=27 width=138) (actual time=232.413..235.296 rows=269 loops=1)
                                             Hash Cond: (cc.status_id = cct2.id)
                                             ->  Merge Join  (cost=19696.52..19992.51 rows=109 width=142) (actual time=232.336..235.133 rows=333 loops=1)
                                                   Merge Cond: (cc.movie_id = ml.movie_id)
                                                   ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.034..2.440 rows=5140 loops=1)
                                                   ->  Sort  (cost=19696.10..19696.27 rows=69 width=130) (actual time=231.871..231.922 rows=756 loops=1)
                                                         Sort Key: t.id
                                                         Sort Method: quicksort  Memory: 120kB
                                                         ->  Gather  (cost=7378.71..19693.99 rows=69 width=130) (actual time=123.957..233.113 rows=698 loops=1)
                                                               Workers Planned: 2
                                                               Workers Launched: 2
                                                               ->  Parallel Hash Join  (cost=6378.71..18687.09 rows=29 width=130) (actual time=120.044..224.500 rows=233 loops=3)
                                                                     Hash Cond: (mc.company_id = cn.id)
                                                                     ->  Hash Join  (cost=652.57..12960.52 rows=160 width=115) (actual time=23.333..164.008 rows=931 loops=3)
                                                                           Hash Cond: (mc.company_type_id = ct.id)
                                                                           ->  Merge Join  (cost=651.50..12956.00 rows=640 width=119) (actual time=23.211..163.516 rows=1104 loops=3)
                                                                                 Merge Cond: (ml.movie_id = mc.movie_id)
                                                                                 ->  Merge Join  (cost=651.07..7725.24 rows=250 width=107) (actual time=19.671..117.330 rows=444 loops=3)
                                                                                       Merge Cond: (t.id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=379985 width=21) (actual time=0.736..102.439 rows=19945 loops=3)
                                                                                             Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                                                                             Rows Removed by Filter: 42153
                                                                                       ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.394..12.584 rows=2315 loops=3)
                                                                                             Sort Key: ml.movie_id
                                                                                             Sort Method: quicksort  Memory: 205kB
                                                                                             Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                             Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                                                             ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.152..11.123 rows=2315 loops=3)
                                                                                                   Hash Cond: (ml.link_type_id = lt.id)
                                                                                                   ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.028..6.735 rows=29997 loops=3)
                                                                                                   ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.062..0.063 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.046..0.051 rows=2 loops=3)
                                                                                                               Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                               Rows Removed by Filter: 16
                                                                                 ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.061..42.531 rows=42275 loops=3)
                                                                                       Filter: (note IS NULL)
                                                                                       Rows Removed by Filter: 42817
                                                                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.054..0.056 rows=1 loops=3)
                                                                                       Filter: ((kind)::text = 'production companies'::text)
                                                                                       Rows Removed by Filter: 3
                                                                     ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=59.097..59.097 rows=16101 loops=3)
                                                                           Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.068..48.285 rows=16101 loops=3)
                                                                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                                 Rows Removed by Filter: 62232
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                                                         Filter: ((kind)::text = 'complete'::text)
                                                         Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.047..0.047 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.033..0.035 rows=2 loops=1)
                                                   Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                                                   Rows Removed by Filter: 2
                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.673..19.673 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.185..19.661 rows=1 loops=1)
                                 Filter: ((keyword)::text = 'sequel'::text)
                                 Rows Removed by Filter: 134169
 Planning Time: 83.863 ms
 Execution Time: 310.368 ms
(87 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27b.sql_explained.sql
SET
SET
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=62047.93..62047.94 rows=1 width=96) (actual time=527.327..527.327 rows=1 loops=1)
   ->  Hash Join  (cost=58902.55..62047.92 rows=1 width=118) (actual time=526.486..527.201 rows=247 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=56276.42..59421.66 rows=47 width=122) (actual time=506.415..507.053 rows=1919 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.030..18.133 rows=69431 loops=1)
               ->  Materialize  (cost=56275.98..56275.99 rows=1 width=138) (actual time=480.543..480.760 rows=1911 loops=1)
                     ->  Sort  (cost=56275.98..56275.99 rows=1 width=138) (actual time=480.532..480.548 rows=247 loops=1)
                           Sort Key: t.id
                           Sort Method: quicksort  Memory: 59kB
                           ->  Hash Join  (cost=55981.58..56275.97 rows=1 width=138) (actual time=479.887..480.273 rows=247 loops=1)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Hash Join  (cost=55980.51..56274.91 rows=1 width=142) (actual time=479.804..480.109 rows=418 loops=1)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Merge Join  (cost=55979.44..56273.83 rows=2 width=146) (actual time=479.725..479.918 rows=418 loops=1)
                                             Merge Cond: (cc.movie_id = ml.movie_id)
                                             ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.042..1.955 rows=4705 loops=1)
                                             ->  Sort  (cost=55979.02..55979.02 rows=1 width=134) (actual time=477.126..477.192 rows=908 loops=1)
                                                   Sort Key: t.id
                                                   Sort Method: quicksort  Memory: 128kB
                                                   ->  Gather  (cost=50471.19..55979.01 rows=1 width=134) (actual time=411.085..477.078 rows=737 loops=1)
                                                         Workers Planned: 1
                                                         Workers Launched: 1
                                                         ->  Parallel Hash Join  (cost=49471.19..54978.91 rows=1 width=134) (actual time=414.645..471.290 rows=368 loops=2)
                                                               Hash Cond: (cn.id = mc.company_id)
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.042..64.143 rows=24151 loops=2)
                                                                     Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                     Rows Removed by Filter: 93348
                                                               ->  Parallel Hash  (cost=49471.16..49471.16 rows=3 width=119) (actual time=403.299..403.299 rows=718 loops=2)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                                                     ->  Hash Join  (cost=653.00..49471.16 rows=3 width=119) (actual time=252.567..370.912 rows=718 loops=2)
                                                                           Hash Cond: (mc.company_type_id = ct.id)
                                                                           ->  Merge Join  (cost=651.94..49470.03 rows=13 width=123) (actual time=252.458..370.577 rows=736 loops=2)
                                                                                 Merge Cond: (ml.movie_id = mc.movie_id)
                                                                                 ->  Merge Join  (cost=651.51..44246.14 rows=5 width=111) (actual time=234.337..345.652 rows=151 loops=2)
                                                                                       Merge Cond: (mi.movie_id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..972063.42 rows=55380 width=4) (actual time=1.390..140.017 rows=1440 loops=2)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                                                                                             Rows Removed by Filter: 187318
                                                                                       ->  Materialize  (cost=651.07..8854.49 rows=33 width=107) (actual time=24.958..205.366 rows=235 loops=2)
                                                                                             ->  Merge Join  (cost=651.07..8854.40 rows=33 width=107) (actual time=24.947..205.252 rows=141 loops=2)
                                                                                                   Merge Cond: (t.id = ml.movie_id)
                                                                                                   ->  Index Scan using title_pkey on title t  (cost=0.43..108402.95 rows=50313 width=21) (actual time=2.701..194.756 rows=4216 loops=2)
                                                                                                         Filter: (production_year = 1998)
                                                                                                         Rows Removed by Filter: 182255
                                                                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=9.575..9.752 rows=2315 loops=2)
                                                                                                         Sort Key: ml.movie_id
                                                                                                         Sort Method: quicksort  Memory: 205kB
                                                                                                         Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.129..8.366 rows=2315 loops=2)
                                                                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.024..4.142 rows=29997 loops=2)
                                                                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.044..0.044 rows=2 loops=2)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.027..0.033 rows=2 loops=2)
                                                                                                                           Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                                           Rows Removed by Filter: 16
                                                                                 ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.030..22.250 rows=34556 loops=2)
                                                                                       Filter: (note IS NULL)
                                                                                       Rows Removed by Filter: 35332
                                                                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.041..0.043 rows=1 loops=2)
                                                                                       Filter: ((kind)::text = 'production companies'::text)
                                                                                       Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.025..0.026 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.011..0.013 rows=2 loops=1)
                                                   Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                                                   Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.026..0.027 rows=1 loops=1)
                                             Filter: ((kind)::text = 'complete'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.877..19.877 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.177..19.865 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 85.196 ms
 Execution Time: 528.616 ms
(82 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=64696.47..64696.48 rows=1 width=96) (actual time=554.387..554.387 rows=1 loops=1)
   ->  Hash Join  (cost=61522.37..64696.47 rows=1 width=118) (actual time=529.584..554.079 rows=743 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=58896.24..62065.93 rows=1677 width=122) (actual time=507.182..533.223 rows=11620 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.032..17.611 rows=69431 loops=1)
               ->  Sort  (cost=58895.80..58895.89 rows=36 width=138) (actual time=504.680..505.400 rows=11612 loops=1)
                     Sort Key: ml.movie_id
                     Sort Method: quicksort  Memory: 210kB
                     ->  Hash Join  (cost=58588.08..58894.87 rows=36 width=138) (actual time=499.539..503.772 rows=1150 loops=1)
                           Hash Cond: (cc.subject_id = cct1.id)
                           ->  Hash Join  (cost=58587.01..58893.03 rows=143 width=142) (actual time=499.455..503.366 rows=1436 loops=1)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Merge Join  (cost=58585.95..58888.88 rows=572 width=146) (actual time=499.378..502.895 rows=1436 loops=1)
                                       Merge Cond: (cc.movie_id = ml.movie_id)
                                       ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.054..2.251 rows=5142 loops=1)
                                       ->  Sort  (cost=58585.52..58586.43 rows=363 width=134) (actual time=498.945..499.277 rows=4252 loops=1)
                                             Sort Key: ml.movie_id
                                             Sort Method: quicksort  Memory: 654kB
                                             ->  Gather  (cost=7421.33..58570.09 rows=363 width=134) (actual time=89.455..497.906 rows=3966 loops=1)
                                                   Workers Planned: 2
                                                   Workers Launched: 2
                                                   ->  Hash Join  (cost=6421.33..57533.79 rows=151 width=134) (actual time=72.161..464.128 rows=1322 loops=3)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Parallel Hash Join  (cost=6420.26..57529.46 rows=605 width=138) (actual time=71.962..463.492 rows=1361 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Merge Join  (cost=694.11..51794.52 rows=3349 width=123) (actual time=13.240..413.963 rows=3944 loops=3)
                                                                     Merge Cond: (ml.movie_id = mc.movie_id)
                                                                     ->  Merge Join  (cost=693.68..46534.00 rows=1310 width=111) (actual time=13.057..375.100 rows=1247 loops=3)
                                                                           Merge Cond: (ml.movie_id = t.id)
                                                                           ->  Merge Join  (cost=651.07..37496.27 rows=1747 width=90) (actual time=10.767..163.814 rows=1288 loops=3)
                                                                                 Merge Cond: (mi.movie_id = ml.movie_id)
                                                                                 ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1010698.11 rows=372351 width=4) (actual time=0.223..151.988 rows=11321 loops=3)
                                                                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))
                                                                                       Rows Removed by Filter: 160210
                                                                                 ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=9.503..9.760 rows=2954 loops=3)
                                                                                       Sort Key: ml.movie_id
                                                                                       Sort Method: quicksort  Memory: 205kB
                                                                                       Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                       Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.125..8.287 rows=2315 loops=3)
                                                                                             Hash Cond: (ml.link_type_id = lt.id)
                                                                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.028..4.068 rows=29997 loops=3)
                                                                                             ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.037..0.037 rows=2 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.020..0.025 rows=2 loops=3)
                                                                                                         Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                         Rows Removed by Filter: 16
                                                                           ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=1895923 width=21) (actual time=0.034..200.115 rows=133952 loops=3)
                                                                                 Filter: ((production_year >= 1950) AND (production_year <= 2010))
                                                                                 Rows Removed by Filter: 37741
                                                                     ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.026..34.362 rows=47785 loops=3)
                                                                           Filter: (note IS NULL)
                                                                           Rows Removed by Filter: 47347
                                                               ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=47.464..47.465 rows=16101 loops=3)
                                                                     Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.033..37.381 rows=16101 loops=3)
                                                                           Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                           Rows Removed by Filter: 62232
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.022..0.022 rows=2 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.010..0.012 rows=2 loops=1)
                                             Filter: ((kind)::text ~~ 'complete%'::text)
                                             Rows Removed by Filter: 2
                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=1)
                                       Filter: ((kind)::text = 'cast'::text)
                                       Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.698..19.698 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.228..19.685 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 85.116 ms
 Execution Time: 556.666 ms
(81 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28a.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=468295.89..468295.90 rows=1 width=96) (actual time=3961.471..3961.471 rows=1 loops=1)
   ->  Hash Join  (cost=451069.27..468295.88 rows=1 width=41) (actual time=3787.119..3959.485 rows=4803 loops=1)
         Hash Cond: (mi_idx.info_type_id = it2.id)
         ->  Gather  (cost=451066.84..468293.45 rows=1 width=45) (actual time=3786.982..3962.731 rows=15325 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=450066.84..467293.35 rows=1 width=45) (actual time=3762.095..3947.170 rows=5108 loops=3)
                     Hash Cond: (mi_idx.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.102..156.238 rows=447629 loops=3)
                           Filter: ((info)::text < '8.5'::text)
                           Rows Removed by Filter: 12383
                     ->  Parallel Hash  (cost=450066.83..450066.83 rows=1 width=56) (actual time=3741.725..3741.725 rows=1704 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 600kB
                           ->  Hash Join  (cost=147280.54..450066.83 rows=1 width=56) (actual time=3251.422..3728.305 rows=1704 loops=3)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Hash Join  (cost=147279.45..450065.74 rows=1 width=60) (actual time=3251.317..3727.696 rows=2155 loops=3)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Hash Join  (cost=147278.39..450064.67 rows=1 width=64) (actual time=3242.735..3725.866 rows=13930 loops=3)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Hash Join  (cost=142847.96..444972.22 rows=1 width=52) (actual time=3160.511..3624.442 rows=15212 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=142845.53..444969.79 rows=1 width=56) (actual time=1357.335..3620.100 rows=17574 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.002..2227.689 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Parallel Hash  (cost=142845.52..142845.52 rows=1 width=48) (actual time=1349.465..1349.466 rows=16473 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5144kB
                                                               ->  Parallel Hash Join  (cost=137845.48..142845.52 rows=1 width=48) (actual time=1287.929..1332.293 rows=16473 loops=3)
                                                                     Hash Cond: (cn.id = mc.company_id)
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.039..31.690 rows=42077 loops=3)
                                                                           Filter: ((country_code)::text <> '[us]'::text)
                                                                           Rows Removed by Filter: 36256
                                                                     ->  Parallel Hash  (cost=137845.47..137845.47 rows=1 width=33) (actual time=1287.788..1287.788 rows=17485 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4504kB
                                                                           ->  Hash Join  (cost=102542.40..137845.47 rows=1 width=33) (actual time=971.703..1262.378 rows=17485 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=102541.31..137844.38 rows=1 width=37) (actual time=971.592..1257.766 rows=17485 loops=3)
                                                                                       Hash Cond: (mc.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.020..269.566 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=102541.20..102541.20 rows=9 width=25) (actual time=969.864..969.864 rows=3895 loops=3)
                                                                                             Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 984kB
                                                                                             ->  Hash Join  (cost=51215.33..102541.20 rows=9 width=25) (actual time=582.715..920.907 rows=3895 loops=3)
                                                                                                   Hash Cond: (t.kind_id = kt.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..102539.96 rows=31 width=29) (actual time=581.949..918.918 rows=4924 loops=3)
                                                                                                         Hash Cond: (t.id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.021..273.573 rows=460484 loops=3)
                                                                                                               Filter: (production_year > 2000)
                                                                                                               Rows Removed by Filter: 382286
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=581.060..581.060 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=46.122..487.000 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..253.310 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=45.840..45.840 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.582..45.819 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.078..0.078 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.062..0.065 rows=2 loops=3)
                                                                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                                                                               Rows Removed by Filter: 5
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.057..0.057 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.040..0.041 rows=4 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.071..0.071 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.058 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=71.759..71.759 rows=135086 loops=3)
                                                   Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.028..30.439 rows=135086 loops=3)
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.028..0.029 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.015..0.017 rows=1 loops=3)
                                                   Filter: ((kind)::text = 'crew'::text)
                                                   Rows Removed by Filter: 3
                                 ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.058..0.058 rows=3 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=3 width=4) (actual time=0.034..0.036 rows=3 loops=3)
                                             Filter: ((kind)::text <> 'complete+verified'::text)
                                             Rows Removed by Filter: 1
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.023..0.026 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 111.674 ms
 Execution Time: 3968.469 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28b.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=418889.66..418889.67 rows=1 width=96) (actual time=3111.536..3111.536 rows=1 loops=1)
   ->  Hash Join  (cost=403298.67..418889.65 rows=1 width=41) (actual time=2976.930..3111.447 rows=148 loops=1)
         Hash Cond: (mi_idx.info_type_id = it2.id)
         ->  Gather  (cost=403296.25..418887.22 rows=1 width=45) (actual time=2976.812..3117.711 rows=224 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=402296.25..417887.12 rows=1 width=45) (actual time=3047.062..3103.110 rows=75 loops=3)
                     Hash Cond: (mi_idx.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=124848 width=13) (actual time=0.050..137.580 rows=99992 loops=3)
                           Filter: ((info)::text > '6.5'::text)
                           Rows Removed by Filter: 360020
                     ->  Parallel Hash  (cost=402296.24..402296.24 rows=1 width=56) (actual time=2953.592..2953.592 rows=70 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=350869.64..402296.24 rows=1 width=56) (actual time=2938.751..2953.374 rows=70 loops=3)
                                 Hash Cond: (cc.subject_id = cct1.id)
                                 ->  Hash Join  (cost=350868.57..402295.17 rows=1 width=60) (actual time=2861.223..2953.191 rows=544 loops=3)
                                       Hash Cond: (cc.status_id = cct2.id)
                                       ->  Hash Join  (cost=350867.49..402294.08 rows=1 width=64) (actual time=2855.850..2952.909 rows=1108 loops=3)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Hash Join  (cost=346437.05..397201.63 rows=1 width=52) (actual time=2616.210..2849.915 rows=1608 loops=3)
                                                   Hash Cond: (t.kind_id = kt.id)
                                                   ->  Parallel Hash Join  (cost=346435.94..397200.52 rows=1 width=56) (actual time=2550.214..2849.337 rows=1675 loops=3)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.013..265.091 rows=337640 loops=3)
                                                               Filter: (production_year > 2005)
                                                               Rows Removed by Filter: 505131
                                                         ->  Parallel Hash  (cost=346435.93..346435.93 rows=1 width=31) (actual time=2540.803..2540.803 rows=4086 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1112kB
                                                               ->  Parallel Hash Join  (cost=341435.89..346435.93 rows=1 width=31) (actual time=2512.686..2536.421 rows=4086 loops=3)
                                                                     Hash Cond: (cn.id = mc.company_id)
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.014..17.781 rows=42077 loops=3)
                                                                           Filter: ((country_code)::text <> '[us]'::text)
                                                                           Rows Removed by Filter: 36256
                                                                     ->  Parallel Hash  (cost=341435.88..341435.88 rows=1 width=16) (actual time=2512.552..2512.552 rows=4250 loops=3)
                                                                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 920kB
                                                                           ->  Hash Join  (cost=306132.81..341435.88 rows=1 width=16) (actual time=2190.364..2469.148 rows=4250 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=306131.72..341434.79 rows=1 width=20) (actual time=2190.252..2467.986 rows=4250 loops=3)
                                                                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.034..265.693 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=306131.71..306131.71 rows=1 width=8) (actual time=2187.128..2187.128 rows=653 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Hash Join  (cost=51216.64..306131.71 rows=1 width=8) (actual time=1891.006..2186.552 rows=653 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..306129.23 rows=21 width=12) (actual time=555.222..2185.998 rows=1510 loops=3)
                                                                                                         Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=55380 width=8) (actual time=0.913..1621.099 rows=44746 loops=3)
                                                                                                               Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                                                                                                               Rows Removed by Filter: 4900494
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=553.332..553.332 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=33.469..472.144 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..252.079 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=33.152..33.153 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.399..33.135 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.043 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'countries'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.058..0.058 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.040..0.042 rows=4 loops=3)
                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.082..0.083 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.066..0.069 rows=2 loops=3)
                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                               Rows Removed by Filter: 5
                                             ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=84.742..84.742 rows=135086 loops=3)
                                                   Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.028..27.777 rows=135086 loops=3)
                                       ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.023..0.023 rows=3 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=3 width=4) (actual time=0.008..0.010 rows=3 loops=3)
                                                   Filter: ((kind)::text <> 'complete+verified'::text)
                                                   Rows Removed by Filter: 1
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.041..0.042 rows=1 loops=3)
                                             Filter: ((kind)::text = 'crew'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 110.353 ms
 Execution Time: 3119.008 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28c.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=467734.71..467734.72 rows=1 width=96) (actual time=3927.741..3927.741 rows=1 loops=1)
   ->  Hash Join  (cost=449846.07..467734.70 rows=1 width=41) (actual time=3694.811..3924.140 rows=8373 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=449845.01..467733.64 rows=1 width=45) (actual time=3694.703..3921.252 rows=15126 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=449843.95..467732.57 rows=1 width=49) (actual time=3694.622..3917.201 rows=16719 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=445413.51..462640.12 rows=1 width=61) (actual time=3599.300..3813.153 rows=21489 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=445411.09..462637.70 rows=1 width=65) (actual time=3599.188..3801.570 rows=64628 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=444411.09..461637.60 rows=1 width=65) (actual time=3593.421..3792.834 rows=21543 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.918..157.362 rows=447629 loops=3)
                                             Filter: ((info)::text < '8.5'::text)
                                             Rows Removed by Filter: 12383
                                       ->  Parallel Hash  (cost=444411.07..444411.07 rows=1 width=52) (actual time=3579.967..3579.967 rows=7276 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2456kB
                                             ->  Hash Join  (cost=142286.81..444411.07 rows=1 width=52) (actual time=3103.447..3556.935 rows=7276 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=142284.38..444408.65 rows=1 width=56) (actual time=1298.955..3554.760 rows=8340 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.009..2240.006 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Parallel Hash  (cost=142284.37..142284.37 rows=1 width=48) (actual time=1279.221..1279.221 rows=7967 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2552kB
                                                               ->  Hash Join  (cost=137284.33..142284.37 rows=1 width=48) (actual time=1239.035..1270.264 rows=7967 loops=3)
                                                                     Hash Cond: (mc.company_type_id = ct.id)
                                                                     ->  Parallel Hash Join  (cost=137283.24..142283.28 rows=1 width=52) (actual time=1238.923..1268.176 rows=7967 loops=3)
                                                                           Hash Cond: (cn.id = mc.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.010..20.760 rows=42077 loops=3)
                                                                                 Filter: ((country_code)::text <> '[us]'::text)
                                                                                 Rows Removed by Filter: 36256
                                                                           ->  Parallel Hash  (cost=137283.23..137283.23 rows=1 width=37) (actual time=1238.796..1238.796 rows=8618 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2360kB
                                                                                 ->  Parallel Hash Join  (cost=101980.16..137283.23 rows=1 width=37) (actual time=936.188..1215.220 rows=8618 loops=3)
                                                                                       Hash Cond: (mc.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.036..268.433 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=101980.08..101980.08 rows=7 width=25) (actual time=930.511..930.511 rows=2691 loops=3)
                                                                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                                                                                             ->  Hash Join  (cost=51215.33..101980.08 rows=7 width=25) (actual time=569.647..889.243 rows=2691 loops=3)
                                                                                                   Hash Cond: (t.kind_id = kt.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..101978.87 rows=23 width=29) (actual time=568.984..887.896 rows=3246 loops=3)
                                                                                                         Hash Cond: (t.id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.020..269.937 rows=337640 loops=3)
                                                                                                               Filter: (production_year > 2005)
                                                                                                               Rows Removed by Filter: 505131
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=568.395..568.395 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.488..472.396 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.023..253.054 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.298..32.299 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.439..32.284 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.071..0.071 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.053..0.056 rows=2 loops=3)
                                                                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                                                                               Rows Removed by Filter: 5
                                                                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.055..0.055 rows=4 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.040..0.041 rows=4 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.050 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.029..0.032 rows=1 loops=1)
                                       Filter: ((info)::text = 'rating'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.372..69.372 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.020..28.132 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.027..0.027 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.024..0.025 rows=1 loops=1)
                     Filter: ((kind)::text = 'complete'::text)
                     Rows Removed by Filter: 3
 Planning Time: 109.645 ms
 Execution Time: 3930.652 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29a.sql_explained.sql
SET
SET
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1085189.97..1085189.98 rows=1 width=96) (actual time=8795.661..8795.661 rows=1 loops=1)
   ->  Hash Join  (cost=1002792.89..1085189.96 rows=1 width=48) (actual time=8792.829..8795.178 rows=1620 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=1002791.82..1085188.89 rows=1 width=52) (actual time=8792.710..8794.676 rows=1620 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=1002790.76..1085187.83 rows=1 width=56) (actual time=8792.638..8794.215 rows=1620 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=998360.33..1080095.38 rows=1 width=68) (actual time=8711.294..8715.124 rows=1620 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=997360.33..1079095.28 rows=1 width=68) (actual time=8552.920..8553.070 rows=540 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=221.924..521.533 rows=16670 loops=3)
                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1372493
                                 ->  Parallel Hash  (cost=997360.31..997360.31 rows=1 width=65) (actual time=8026.443..8026.443 rows=540 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                       ->  Hash Join  (cost=980800.35..997360.31 rows=1 width=65) (actual time=7930.375..8000.766 rows=540 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Hash Join  (cost=978174.21..994734.17 rows=1 width=69) (actual time=7909.042..7973.532 rows=58320 loops=3)
                                                   Hash Cond: (ci.role_id = rt.id)
                                                   ->  Parallel Hash Join  (cost=978173.05..994733.01 rows=1 width=73) (actual time=7908.917..7958.758 rows=58320 loops=3)
                                                         Hash Cond: (an.person_id = ci.person_id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.035..72.439 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=978173.04..978173.04 rows=1 width=69) (actual time=7825.396..7825.396 rows=19440 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6072kB
                                                               ->  Parallel Hash Join  (cost=911370.37..978173.04 rows=1 width=69) (actual time=6255.684..6773.724 rows=19440 loops=3)
                                                                     Hash Cond: (ci.person_role_id = chn.id)
                                                                     ->  Parallel Hash Join  (cost=858566.42..925369.09 rows=1 width=57) (actual time=5998.547..6502.368 rows=149955 loops=3)
                                                                           Hash Cond: (pi.person_id = ci.person_id)
                                                                           ->  Hash Join  (cost=2.43..66764.11 rows=10928 width=4) (actual time=0.100..449.848 rows=206842 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.033..287.471 rows=987888 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.018..0.029 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'trivia'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=858563.98..858563.98 rows=1 width=53) (actual time=5988.796..5988.796 rows=13941 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4312kB
                                                                                 ->  Parallel Hash Join  (cost=396900.01..858563.98 rows=1 width=53) (actual time=2811.345..5534.440 rows=13941 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..460336.89 rows=353886 width=16) (actual time=0.085..2715.340 rows=278900 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11802548
                                                                                       ->  Parallel Hash  (cost=396900.00..396900.00 rows=1 width=37) (actual time=2776.945..2776.945 rows=369 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=391988.71..396900.00 rows=1 width=37) (actual time=2749.842..2776.738 rows=369 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.034..26.349 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=391988.70..391988.70 rows=1 width=41) (actual time=2746.835..2746.835 rows=1603 loops=3)
                                                                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                                         ->  Parallel Hash Join  (cost=358250.56..391988.70 rows=1 width=41) (actual time=2638.087..2638.471 rows=1603 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = t.id)
                                                                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.022..150.434 rows=869710 loops=3)
                                                                                                               ->  Parallel Hash  (cost=358250.54..358250.54 rows=1 width=33) (actual time=2380.429..2380.429 rows=81 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                     ->  Hash Join  (cost=102687.90..358250.54 rows=1 width=33) (actual time=2059.135..2380.323 rows=81 loops=3)
                                                                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                                                                           ->  Parallel Hash Join  (cost=102685.48..358248.12 rows=1 width=37) (actual time=2059.008..2380.177 rows=81 loops=3)
                                                                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=171.958..1662.143 rows=150368 loops=3)
                                                                                                                                       Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                                                                       Rows Removed by Filter: 4794872
                                                                                                                                 ->  Parallel Hash  (cost=102685.41..102685.41 rows=5 width=29) (actual time=701.268..701.268 rows=45 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                       ->  Parallel Hash Join  (cost=54433.65..102685.41 rows=5 width=29) (actual time=665.221..701.180 rows=45 loops=3)
                                                                                                                                             Hash Cond: (mk.movie_id = t.id)
                                                                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.012..248.524 rows=1507977 loops=3)
                                                                                                                                             ->  Parallel Hash  (cost=54433.61..54433.61 rows=3 width=21) (actual time=272.637..272.637 rows=1 loops=3)
                                                                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=3 width=21) (actual time=164.643..272.545 rows=1 loops=3)
                                                                                                                                                         Filter: ((production_year >= 2000) AND (production_year <= 2010) AND ((title)::text = 'Shrek 2'::text))
                                                                                                                                                         Rows Removed by Filter: 842770
                                                                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.073..0.073 rows=1 loops=3)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.048..0.059 rows=1 loops=3)
                                                                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=52803.93..52803.93 rows=1 width=20) (actual time=253.604..253.604 rows=0 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..52803.93 rows=1 width=20) (actual time=173.860..253.566 rows=0 loops=3)
                                                                                 Filter: ((name)::text = 'Queen'::text)
                                                                                 Rows Removed by Filter: 1046779
                                                   ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.050..0.052 rows=1 loops=3)
                                                               Filter: ((role)::text = 'actress'::text)
                                                               Rows Removed by Filter: 11
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.266..21.266 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.086..21.241 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'computer-animation'::text)
                                                         Rows Removed by Filter: 134169
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.884..69.884 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.022..28.482 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.023..0.025 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 146.646 ms
 Execution Time: 8799.033 ms
(111 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29b.sql_explained.sql
SET
SET
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1069734.87..1069734.88 rows=1 width=96) (actual time=7663.632..7663.633 rows=1 loops=1)
   ->  Hash Join  (cost=987337.79..1069734.86 rows=1 width=48) (actual time=7662.926..7663.617 rows=15 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=987336.72..1069733.79 rows=1 width=52) (actual time=7662.823..7663.511 rows=15 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=987335.66..1069732.73 rows=1 width=56) (actual time=7662.750..7663.435 rows=15 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=982905.23..1064640.28 rows=1 width=68) (actual time=7265.696..7585.011 rows=15 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=981905.23..1063640.18 rows=1 width=68) (actual time=7468.906..7574.710 rows=5 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=230.039..547.353 rows=16670 loops=3)
                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1372493
                                 ->  Parallel Hash  (cost=981905.21..981905.21 rows=1 width=65) (actual time=7023.163..7023.163 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Hash Join  (cost=965345.25..981905.21 rows=1 width=65) (actual time=6976.525..7023.050 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Hash Join  (cost=962719.11..979279.07 rows=1 width=69) (actual time=6955.143..7001.683 rows=540 loops=3)
                                                   Hash Cond: (ci.role_id = rt.id)
                                                   ->  Parallel Hash Join  (cost=962717.95..979277.91 rows=1 width=73) (actual time=6955.005..7001.408 rows=540 loops=3)
                                                         Hash Cond: (an.person_id = ci.person_id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.027..79.056 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=962717.94..962717.94 rows=1 width=69) (actual time=6883.631..6883.632 rows=180 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=895915.27..962717.94 rows=1 width=69) (actual time=6733.521..6883.455 rows=180 loops=3)
                                                                     Hash Cond: (ci.person_role_id = chn.id)
                                                                     ->  Parallel Hash Join  (cost=843111.32..909913.99 rows=1 width=57) (actual time=6186.269..6617.231 rows=2489 loops=3)
                                                                           Hash Cond: (pi.person_id = ci.person_id)
                                                                           ->  Hash Join  (cost=2.43..66764.11 rows=10928 width=4) (actual time=0.113..452.264 rows=47448 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.028..311.288 rows=987888 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.044 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.019..0.029 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'height'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=843108.88..843108.88 rows=1 width=53) (actual time=6155.252..6155.252 rows=7101 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2232kB
                                                                                 ->  Parallel Hash Join  (cost=381444.91..843108.88 rows=1 width=53) (actual time=2590.771..5386.824 rows=7101 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..460336.89 rows=353886 width=16) (actual time=0.108..2777.969 rows=278900 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11802548
                                                                                       ->  Parallel Hash  (cost=381444.90..381444.90 rows=1 width=37) (actual time=2569.578..2569.579 rows=189 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Parallel Hash Join  (cost=376533.61..381444.90 rows=1 width=37) (actual time=2556.625..2569.389 rows=189 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..16.858 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=376533.60..376533.60 rows=1 width=41) (actual time=2549.453..2549.453 rows=811 loops=3)
                                                                                                         Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 248kB
                                                                                                         ->  Parallel Hash Join  (cost=342795.46..376533.60 rows=1 width=41) (actual time=2439.133..2439.353 rows=811 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = t.id)
                                                                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.225..159.597 rows=869710 loops=3)
                                                                                                               ->  Parallel Hash  (cost=342795.44..342795.44 rows=1 width=33) (actual time=2172.616..2172.616 rows=45 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                     ->  Hash Join  (cost=102687.84..342795.44 rows=1 width=33) (actual time=1886.957..2172.526 rows=45 loops=3)
                                                                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                                                                           ->  Parallel Hash Join  (cost=102685.41..342793.02 rows=1 width=37) (actual time=1886.820..2172.378 rows=45 loops=3)
                                                                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=227791 width=8) (actual time=145.307..1450.639 rows=129228 loops=3)
                                                                                                                                       Filter: ((info)::text ~~ 'USA:%200%'::text)
                                                                                                                                       Rows Removed by Filter: 4816012
                                                                                                                                 ->  Parallel Hash  (cost=102685.39..102685.39 rows=2 width=29) (actual time=707.010..707.010 rows=45 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                       ->  Parallel Hash Join  (cost=54433.62..102685.39 rows=2 width=29) (actual time=670.491..706.905 rows=45 loops=3)
                                                                                                                                             Hash Cond: (mk.movie_id = t.id)
                                                                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.014..255.183 rows=1507977 loops=3)
                                                                                                                                             ->  Parallel Hash  (cost=54433.61..54433.61 rows=1 width=21) (actual time=270.864..270.864 rows=1 loops=3)
                                                                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=1 width=21) (actual time=250.553..270.782 rows=1 loops=3)
                                                                                                                                                         Filter: ((production_year >= 2000) AND (production_year <= 2005) AND ((title)::text = 'Shrek 2'::text))
                                                                                                                                                         Rows Removed by Filter: 842770
                                                                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.078..0.078 rows=1 loops=3)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.053..0.064 rows=1 loops=3)
                                                                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=52803.93..52803.93 rows=1 width=20) (actual time=265.855..265.855 rows=0 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..52803.93 rows=1 width=20) (actual time=182.264..265.809 rows=0 loops=3)
                                                                                 Filter: ((name)::text = 'Queen'::text)
                                                                                 Rows Removed by Filter: 1046779
                                                   ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.071..0.071 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.052..0.054 rows=1 loops=3)
                                                               Filter: ((role)::text = 'actress'::text)
                                                               Rows Removed by Filter: 11
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.256..21.256 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.081..21.232 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'computer-animation'::text)
                                                         Rows Removed by Filter: 134169
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.155..70.155 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.013..28.517 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.023..0.025 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 145.000 ms
 Execution Time: 7666.255 ms
(111 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29c.sql_explained.sql
SET
SET
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1104796.41..1104796.42 rows=1 width=96) (actual time=8020.247..8020.247 rows=1 loops=1)
   ->  Hash Join  (cost=849233.65..1104796.40 rows=1 width=48) (actual time=6982.422..8014.691 rows=16308 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Hash Join  (cost=849231.22..1104793.97 rows=1 width=52) (actual time=6982.321..8010.678 rows=16308 loops=1)
               Hash Cond: (ci.role_id = rt.id)
               ->  Hash Join  (cost=849230.06..1104792.80 rows=1 width=56) (actual time=6982.236..8006.752 rows=16308 loops=1)
                     Hash Cond: (cc.status_id = cct2.id)
                     ->  Hash Join  (cost=849229.00..1104791.74 rows=1 width=60) (actual time=6982.009..8001.639 rows=28022 loops=1)
                           Hash Cond: (cc.subject_id = cct1.id)
                           ->  Gather  (cost=849227.94..1104790.67 rows=1 width=64) (actual time=6981.935..7999.897 rows=28022 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=848227.94..1103790.57 rows=1 width=64) (actual time=6915.962..7948.703 rows=9341 loops=3)
                                       Hash Cond: (mi.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=173.611..1669.506 rows=150368 loops=3)
                                             Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                             Rows Removed by Filter: 4794872
                                       ->  Parallel Hash  (cost=848227.92..848227.92 rows=1 width=80) (actual time=6257.461..6257.461 rows=3288 loops=3)
                                             Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1304kB
                                             ->  Parallel Hash Join  (cost=793788.39..848227.92 rows=1 width=80) (actual time=5602.427..5892.842 rows=3288 loops=3)
                                                   Hash Cond: (chn.id = ci.person_role_id)
                                                   ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.049..234.602 rows=1046780 loops=3)
                                                   ->  Parallel Hash  (cost=793788.37..793788.37 rows=1 width=68) (actual time=5520.429..5520.429 rows=3428 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1272kB
                                                         ->  Parallel Hash Join  (cost=777228.20..793788.37 rows=1 width=68) (actual time=5317.725..5402.950 rows=3428 loops=3)
                                                               Hash Cond: (n.id = ci.person_id)
                                                               ->  Parallel Hash Join  (cost=148593.14..165153.19 rows=28 width=27) (actual time=1185.943..1300.772 rows=5368 loops=3)
                                                                     Hash Cond: (an.person_id = n.id)
                                                                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.027..71.091 rows=300448 loops=3)
                                                                     ->  Parallel Hash  (cost=148591.56..148591.56 rows=126 width=23) (actual time=1185.002..1185.002 rows=3355 loops=3)
                                                                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                           ->  Hash Join  (cost=81912.66..148591.56 rows=126 width=23) (actual time=539.490..1000.062 rows=3355 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Hash Join  (cost=81910.23..148550.34 rows=14247 width=27) (actual time=537.989..997.255 rows=15416 loops=3)
                                                                                       Hash Cond: (pi.person_id = n.id)
                                                                                       ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.025..309.919 rows=987888 loops=3)
                                                                                       ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=537.090..537.091 rows=16670 loops=3)
                                                                                             Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                             ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=219.103..523.637 rows=16670 loops=3)
                                                                                                   Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                                   Rows Removed by Filter: 1372493
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.066 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.054 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'trivia'::text)
                                                                                             Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=628635.05..628635.05 rows=1 width=57) (actual time=4100.300..4100.300 rows=3451 loops=3)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1240kB
                                                                     ->  Parallel Hash Join  (cost=148044.74..628635.05 rows=1 width=57) (actual time=1172.432..4015.668 rows=3451 loops=3)
                                                                           Hash Cond: (ci.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.418..2810.575 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Parallel Hash  (cost=148044.70..148044.70 rows=3 width=41) (actual time=1164.305..1164.306 rows=105 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=94621.37..148044.70 rows=3 width=41) (actual time=1066.047..1164.192 rows=105 loops=3)
                                                                                       Hash Cond: (t.id = mc.movie_id)
                                                                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=432897 width=21) (actual time=0.030..282.930 rows=347600 loops=3)
                                                                                             Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                                                             Rows Removed by Filter: 495171
                                                                                       ->  Parallel Hash  (cost=94621.24..94621.24 rows=10 width=20) (actual time=841.775..841.775 rows=144 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=89709.93..94621.24 rows=10 width=20) (actual time=816.805..841.612 rows=144 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.013..21.560 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=89709.68..89709.68 rows=20 width=24) (actual time=816.374..816.375 rows=589 loops=3)
                                                                                                         Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                                                                                         ->  Hash Join  (cost=55308.66..89709.68 rows=20 width=24) (actual time=587.166..815.545 rows=589 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = cc.movie_id)
                                                                                                               ->  Parallel Hash Join  (cost=50878.23..84616.67 rows=74 width=12) (actual time=462.452..728.321 rows=1073 loops=3)
                                                                                                                     Hash Cond: (mc.movie_id = mk.movie_id)
                                                                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.030..156.850 rows=869710 loops=3)
                                                                                                                     ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=458.302..458.302 rows=138 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                                           ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=25.200..458.070 rows=138 loops=3)
                                                                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..253.675 rows=1507977 loops=3)
                                                                                                                                 ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.192..21.192 rows=1 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.080..21.182 rows=1 loops=3)
                                                                                                                                             Filter: ((keyword)::text = 'computer-animation'::text)
                                                                                                                                             Rows Removed by Filter: 134169
                                                                                                               ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.409..69.409 rows=135086 loops=3)
                                                                                                                     Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                                                                                     ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.037..27.851 rows=135086 loops=3)
                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                                       Filter: ((kind)::text = 'cast'::text)
                                       Rows Removed by Filter: 3
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.029..0.029 rows=1 loops=1)
                                 Filter: ((kind)::text = 'complete+verified'::text)
                                 Rows Removed by Filter: 3
               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.031..0.031 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.019..0.022 rows=1 loops=1)
                           Filter: ((role)::text = 'actress'::text)
                           Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.028 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 144.720 ms
 Execution Time: 8028.402 ms
(109 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=139838.09..139838.10 rows=1 width=32) (actual time=1272.640..1272.640 rows=1 loops=1)
   ->  Gather  (cost=139837.88..139838.09 rows=2 width=32) (actual time=1271.986..1278.756 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=138837.88..138837.89 rows=1 width=32) (actual time=1265.532..1265.532 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=88354.74..138837.87 rows=3 width=17) (actual time=909.254..1264.117 rows=2611 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.025..227.987 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=88354.70..88354.70 rows=3 width=8) (actual time=906.054..906.054 rows=2611 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                           ->  Parallel Hash Join  (cost=55672.11..88354.70 rows=3 width=8) (actual time=534.311..833.346 rows=2611 loops=3)
                                 Hash Cond: (mc.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=4793.88..37309.04 rows=44647 width=4) (actual time=23.134..313.921 rows=49377 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.040..157.894 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=4722.92..4722.92 rows=5677 width=4) (actual time=22.929..22.929 rows=3258 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 544kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=5677 width=4) (actual time=0.011..20.938 rows=3258 loops=3)
                                                   Filter: ((country_code)::text = '[de]'::text)
                                                   Rows Removed by Filter: 75074
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=510.123..510.123 rows=13947 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.550..461.391 rows=13947 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..253.253 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.378..21.378 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.828..21.356 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.122 ms
 Execution Time: 1279.188 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2b.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=139653.63..139653.64 rows=1 width=32) (actual time=1226.070..1226.070 rows=1 loops=1)
   ->  Gather  (cost=89170.30..139653.63 rows=2 width=17) (actual time=861.164..1230.488 rows=5228 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=88170.30..138653.43 rows=1 width=17) (actual time=855.805..1217.079 rows=1743 loops=3)
               Hash Cond: (t.id = mc.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.024..233.314 rows=842771 loops=3)
               ->  Parallel Hash  (cost=88170.28..88170.28 rows=1 width=8) (actual time=853.625..853.625 rows=1743 loops=3)
                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                     ->  Parallel Hash Join  (cost=55617.21..88170.28 rows=1 width=8) (actual time=536.632..821.901 rows=1743 loops=3)
                           Hash Cond: (mc.movie_id = mk.movie_id)
                           ->  Parallel Hash Join  (cost=4738.98..37254.14 rows=10108 width=4) (actual time=21.113..302.864 rows=18803 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.039..156.646 rows=869710 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=1285 width=4) (actual time=20.959..20.959 rows=780 loops=3)
                                       Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=1285 width=4) (actual time=0.014..20.348 rows=780 loops=3)
                                             Filter: ((country_code)::text = '[nl]'::text)
                                             Rows Removed by Filter: 77552
                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=514.236..514.236 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.171..459.871 rows=13947 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..252.580 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.017..21.017 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.835..20.996 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
 Planning Time: 4.240 ms
 Execution Time: 1232.616 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2c.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=139600.06..139600.07 rows=1 width=32) (actual time=821.602..821.602 rows=1 loops=1)
   ->  Gather  (cost=89116.82..139600.05 rows=1 width=17) (actual time=821.597..828.128 rows=0 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=88116.82..138599.95 rows=1 width=17) (actual time=814.466..814.467 rows=0 loops=3)
               Hash Cond: (t.id = mc.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (never executed)
               ->  Parallel Hash  (cost=88116.81..88116.81 rows=1 width=8) (actual time=813.806..813.806 rows=0 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 0kB
                     ->  Parallel Hash Join  (cost=55601.29..88116.81 rows=1 width=8) (actual time=813.667..813.668 rows=0 loops=3)
                           Hash Cond: (mc.movie_id = mk.movie_id)
                           ->  Parallel Hash Join  (cost=4723.07..37238.23 rows=92 width=4) (actual time=196.711..298.529 rows=1 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.030..166.592 rows=869710 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=12 width=4) (actual time=22.244..22.244 rows=0 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=12 width=4) (actual time=16.358..22.183 rows=0 loops=3)
                                             Filter: ((country_code)::text = '[sm]'::text)
                                             Rows Removed by Filter: 78332
                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=515.042..515.042 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.556..465.553 rows=13947 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..256.682 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.377..21.377 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.848..21.354 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
 Planning Time: 4.228 ms
 Execution Time: 828.539 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2d.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=141451.03..141451.04 rows=1 width=32) (actual time=1347.671..1347.671 rows=1 loops=1)
   ->  Gather  (cost=141450.82..141451.03 rows=2 width=32) (actual time=1346.294..1353.250 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=140450.82..140450.83 rows=1 width=32) (actual time=1339.841..1339.842 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=17) (actual time=1014.513..1333.168 rows=22772 loops=3)
                     Hash Cond: (mc.company_id = cn.id)
                     ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=21) (actual time=973.243..1277.062 rows=49517 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.024..156.988 rows=869710 loops=3)
                           ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=25) (actual time=972.932..972.932 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                 ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=25) (actual time=527.537..896.258 rows=13947 loops=3)
                                       Hash Cond: (t.id = mk.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.024..229.310 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=527.232..527.233 rows=13947 loops=3)
                                             Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                             ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.062..462.130 rows=13947 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.016..255.332 rows=1507977 loops=3)
                                                   ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.936..19.936 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.809..19.915 rows=1 loops=3)
                                                               Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                               Rows Removed by Filter: 134169
                     ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.718..39.718 rows=28281 loops=3)
                           Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.034..25.965 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
 Planning Time: 4.163 ms
 Execution Time: 1353.708 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30a.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=944426.03..944426.04 rows=1 width=128) (actual time=6178.150..6178.150 rows=1 loops=1)
   ->  Hash Join  (cost=927922.43..944426.02 rows=1 width=80) (actual time=6062.657..6177.646 rows=757 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=927921.36..944424.94 rows=1 width=84) (actual time=6062.553..6177.326 rows=757 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=927920.30..944423.88 rows=1 width=88) (actual time=6062.471..6176.851 rows=2492 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=923489.86..939331.43 rows=1 width=100) (actual time=5948.317..6082.922 rows=6214 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=923487.44..939329.00 rows=1 width=104) (actual time=5948.194..6080.634 rows=18687 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=922487.44..938328.90 rows=1 width=104) (actual time=5942.277..6071.098 rows=6229 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.033..76.941 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=922487.42..922487.42 rows=1 width=91) (actual time=5928.698..5928.698 rows=2263 loops=3)
                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                             ->  Parallel Hash Join  (cost=842460.08..922487.42 rows=1 width=91) (actual time=5381.576..5897.226 rows=2263 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.046..447.173 rows=579860 loops=3)
                                                         Filter: ((gender)::text = 'm'::text)
                                                         Rows Removed by Filter: 809304
                                                   ->  Parallel Hash  (cost=842460.07..842460.07 rows=1 width=80) (actual time=5381.018..5381.018 rows=3573 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1176kB
                                                         ->  Parallel Hash Join  (cost=342439.39..842460.07 rows=1 width=80) (actual time=4200.700..5323.209 rows=3573 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=163.830..2883.200 rows=414905 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                     Rows Removed by Filter: 11666543
                                                               ->  Parallel Hash  (cost=342439.38..342439.38 rows=1 width=72) (actual time=2382.263..2382.263 rows=5468 loops=3)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1496kB
                                                                     ->  Parallel Hash Join  (cost=291113.75..342439.38 rows=1 width=72) (actual time=2034.752..2366.040 rows=5468 loops=3)
                                                                           Hash Cond: (t.id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.014..273.749 rows=460484 loops=3)
                                                                                 Filter: (production_year > 2000)
                                                                                 Rows Removed by Filter: 382286
                                                                           ->  Parallel Hash  (cost=291113.73..291113.73 rows=1 width=51) (actual time=2031.294..2031.294 rows=11309 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                                 ->  Hash Join  (cost=51720.34..291113.73 rows=1 width=51) (actual time=1840.657..1994.025 rows=11309 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..291111.24 rows=25 width=55) (actual time=1456.850..1990.552 rows=11907 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=890.709..1413.308 rows=24349 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                                   Rows Removed by Filter: 4920891
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=566.060..566.060 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.296..485.026 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..251.482 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.098..40.098 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.117..40.084 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.075..0.075 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.055 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.029..0.032 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.991..70.991 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.023..28.864 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.021..0.021 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.041..0.041 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.025..0.027 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                     Rows Removed by Filter: 2
 Planning Time: 91.541 ms
 Execution Time: 6181.211 ms
(80 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30b.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=950168.28..950168.29 rows=1 width=128) (actual time=6481.237..6481.237 rows=1 loops=1)
   ->  Hash Join  (cost=933664.68..950168.27 rows=1 width=80) (actual time=6411.810..6481.200 rows=28 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=933663.61..950167.19 rows=1 width=84) (actual time=6411.711..6481.092 rows=28 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=933662.55..950166.13 rows=1 width=88) (actual time=6411.632..6480.996 rows=108 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=929232.11..945073.68 rows=1 width=100) (actual time=6338.963..6396.475 rows=108 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=929229.69..945071.25 rows=1 width=104) (actual time=6338.841..6398.245 rows=324 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=928229.69..944071.15 rows=1 width=104) (actual time=6353.337..6388.317 rows=108 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.298..78.506 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=928229.67..928229.67 rows=1 width=91) (actual time=6252.953..6252.953 rows=36 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=871161.79..928229.67 rows=1 width=91) (actual time=6199.038..6252.679 rows=36 loops=3)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=161 width=21) (actual time=2.114..370.522 rows=178 loops=3)
                                                         Filter: ((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))
                                                         Rows Removed by Filter: 842593
                                                   ->  Parallel Hash  (cost=871161.78..871161.78 rows=1 width=70) (actual time=5881.796..5881.796 rows=4543 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1272kB
                                                         ->  Parallel Hash Join  (cost=791134.44..871161.78 rows=1 width=70) (actual time=5297.901..5827.071 rows=4543 loops=3)
                                                               Hash Cond: (n.id = ci.person_id)
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.058..458.567 rows=579860 loops=3)
                                                                     Filter: ((gender)::text = 'm'::text)
                                                                     Rows Removed by Filter: 809304
                                                               ->  Parallel Hash  (cost=791134.42..791134.42 rows=1 width=59) (actual time=5297.131..5297.131 rows=7458 loops=3)
                                                                     Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1880kB
                                                                     ->  Parallel Hash Join  (cost=291113.75..791134.42 rows=1 width=59) (actual time=4070.187..5244.000 rows=7458 loops=3)
                                                                           Hash Cond: (ci.movie_id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=231.197..3030.122 rows=414905 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                                 Rows Removed by Filter: 11666543
                                                                           ->  Parallel Hash  (cost=291113.73..291113.73 rows=1 width=51) (actual time=2157.576..2157.576 rows=11309 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2840kB
                                                                                 ->  Hash Join  (cost=51720.34..291113.73 rows=1 width=51) (actual time=1925.306..2085.097 rows=11309 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..291111.24 rows=25 width=55) (actual time=1516.455..2081.585 rows=11907 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=944.810..1497.867 rows=24349 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                                   Rows Removed by Filter: 4920891
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=571.558..571.558 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.467..486.818 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..255.937 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.330..40.330 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.115..40.316 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.073..0.073 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.054 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.044 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.031..0.034 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.975..69.975 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.014..28.522 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.038..0.038 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.025..0.027 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                     Rows Removed by Filter: 2
 Planning Time: 91.594 ms
 Execution Time: 6484.118 ms
(80 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=974687.78..974687.79 rows=1 width=128) (actual time=6760.554..6760.554 rows=1 loops=1)
   ->  Hash Join  (cost=958184.19..974687.77 rows=1 width=80) (actual time=6550.107..6755.992 rows=8024 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=958183.12..974686.71 rows=1 width=84) (actual time=6549.986..6753.220 rows=14123 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=958182.06..974685.64 rows=1 width=88) (actual time=6549.899..6748.944 rows=18841 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=953751.63..969593.19 rows=1 width=100) (actual time=6477.491..6637.751 rows=26153 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=953749.20..969590.76 rows=1 width=104) (actual time=6477.362..6624.670 rows=78897 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=952749.20..968590.66 rows=1 width=104) (actual time=6464.892..6609.269 rows=26299 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.034..75.724 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=952749.19..952749.19 rows=1 width=91) (actual time=6460.048..6460.048 rows=9085 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3064kB
                                             ->  Parallel Hash Join  (cost=872721.85..952749.19 rows=1 width=91) (actual time=5916.795..6435.447 rows=9085 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.049..444.106 rows=579860 loops=3)
                                                         Filter: ((gender)::text = 'm'::text)
                                                         Rows Removed by Filter: 809304
                                                   ->  Parallel Hash  (cost=872721.83..872721.83 rows=1 width=80) (actual time=5916.215..5916.215 rows=15008 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4632kB
                                                         ->  Parallel Hash Join  (cost=372701.16..872721.83 rows=1 width=80) (actual time=4744.038..5886.249 rows=15008 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=204.900..2908.665 rows=414905 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                     Rows Removed by Filter: 11666543
                                                               ->  Parallel Hash  (cost=372701.14..372701.14 rows=1 width=72) (actual time=2912.040..2912.040 rows=22680 loops=3)
                                                                     Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6968kB
                                                                     ->  Parallel Hash Join  (cost=322218.01..372701.14 rows=1 width=72) (actual time=2468.609..2829.796 rows=22680 loops=3)
                                                                           Hash Cond: (t.id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.012..227.565 rows=842771 loops=3)
                                                                           ->  Parallel Hash  (cost=322218.00..322218.00 rows=1 width=51) (actual time=2467.145..2467.145 rows=22680 loops=3)
                                                                                 Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                                                 ->  Hash Join  (cost=51720.34..322218.00 rows=1 width=51) (actual time=2202.873..2426.447 rows=22680 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..322215.41 rows=60 width=55) (actual time=1706.286..2420.293 rows=24129 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1038.805..1840.048 rows=62990 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                                   Rows Removed by Filter: 4882250
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=559.309..559.309 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.542..481.907 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..250.823 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.384..40.384 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.108..40.369 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.071..0.071 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.053 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.041 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.948..69.948 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.013..28.505 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.024..0.025 rows=1 loops=1)
                     Filter: ((kind)::text = 'complete+verified'::text)
                     Rows Removed by Filter: 3
 Planning Time: 92.057 ms
 Execution Time: 6766.629 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=975119.34..975119.35 rows=1 width=128) (actual time=6330.698..6330.698 rows=1 loops=1)
   ->  Gather  (cost=975119.11..975119.32 rows=2 width=128) (actual time=6329.613..6336.767 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=974119.11..974119.12 rows=1 width=128) (actual time=6322.022..6322.022 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=923635.97..974119.10 rows=1 width=80) (actual time=6211.741..6321.728 rows=424 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.015..223.967 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=923635.96..923635.96 rows=1 width=83) (actual time=5983.197..5983.197 rows=424 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 168kB
                           ->  Parallel Hash Join  (cost=843608.62..923635.96 rows=1 width=83) (actual time=5479.845..5982.853 rows=424 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.046..444.174 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=843608.60..843608.60 rows=1 width=72) (actual time=5472.123..5472.123 rows=519 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                       ->  Parallel Hash Join  (cost=343587.93..843608.60 rows=1 width=72) (actual time=4352.269..5471.749 rows=519 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=167.463..2912.732 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=343587.91..343587.91 rows=1 width=64) (actual time=2512.341..2512.341 rows=508 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                   ->  Parallel Hash Join  (cost=311072.34..343587.91 rows=1 width=64) (actual time=2285.700..2504.307 rows=508 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Hash Join  (cost=4723.09..37238.26 rows=106 width=4) (actual time=21.155..282.215 rows=605 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.036..156.395 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=16.486..16.486 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=0.453..15.756 rows=3 loops=3)
                                                                           Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                           Rows Removed by Filter: 78329
                                                         ->  Parallel Hash  (cost=306349.24..306349.24 rows=1 width=60) (actual time=2221.398..2221.398 rows=10505 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                               ->  Parallel Hash Join  (cost=291078.97..306349.24 rows=1 width=60) (actual time=2014.180..2199.585 rows=10505 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.134..161.394 rows=153308 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.032..77.242 rows=460012 loops=3)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.029 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'votes'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=291076.53..291076.53 rows=1 width=51) (actual time=2013.751..2013.751 rows=11309 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2264kB
                                                                           ->  Parallel Hash Join  (cost=51720.34..291076.53 rows=1 width=51) (actual time=1822.892..1979.272 rows=11309 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..239357.37 rows=330 width=47) (actual time=1259.130..1406.101 rows=24086 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=880.094..1397.811 rows=24349 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                             Rows Removed by Filter: 4920891
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.085..0.085 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.048..0.061 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=563.687..563.687 rows=25571 loops=3)
                                                                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                       ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.553..485.604 rows=25571 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..251.389 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.382..40.382 rows=7 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.102..40.358 rows=7 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                         Rows Removed by Filter: 134163
 Planning Time: 117.958 ms
 Execution Time: 6337.978 ms
(72 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31b.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=980989.91..980989.92 rows=1 width=128) (actual time=6149.516..6149.517 rows=1 loops=1)
   ->  Gather  (cost=980989.68..980989.89 rows=2 width=128) (actual time=6149.270..6155.850 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=979989.68..979989.69 rows=1 width=128) (actual time=6141.563..6141.563 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=899962.33..979989.67 rows=1 width=80) (actual time=5695.883..6141.513 rows=28 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.044..445.459 rows=579860 loops=3)
                           Filter: ((gender)::text = 'm'::text)
                           Rows Removed by Filter: 809304
                     ->  Parallel Hash  (cost=899962.31..899962.31 rows=1 width=69) (actual time=5637.536..5637.536 rows=28 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=400520.12..899962.31 rows=1 width=69) (actual time=4626.993..5637.412 rows=28 loops=3)
                                 Hash Cond: (t.id = mi.movie_id)
                                 ->  Parallel Hash Join  (cost=57069.28..556511.17 rows=79 width=29) (actual time=2180.515..3290.425 rows=212 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=163.459..2874.630 rows=414905 loops=3)
                                             Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                             Rows Removed by Filter: 11666543
                                       ->  Parallel Hash  (cost=57067.27..57067.27 rows=161 width=21) (actual time=368.246..368.247 rows=178 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=161 width=21) (actual time=5.221..367.922 rows=178 loops=3)
                                                   Filter: ((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))
                                                   Rows Removed by Filter: 842593
                                 ->  Parallel Hash  (cost=343450.83..343450.83 rows=1 width=64) (actual time=2346.846..2346.847 rows=87 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=104094.63..343450.83 rows=1 width=64) (actual time=2218.785..2346.751 rows=87 loops=3)
                                             Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                             ->  Hash Join  (cost=2.43..239357.37 rows=330 width=47) (actual time=1275.567..1424.318 rows=24086 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=890.915..1416.228 rows=24349 loops=3)
                                                         Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                         Rows Removed by Filter: 4920891
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.030 rows=1 loops=3)
                                                               Filter: ((info)::text = 'genres'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=104092.19..104092.19 rows=1 width=17) (actual time=919.010..919.010 rows=105 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=88821.93..104092.19 rows=1 width=17) (actual time=806.422..918.870 rows=105 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.171..160.513 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.036..77.779 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.071..0.071 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.047..0.050 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=88819.49..88819.49 rows=1 width=8) (actual time=742.511..742.511 rows=105 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=40567.20..88819.49 rows=1 width=8) (actual time=379.346..742.365 rows=105 loops=3)
                                                                     Hash Cond: (mk.movie_id = mc.movie_id)
                                                                     ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=38.945..480.296 rows=25571 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..249.829 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=38.801..38.801 rows=7 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.058..38.786 rows=7 loops=3)
                                                                                       Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                       Rows Removed by Filter: 134163
                                                                     ->  Parallel Hash  (cost=37102.41..37102.41 rows=1 width=4) (actual time=257.694..257.694 rows=45 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=4723.09..37102.41 rows=1 width=4) (actual time=55.144..257.562 rows=45 loops=3)
                                                                                 Hash Cond: (mc.company_id = cn.id)
                                                                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=39 width=8) (actual time=1.518..234.232 rows=2654 loops=3)
                                                                                       Filter: ((note)::text ~~ '%(Blu-ray)%'::text)
                                                                                       Rows Removed by Filter: 867055
                                                                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=22.467..22.467 rows=3 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=7.347..22.418 rows=3 loops=3)
                                                                                             Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                                             Rows Removed by Filter: 78329
 Planning Time: 122.336 ms
 Execution Time: 6157.042 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31c.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=1005633.28..1005633.29 rows=1 width=128) (actual time=7650.764..7650.764 rows=1 loops=1)
   ->  Gather  (cost=1005633.05..1005633.26 rows=2 width=128) (actual time=7649.190..7657.067 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=1004633.05..1004633.06 rows=1 width=128) (actual time=7641.524..7641.524 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=954149.91..1004633.04 rows=1 width=80) (actual time=7498.229..7640.989 rows=942 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.027..229.176 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=954149.90..954149.90 rows=1 width=83) (actual time=7301.690..7301.690 rows=942 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 344kB
                           ->  Parallel Hash Join  (cost=874660.64..954149.90 rows=1 width=83) (actual time=6667.250..7214.635 rows=942 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.047..371.985 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=874660.62..874660.62 rows=1 width=72) (actual time=6661.938..6661.938 rows=942 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                       ->  Parallel Hash Join  (cost=374639.95..874660.62 rows=1 width=72) (actual time=5090.330..6195.753 rows=942 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=211.944..2880.877 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=374639.93..374639.93 rows=1 width=64) (actual time=3267.517..3267.517 rows=947 loops=3)
                                                   Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                   ->  Parallel Hash Join  (cost=342124.37..374639.93 rows=1 width=64) (actual time=2779.328..3003.063 rows=947 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Hash Join  (cost=4723.09..37238.26 rows=106 width=4) (actual time=20.398..278.484 rows=605 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.040..153.006 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=15.833..15.834 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=1.122..15.781 rows=3 loops=3)
                                                                           Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                           Rows Removed by Filter: 78329
                                                         ->  Parallel Hash  (cost=337401.26..337401.26 rows=1 width=60) (actual time=2723.614..2723.614 rows=21129 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4824kB
                                                               ->  Parallel Hash Join  (cost=322130.99..337401.26 rows=1 width=60) (actual time=2483.458..2672.052 rows=21129 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.140..160.573 rows=153308 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.034..76.333 rows=460012 loops=3)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.041..0.041 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.029 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'votes'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=322128.55..322128.55 rows=1 width=51) (actual time=2483.098..2483.098 rows=22680 loops=3)
                                                                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                                           ->  Parallel Hash Join  (cost=51720.34..322128.55 rows=1 width=51) (actual time=2209.436..2442.620 rows=22680 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1645.060..1859.967 rows=62198 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1039.308..1842.519 rows=62990 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                             Rows Removed by Filter: 4882250
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.080..0.080 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.056 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=564.288..564.288 rows=25571 loops=3)
                                                                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                       ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.707..482.446 rows=25571 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.055..251.887 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.509..40.509 rows=7 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.118..40.485 rows=7 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                         Rows Removed by Filter: 134163
 Planning Time: 116.195 ms
 Execution Time: 7658.031 ms
(70 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/32a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=75986.58..75986.59 rows=1 width=96) (actual time=402.701..402.701 rows=1 loops=1)
   ->  Gather  (cost=75986.36..75986.57 rows=2 width=96) (actual time=402.393..408.311 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=74986.36..74986.37 rows=1 width=96) (actual time=395.210..395.211 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=24503.19..74986.33 rows=4 width=116) (actual time=395.204..395.205 rows=0 loops=3)
                     Hash Cond: (t2.id = ml.linked_movie_id)
                     ->  Parallel Seq Scan on title t2  (cost=0.00..46532.63 rows=1053463 width=21) (never executed)
                     ->  Parallel Hash  (cost=24503.14..24503.14 rows=4 width=103) (actual time=394.633..394.633 rows=0 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 0kB
                           ->  Hash Join  (cost=2676.61..24503.14 rows=4 width=103) (actual time=391.200..391.200 rows=0 loops=3)
                                 Hash Cond: (ml.link_type_id = lt.id)
                                 ->  Hash Join  (cost=2675.20..24501.72 rows=4 width=25) (actual time=391.077..391.078 rows=0 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=49.07..20347.47 rows=582120 width=29) (actual time=13.129..360.813 rows=96064 loops=3)
                                             Merge Cond: (t1.id = ml.movie_id)
                                             ->  Merge Join  (cost=47.47..247535.04 rows=1884971 width=29) (actual time=12.810..305.728 rows=32619 loops=3)
                                                   Merge Cond: (mk.movie_id = t1.id)
                                                   ->  Parallel Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..115667.54 rows=1884971 width=8) (actual time=0.064..11.703 rows=32619 loops=3)
                                                   ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=21) (actual time=0.058..264.181 rows=187035 loops=3)
                                             ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=12) (actual time=0.044..29.026 rows=120323 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.337..21.337 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=20.762..21.317 rows=1 loops=3)
                                                   Filter: ((keyword)::text = '10,000-mile-club'::text)
                                                   Rows Removed by Filter: 134169
                                 ->  Hash  (cost=1.18..1.18 rows=18 width=86) (actual time=0.075..0.075 rows=18 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=86) (actual time=0.045..0.049 rows=18 loops=3)
 Planning Time: 5.362 ms
 Execution Time: 408.944 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/32b.sql_explained.sql
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=75986.58..75986.59 rows=1 width=96) (actual time=805.225..805.225 rows=1 loops=1)
   ->  Gather  (cost=75986.36..75986.57 rows=2 width=96) (actual time=804.897..812.067 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=74986.36..74986.37 rows=1 width=96) (actual time=797.952..797.952 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=24503.19..74986.33 rows=4 width=116) (actual time=430.411..796.366 rows=1463 loops=3)
                     Hash Cond: (t2.id = ml.linked_movie_id)
                     ->  Parallel Seq Scan on title t2  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.014..234.626 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=24503.14..24503.14 rows=4 width=103) (actual time=429.420..429.421 rows=1463 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 408kB
                           ->  Hash Join  (cost=2676.61..24503.14 rows=4 width=103) (actual time=56.729..351.316 rows=1463 loops=3)
                                 Hash Cond: (ml.link_type_id = lt.id)
                                 ->  Hash Join  (cost=2675.20..24501.72 rows=4 width=25) (actual time=56.614..350.746 rows=1463 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=49.07..20347.47 rows=582120 width=29) (actual time=3.209..320.278 rows=96064 loops=3)
                                             Merge Cond: (t1.id = ml.movie_id)
                                             ->  Merge Join  (cost=47.47..247535.04 rows=1884971 width=29) (actual time=3.034..269.189 rows=32619 loops=3)
                                                   Merge Cond: (mk.movie_id = t1.id)
                                                   ->  Parallel Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..115667.54 rows=1884971 width=8) (actual time=0.025..7.772 rows=32619 loops=3)
                                                   ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=21) (actual time=0.057..232.376 rows=187035 loops=3)
                                             ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=12) (actual time=0.040..25.368 rows=120370 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.325..21.325 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.820..21.312 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
                                 ->  Hash  (cost=1.18..1.18 rows=18 width=86) (actual time=0.063..0.063 rows=18 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=86) (actual time=0.035..0.038 rows=18 loops=3)
 Planning Time: 4.955 ms
 Execution Time: 812.695 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33a.sql_explained.sql
SET
SET
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=154593.22..154593.23 rows=1 width=192) (actual time=1429.636..1429.636 rows=1 loops=1)
   ->  Hash Join  (cost=144214.38..154593.20 rows=1 width=82) (actual time=1429.602..1429.614 rows=8 loops=1)
         Hash Cond: (t2.kind_id = kt2.id)
         ->  Hash Join  (cost=144213.28..154592.10 rows=1 width=86) (actual time=1429.494..1429.504 rows=8 loops=1)
               Hash Cond: (mi_idx1.info_type_id = it1.id)
               ->  Hash Join  (cost=144210.85..154589.67 rows=2 width=90) (actual time=1429.385..1429.411 rows=24 loops=1)
                     Hash Cond: (t1.kind_id = kt1.id)
                     ->  Merge Join  (cost=144209.75..154588.52 rows=12 width=94) (actual time=1429.305..1429.324 rows=24 loops=1)
                           Merge Cond: (ml.movie_id = t1.id)
                           ->  Merge Join  (cost=144209.32..146403.23 rows=12 width=85) (actual time=1407.729..1407.742 rows=24 loops=1)
                                 Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                 ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.041..2.546 rows=8479 loops=1)
                                 ->  Sort  (cost=144208.90..144208.91 rows=4 width=72) (actual time=1404.232..1404.235 rows=22 loops=1)
                                       Sort Key: ml.movie_id
                                       Sort Method: quicksort  Memory: 26kB
                                       ->  Hash Join  (cost=137529.19..144208.86 rows=4 width=72) (actual time=1365.902..1404.129 rows=8 loops=1)
                                             Hash Cond: (cn1.id = mc1.company_id)
                                             ->  Seq Scan on company_name cn1  (cost=0.00..5932.46 rows=85390 width=23) (actual time=0.037..46.501 rows=84843 loops=1)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 150154
                                             ->  Hash  (cost=137529.07..137529.07 rows=10 width=57) (actual time=1350.155..1350.155 rows=29 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                   ->  Merge Join  (cost=132176.15..137529.07 rows=10 width=57) (actual time=1325.495..1350.133 rows=29 loops=1)
                                                         Merge Cond: (mc1.movie_id = ml.movie_id)
                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..131550.35 rows=2609129 width=8) (actual time=0.024..24.472 rows=61895 loops=1)
                                                         ->  Sort  (cost=132175.72..132175.73 rows=2 width=49) (actual time=1318.341..1318.344 rows=29 loops=1)
                                                               Sort Key: ml.movie_id
                                                               Sort Method: quicksort  Memory: 26kB
                                                               ->  Gather  (cost=127279.79..132175.71 rows=2 width=49) (actual time=1282.102..1318.690 rows=11 loops=1)
                                                                     Workers Planned: 1
                                                                     Workers Launched: 1
                                                                     ->  Parallel Hash Join  (cost=126279.79..131175.51 rows=1 width=49) (actual time=1278.088..1310.429 rows=6 loops=2)
                                                                           Hash Cond: (cn2.id = mc2.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.019..20.272 rows=117498 loops=2)
                                                                           ->  Parallel Hash  (cost=126279.78..126279.78 rows=1 width=34) (actual time=1275.943..1275.943 rows=6 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                 ->  Parallel Hash Join  (cost=92541.63..126279.78 rows=1 width=34) (actual time=883.922..1275.893 rows=6 loops=2)
                                                                                       Hash Cond: (mc2.movie_id = t2.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.021..233.642 rows=1304564 loops=2)
                                                                                       ->  Parallel Hash  (cost=92541.62..92541.62 rows=1 width=42) (actual time=882.181..882.181 rows=3 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Hash Join  (cost=76393.09..92541.62 rows=1 width=42) (actual time=665.432..882.107 rows=3 loops=2)
                                                                                                   Hash Cond: (mi_idx2.info_type_id = it2.id)
                                                                                                   ->  Parallel Hash Join  (cost=76390.66..92538.93 rows=96 width=46) (actual time=630.133..881.963 rows=153 loops=2)
                                                                                                         Hash Cond: (mi_idx2.movie_id = t2.id)
                                                                                                         ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=273383 width=13) (actual time=0.048..216.743 rows=327480 loops=2)
                                                                                                               Filter: ((info)::text < '3.0'::text)
                                                                                                               Rows Removed by Filter: 362537
                                                                                                         ->  Parallel Hash  (cost=76386.05..76386.05 rows=369 width=33) (actual time=629.854..629.854 rows=122 loops=2)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                               ->  Hash Join  (cost=75275.92..76386.05 rows=369 width=33) (actual time=565.340..629.632 rows=122 loops=2)
                                                                                                                     Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                     ->  Merge Join  (cost=75274.64..76377.59 rows=2212 width=37) (actual time=565.132..629.268 rows=2166 loops=2)
                                                                                                                           Merge Cond: (t2.id = ml.linked_movie_id)
                                                                                                                           ->  Sort  (cost=72580.89..73046.92 rows=186410 width=25) (actual time=544.218..578.518 rows=222854 loops=2)
                                                                                                                                 Sort Key: t2.id
                                                                                                                                 Sort Method: external merge  Disk: 8040kB
                                                                                                                                 Worker 0:  Sort Method: external merge  Disk: 7944kB
                                                                                                                                 ->  Parallel Seq Scan on title t2  (cost=0.00..51799.95 rows=186410 width=25) (actual time=0.025..392.801 rows=222930 loops=2)
                                                                                                                                       Filter: ((production_year >= 2005) AND (production_year <= 2008))
                                                                                                                                       Rows Removed by Filter: 1041226
                                                                                                                           ->  Sort  (cost=2693.63..2768.62 rows=29997 width=12) (actual time=20.893..23.175 rows=29997 loops=2)
                                                                                                                                 Sort Key: ml.linked_movie_id
                                                                                                                                 Sort Method: quicksort  Memory: 2175kB
                                                                                                                                 Worker 0:  Sort Method: quicksort  Memory: 2175kB
                                                                                                                                 ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.040..6.375 rows=29997 loops=2)
                                                                                                                     ->  Hash  (cost=1.25..1.25 rows=3 width=4) (actual time=0.058..0.058 rows=2 loops=2)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on link_type lt  (cost=0.00..1.25 rows=3 width=4) (actual time=0.043..0.048 rows=2 loops=2)
                                                                                                                                 Filter: ((link)::text = ANY ('{sequel,follows,"followed by"}'::text[]))
                                                                                                                                 Rows Removed by Filter: 16
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=2)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.047 rows=1 loops=2)
                                                                                                               Filter: ((info)::text = 'rating'::text)
                                                                                                               Rows Removed by Filter: 112
                           ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=25) (actual time=0.014..19.133 rows=22690 loops=1)
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                                 Filter: ((kind)::text = 'tv series'::text)
                                 Rows Removed by Filter: 6
               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=1)
                           Filter: ((info)::text = 'rating'::text)
                           Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=1 width=4) (actual time=0.031..0.033 rows=1 loops=1)
                     Filter: ((kind)::text = 'tv series'::text)
                     Rows Removed by Filter: 6
 Planning Time: 111.983 ms
 Execution Time: 1475.236 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33b.sql_explained.sql
SET
SET
                                                                                                                                    QUERY PLAN                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=126526.42..126526.43 rows=1 width=192) (actual time=1276.055..1276.055 rows=1 loops=1)
   ->  Hash Join  (cost=121630.57..126526.40 rows=1 width=82) (actual time=1246.792..1276.036 rows=4 loops=1)
         Hash Cond: (mi_idx2.info_type_id = it2.id)
         ->  Hash Join  (cost=121628.15..126523.97 rows=1 width=86) (actual time=1246.686..1275.929 rows=8 loops=1)
               Hash Cond: (t2.kind_id = kt2.id)
               ->  Gather  (cost=121627.05..126522.87 rows=1 width=90) (actual time=1246.602..1280.894 rows=42 loops=1)
                     Workers Planned: 1
                     Workers Launched: 1
                     ->  Parallel Hash Join  (cost=120627.05..125522.77 rows=1 width=90) (actual time=1240.258..1269.409 rows=21 loops=2)
                           Hash Cond: (cn2.id = mc2.company_id)
                           ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.007..16.341 rows=117498 loops=2)
                           ->  Parallel Hash  (cost=120627.03..120627.03 rows=1 width=75) (actual time=1239.179..1239.179 rows=21 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=86888.89..120627.03 rows=1 width=75) (actual time=885.303..1239.095 rows=21 loops=2)
                                       Hash Cond: (mc2.movie_id = t2.id)
                                       ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.006..233.573 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=86888.88..86888.88 rows=1 width=83) (actual time=846.820..846.820 rows=6 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Hash Join  (cost=70741.00..86888.88 rows=1 width=83) (actual time=654.647..846.760 rows=6 loops=2)
                                                   Hash Cond: (mi_idx1.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=70738.57..86886.45 rows=1 width=87) (actual time=654.524..846.634 rows=18 loops=2)
                                                         Hash Cond: (mi_idx2.movie_id = t2.id)
                                                         ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=273383 width=13) (actual time=0.018..212.989 rows=327480 loops=2)
                                                               Filter: ((info)::text < '3.0'::text)
                                                               Rows Removed by Filter: 362537
                                                         ->  Parallel Hash  (cost=70738.56..70738.56 rows=1 width=74) (actual time=599.818..599.818 rows=9 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=21387.24..70738.56 rows=1 width=74) (actual time=365.290..599.742 rows=9 loops=2)
                                                                     Hash Cond: (t2.id = ml.linked_movie_id)
                                                                     ->  Parallel Seq Scan on title t2  (cost=0.00..49166.29 rows=49337 width=25) (actual time=0.051..348.217 rows=59782 loops=2)
                                                                           Filter: (production_year = 2007)
                                                                           Rows Removed by Filter: 1204374
                                                                     ->  Parallel Hash  (cost=21387.06..21387.06 rows=15 width=49) (actual time=237.513..237.513 rows=590 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                           ->  Hash Join  (cost=14591.57..21387.06 rows=15 width=49) (actual time=143.002..237.002 rows=590 loops=2)
                                                                                 Hash Cond: (t1.kind_id = kt1.id)
                                                                                 ->  Merge Join  (cost=14590.47..21385.52 rows=102 width=53) (actual time=142.923..236.740 rows=716 loops=2)
                                                                                       Merge Cond: (t1.id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using title_pkey on title t1  (cost=0.43..87333.68 rows=1053463 width=25) (actual time=0.028..84.834 rows=81444 loops=2)
                                                                                       ->  Sort  (cost=14590.04..14590.65 rows=246 width=44) (actual time=141.980..142.079 rows=1431 loops=2)
                                                                                             Sort Key: ml.movie_id
                                                                                             Sort Method: quicksort  Memory: 213kB
                                                                                             Worker 0:  Sort Method: quicksort  Memory: 213kB
                                                                                             ->  Hash Join  (cost=6611.72..14580.27 rows=246 width=44) (actual time=62.843..140.898 rows=1431 loops=2)
                                                                                                   Hash Cond: (mc1.company_id = cn1.id)
                                                                                                   ->  Merge Join  (cost=651.94..8551.02 rows=26465 width=29) (actual time=10.076..84.645 rows=29022 loops=2)
                                                                                                         Merge Cond: (ml.movie_id = mc1.movie_id)
                                                                                                         ->  Merge Join  (cost=651.06..2920.55 rows=5051 width=21) (actual time=9.953..35.337 rows=6192 loops=2)
                                                                                                               Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                                                                                               ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.043..16.126 rows=63901 loops=2)
                                                                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=8) (actual time=9.879..10.402 rows=6443 loops=2)
                                                                                                                     Sort Key: ml.movie_id
                                                                                                                     Sort Method: quicksort  Memory: 205kB
                                                                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=8) (actual time=0.130..8.774 rows=2315 loops=2)
                                                                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.029..4.561 rows=29997 loops=2)
                                                                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.037..0.038 rows=2 loops=2)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.022..0.027 rows=2 loops=2)
                                                                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                                                       Rows Removed by Filter: 16
                                                                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..131550.35 rows=2609129 width=8) (actual time=0.029..32.903 rows=111067 loops=2)
                                                                                                   ->  Hash  (cost=5932.46..5932.46 rows=2185 width=23) (actual time=52.742..52.743 rows=2340 loops=2)
                                                                                                         Buckets: 4096  Batches: 1  Memory Usage: 160kB
                                                                                                         ->  Seq Scan on company_name cn1  (cost=0.00..5932.46 rows=2185 width=23) (actual time=0.051..51.178 rows=2340 loops=2)
                                                                                                               Filter: ((country_code)::text = '[nl]'::text)
                                                                                                               Rows Removed by Filter: 232657
                                                                                 ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.028..0.028 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=1 width=4) (actual time=0.016..0.018 rows=1 loops=2)
                                                                                             Filter: ((kind)::text = 'tv series'::text)
                                                                                             Rows Removed by Filter: 6
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.047 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.028..0.028 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=1 width=4) (actual time=0.017..0.019 rows=1 loops=1)
                           Filter: ((kind)::text = 'tv series'::text)
                           Rows Removed by Filter: 6
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 112.715 ms
 Execution Time: 1282.272 ms
(90 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33c.sql_explained.sql
SET
SET
                                                                                                                                       QUERY PLAN                                                                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=141754.28..141754.29 rows=1 width=192) (actual time=1594.873..1594.874 rows=1 loops=1)
   ->  Hash Join  (cost=133569.54..141754.26 rows=1 width=82) (actual time=1476.828..1594.741 rows=114 loops=1)
         Hash Cond: (t1.kind_id = kt1.id)
         ->  Merge Join  (cost=133568.42..141753.15 rows=1 width=86) (actual time=1476.728..1594.600 rows=114 loops=1)
               Merge Cond: (t1.id = ml.movie_id)
               ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=25) (actual time=0.024..122.079 rows=152917 loops=1)
               ->  Sort  (cost=133567.99..133568.00 rows=1 width=77) (actual time=1454.651..1454.661 rows=114 loops=1)
                     Sort Key: mc1.movie_id
                     Sort Method: quicksort  Memory: 42kB
                     ->  Hash Join  (cost=131373.01..133567.98 rows=1 width=77) (actual time=1442.295..1454.512 rows=114 loops=1)
                           Hash Cond: (mi_idx1.info_type_id = it1.id)
                           ->  Merge Join  (cost=131370.59..133565.36 rows=70 width=81) (actual time=1442.208..1454.374 rows=342 loops=1)
                                 Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                 ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.029..9.072 rows=50698 loops=1)
                                 ->  Sort  (cost=131370.16..131370.22 rows=23 width=68) (actual time=1439.730..1439.757 rows=347 loops=1)
                                       Sort Key: mc1.movie_id
                                       Sort Method: quicksort  Memory: 42kB
                                       ->  Gather  (cost=124052.14..131369.64 rows=23 width=68) (actual time=1412.031..1456.743 rows=121 loops=1)
                                             Workers Planned: 1
                                             Workers Launched: 1
                                             ->  Hash Join  (cost=123052.14..130367.34 rows=14 width=68) (actual time=1404.812..1432.577 rows=60 loops=2)
                                                   Hash Cond: (t2.kind_id = kt2.id)
                                                   ->  Parallel Hash Join  (cost=123051.03..130366.03 rows=47 width=72) (actual time=1403.109..1432.372 rows=70 loops=2)
                                                         Hash Cond: (cn2.id = mc2.company_id)
                                                         ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.012..15.881 rows=117498 loops=2)
                                                         ->  Parallel Hash  (cost=123050.62..123050.62 rows=33 width=57) (actual time=1402.420..1402.420 rows=70 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=89312.34..123050.62 rows=33 width=57) (actual time=1012.493..1402.326 rows=70 loops=2)
                                                                     Hash Cond: (mc2.movie_id = t2.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.007..231.790 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=89311.94..89311.94 rows=32 width=65) (actual time=1009.566..1009.566 rows=38 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=33182.88..89311.94 rows=32 width=65) (actual time=558.866..1009.429 rows=38 loops=2)
                                                                                 Hash Cond: (t2.id = ml.linked_movie_id)
                                                                                 ->  Parallel Seq Scan on title t2  (cost=0.00..51799.95 rows=432897 width=25) (actual time=0.033..404.438 rows=521400 loops=2)
                                                                                       Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                                                       Rows Removed by Filter: 742756
                                                                                 ->  Parallel Hash  (cost=33181.88..33181.88 rows=80 width=40) (actual time=549.152..549.152 rows=49 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Parallel Hash Join  (cost=26712.90..33181.88 rows=80 width=40) (actual time=477.456..548.921 rows=49 loops=2)
                                                                                             Hash Cond: (mc1.company_id = cn1.id)
                                                                                             ->  Hash Join  (cost=21066.29..27534.89 rows=149 width=25) (actual time=404.209..475.384 rows=63 loops=2)
                                                                                                   Hash Cond: (mi_idx2.info_type_id = it2.id)
                                                                                                   ->  Parallel Hash Join  (cost=21063.87..27486.73 rows=16791 width=29) (actual time=403.782..474.626 rows=6846 loops=2)
                                                                                                         Hash Cond: (ml.linked_movie_id = mi_idx2.movie_id)
                                                                                                         ->  Merge Join  (cost=869.16..5648.12 rows=10916 width=16) (actual time=9.131..37.785 rows=5049 loops=2)
                                                                                                               Merge Cond: (mc1.movie_id = ml.movie_id)
                                                                                                               ->  Parallel Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..116330.44 rows=1087137 width=8) (actual time=0.021..21.329 rows=49939 loops=2)
                                                                                                               ->  Sort  (cost=868.72..881.22 rows=5000 width=8) (actual time=8.994..9.398 rows=6226 loops=2)
                                                                                                                     Sort Key: ml.movie_id
                                                                                                                     Sort Method: quicksort  Memory: 205kB
                                                                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                                     ->  Hash Join  (cost=1.29..561.53 rows=5000 width=8) (actual time=0.083..8.019 rows=2315 loops=2)
                                                                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.034..3.934 rows=29997 loops=2)
                                                                                                                           ->  Hash  (cost=1.25..1.25 rows=3 width=4) (actual time=0.031..0.032 rows=2 loops=2)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.25 rows=3 width=4) (actual time=0.025..0.029 rows=2 loops=2)
                                                                                                                                       Filter: ((link)::text = ANY ('{sequel,follows,"followed by"}'::text[]))
                                                                                                                                       Rows Removed by Filter: 16
                                                                                                         ->  Parallel Hash  (cost=15122.68..15122.68 rows=291762 width=13) (actual time=353.049..353.049 rows=351960 loops=2)
                                                                                                               Buckets: 131072  Batches: 16  Memory Usage: 3360kB
                                                                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=291762 width=13) (actual time=0.023..228.477 rows=351960 loops=2)
                                                                                                                     Filter: ((info)::text < '3.5'::text)
                                                                                                                     Rows Removed by Filter: 338058
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=2)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.049 rows=1 loops=2)
                                                                                                               Filter: ((info)::text = 'rating'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=73895 width=23) (actual time=71.864..71.864 rows=63115 loops=2)
                                                                                                   Buckets: 131072  Batches: 1  Memory Usage: 8256kB
                                                                                                   ->  Parallel Seq Scan on company_name cn1  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.032..37.953 rows=63115 loops=2)
                                                                                                         Filter: ((country_code)::text <> '[us]'::text)
                                                                                                         Rows Removed by Filter: 54384
                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.056..0.056 rows=2 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=2 width=4) (actual time=0.036..0.038 rows=2 loops=2)
                                                               Filter: ((kind)::text = ANY ('{"tv series",episode}'::text[]))
                                                               Rows Removed by Filter: 5
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.025 rows=1 loops=1)
                                       Filter: ((info)::text = 'rating'::text)
                                       Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.036..0.037 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=2 width=4) (actual time=0.013..0.016 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{"tv series",episode}'::text[]))
                     Rows Removed by Filter: 5
 Planning Time: 109.596 ms
 Execution Time: 1613.185 ms
(92 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=389853.80..389853.81 rows=1 width=32) (actual time=2996.705..2996.705 rows=1 loops=1)
   ->  Gather  (cost=389853.58..389853.79 rows=2 width=32) (actual time=2996.380..3002.632 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=388853.58..388853.59 rows=1 width=32) (actual time=2990.105..2990.106 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=337023.30..388853.51 rows=30 width=17) (actual time=2805.813..2990.016 rows=69 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.009..270.256 rows=337640 loops=3)
                           Filter: (production_year > 2005)
                           Rows Removed by Filter: 505131
                     ->  Parallel Hash  (cost=337022.38..337022.38 rows=74 width=8) (actual time=2670.805..2670.805 rows=589 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=50880.48..337022.38 rows=74 width=8) (actual time=600.856..2670.262 rows=589 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..285615.00 rows=60182 width=4) (actual time=0.927..2063.102 rows=51299 loops=3)
                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                                       Rows Removed by Filter: 4893941
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=596.285..596.285 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=33.838..472.737 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..253.676 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=32.864..32.865 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.646..32.813 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.648 ms
 Execution Time: 3003.025 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3b.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=340923.67..340923.68 rows=1 width=32) (actual time=2098.089..2098.089 rows=1 loops=1)
   ->  Gather  (cost=340923.45..340923.66 rows=2 width=32) (actual time=2097.778..2103.770 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=339923.45..339923.46 rows=1 width=32) (actual time=2091.452..2091.453 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=290135.26..339923.45 rows=1 width=17) (actual time=2055.243..2091.438 rows=2 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.017..253.611 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=290135.24..290135.24 rows=1 width=8) (actual time=1820.120..1820.120 rows=7 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=50880.48..290135.24 rows=1 width=8) (actual time=680.731..1820.010 rows=7 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=158 width=4) (actual time=72.048..1230.478 rows=762 loops=3)
                                       Filter: ((info)::text = 'Bulgaria'::text)
                                       Rows Removed by Filter: 4944478
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=588.954..588.954 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.146..471.510 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..252.692 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.103..33.104 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.645..33.053 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.314 ms
 Execution Time: 2104.191 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=409155.23..409155.24 rows=1 width=32) (actual time=4115.716..4115.716 rows=1 loops=1)
   ->  Gather  (cost=409155.02..409155.23 rows=2 width=32) (actual time=4115.285..4121.578 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=408155.02..408155.03 rows=1 width=32) (actual time=4109.062..4109.063 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=354417.68..408154.42 rows=241 width=17) (actual time=3753.920..4107.727 rows=2417 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.008..284.492 rows=583011 loops=3)
                           Filter: (production_year > 1990)
                           Rows Removed by Filter: 259760
                     ->  Parallel Hash  (cost=354413.34..354413.34 rows=347 width=8) (actual time=3747.453..3747.453 rows=4054 loops=3)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                           ->  Parallel Hash Join  (cost=50880.48..354413.34 rows=347 width=8) (actual time=601.739..2852.284 rows=4054 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=4) (actual time=0.986..2221.054 rows=235558 loops=3)
                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                       Rows Removed by Filter: 4709682
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=596.760..596.760 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=33.761..472.234 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..253.375 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.006..33.007 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.645..32.954 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.695 ms
 Execution Time: 4121.968 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4a.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=118372.74..118372.75 rows=1 width=64) (actual time=1188.312..1188.313 rows=1 loops=1)
   ->  Gather  (cost=67607.95..118372.73 rows=2 width=22) (actual time=939.305..1193.720 rows=740 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=66607.95..117372.53 rows=1 width=22) (actual time=926.273..1181.209 rows=247 loops=3)
               Hash Cond: (t.id = mi_idx.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.013..267.636 rows=337640 loops=3)
                     Filter: (production_year > 2005)
                     Rows Removed by Filter: 505131
               ->  Parallel Hash  (cost=66607.92..66607.92 rows=2 width=13) (actual time=867.418..867.418 rows=1940 loops=3)
                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                     ->  Parallel Hash Join  (cost=50882.90..66607.92 rows=2 width=13) (actual time=595.842..790.587 rows=1940 loops=3)
                           Hash Cond: (mi_idx.movie_id = mk.movie_id)
                           ->  Hash Join  (cost=2.43..15720.19 rows=1934 width=9) (actual time=0.173..179.005 rows=117663 loops=3)
                                 Hash Cond: (mi_idx.info_type_id = it.id)
                                 ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=218500 width=13) (actual time=0.036..144.829 rows=174440 loops=3)
                                       Filter: ((info)::text > '5.0'::text)
                                       Rows Removed by Filter: 285572
                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.049 rows=1 loops=3)
                                             Filter: ((info)::text = 'rating'::text)
                                             Rows Removed by Filter: 112
                           ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=594.753..594.753 rows=4317 loops=3)
                                 Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                 ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=33.910..472.330 rows=4317 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..254.216 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=32.867..32.867 rows=30 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.647..32.816 rows=30 loops=3)
                                                   Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                   Rows Removed by Filter: 134140
 Planning Time: 3.932 ms
 Execution Time: 1194.647 ms
(35 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4b.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=116799.72..116799.73 rows=1 width=64) (actual time=879.690..879.690 rows=1 loops=1)
   ->  Gather  (cost=67011.42..116799.71 rows=1 width=22) (actual time=806.123..885.720 rows=6 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=66011.42..115799.61 rows=1 width=22) (actual time=824.189..873.306 rows=2 loops=3)
               Hash Cond: (t.id = mi_idx.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.013..250.425 rows=130555 loops=3)
                     Filter: (production_year > 2010)
                     Rows Removed by Filter: 712215
               ->  Parallel Hash  (cost=66011.41..66011.41 rows=1 width=13) (actual time=605.198..605.198 rows=7 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=17758.80..66011.41 rows=1 width=13) (actual time=298.362..605.066 rows=7 loops=3)
                           Hash Cond: (mk.movie_id = mi_idx.movie_id)
                           ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.165..475.838 rows=4317 loops=3)
                                 Hash Cond: (mk.keyword_id = k.id)
                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.015..256.301 rows=1507977 loops=3)
                                 ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.725..33.726 rows=30 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.617..33.679 rows=30 loops=3)
                                             Filter: ((keyword)::text ~~ '%sequel%'::text)
                                             Rows Removed by Filter: 134140
                           ->  Parallel Hash  (cost=15132.23..15132.23 rows=23 width=9) (actual time=128.178..128.179 rows=102 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Hash Join  (cost=2.43..15132.23 rows=23 width=9) (actual time=1.619..128.038 rows=102 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=2615 width=13) (actual time=0.107..126.994 rows=2794 loops=3)
                                             Filter: ((info)::text > '9.0'::text)
                                             Rows Removed by Filter: 457218
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.074..0.074 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.051..0.054 rows=1 loops=3)
                                                   Filter: ((info)::text = 'rating'::text)
                                                   Rows Removed by Filter: 112
 Planning Time: 3.986 ms
 Execution Time: 886.175 ms
(35 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=119900.33..119900.34 rows=1 width=64) (actual time=1264.253..1264.253 rows=1 loops=1)
   ->  Gather  (cost=119900.11..119900.32 rows=2 width=64) (actual time=1263.783..1271.454 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=118900.11..118900.12 rows=1 width=64) (actual time=1257.094..1257.095 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=66992.13..118900.10 rows=2 width=22) (actual time=888.380..1255.700 rows=1567 loops=3)
                     Hash Cond: (t.id = mi_idx.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.013..292.115 rows=583011 loops=3)
                           Filter: (production_year > 1990)
                           Rows Removed by Filter: 259760
                     ->  Parallel Hash  (cost=66992.09..66992.09 rows=3 width=13) (actual time=884.377..884.377 rows=2697 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=50882.90..66992.09 rows=3 width=13) (actual time=615.129..839.840 rows=2697 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                 ->  Hash Join  (cost=2.43..16099.73 rows=3167 width=9) (actual time=0.173..205.948 rows=149656 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=357862 width=13) (actual time=0.038..156.551 rows=287152 loops=3)
                                             Filter: ((info)::text > '2.0'::text)
                                             Rows Removed by Filter: 172860
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.049 rows=1 loops=3)
                                                   Filter: ((info)::text = 'rating'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=612.811..612.811 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.048..479.934 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.029..260.976 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.367..33.367 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.659..33.316 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.950 ms
 Execution Time: 1271.940 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5a.sql_explained.sql
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=372724.06..372724.07 rows=1 width=32) (actual time=256.532..256.532 rows=1 loops=1)
   ->  Gather  (cost=372723.84..372724.05 rows=2 width=32) (actual time=256.354..258.294 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=371723.84..371723.85 rows=1 width=32) (actual time=249.977..249.977 rows=1 loops=3)
               ->  Hash Join  (cost=85882.87..371723.72 rows=48 width=17) (actual time=249.974..249.974 rows=0 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=85879.33..371720.05 rows=48 width=21) (actual time=249.661..249.661 rows=0 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..285615.00 rows=60182 width=8) (never executed)
                                 Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                           ->  Parallel Hash  (cost=85877.27..85877.27 rows=165 width=25) (actual time=249.257..249.257 rows=0 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                 ->  Parallel Hash Join  (cost=35112.01..85877.27 rows=165 width=25) (actual time=249.191..249.192 rows=0 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (never executed)
                                             Filter: (production_year > 2005)
                                       ->  Parallel Hash  (cost=35106.92..35106.92 rows=407 width=4) (actual time=249.151..249.151 rows=0 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                             ->  Hash Join  (cost=1.06..35106.92 rows=407 width=4) (actual time=249.127..249.127 rows=0 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=1629 width=8) (actual time=6.038..247.405 rows=8008 loops=3)
                                                         Filter: (((note)::text ~~ '%(theatrical)%'::text) AND ((note)::text ~~ '%(France)%'::text))
                                                         Rows Removed by Filter: 861701
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.047..0.048 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.102..0.102 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.041..0.056 rows=113 loops=3)
 Planning Time: 4.526 ms
 Execution Time: 258.718 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5b.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=328691.22..328691.23 rows=1 width=32) (actual time=244.585..244.585 rows=1 loops=1)
   ->  Gather  (cost=328691.00..328691.21 rows=2 width=32) (actual time=244.445..246.381 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=327691.00..327691.01 rows=1 width=32) (actual time=238.095..238.095 rows=1 loops=3)
               ->  Hash Join  (cost=87607.92..327691.00 rows=1 width=17) (actual time=238.092..238.092 rows=0 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=87604.38..327687.46 rows=1 width=21) (actual time=237.779..237.780 rows=0 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=221252 width=8) (never executed)
                                 Filter: ((info)::text = ANY ('{USA,America}'::text[]))
                           ->  Parallel Hash  (cost=87604.36..87604.36 rows=1 width=25) (actual time=237.390..237.390 rows=0 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                 ->  Parallel Hash Join  (cost=37816.17..87604.36 rows=1 width=25) (actual time=237.303..237.304 rows=0 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (never executed)
                                             Filter: (production_year > 2010)
                                       ->  Parallel Hash  (cost=37816.09..37816.09 rows=6 width=4) (actual time=237.263..237.264 rows=0 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                             ->  Hash Join  (cost=1.06..37816.09 rows=6 width=4) (actual time=237.238..237.239 rows=0 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=25 width=8) (actual time=4.385..236.918 rows=473 loops=3)
                                                         Filter: (((note)::text ~~ '%(VHS)%'::text) AND ((note)::text ~~ '%(USA)%'::text) AND ((note)::text ~~ '%(1994)%'::text))
                                                         Rows Removed by Filter: 869237
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.028..0.029 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.099..0.100 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.036..0.050 rows=113 loops=3)
 Planning Time: 4.421 ms
 Execution Time: 246.831 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5c.sql_explained.sql
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=391106.63..391106.64 rows=1 width=32) (actual time=3006.477..3006.477 rows=1 loops=1)
   ->  Gather  (cost=391106.42..391106.63 rows=2 width=32) (actual time=3006.030..3013.243 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=390106.42..390106.43 rows=1 width=32) (actual time=2999.290..2999.290 rows=1 loops=3)
               ->  Hash Join  (cost=87874.47..390061.87 rows=17818 width=17) (actual time=744.677..2999.045 rows=223 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=87870.93..390009.80 rows=17818 width=21) (actual time=744.343..2998.577 rows=223 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.079..2321.064 rows=235558 loops=3)
                                 Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                 Rows Removed by Filter: 4709682
                           ->  Parallel Hash  (cost=87706.73..87706.73 rows=13136 width=25) (actual time=649.432..649.432 rows=256 loops=3)
                                 Buckets: 32768  Batches: 1  Memory Usage: 352kB
                                 ->  Parallel Hash Join  (cost=35744.04..87706.73 rows=13136 width=25) (actual time=316.091..648.732 rows=256 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.025..288.444 rows=583011 loops=3)
                                             Filter: (production_year > 1990)
                                             Rows Removed by Filter: 259760
                                       ->  Parallel Hash  (cost=35507.44..35507.44 rows=18928 width=4) (actual time=296.420..296.420 rows=266 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 608kB
                                             ->  Hash Join  (cost=1.06..35507.44 rows=18928 width=4) (actual time=210.731..296.062 rows=266 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=75712 width=8) (actual time=0.026..285.724 rows=98543 loops=3)
                                                         Filter: (((note)::text !~~ '%(TV)%'::text) AND ((note)::text ~~ '%(USA)%'::text))
                                                         Rows Removed by Filter: 771167
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.028..0.029 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.109..0.109 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.041..0.061 rows=113 loops=3)
 Planning Time: 4.377 ms
 Execution Time: 3013.683 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=622340.59..622340.60 rows=1 width=96) (actual time=4832.463..4832.463 rows=1 loops=1)
   ->  Gather  (cost=622340.37..622340.58 rows=2 width=96) (actual time=4832.295..4837.965 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=621340.37..621340.38 rows=1 width=96) (actual time=4825.545..4825.546 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=571552.17..621340.36 rows=1 width=48) (actual time=4793.705..4825.502 rows=2 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.016..252.070 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=39) (actual time=4555.935..4555.935 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=39) (actual time=3457.847..4555.823 rows=2 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=799.498..4093.405 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.027..2137.177 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=494.106..494.106 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=199.909..494.012 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=462.304..462.305 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=98.624..462.240 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..259.157 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=21.051..21.051 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.510..21.029 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.286 ms
 Execution Time: 4838.541 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6b.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=622719.90..622719.91 rows=1 width=96) (actual time=5051.836..5051.836 rows=1 loops=1)
   ->  Gather  (cost=622719.67..622719.88 rows=2 width=96) (actual time=5051.264..5057.555 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=621719.67..621719.68 rows=1 width=96) (actual time=5044.699..5044.700 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=544400.32..621719.67 rows=1 width=48) (actual time=4894.813..5044.681 rows=4 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=201.516..501.265 rows=1 loops=3)
                           Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                           Rows Removed by Filter: 1389163
                     ->  Parallel Hash  (cost=544400.31..544400.31 rows=1 width=37) (actual time=4542.734..4542.734 rows=128 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=101052.25..544400.31 rows=1 width=37) (actual time=974.454..4542.460 rows=128 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=49166.44..492513.86 rows=167 width=29) (actual time=251.473..3992.711 rows=1033 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.036..2151.243 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=49166.29..49166.29 rows=12 width=21) (actual time=237.490..237.490 rows=146 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=12 width=21) (actual time=101.863..237.224 rows=146 loops=3)
                                                   Filter: (production_year > 2014)
                                                   Rows Removed by Filter: 842625
                                 ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=549.182..549.182 rows=11849 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                       ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=43.928..484.670 rows=11849 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..252.941 rows=1507977 loops=3)
                                             ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=43.725..43.726 rows=8 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.171..43.700 rows=8 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                         Rows Removed by Filter: 134162
 Planning Time: 4.434 ms
 Execution Time: 5058.044 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=621712.31..621712.32 rows=1 width=96) (actual time=5029.917..5029.917 rows=1 loops=1)
   ->  Gather  (cost=621712.09..621712.30 rows=2 width=96) (actual time=5029.580..5036.633 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=620712.09..620712.10 rows=1 width=96) (actual time=5022.694..5022.694 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=543392.73..620712.08 rows=1 width=48) (actual time=4869.828..5022.676 rows=1 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=204.863..510.547 rows=1 loops=3)
                           Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                           Rows Removed by Filter: 1389163
                     ->  Parallel Hash  (cost=543392.72..543392.72 rows=1 width=37) (actual time=4511.412..4511.412 rows=11 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=100044.67..543392.72 rows=1 width=37) (actual time=1253.091..4511.257 rows=11 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=49166.44..492513.86 rows=167 width=29) (actual time=247.682..4048.403 rows=1033 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.028..2206.277 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=49166.29..49166.29 rows=12 width=21) (actual time=235.001..235.002 rows=146 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=12 width=21) (actual time=101.271..234.726 rows=146 loops=3)
                                                   Filter: (production_year > 2014)
                                                   Rows Removed by Filter: 842625
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=462.508..462.508 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=148.699..462.437 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..258.864 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=21.343..21.343 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.527..21.320 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.151 ms
 Execution Time: 5037.192 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6d.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=624885.62..624885.63 rows=1 width=96) (actual time=4983.385..4983.385 rows=1 loops=1)
   ->  Gather  (cost=624885.39..624885.60 rows=2 width=96) (actual time=4982.768..4989.469 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=623885.39..623885.40 rows=1 width=96) (actual time=4976.328..4976.329 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=572559.75..623885.39 rows=1 width=48) (actual time=4812.626..4976.260 rows=29 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.014..276.514 rows=460484 loops=3)
                           Filter: (production_year > 2000)
                           Rows Removed by Filter: 382286
                     ->  Parallel Hash  (cost=572559.74..572559.74 rows=1 width=39) (actual time=4651.356..4651.356 rows=37 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=129206.67..572559.74 rows=1 width=39) (actual time=1358.483..4651.188 rows=37 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=806.214..4098.824 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.026..2134.301 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=501.091..501.091 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=201.029..501.007 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=552.161..552.161 rows=11849 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                       ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=43.320..486.402 rows=11849 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..255.400 rows=1507977 loops=3)
                                             ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=43.083..43.084 rows=8 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.169..43.058 rows=8 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                         Rows Removed by Filter: 134162
 Planning Time: 4.528 ms
 Execution Time: 4989.951 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6e.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=623878.03..623878.04 rows=1 width=96) (actual time=5072.124..5072.124 rows=1 loops=1)
   ->  Gather  (cost=623877.81..623878.02 rows=2 width=96) (actual time=5071.882..5079.329 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=622877.81..622877.82 rows=1 width=96) (actual time=5065.008..5065.009 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=571552.17..622877.80 rows=1 width=48) (actual time=5021.288..5064.959 rows=2 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.015..283.681 rows=460484 loops=3)
                           Filter: (production_year > 2000)
                           Rows Removed by Filter: 382286
                     ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=39) (actual time=4734.406..4734.406 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=39) (actual time=3588.768..4734.277 rows=2 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=830.298..4266.871 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.030..2288.177 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=513.423..513.424 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=206.071..513.362 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=467.260..467.260 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=129.663..467.181 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..263.658 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=21.374..21.374 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.510..21.352 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.101 ms
 Execution Time: 5079.901 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6f.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=652048.60..652048.61 rows=1 width=96) (actual time=7205.193..7205.193 rows=1 loops=1)
   ->  Gather  (cost=652048.38..652048.59 rows=2 width=96) (actual time=7199.861..7338.936 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=651048.38..651048.39 rows=1 width=96) (actual time=7192.859..7192.859 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=565020.96..651031.37 rows=2268 width=48) (actual time=6560.394..7085.346 rows=261826 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.052..398.424 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=564992.61..564992.61 rows=2268 width=37) (actual time=5621.574..5621.574 rows=261826 loops=3)
                           Buckets: 65536 (originally 8192)  Batches: 16 (originally 1)  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=104652.02..564992.61 rows=2268 width=37) (actual time=996.713..5324.502 rows=261826 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.044..2325.589 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=104651.25..104651.25 rows=62 width=41) (actual time=996.546..996.546 rows=4722 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1304kB
                                       ->  Parallel Hash Join  (cost=51885.81..104651.25 rows=62 width=41) (actual time=588.369..936.723 rows=4722 loops=3)
                                             Hash Cond: (t.id = mk.movie_id)
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.020..280.938 rows=460484 loops=3)
                                                   Filter: (production_year > 2000)
                                                   Rows Removed by Filter: 382286
                                             ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=588.057..588.057 rows=11849 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                                   ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.295..492.496 rows=11849 loops=3)
                                                         Hash Cond: (mk.keyword_id = k.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..260.731 rows=1507977 loops=3)
                                                         ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=43.908..43.909 rows=8 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.174..43.883 rows=8 loops=3)
                                                                     Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                                     Rows Removed by Filter: 134162
 Planning Time: 4.373 ms
 Execution Time: 7339.423 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7a.sql_explained.sql
SET
SET
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=693399.56..693399.57 rows=1 width=64) (actual time=6097.779..6097.780 rows=1 loops=1)
   ->  Gather  (cost=693399.34..693399.55 rows=2 width=64) (actual time=6097.519..6104.127 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=692399.34..692399.35 rows=1 width=64) (actual time=6089.493..6089.493 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=675186.31..692399.33 rows=1 width=32) (actual time=6032.276..6089.466 rows=11 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..16090.49 rows=299338 width=4) (actual time=0.042..123.302 rows=224897 loops=3)
                           Filter: ((name)::text ~~ '%a%'::text)
                           Rows Removed by Filter: 75550
                     ->  Parallel Hash  (cost=675186.30..675186.30 rows=1 width=44) (actual time=5943.648..5943.648 rows=5 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=622849.52..675186.30 rows=1 width=44) (actual time=5895.888..5943.520 rows=5 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=622267.21..674603.97 rows=1 width=52) (actual time=5648.067..5932.172 rows=130 loops=3)
                                       Hash Cond: (t.id = ci.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=143147 width=21) (actual time=0.024..267.437 rows=113395 loops=3)
                                             Filter: ((production_year >= 1980) AND (production_year <= 1995))
                                             Rows Removed by Filter: 729375
                                       ->  Parallel Hash  (cost=622267.19..622267.19 rows=1 width=31) (actual time=5645.442..5645.442 rows=890 loops=3)
                                             Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                             ->  Parallel Hash Join  (cost=161930.27..622267.19 rows=1 width=31) (actual time=1103.019..4786.942 rows=890 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.033..2246.313 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=161930.25..161930.25 rows=1 width=23) (actual time=1067.993..1067.993 rows=6 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=66488.22..161930.25 rows=1 width=23) (actual time=350.492..1067.884 rows=6 loops=3)
                                                               Hash Cond: (n.id = pi.person_id)
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..94683.23 rows=202346 width=19) (actual time=0.059..721.217 rows=181097 loops=3)
                                                                     Filter: (((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'B%'::text))))
                                                                     Rows Removed by Filter: 1208067
                                                               ->  Parallel Hash  (cost=66488.21..66488.21 rows=1 width=4) (actual time=327.060..327.060 rows=21 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Hash Join  (cost=2.43..66488.21 rows=1 width=4) (actual time=6.651..326.985 rows=21 loops=3)
                                                                           Hash Cond: (pi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on person_info pi  (cost=0.00..66485.75 rows=12 width=8) (actual time=6.534..326.843 rows=21 loops=3)
                                                                                 Filter: ((note)::text = 'Volker Boehm'::text)
                                                                                 Rows Removed by Filter: 987867
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.059 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.049 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'mini biography'::text)
                                                                                       Rows Removed by Filter: 112
                                 ->  Hash  (cost=561.48..561.48 rows=1666 width=4) (actual time=11.231..11.231 rows=5186 loops=3)
                                       Buckets: 8192 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 247kB
                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=4) (actual time=0.189..9.555 rows=5186 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.038..4.930 rows=29997 loops=3)
                                             ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=3)
                                                         Filter: ((link)::text = 'features'::text)
                                                         Rows Removed by Filter: 17
 Planning Time: 15.112 ms
 Execution Time: 6105.095 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7b.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=663974.41..663974.42 rows=1 width=64) (actual time=5174.705..5174.705 rows=1 loops=1)
   ->  Gather  (cost=663974.19..663974.40 rows=2 width=64) (actual time=5173.323..5180.049 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=662974.19..662974.20 rows=1 width=64) (actual time=5166.363..5166.363 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=645761.16..662974.18 rows=1 width=32) (actual time=5120.817..5166.339 rows=5 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..16090.49 rows=299338 width=4) (actual time=0.038..114.984 rows=224897 loops=3)
                           Filter: ((name)::text ~~ '%a%'::text)
                           Rows Removed by Filter: 75550
                     ->  Parallel Hash  (cost=645761.15..645761.15 rows=1 width=44) (actual time=5028.924..5028.924 rows=3 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Hash Join  (cost=201453.00..645761.15 rows=1 width=44) (actual time=4610.514..5028.660 rows=3 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=200870.69..645178.82 rows=1 width=52) (actual time=2843.115..5017.772 rows=7 loops=3)
                                       Hash Cond: (n.id = pi.person_id)
                                       ->  Parallel Hash Join  (cost=134382.47..578648.77 rows=11153 width=48) (actual time=1031.904..4700.220 rows=11015 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Hash Join  (cost=82162.96..525510.35 rows=350058 width=27) (actual time=478.550..4359.984 rows=304108 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.033..2204.766 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=40251 width=19) (actual time=477.635..477.641 rows=30659 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 6048kB
                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40251 width=19) (actual time=0.102..456.211 rows=30659 loops=3)
                                                               Filter: (((name_pcode_cf)::text ~~ 'D%'::text) AND ((gender)::text = 'm'::text))
                                                               Rows Removed by Filter: 1358505
                                             ->  Parallel Hash  (cost=51799.95..51799.95 rows=33565 width=21) (actual time=281.537..281.537 rows=25355 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 5376kB
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=33565 width=21) (actual time=0.028..258.234 rows=25355 loops=3)
                                                         Filter: ((production_year >= 1980) AND (production_year <= 1984))
                                                         Rows Removed by Filter: 817416
                                       ->  Parallel Hash  (cost=66488.21..66488.21 rows=1 width=4) (actual time=316.228..316.228 rows=21 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=2.43..66488.21 rows=1 width=4) (actual time=6.773..316.153 rows=21 loops=3)
                                                   Hash Cond: (pi.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on person_info pi  (cost=0.00..66485.75 rows=12 width=8) (actual time=6.652..316.007 rows=21 loops=3)
                                                         Filter: ((note)::text = 'Volker Boehm'::text)
                                                         Rows Removed by Filter: 987867
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.067 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.052 rows=1 loops=3)
                                                               Filter: ((info)::text = 'mini biography'::text)
                                                               Rows Removed by Filter: 112
                                 ->  Hash  (cost=561.48..561.48 rows=1666 width=4) (actual time=10.828..10.828 rows=5186 loops=3)
                                       Buckets: 8192 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 247kB
                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=4) (actual time=0.167..9.175 rows=5186 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.037..4.589 rows=29997 loops=3)
                                             ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=3)
                                                         Filter: ((link)::text = 'features'::text)
                                                         Rows Removed by Filter: 17
 Planning Time: 13.903 ms
 Execution Time: 5180.871 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7c.sql_explained.sql
SET
SET
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=697422.31..697422.32 rows=1 width=64) (actual time=8785.612..8785.612 rows=1 loops=1)
   ->  Gather  (cost=697422.09..697422.30 rows=2 width=64) (actual time=8779.443..9478.034 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=696422.09..696422.10 rows=1 width=64) (actual time=8772.501..8772.501 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=678258.59..696422.08 rows=2 width=109) (actual time=8573.803..8644.882 rows=22728 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..17029.39 rows=302423 width=4) (actual time=0.044..122.150 rows=228698 loops=3)
                           Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%a%'::text) OR ((name)::text ~~ 'A%'::text)))
                           Rows Removed by Filter: 71749
                     ->  Parallel Hash  (cost=678258.58..678258.58 rows=1 width=121) (actual time=8367.213..8367.213 rows=13386 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 2592kB
                           ->  Hash Join  (cost=624016.03..678258.58 rows=1 width=121) (actual time=7636.931..8283.900 rows=13386 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=623371.14..677606.36 rows=189 width=129) (actual time=7617.913..8234.614 rows=176455 loops=3)
                                       Hash Cond: (t.id = ci.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=649194 width=4) (actual time=0.038..298.444 rows=518532 loops=3)
                                             Filter: ((production_year >= 1980) AND (production_year <= 2010))
                                             Rows Removed by Filter: 324238
                                       ->  Parallel Hash  (cost=623367.30..623367.30 rows=307 width=125) (actual time=7056.525..7056.525 rows=305764 loops=3)
                                             Buckets: 8192 (originally 1024)  Batches: 256 (originally 1)  Memory Usage: 3232kB
                                             ->  Parallel Hash Join  (cost=163029.14..623367.30 rows=307 width=125) (actual time=1313.248..5207.075 rows=305764 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.044..2169.577 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=163028.71..163028.71 rows=35 width=117) (actual time=1312.775..1312.775 rows=4354 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 11384kB
                                                         ->  Parallel Hash Join  (cost=98354.03..163028.71 rows=35 width=117) (actual time=1205.892..1274.783 rows=4354 loops=3)
                                                               Hash Cond: (pi.person_id = n.id)
                                                               ->  Hash Join  (cost=2.43..63495.30 rows=306 width=98) (actual time=0.097..340.367 rows=28061 loops=3)
                                                                     Hash Cond: (pi.info_type_id = it.id)
                                                                     ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=34617 width=102) (actual time=0.038..322.359 rows=28061 loops=3)
                                                                           Filter: (note IS NOT NULL)
                                                                           Rows Removed by Filter: 959827
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.046 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.042 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'mini biography'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=94683.23..94683.23 rows=199790 width=19) (actual time=777.409..777.409 rows=169207 loops=3)
                                                                     Buckets: 65536  Batches: 8  Memory Usage: 4032kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..94683.23 rows=199790 width=19) (actual time=0.075..715.985 rows=169207 loops=3)
                                                                           Filter: (((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'A%'::text))))
                                                                           Rows Removed by Filter: 1219957
                                 ->  Hash  (cost=561.57..561.57 rows=6666 width=4) (actual time=18.337..18.337 rows=21505 loops=3)
                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 1013kB
                                       ->  Hash Join  (cost=1.32..561.57 rows=6666 width=4) (actual time=0.149..11.552 rows=21505 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.036..4.694 rows=29997 loops=3)
                                             ->  Hash  (cost=1.27..1.27 rows=4 width=4) (actual time=0.061..0.061 rows=4 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.27 rows=4 width=4) (actual time=0.030..0.034 rows=4 loops=3)
                                                         Filter: ((link)::text = ANY ('{references,"referenced in",features,"featured in"}'::text[]))
                                                         Rows Removed by Filter: 14
 Planning Time: 14.358 ms
 Execution Time: 9480.654 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8a.sql_explained.sql
SET
SET
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=631023.55..631023.56 rows=1 width=64) (actual time=3900.561..3900.562 rows=1 loops=1)
   ->  Gather  (cost=631023.33..631023.54 rows=2 width=64) (actual time=3899.647..3908.147 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=630023.33..630023.34 rows=1 width=64) (actual time=3892.482..3892.482 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=579540.20..630023.33 rows=1 width=33) (actual time=3674.068..3892.423 rows=21 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.016..225.015 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=579540.18..579540.18 rows=1 width=24) (actual time=3563.850..3563.850 rows=21 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=563388.51..579540.18 rows=1 width=24) (actual time=3532.586..3563.719 rows=21 loops=3)
                                 Hash Cond: (an1.person_id = ci.person_id)
                                 ->  Parallel Hash Join  (cost=81879.04..98016.48 rows=3793 width=24) (actual time=515.299..639.474 rows=1344 loops=3)
                                       Hash Cond: (an1.person_id = n1.id)
                                       ->  Parallel Seq Scan on aka_name an1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.031..79.546 rows=300448 loops=3)
                                       ->  Parallel Hash  (cost=81659.82..81659.82 rows=17538 width=4) (actual time=514.547..514.547 rows=6970 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 1376kB
                                             ->  Parallel Seq Scan on name n1  (cost=0.00..81659.82 rows=17538 width=4) (actual time=0.150..507.939 rows=6970 loops=3)
                                                   Filter: (((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))
                                                   Rows Removed by Filter: 1382193
                                 ->  Parallel Hash  (cost=481509.44..481509.44 rows=2 width=12) (actual time=2923.792..2923.792 rows=2479 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 504kB
                                       ->  Hash Join  (cost=39896.72..481509.44 rows=2 width=12) (actual time=1143.909..2762.271 rows=2479 loops=3)
                                             Hash Cond: (ci.role_id = rt.id)
                                             ->  Parallel Hash Join  (cost=39895.56..481508.19 rows=25 width=16) (actual time=313.042..2760.738 rows=6533 loops=3)
                                                   Hash Cond: (ci.movie_id = mc.movie_id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=40775 width=12) (actual time=0.869..2438.048 rows=31032 loops=3)
                                                         Filter: ((note)::text = '(voice: English version)'::text)
                                                         Rows Removed by Filter: 12050416
                                                   ->  Parallel Hash  (cost=39892.48..39892.48 rows=246 width=4) (actual time=311.613..311.614 rows=16109 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2968kB
                                                         ->  Parallel Hash Join  (cost=4773.19..39892.48 rows=246 width=4) (actual time=26.057..276.566 rows=16109 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=8470 width=8) (actual time=0.073..244.050 rows=16299 loops=3)
                                                                     Filter: (((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text))
                                                                     Rows Removed by Filter: 853411
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=4022 width=4) (actual time=25.836..25.837 rows=2251 loops=3)
                                                                     Buckets: 8192  Batches: 1  Memory Usage: 384kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=4022 width=4) (actual time=0.033..24.226 rows=2251 loops=3)
                                                                           Filter: ((country_code)::text = '[jp]'::text)
                                                                           Rows Removed by Filter: 76082
                                             ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.044..0.046 rows=1 loops=3)
                                                         Filter: ((role)::text = 'actress'::text)
                                                         Rows Removed by Filter: 11
 Planning Time: 9.120 ms
 Execution Time: 3908.810 ms
(48 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8b.sql_explained.sql
SET
SET
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=642938.22..642938.23 rows=1 width=64) (actual time=5133.185..5133.185 rows=1 loops=1)
   ->  Gather  (cost=642938.11..642938.22 rows=1 width=64) (actual time=5132.851..5138.416 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=641938.11..641938.12 rows=1 width=64) (actual time=5127.529..5127.530 rows=1 loops=2)
               ->  Hash Join  (cost=637200.09..641938.10 rows=1 width=33) (actual time=5108.897..5127.491 rows=3 loops=2)
                     Hash Cond: (ci.role_id = rt.id)
                     ->  Parallel Hash Join  (cost=637198.93..641936.94 rows=1 width=37) (actual time=5108.672..5127.265 rows=3 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=4022 width=4) (actual time=0.018..21.971 rows=3376 loops=2)
                                 Filter: ((country_code)::text = '[jp]'::text)
                                 Rows Removed by Filter: 114122
                           ->  Parallel Hash  (cost=637198.91..637198.91 rows=1 width=41) (actual time=5104.413..5104.413 rows=3 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=596664.89..637198.91 rows=1 width=41) (actual time=4891.476..5104.351 rows=3 loops=2)
                                       Hash Cond: (mc.movie_id = ci.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..40532.74 rows=338 width=8) (actual time=0.079..355.958 rows=4284 loops=2)
                                             Filter: (((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text) AND (((note)::text ~~ '%(2006)%'::text) OR ((note)::text ~~ '%(2007)%'::text)))
                                             Rows Removed by Filter: 1300280
                                       ->  Parallel Hash  (cost=596664.88..596664.88 rows=1 width=45) (actual time=4747.355..4747.355 rows=4 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=580513.21..596664.88 rows=1 width=45) (actual time=4709.241..4747.285 rows=4 loops=2)
                                                   Hash Cond: (an.person_id = ci.person_id)
                                                   ->  Parallel Hash Join  (cost=81879.04..98016.48 rows=3793 width=24) (actual time=735.645..909.507 rows=2016 loops=2)
                                                         Hash Cond: (an.person_id = n.id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.027..108.882 rows=450672 loops=2)
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=17538 width=4) (actual time=734.723..734.723 rows=10456 loops=2)
                                                               Buckets: 65536  Batches: 1  Memory Usage: 1344kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=17538 width=4) (actual time=0.320..726.508 rows=10456 loops=2)
                                                                     Filter: (((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))
                                                                     Rows Removed by Filter: 2073290
                                                   ->  Parallel Hash  (cost=498634.15..498634.15 rows=1 width=33) (actual time=3837.435..3837.435 rows=113 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                         ->  Parallel Hash Join  (cost=57067.49..498634.15 rows=1 width=33) (actual time=462.623..3837.249 rows=113 loops=2)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=40775 width=12) (actual time=0.846..3449.305 rows=46548 loops=2)
                                                                     Filter: ((note)::text = '(voice: English version)'::text)
                                                                     Rows Removed by Filter: 18075624
                                                               ->  Parallel Hash  (cost=57067.27..57067.27 rows=18 width=21) (actual time=381.211..381.211 rows=4 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=18 width=21) (actual time=289.209..381.147 rows=4 loops=2)
                                                                           Filter: ((production_year >= 2006) AND (production_year <= 2007) AND (((title)::text ~~ 'One Piece%'::text) OR ((title)::text ~~ 'Dragon Ball Z%'::text)))
                                                                           Rows Removed by Filter: 1264152
                     ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=2)
                                 Filter: ((role)::text = 'actress'::text)
                                 Rows Removed by Filter: 11
 Planning Time: 9.283 ms
 Execution Time: 5139.090 ms
(50 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8c.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=767932.80..767932.81 rows=1 width=64) (actual time=8111.002..8111.003 rows=1 loops=1)
   ->  Gather  (cost=767932.58..767932.79 rows=2 width=64) (actual time=8107.238..8267.915 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=766932.58..766932.59 rows=1 width=64) (actual time=8100.477..8100.477 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=243772.58..752972.57 rows=2792002 width=33) (actual time=7584.463..7867.403 rows=829204 loops=3)
                     Hash Cond: (ci.person_id = a1.person_id)
                     ->  Parallel Hash Join  (cost=118006.90..594573.48 rows=1215217 width=21) (actual time=5657.716..5973.624 rows=656886 loops=3)
                           Hash Cond: (ci.movie_id = t.id)
                           ->  Hash Join  (cost=1.16..457349.15 rows=1258484 width=8) (actual time=2547.400..3950.195 rows=909648 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.036..2150.588 rows=12081448 loops=3)
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.030..0.030 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=3)
                                             Filter: ((role)::text = 'writer'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=110366.87..110366.87 rows=395029 width=25) (actual time=1457.515..1457.516 rows=384599 loops=3)
                                 Buckets: 65536  Batches: 32  Memory Usage: 2784kB
                                 ->  Parallel Hash Join  (cost=44347.81..110366.87 rows=395029 width=25) (actual time=1052.506..1325.024 rows=384599 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.016..265.456 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=37865.94..37865.94 rows=395029 width=4) (actual time=517.899..517.899 rows=384599 loops=3)
                                             Buckets: 131072  Batches: 16  Memory Usage: 3872kB
                                             ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=4) (actual time=37.451..393.800 rows=384599 loops=3)
                                                   Hash Cond: (mc.company_id = cn.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.016..159.786 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=37.187..37.187 rows=28281 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4352kB
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.037..24.805 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                     ->  Parallel Hash  (cost=118870.18..118870.18 rows=375560 width=24) (actual time=1402.318..1402.318 rows=300448 loops=3)
                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=22047.10..118870.18 rows=375560 width=24) (actual time=954.112..1300.645 rows=300448 loops=3)
                                 Hash Cond: (n1.id = a1.person_id)
                                 ->  Parallel Seq Scan on name n1  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.054..417.903 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=15151.60..15151.60 rows=375560 width=20) (actual time=186.327..186.328 rows=300448 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 3712kB
                                       ->  Parallel Seq Scan on aka_name a1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.042..87.756 rows=300448 loops=3)
 Planning Time: 8.604 ms
 Execution Time: 8268.594 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8d.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=767932.80..767932.81 rows=1 width=64) (actual time=7275.297..7275.298 rows=1 loops=1)
   ->  Gather  (cost=767932.58..767932.79 rows=2 width=64) (actual time=7270.653..7407.209 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=766932.58..766932.59 rows=1 width=64) (actual time=7263.796..7263.797 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=243772.58..752972.57 rows=2792002 width=33) (actual time=7160.097..7233.321 rows=107668 loops=3)
                     Hash Cond: (ci.person_id = an1.person_id)
                     ->  Parallel Hash Join  (cost=118006.90..594573.48 rows=1215217 width=21) (actual time=5565.479..5683.496 rows=95179 loops=3)
                           Hash Cond: (ci.movie_id = t.id)
                           ->  Hash Join  (cost=1.16..457349.15 rows=1258484 width=8) (actual time=3155.258..4025.353 rows=92134 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.051..2341.001 rows=12081448 loops=3)
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.031..0.031 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.027..0.028 rows=1 loops=3)
                                             Filter: ((role)::text = 'costume designer'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=110366.87..110366.87 rows=395029 width=25) (actual time=1502.019..1502.019 rows=384599 loops=3)
                                 Buckets: 65536  Batches: 32  Memory Usage: 2784kB
                                 ->  Parallel Hash Join  (cost=44347.81..110366.87 rows=395029 width=25) (actual time=1078.675..1368.876 rows=384599 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.015..275.042 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=37865.94..37865.94 rows=395029 width=4) (actual time=531.814..531.814 rows=384599 loops=3)
                                             Buckets: 131072  Batches: 16  Memory Usage: 3872kB
                                             ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=4) (actual time=43.439..419.043 rows=384599 loops=3)
                                                   Hash Cond: (mc.company_id = cn.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.020..171.920 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=42.945..42.946 rows=28281 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.040..26.075 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                     ->  Parallel Hash  (cost=118870.18..118870.18 rows=375560 width=24) (actual time=1435.310..1435.310 rows=300448 loops=3)
                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=22047.10..118870.18 rows=375560 width=24) (actual time=974.386..1333.177 rows=300448 loops=3)
                                 Hash Cond: (n1.id = an1.person_id)
                                 ->  Parallel Seq Scan on name n1  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.054..428.228 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=15151.60..15151.60 rows=375560 width=20) (actual time=194.449..194.449 rows=300448 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 3680kB
                                       ->  Parallel Seq Scan on aka_name an1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.049..92.936 rows=300448 loops=3)
 Planning Time: 8.672 ms
 Execution Time: 7408.312 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9a.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=727877.31..727877.32 rows=1 width=96) (actual time=4605.722..4605.723 rows=1 loops=1)
   ->  Gather  (cost=674329.47..727877.30 rows=1 width=49) (actual time=4314.139..4612.198 rows=121 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=673329.47..726877.20 rows=1 width=49) (actual time=4404.730..4598.356 rows=40 loops=3)
               Hash Cond: (t.id = ci.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=466073 width=21) (actual time=0.013..266.599 rows=369296 loops=3)
                     Filter: ((production_year >= 2005) AND (production_year <= 2015))
                     Rows Removed by Filter: 473475
               ->  Parallel Hash  (cost=673329.45..673329.45 rows=1 width=40) (actual time=4290.271..4290.271 rows=114 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=668418.17..673329.45 rows=1 width=40) (actual time=4265.408..4290.119 rows=114 loops=3)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.026..21.939 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
                           ->  Parallel Hash  (cost=668418.15..668418.15 rows=1 width=44) (actual time=4265.015..4265.015 rows=116 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=613978.62..668418.15 rows=1 width=44) (actual time=3891.026..4264.916 rows=116 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.040..243.812 rows=1046780 loops=3)
                                       ->  Parallel Hash  (cost=613978.60..613978.60 rows=1 width=32) (actual time=3889.279..3889.279 rows=124 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=578389.44..613978.60 rows=1 width=32) (actual time=3591.181..3889.159 rows=124 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=131225 width=8) (actual time=0.022..287.501 rows=196998 loops=3)
                                                         Filter: ((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                                         Rows Removed by Filter: 672712
                                                   ->  Parallel Hash  (cost=578389.42..578389.42 rows=2 width=24) (actual time=3580.209..3580.209 rows=142 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Hash Join  (cost=97799.03..578389.42 rows=2 width=24) (actual time=1627.036..3580.063 rows=142 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Hash Join  (cost=97797.87..578388.18 rows=19 width=28) (actual time=1626.921..3579.900 rows=142 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.094..2836.227 rows=289159 loops=3)
                                                                           Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                           Rows Removed by Filter: 11792289
                                                                     ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=24) (actual time=701.686..701.686 rows=519 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                           ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=24) (actual time=583.899..701.181 rows=519 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.032..73.155 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=4) (actual time=582.407..582.408 rows=2256 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=4) (actual time=216.644..513.159 rows=2256 loops=3)
                                                                                             Filter: (((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1386908
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actress'::text)
                                                                           Rows Removed by Filter: 11
 Planning Time: 15.866 ms
 Execution Time: 4612.984 ms
(54 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9b.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=691306.83..691306.84 rows=1 width=128) (actual time=4486.072..4486.072 rows=1 loops=1)
   ->  Gather  (cost=638698.30..691306.82 rows=1 width=64) (actual time=4246.324..4493.352 rows=40 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=637698.30..690306.72 rows=1 width=64) (actual time=4309.355..4478.434 rows=13 loops=3)
               Hash Cond: (t.id = ci.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=215591 width=21) (actual time=0.018..260.754 rows=170942 loops=3)
                     Filter: ((production_year >= 2007) AND (production_year <= 2010))
                     Rows Removed by Filter: 671829
               ->  Parallel Hash  (cost=637698.28..637698.28 rows=1 width=55) (actual time=4196.408..4196.408 rows=31 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=632787.00..637698.28 rows=1 width=55) (actual time=4170.914..4196.270 rows=31 loops=3)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.023..23.015 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
                           ->  Parallel Hash  (cost=632786.98..632786.98 rows=1 width=59) (actual time=4170.234..4170.234 rows=31 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=594815.82..632786.98 rows=1 width=59) (actual time=3927.011..4170.142 rows=31 loops=3)
                                       Hash Cond: (mc.movie_id = ci.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=41669 width=8) (actual time=0.028..274.644 rows=66173 loops=3)
                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                             Rows Removed by Filter: 803537
                                       ->  Parallel Hash  (cost=594815.80..594815.80 rows=1 width=51) (actual time=3887.225..3887.226 rows=79 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=540376.27..594815.80 rows=1 width=51) (actual time=3498.737..3887.086 rows=79 loops=3)
                                                   Hash Cond: (chn.id = ci.person_role_id)
                                                   ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.059..259.726 rows=1046780 loops=3)
                                                   ->  Parallel Hash  (cost=540376.25..540376.25 rows=1 width=39) (actual time=3496.710..3496.710 rows=88 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Hash Join  (cost=97799.03..540376.25 rows=1 width=39) (actual time=1877.459..3496.570 rows=88 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Hash Join  (cost=97797.87..540375.04 rows=15 width=43) (actual time=1877.343..3496.425 rows=88 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=298009 width=16) (actual time=0.058..2446.799 rows=237943 loops=3)
                                                                           Filter: ((note)::text = '(voice)'::text)
                                                                           Rows Removed by Filter: 11843505
                                                                     ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=39) (actual time=1014.696..1014.696 rows=432 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                           ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=39) (actual time=892.873..1014.198 rows=432 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.035..78.249 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=891.295..891.295 rows=1803 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 504kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=216.531..501.890 rows=1803 loops=3)
                                                                                             Filter: (((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1387361
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.039..0.042 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actress'::text)
                                                                           Rows Removed by Filter: 11
 Planning Time: 15.499 ms
 Execution Time: 4494.106 ms
(54 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9c.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=750479.65..750479.66 rows=1 width=128) (actual time=5143.992..5143.992 rows=1 loops=1)
   ->  Gather  (cost=750479.42..750479.63 rows=2 width=128) (actual time=5140.011..5215.345 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=749479.42..749479.43 rows=1 width=128) (actual time=5132.893..5132.893 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=732915.55..749475.64 rows=378 width=64) (actual time=5017.340..5131.466 rows=2715 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.053..71.674 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=732913.48..732913.48 rows=165 width=56) (actual time=5015.047..5015.047 rows=1501 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=682429.67..732913.48 rows=165 width=56) (actual time=4664.222..5001.361 rows=1501 loops=3)
                                 Hash Cond: (t.id = ci.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.014..221.500 rows=842771 loops=3)
                                 ->  Parallel Hash  (cost=682427.61..682427.61 rows=165 width=47) (actual time=4662.432..4662.432 rows=1501 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 568kB
                                       ->  Parallel Hash Join  (cost=648686.41..682427.61 rows=165 width=47) (actual time=4330.648..4609.647 rows=1501 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=643335.63..677075.64 rows=453 width=51) (actual time=4289.895..4567.536 rows=4128 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.022..153.439 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=643333.50..643333.50 rows=170 width=43) (actual time=4288.855..4288.855 rows=1895 loops=3)
                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 600kB
                                                         ->  Parallel Hash Join  (cost=155467.08..643333.50 rows=170 width=43) (actual time=4030.170..4239.069 rows=1895 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Hash Join  (cost=81911.39..562103.89 rows=353 width=31) (actual time=1429.366..3349.127 rows=2184 loops=3)
                                                                     Hash Cond: (ci.role_id = rt.id)
                                                                     ->  Parallel Hash Join  (cost=81910.23..562087.69 rows=4234 width=35) (actual time=1429.292..3348.223 rows=2185 loops=3)
                                                                           Hash Cond: (ci.person_id = n.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.085..2764.750 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=536.735..536.736 rows=16670 loops=3)
                                                                                 Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=220.922..523.814 rows=16670 loops=3)
                                                                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                       Rows Removed by Filter: 1372493
                                                                     ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.054..0.056 rows=1 loops=3)
                                                                                 Filter: ((role)::text = 'actress'::text)
                                                                                 Rows Removed by Filter: 11
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=656.905..656.906 rows=1046780 loops=3)
                                                                     Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.062..295.546 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.331..39.331 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4352kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.028..25.496 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 16.057 ms
 Execution Time: 5216.440 ms
(51 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9d.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=756571.53..756571.54 rows=1 width=128) (actual time=6533.566..6533.566 rows=1 loops=1)
   ->  Gather  (cost=756571.30..756571.51 rows=2 width=128) (actual time=6525.522..6756.047 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=755571.30..755571.31 rows=1 width=128) (actual time=6518.502..6518.502 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=738933.47..755496.36 rows=7494 width=64) (actual time=6330.972..6445.460 rows=161027 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.127..73.448 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=738892.70..738892.70 rows=3262 width=56) (actual time=6142.730..6142.730 rows=57856 loops=3)
                           Buckets: 32768 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2848kB
                           ->  Parallel Hash Join  (cost=688395.99..738892.70 rows=3262 width=56) (actual time=5844.345..6087.830 rows=57856 loops=3)
                                 Hash Cond: (t.id = ci.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.024..226.124 rows=842771 loops=3)
                                 ->  Parallel Hash  (cost=688355.22..688355.22 rows=3262 width=47) (actual time=5291.494..5291.494 rows=57856 loops=3)
                                       Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2432kB
                                       ->  Parallel Hash Join  (cost=654556.12..688355.22 rows=3262 width=47) (actual time=5001.252..5232.233 rows=57856 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=649205.34..682980.87 rows=8976 width=51) (actual time=4960.786..5161.985 rows=142133 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.023..156.899 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=649163.11..649163.11 rows=3378 width=43) (actual time=4569.710..4569.711 rows=85164 loops=3)
                                                         Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2976kB
                                                         ->  Parallel Hash Join  (cost=158158.83..649163.11 rows=3378 width=43) (actual time=4272.823..4481.192 rows=85164 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Hash Join  (cost=84603.14..567826.09 rows=6986 width=31) (actual time=3440.610..3553.981 rows=92002 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Hash Join  (cost=1.16..480518.83 rows=30581 width=12) (actual time=896.076..2844.601 rows=92055 loops=3)
                                                                           Hash Cond: (ci.role_id = rt.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.104..2781.477 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.049..0.050 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.045..0.047 rows=1 loops=3)
                                                                                       Filter: ((role)::text = 'actress'::text)
                                                                                       Rows Removed by Filter: 11
                                                                     ->  Parallel Hash  (cost=77318.68..77318.68 rows=396664 width=19) (actual time=548.002..548.002 rows=320518 loops=3)
                                                                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                                                                           ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=396664 width=19) (actual time=181.072..438.030 rows=320518 loops=3)
                                                                                 Filter: ((gender)::text = 'f'::text)
                                                                                 Rows Removed by Filter: 1068645
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=668.535..668.535 rows=1046780 loops=3)
                                                                     Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.075..298.592 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.597..39.597 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.031..25.403 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 15.394 ms
 Execution Time: 6757.211 ms
(51 rows)

