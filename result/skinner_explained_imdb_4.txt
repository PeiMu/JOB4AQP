execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10a.sql_explained.sql
SET
SET
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=629274.70..629274.71 rows=1 width=64) (actual time=3954.557..3954.557 rows=1 loops=1)
   ->  Gather  (cost=629274.48..629274.69 rows=2 width=64) (actual time=3954.099..3961.848 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=628274.48..628274.49 rows=1 width=64) (actual time=3946.954..3946.955 rows=1 loops=3)
               ->  Hash Join  (cost=567292.56..628274.47 rows=2 width=33) (actual time=3553.483..3946.869 rows=35 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=567291.47..628273.38 rows=2 width=37) (actual time=3553.217..3946.586 rows=35 loops=3)
                           Hash Cond: (chn.id = ci.person_role_id)
                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.060..266.538 rows=1046780 loops=3)
                           ->  Parallel Hash  (cost=567291.40..567291.40 rows=5 width=25) (actual time=3551.871..3551.871 rows=37 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=516526.82..567291.40 rows=5 width=25) (actual time=3424.136..3551.727 rows=37 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.020..267.623 rows=337640 loops=3)
                                             Filter: (production_year > 2005)
                                             Rows Removed by Filter: 505131
                                       ->  Parallel Hash  (cost=516526.68..516526.68 rows=11 width=16) (actual time=3246.037..3246.037 rows=92 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=483987.14..516526.68 rows=11 width=16) (actual time=3001.145..3245.853 rows=92 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Hash Join  (cost=4733.23..37248.39 rows=6486 width=8) (actual time=23.777..308.774 rows=2930 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..164.897 rows=869710 loops=3)
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=825 width=4) (actual time=22.975..22.975 rows=454 loops=3)
                                                               Buckets: 2048  Batches: 1  Memory Usage: 112kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=825 width=4) (actual time=0.058..22.490 rows=454 loops=3)
                                                                     Filter: ((country_code)::text = '[ru]'::text)
                                                                     Rows Removed by Filter: 77879
                                                   ->  Parallel Hash  (cost=479245.16..479245.16 rows=700 width=8) (actual time=2935.784..2935.784 rows=8625 loops=3)
                                                         Buckets: 32768 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 1552kB
                                                         ->  Hash Join  (cost=1.16..479245.16 rows=700 width=8) (actual time=0.847..2810.472 rows=8625 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=8405 width=12) (actual time=0.722..2805.446 rows=10763 loops=3)
                                                                     Filter: (((note)::text ~~ '%(voice)%'::text) AND ((note)::text ~~ '%(uncredited)%'::text))
                                                                     Rows Removed by Filter: 12070685
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.048..0.049 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.035..0.038 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actor'::text)
                                                                           Rows Removed by Filter: 11
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.057..0.057 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.035..0.036 rows=4 loops=3)
 Planning Time: 8.356 ms
 Execution Time: 3962.542 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10b.sql_explained.sql
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=612898.77..612898.78 rows=1 width=64) (actual time=4371.333..4371.334 rows=1 loops=1)
   ->  Gather  (cost=612898.55..612898.76 rows=2 width=64) (actual time=4368.683..4424.406 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=611898.55..611898.56 rows=1 width=64) (actual time=4361.728..4361.728 rows=1 loops=3)
               ->  Hash Join  (cost=160692.60..611898.28 rows=55 width=33) (actual time=4361.723..4361.723 rows=0 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=160691.51..611896.89 rows=55 width=37) (actual time=4361.475..4361.554 rows=0 loops=3)
                           Hash Cond: (ci.person_role_id = chn.id)
                           ->  Hash Join  (cost=87135.83..530671.90 rows=115 width=25) (actual time=3357.106..3357.106 rows=0 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Hash Join  (cost=87134.66..530665.85 rows=1377 width=29) (actual time=1869.958..3356.889 rows=871 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=551821 width=12) (actual time=450.410..2729.992 rows=478480 loops=3)
                                             Filter: ((note)::text ~~ '%(producer)%'::text)
                                             Rows Removed by Filter: 11602968
                                       ->  Parallel Hash  (cost=87121.90..87121.90 rows=1021 width=29) (actual time=573.531..573.531 rows=420 loops=3)
                                             Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                             ->  Parallel Hash Join  (cost=37329.47..87121.90 rows=1021 width=29) (actual time=308.874..572.997 rows=420 loops=3)
                                                   Hash Cond: (t.id = mc.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.018..246.191 rows=130555 loops=3)
                                                         Filter: (production_year > 2010)
                                                         Rows Removed by Filter: 712215
                                                   ->  Parallel Hash  (cost=37248.39..37248.39 rows=6486 width=8) (actual time=305.631..305.631 rows=2930 loops=3)
                                                         Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                         ->  Parallel Hash Join  (cost=4733.23..37248.39 rows=6486 width=8) (actual time=23.428..303.873 rows=2930 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.010..159.075 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=825 width=4) (actual time=22.928..22.929 rows=454 loops=3)
                                                                     Buckets: 2048  Batches: 1  Memory Usage: 112kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=825 width=4) (actual time=0.047..22.402 rows=454 loops=3)
                                                                           Filter: ((country_code)::text = '[ru]'::text)
                                                                           Rows Removed by Filter: 77879
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.041..0.044 rows=1 loops=3)
                                             Filter: ((role)::text = 'actor'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=635.814..635.814 rows=1046780 loops=3)
                                 Buckets: 65536  Batches: 64  Memory Usage: 3232kB
                                 ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.070..294.951 rows=1046780 loops=3)
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.056..0.056 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.028..0.030 rows=4 loops=3)
 Planning Time: 8.169 ms
 Execution Time: 4426.893 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10c.sql_explained.sql
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=652016.30..652016.31 rows=1 width=64) (actual time=4967.036..4967.036 rows=1 loops=1)
   ->  Gather  (cost=652016.08..652016.29 rows=2 width=64) (actual time=4963.565..5056.711 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=651016.08..651016.09 rows=1 width=64) (actual time=4956.608..4956.609 rows=1 loops=3)
               ->  Hash Join  (cost=609518.31..650122.02 rows=178812 width=33) (actual time=4917.502..4956.574 rows=3 loops=3)
                     Hash Cond: (ci.role_id = rt.id)
                     ->  Hash Join  (cost=609517.04..649485.59 rows=178812 width=37) (actual time=4917.233..4956.304 rows=3 loops=3)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=609515.95..648517.80 rows=178812 width=41) (actual time=4917.130..4956.199 rows=3 loops=3)
                                 Hash Cond: (mc.movie_id = t.id)
                                 ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=8) (actual time=30.273..392.471 rows=384599 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..155.691 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=30.051..30.051 rows=28281 loops=3)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.023..19.102 rows=28281 loops=3)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=600222.44..600222.44 rows=185178 width=45) (actual time=4408.796..4408.796 rows=4 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 576kB
                                       ->  Parallel Hash Join  (cost=136144.88..600222.44 rows=185178 width=45) (actual time=4317.144..4407.493 rows=4 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Hash Join  (cost=73555.68..529520.84 rows=266824 width=24) (actual time=3624.252..3792.591 rows=5 loops=3)
                                                   Hash Cond: (ci.person_role_id = chn.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=551821 width=12) (actual time=311.862..2750.443 rows=478480 loops=3)
                                                         Filter: ((note)::text ~~ '%(producer)%'::text)
                                                         Rows Removed by Filter: 11602968
                                                   ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=649.441..649.442 rows=1046780 loops=3)
                                                         Buckets: 65536  Batches: 64  Memory Usage: 3232kB
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.052..289.547 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=49166.29..49166.29 rows=731112 width=21) (actual time=489.899..489.899 rows=583011 loops=3)
                                                   Buckets: 65536  Batches: 32  Memory Usage: 3648kB
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.036..294.344 rows=583011 loops=3)
                                                         Filter: (production_year > 1990)
                                                         Rows Removed by Filter: 259760
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.039..0.040 rows=4 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.027..0.028 rows=4 loops=3)
                     ->  Hash  (cost=1.12..1.12 rows=12 width=4) (actual time=0.057..0.057 rows=12 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on role_type rt  (cost=0.00..1.12 rows=12 width=4) (actual time=0.034..0.037 rows=12 loops=3)
 Planning Time: 8.024 ms
 Execution Time: 5057.397 ms
(44 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11a.sql_explained.sql
SET
SET
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=25460.06..25460.07 rows=1 width=96) (actual time=346.164..346.164 rows=1 loops=1)
   ->  Gather  (cost=19952.24..25460.06 rows=1 width=118) (actual time=298.843..351.003 rows=310 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Parallel Hash Join  (cost=18952.24..24459.96 rows=1 width=118) (actual time=301.053..340.413 rows=155 loops=2)
               Hash Cond: (cn.id = mc.company_id)
               ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.020..45.729 rows=24151 loops=2)
                     Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                     Rows Removed by Filter: 93348
               ->  Parallel Hash  (cost=18952.23..18952.23 rows=1 width=103) (actual time=291.454..291.454 rows=332 loops=2)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Hash Join  (cost=8687.12..18952.23 rows=1 width=103) (actual time=167.252..291.111 rows=332 loops=2)
                           Hash Cond: (mk.keyword_id = k.id)
                           ->  Merge Join  (cost=6060.98..16306.51 rows=7458 width=107) (actual time=109.285..261.094 rows=16065 loops=2)
                                 Merge Cond: (ml.movie_id = mk.movie_id)
                                 ->  Merge Join  (cost=6016.36..13086.62 rows=160 width=115) (actual time=109.195..222.004 rows=1397 loops=2)
                                       Merge Cond: (t.id = ml.movie_id)
                                       ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=379985 width=21) (actual time=0.041..110.161 rows=26100 loops=2)
                                             Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                             Rows Removed by Filter: 56295
                                       ->  Sort  (cost=6015.92..6018.59 rows=1065 width=94) (actual time=108.416..108.739 rows=4393 loops=2)
                                             Sort Key: mc.movie_id
                                             Sort Method: quicksort  Memory: 536kB
                                             Worker 0:  Sort Method: quicksort  Memory: 536kB
                                             ->  Hash Join  (cost=652.13..5962.37 rows=1065 width=94) (actual time=12.743..106.281 rows=4393 loops=2)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Merge Join  (cost=651.06..5938.28 rows=4260 width=98) (actual time=12.651..104.858 rows=5069 loops=2)
                                                         Merge Cond: (mc.movie_id = ml.movie_id)
                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.065..86.469 rows=49142 loops=2)
                                                               Filter: (note IS NULL)
                                                               Rows Removed by Filter: 50735
                                                         ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.467..12.858 rows=5369 loops=2)
                                                               Sort Key: ml.movie_id
                                                               Sort Method: quicksort  Memory: 205kB
                                                               Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                               ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.143..11.263 rows=2315 loops=2)
                                                                     Hash Cond: (ml.link_type_id = lt.id)
                                                                     ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.024..6.923 rows=29997 loops=2)
                                                                     ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.049..0.049 rows=2 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.032..0.037 rows=2 loops=2)
                                                                                 Filter: ((link)::text ~~ '%follow%'::text)
                                                                                 Rows Removed by Filter: 16
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.043..0.044 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.031..0.032 rows=1 loops=2)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                                 ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.015..27.319 rows=96539 loops=2)
                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=28.398..28.398 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.495..28.377 rows=1 loops=2)
                                       Filter: ((keyword)::text = 'sequel'::text)
                                       Rows Removed by Filter: 134169
 Planning Time: 14.624 ms
 Execution Time: 351.999 ms
(56 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=37292.30..37292.31 rows=1 width=96) (actual time=502.801..502.801 rows=1 loops=1)
   ->  Hash Join  (cost=15626.08..37292.29 rows=1 width=118) (actual time=390.225..502.779 rows=14 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=12999.94..34666.15 rows=1 width=122) (actual time=369.906..482.452 rows=56 loops=1)
               Merge Cond: (ml.movie_id = mk.movie_id)
               ->  Merge Join  (cost=12999.51..31520.71 rows=1 width=130) (actual time=350.115..462.634 rows=14 loops=1)
                     Merge Cond: (t.id = ml.movie_id)
                     ->  Gather Merge  (cost=1000.45..93601.60 rows=5 width=21) (actual time=267.071..546.155 rows=3 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=2 width=21) (actual time=139.218..415.235 rows=3 loops=3)
                                 Filter: (((title)::text ~~ '%Money%'::text) AND (production_year = 1998))
                                 Rows Removed by Filter: 280859
                     ->  Sort  (cost=11999.06..11999.54 rows=192 width=109) (actual time=82.990..83.019 rows=450 loops=1)
                           Sort Key: mc.movie_id
                           Sort Method: quicksort  Memory: 61kB
                           ->  Gather  (cost=7378.27..11991.77 rows=192 width=109) (actual time=63.248..83.885 rows=450 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Hash Join  (cost=6378.27..10972.57 rows=80 width=109) (actual time=58.613..75.665 rows=150 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=6377.21..10969.78 rows=321 width=113) (actual time=58.436..75.444 rows=153 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Merge Join  (cost=651.06..5238.97 rows=1775 width=98) (actual time=8.653..27.036 rows=692 loops=3)
                                                   Merge Cond: (mc.movie_id = ml.movie_id)
                                                   ->  Parallel Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..116330.44 rows=530595 width=12) (actual time=0.125..16.885 rows=16381 loops=3)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 16912
                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=8.430..8.538 rows=1516 loops=3)
                                                         Sort Key: ml.movie_id
                                                         Sort Method: quicksort  Memory: 103kB
                                                         Worker 0:  Sort Method: quicksort  Memory: 103kB
                                                         Worker 1:  Sort Method: quicksort  Memory: 103kB
                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.167..7.793 rows=1158 loops=3)
                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.034..3.746 rows=29997 loops=3)
                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.059..0.059 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.042..0.047 rows=1 loops=3)
                                                                           Filter: ((link)::text ~~ '%follows%'::text)
                                                                           Rows Removed by Filter: 17
                                             ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=47.320..47.320 rows=16101 loops=3)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.035..36.481 rows=16101 loops=3)
                                                         Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                         Rows Removed by Filter: 62232
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=3)
                                                   Filter: ((kind)::text = 'production companies'::text)
                                                   Rows Removed by Filter: 3
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.031..12.880 rows=69469 loops=1)
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.259..20.259 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.261..20.248 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 13.919 ms
 Execution Time: 671.262 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11c.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=26126.74..26126.75 rows=1 width=96) (actual time=676.290..676.290 rows=1 loops=1)
   ->  Hash Join  (cost=22974.01..26126.73 rows=1 width=60) (actual time=528.375..672.435 rows=6946 loops=1)
         Hash Cond: (ml.link_type_id = lt.id)
         ->  Hash Join  (cost=22972.60..26125.32 rows=1 width=64) (actual time=528.259..670.767 rows=6946 loops=1)
               Hash Cond: (mk.keyword_id = k.id)
               ->  Merge Join  (cost=20178.73..23330.26 rows=454 width=68) (actual time=304.330..560.925 rows=780776 loops=1)
                     Merge Cond: (mk.movie_id = ml.movie_id)
                     ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.047..25.117 rows=77819 loops=1)
                     ->  Sort  (cost=20178.30..20178.32 rows=10 width=76) (actual time=302.840..354.046 rows=780794 loops=1)
                           Sort Key: mc.movie_id
                           Sort Method: quicksort  Memory: 1609kB
                           ->  Gather  (cost=6420.11..20178.13 rows=10 width=76) (actual time=71.065..298.352 rows=8393 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Hash Join  (cost=5420.11..19177.13 rows=4 width=76) (actual time=64.778..236.229 rows=2798 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=5419.02..19176.02 rows=5 width=80) (actual time=64.597..235.172 rows=2801 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Merge Join  (cost=4.62..13682.01 rows=30328 width=65) (actual time=1.009..193.702 rows=34978 loops=3)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=2.03..8120.68 rows=11307 width=29) (actual time=0.519..122.020 rows=9909 loops=3)
                                                         Merge Cond: (t.id = ml.movie_id)
                                                         ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..89967.34 rows=952979 width=21) (actual time=0.163..102.965 rows=59309 loops=3)
                                                               Filter: (production_year > 1950)
                                                               Rows Removed by Filter: 2750
                                                         ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=8) (actual time=0.063..8.965 rows=29997 loops=3)
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1335700 width=36) (actual time=0.049..60.636 rows=77963 loops=3)
                                                         Filter: (note IS NOT NULL)
                                                         Rows Removed by Filter: 66967
                                             ->  Parallel Hash  (cost=5414.09..5414.09 rows=25 width=23) (actual time=36.526..36.526 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=25 width=23) (actual time=0.403..36.413 rows=30 loops=3)
                                                         Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '20th Century Fox%'::text) OR ((name)::text ~~ 'Twentieth Century Fox%'::text)))
                                                         Rows Removed by Filter: 78303
                                       ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.056..0.056 rows=3 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=3 width=4) (actual time=0.034..0.036 rows=3 loops=3)
                                                   Filter: ((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))
                                                   Rows Removed by Filter: 1
               ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=43.655..43.655 rows=3 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=1.690..43.640 rows=3 loops=1)
                           Filter: ((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))
                           Rows Removed by Filter: 134167
         ->  Hash  (cost=1.18..1.18 rows=18 width=4) (actual time=0.050..0.050 rows=18 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=4) (actual time=0.032..0.035 rows=18 loops=1)
 Planning Time: 14.628 ms
 Execution Time: 677.526 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11d.sql_explained.sql
SET
SET
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=34220.63..34220.64 rows=1 width=96) (actual time=339.487..339.487 rows=1 loops=1)
   ->  Hash Join  (cost=26974.32..34220.25 rows=51 width=60) (actual time=256.050..334.007 rows=14899 loops=1)
         Hash Cond: (cn.id = mc.company_id)
         ->  Seq Scan on company_name cn  (cost=0.00..5932.46 rows=210072 width=23) (actual time=0.038..56.021 rows=210031 loops=1)
               Filter: ((country_code)::text <> '[pl]'::text)
               Rows Removed by Filter: 24966
         ->  Hash  (cost=26973.61..26973.61 rows=57 width=45) (actual time=255.920..255.920 rows=14916 loops=1)
               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1231kB
               ->  Hash Join  (cost=21742.73..26973.61 rows=57 width=45) (actual time=211.626..249.583 rows=14916 loops=1)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Merge Join  (cost=21741.65..26972.11 rows=76 width=49) (actual time=211.530..245.866 rows=15510 loops=1)
                           Merge Cond: (mc.movie_id = ml.movie_id)
                           ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1335700 width=36) (actual time=0.024..26.808 rows=42219 loops=1)
                                 Filter: (note IS NOT NULL)
                                 Rows Removed by Filter: 41437
                           ->  Sort  (cost=21741.22..21741.29 rows=28 width=29) (actual time=211.256..212.312 rows=15913 loops=1)
                                 Sort Key: mk.movie_id
                                 Sort Method: quicksort  Memory: 159kB
                                 ->  Gather  (cost=3836.65..21740.54 rows=28 width=29) (actual time=40.776..210.587 rows=1460 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 2
                                       ->  Hash Join  (cost=2836.65..20737.74 rows=12 width=29) (actual time=39.472..199.671 rows=487 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Hash Join  (cost=2835.24..20736.30 rows=12 width=33) (actual time=39.279..199.328 rows=487 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Merge Join  (cost=41.37..16560.07 rows=526594 width=37) (actual time=0.531..163.146 rows=95464 loops=3)
                                                         Merge Cond: (ml.movie_id = mk.movie_id)
                                                         ->  Merge Join  (cost=2.03..8120.68 rows=11307 width=29) (actual time=0.287..96.913 rows=9909 loops=3)
                                                               Merge Cond: (t.id = ml.movie_id)
                                                               ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..89967.34 rows=952979 width=21) (actual time=0.035..80.100 rows=59309 loops=3)
                                                                     Filter: (production_year > 1950)
                                                                     Rows Removed by Filter: 2750
                                                               ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=8) (actual time=0.055..7.019 rows=29997 loops=3)
                                                         ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.055..37.175 rows=175267 loops=3)
                                                   ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=27.275..27.275 rows=3 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=1.136..27.261 rows=3 loops=3)
                                                               Filter: ((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))
                                                               Rows Removed by Filter: 134167
                                             ->  Hash  (cost=1.18..1.18 rows=18 width=4) (actual time=0.060..0.060 rows=18 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=4) (actual time=0.036..0.039 rows=18 loops=3)
                     ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.044..0.044 rows=3 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=3 width=4) (actual time=0.023..0.025 rows=3 loops=1)
                                 Filter: ((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))
                                 Rows Removed by Filter: 1
 Planning Time: 13.344 ms
 Execution Time: 340.457 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12a.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=346907.90..346907.91 rows=1 width=96) (actual time=3509.539..3509.539 rows=1 loops=1)
   ->  Gather  (cost=346907.78..346907.89 rows=1 width=96) (actual time=3509.208..3514.567 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=345907.78..345907.79 rows=1 width=96) (actual time=3503.729..3503.729 rows=1 loops=2)
               ->  Hash Join  (cost=340996.48..345907.77 rows=1 width=41) (actual time=3474.096..3503.515 rows=198 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=340995.42..345906.71 rows=1 width=45) (actual time=3473.877..3503.196 rows=354 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.016..24.068 rows=42422 loops=2)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 75077
                           ->  Parallel Hash  (cost=340995.41..340995.41 rows=1 width=30) (actual time=3473.422..3473.423 rows=967 loops=2)
                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                 ->  Parallel Hash Join  (cost=307257.26..340995.41 rows=1 width=30) (actual time=2931.927..3334.034 rows=967 loops=2)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.006..233.712 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=307257.25..307257.25 rows=1 width=34) (actual time=2926.234..2926.234 rows=278 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=254758.25..307257.25 rows=1 width=34) (actual time=2537.231..2925.826 rows=278 loops=2)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=186410 width=21) (actual time=0.034..373.046 rows=222930 loops=2)
                                                         Filter: ((production_year >= 2005) AND (production_year <= 2008))
                                                         Rows Removed by Filter: 1041226
                                                   ->  Parallel Hash  (cost=254758.24..254758.24 rows=1 width=13) (actual time=2518.188..2518.188 rows=972 loops=2)
                                                         Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                         ->  Parallel Hash Join  (cost=15184.50..254758.24 rows=1 width=13) (actual time=2145.607..2424.976 rows=972 loops=2)
                                                               Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                               ->  Hash Join  (cost=2.43..239572.30 rows=1028 width=4) (actual time=1918.920..2177.746 rows=136360 loops=2)
                                                                     Hash Cond: (mi.info_type_id = it1.id)
                                                                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=116213 width=8) (actual time=1333.928..2143.259 rows=137322 loops=2)
                                                                           Filter: ((info)::text = ANY ('{Drama,Horror}'::text[]))
                                                                           Rows Removed by Filter: 7280538
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.015..0.027 rows=1 loops=2)
                                                                                 Filter: ((info)::text = 'genres'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=15179.85..15179.85 rows=178 width=9) (actual time=226.441..226.441 rows=7924 loops=2)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                     ->  Hash Join  (cost=2.43..15179.85 rows=178 width=9) (actual time=0.223..197.390 rows=7924 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.063..191.088 rows=26824 loops=2)
                                                                                 Filter: ((info)::text > '8.0'::text)
                                                                                 Rows Removed by Filter: 663193
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.035 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 14.561 ms
 Execution Time: 3515.294 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12b.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348978.79..348978.80 rows=1 width=64) (actual time=3729.588..3729.589 rows=1 loops=1)
   ->  Gather  (cost=348978.68..348978.79 rows=1 width=64) (actual time=3729.277..3734.756 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347978.68..347978.69 rows=1 width=64) (actual time=3723.878..3723.878 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343067.38..347978.67 rows=1 width=60) (actual time=3703.597..3723.843 rows=5 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.015..23.999 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343067.37..343067.37 rows=1 width=64) (actual time=3695.162..3695.162 rows=16 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102227.57..343067.37 rows=1 width=64) (actual time=2709.694..3695.106 rows=16 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=1494.512..2585.955 rows=60932 loops=2)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.027..1648.018 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.042..0.042 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'budget'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102225.13..102225.13 rows=1 width=33) (actual time=1102.882..1102.882 rows=16 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=86954.86..102225.13 rows=1 width=33) (actual time=1102.789..1102.808 rows=16 loops=2)
                                             Hash Cond: (mi_idx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=201.062..201.065 rows=5 loops=2)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.022..117.130 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=2)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86951.75..86951.75 rows=55 width=29) (actual time=901.652..901.652 rows=1984 loops=2)
                                                   Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 376kB
                                                   ->  Hash Join  (cost=54436.04..86951.75 rows=55 width=29) (actual time=465.464..890.793 rows=1984 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Parallel Hash Join  (cost=54434.96..86950.06 rows=111 width=33) (actual time=465.343..889.803 rows=1984 loops=2)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..235.264 rows=1304564 loops=2)
                                                               ->  Parallel Hash  (cost=54433.61..54433.61 rows=108 width=21) (actual time=464.477..464.477 rows=1268 loops=2)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=108 width=21) (actual time=0.706..462.019 rows=1268 loops=2)
                                                                           Filter: ((production_year > 2000) AND (((title)::text ~~ 'Birdemic%'::text) OR ((title)::text ~~ '%Movie%'::text)))
                                                                           Rows Removed by Filter: 1262888
                                                         ->  Hash  (cost=1.06..1.06 rows=2 width=4) (actual time=0.055..0.055 rows=2 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.06 rows=2 width=4) (actual time=0.034..0.036 rows=2 loops=2)
                                                                     Filter: ((kind IS NOT NULL) AND (((kind)::text = 'production companies'::text) OR ((kind)::text = 'distributors'::text)))
                                                                     Rows Removed by Filter: 2
 Planning Time: 14.066 ms
 Execution Time: 3735.561 ms
(53 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12c.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=363505.12..363505.13 rows=1 width=96) (actual time=3858.143..3858.144 rows=1 loops=1)
   ->  Gather  (cost=363505.00..363505.11 rows=1 width=96) (actual time=3857.506..3863.256 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=362505.00..362505.01 rows=1 width=96) (actual time=3852.092..3852.092 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=357593.71..362504.99 rows=1 width=41) (actual time=3819.515..3850.806 rows=2356 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.015..24.473 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=357593.68..357593.68 rows=2 width=26) (actual time=3818.888..3818.888 rows=7768 loops=2)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1176kB
                           ->  Hash Join  (cost=323855.49..357593.68 rows=2 width=26) (actual time=3585.295..3796.197 rows=7768 loops=2)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=323854.42..357592.57 rows=10 width=30) (actual time=3361.480..3791.754 rows=22503 loops=2)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.006..229.893 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=323854.40..323854.40 rows=2 width=34) (actual time=3361.240..3361.240 rows=3982 loops=2)
                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                             ->  Parallel Hash Join  (cost=270431.08..323854.40 rows=2 width=34) (actual time=2875.863..3350.607 rows=3982 loops=2)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=432897 width=21) (actual time=0.029..398.678 rows=521400 loops=2)
                                                         Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                         Rows Removed by Filter: 742756
                                                   ->  Parallel Hash  (cost=270431.01..270431.01 rows=5 width=13) (actual time=2875.160..2875.160 rows=11094 loops=2)
                                                         Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1592kB
                                                         ->  Parallel Hash Join  (cost=15354.10..270431.01 rows=5 width=13) (actual time=2495.594..2846.000 rows=11094 loops=2)
                                                               Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                               ->  Hash Join  (cost=2.43..255074.87 rows=1187 width=4) (actual time=2233.340..2546.035 rows=162628 loops=2)
                                                                     Hash Cond: (mi.info_type_id = it1.id)
                                                                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=134092 width=8) (actual time=1555.962..2505.348 rows=163656 loops=2)
                                                                           Filter: ((info)::text = ANY ('{Drama,Horror,Western,Family}'::text[]))
                                                                           Rows Removed by Filter: 7254204
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.029 rows=1 loops=2)
                                                                                 Filter: ((info)::text = 'genres'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=15342.82..15342.82 rows=708 width=9) (actual time=262.138..262.138 rows=60786 loops=2)
                                                                     Buckets: 131072 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 6832kB
                                                                     ->  Hash Join  (cost=2.43..15342.82 rows=708 width=9) (actual time=0.160..222.942 rows=60786 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=79942 width=13) (actual time=0.058..201.385 rows=96948 loops=2)
                                                                                 Filter: ((info)::text > '7.0'::text)
                                                                                 Rows Removed by Filter: 593070
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.044 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.031..0.034 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.031..0.033 rows=1 loops=2)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
 Planning Time: 14.022 ms
 Execution Time: 3864.091 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13a.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=345137.34..345137.35 rows=1 width=96) (actual time=3304.567..3304.567 rows=1 loops=1)
   ->  Gather  (cost=345137.12..345137.33 rows=2 width=96) (actual time=3299.768..3323.145 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=344137.12..344137.13 rows=1 width=96) (actual time=3291.900..3291.900 rows=1 loops=3)
               ->  Hash Join  (cost=293653.26..344137.03 rows=11 width=65) (actual time=3111.434..3275.742 rows=37034 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=293652.16..344135.60 rows=79 width=69) (actual time=2893.290..3264.887 rows=44730 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.010..217.684 rows=842771 loops=3)
                           ->  Parallel Hash  (cost=293651.17..293651.17 rows=79 width=60) (actual time=2892.446..2892.446 rows=44730 loops=3)
                                 Buckets: 262144 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 13880kB
                                 ->  Parallel Hash Join  (cost=52811.08..293651.17 rows=79 width=60) (actual time=1186.139..2807.509 rows=44730 loops=3)
                                       Hash Cond: (mi.movie_id = mc.movie_id)
                                       ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=461.182..1947.341 rows=1012240 loops=3)
                                             Hash Cond: (mi.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.053..1171.819 rows=4945240 loops=3)
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.032..0.032 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.019..0.030 rows=1 loops=3)
                                                         Filter: ((info)::text = 'release dates'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=52805.23..52805.23 rows=274 width=13) (actual time=723.377..723.377 rows=10503 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2008kB
                                             ->  Hash Join  (cost=20112.16..52805.23 rows=274 width=13) (actual time=645.389..694.368 rows=10503 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Hash Join  (cost=20111.09..52798.24 rows=1095 width=17) (actual time=643.861..690.211 rows=27966 loops=3)
                                                         Hash Cond: (mc.movie_id = miidx.movie_id)
                                                         ->  Parallel Hash Join  (cost=4793.88..37309.04 rows=44647 width=8) (actual time=24.919..327.276 rows=49377 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.018..165.782 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=5677 width=4) (actual time=24.695..24.695 rows=3258 loops=3)
                                                                     Buckets: 16384  Batches: 1  Memory Usage: 576kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=5677 width=4) (actual time=0.037..22.457 rows=3258 loops=3)
                                                                           Filter: ((country_code)::text = '[de]'::text)
                                                                           Rows Removed by Filter: 75074
                                                         ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=290.486..290.487 rows=153308 loops=3)
                                                               Buckets: 131072 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 3328kB
                                                               ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.160..167.041 rows=153308 loops=3)
                                                                     Hash Cond: (miidx.info_type_id = it.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.044..80.400 rows=460012 loops=3)
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.041 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'rating'::text)
                                                                                 Rows Removed by Filter: 112
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.032..0.033 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.070..0.070 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 20.618 ms
 Execution Time: 3324.055 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13b.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348980.78..348980.79 rows=1 width=96) (actual time=4245.486..4245.486 rows=1 loops=1)
   ->  Gather  (cost=348980.66..348980.77 rows=1 width=96) (actual time=4245.244..4250.651 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347980.66..347980.67 rows=1 width=96) (actual time=4239.732..4239.733 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343069.37..347980.65 rows=1 width=41) (actual time=4211.531..4239.590 rows=186 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.016..23.985 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343069.35..343069.35 rows=1 width=26) (actual time=4210.670..4210.670 rows=313 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102229.55..343069.35 rows=1 width=26) (actual time=2429.443..4210.501 rows=313 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=669.732..2766.364 rows=1518360 loops=2)
                                       Hash Cond: (mi.info_type_id = it2.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.032..1650.499 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.035 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102227.11..102227.11 rows=1 width=38) (actual time=1297.996..1297.997 rows=58 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=86956.85..102227.11 rows=1 width=38) (actual time=1139.428..1297.904 rows=58 loops=2)
                                             Hash Cond: (miidx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.138..239.544 rows=229962 loops=2)
                                                   Hash Cond: (miidx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.019..116.238 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.043 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86954.33..86954.33 rows=7 width=29) (actual time=1034.224..1034.224 rows=178 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=54438.22..86954.33 rows=7 width=29) (actual time=906.787..1034.012 rows=178 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Hash Join  (cost=54437.16..86953.12 rows=29 width=33) (actual time=685.523..1033.803 rows=384 loops=2)
                                                               Hash Cond: (t.kind_id = kt.id)
                                                               ->  Parallel Hash Join  (cost=54436.06..86951.16 rows=202 width=37) (actual time=611.698..1033.376 rows=1330 loops=2)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.006..234.855 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=54433.61..54433.61 rows=196 width=25) (actual time=611.446..611.446 rows=1109 loops=2)
                                                                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=196 width=25) (actual time=0.077..609.627 rows=1109 loops=2)
                                                                                 Filter: (((title)::text <> ''::text) AND (((title)::text ~~ '%Champion%'::text) OR ((title)::text ~~ '%Loser%'::text)))
                                                                                 Rows Removed by Filter: 1263047
                                                               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=2)
                                                                           Filter: ((kind)::text = 'movie'::text)
                                                                           Rows Removed by Filter: 6
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
 Planning Time: 21.028 ms
 Execution Time: 4251.548 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13c.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348980.78..348980.79 rows=1 width=96) (actual time=4102.612..4102.613 rows=1 loops=1)
   ->  Gather  (cost=348980.66..348980.77 rows=1 width=96) (actual time=4102.410..4107.825 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347980.66..347980.67 rows=1 width=96) (actual time=4096.973..4096.973 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343069.37..347980.65 rows=1 width=41) (actual time=4073.418..4096.914 rows=26 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.015..24.026 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343069.35..343069.35 rows=1 width=26) (actual time=4068.249..4068.250 rows=81 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102229.55..343069.35 rows=1 width=26) (actual time=2320.201..4068.134 rows=81 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=675.353..2790.985 rows=1518360 loops=2)
                                       Hash Cond: (mi.info_type_id = it2.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.034..1675.714 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.023 rows=1 loops=2)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102227.11..102227.11 rows=1 width=38) (actual time=1133.683..1133.683 rows=16 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=86956.85..102227.11 rows=1 width=38) (actual time=1066.473..1133.638 rows=16 loops=2)
                                             Hash Cond: (miidx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.140..238.341 rows=229962 loops=2)
                                                   Hash Cond: (miidx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.026..115.424 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.051 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.039 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86954.33..86954.33 rows=7 width=29) (actual time=872.625..872.625 rows=40 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=54438.22..86954.33 rows=7 width=29) (actual time=769.952..872.548 rows=40 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Hash Join  (cost=54437.16..86953.12 rows=29 width=33) (actual time=560.907..872.424 rows=90 loops=2)
                                                               Hash Cond: (t.kind_id = kt.id)
                                                               ->  Parallel Hash Join  (cost=54436.06..86951.16 rows=202 width=37) (actual time=473.685..872.293 rows=184 loops=2)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.006..231.857 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=54433.61..54433.61 rows=196 width=25) (actual time=473.297..473.297 rows=147 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=196 width=25) (actual time=3.881..473.040 rows=147 loops=2)
                                                                                 Filter: (((title)::text <> ''::text) AND (((title)::text ~~ 'Champion%'::text) OR ((title)::text ~~ 'Loser%'::text)))
                                                                                 Rows Removed by Filter: 1264009
                                                               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=2)
                                                                           Filter: ((kind)::text = 'movie'::text)
                                                                           Rows Removed by Filter: 6
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.031..0.033 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
 Planning Time: 20.697 ms
 Execution Time: 4108.721 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13d.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=346725.46..346725.47 rows=1 width=96) (actual time=9040.593..9040.593 rows=1 loops=1)
   ->  Gather  (cost=346725.34..346725.45 rows=1 width=96) (actual time=9036.627..9260.781 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=345725.34..345725.35 rows=1 width=96) (actual time=9032.055..9032.055 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=340435.70..345724.28 rows=141 width=41) (actual time=8695.956..8907.727 rows=335195 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.027..24.215 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=340432.26..340432.26 rows=275 width=26) (actual time=8646.293..8646.293 rows=959748 loops=2)
                           Buckets: 65536 (originally 1024)  Batches: 64 (originally 1)  Memory Usage: 4352kB
                           ->  Hash Join  (cost=306684.12..340432.26 rows=275 width=26) (actual time=6533.321..7981.541 rows=959748 loops=2)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=306683.05..340425.77 rows=1004 width=30) (actual time=6473.476..7500.224 rows=4061793 loops=2)
                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.014..232.699 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=306680.43..306680.43 rows=210 width=34) (actual time=5884.204..5884.204 rows=362366 loops=2)
                                             Buckets: 65536 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 3680kB
                                             ->  Hash Join  (cost=256185.00..306680.43 rows=210 width=34) (actual time=4994.718..5651.296 rows=362366 loops=2)
                                                   Hash Cond: (t.kind_id = kt.id)
                                                   ->  Parallel Hash Join  (cost=256183.90..306673.14 rows=1468 width=38) (actual time=4978.698..5544.452 rows=559492 loops=2)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.035..330.691 rows=1264156 loops=2)
                                                         ->  Parallel Hash  (cost=256165.55..256165.55 rows=1468 width=13) (actual time=4121.299..4121.299 rows=559492 loops=2)
                                                               Buckets: 131072 (originally 4096)  Batches: 16 (originally 1)  Memory Usage: 4384kB
                                                               ->  Parallel Hash Join  (cost=15319.64..256165.55 rows=1468 width=13) (actual time=3553.995..3896.676 rows=559492 loops=2)
                                                                     Hash Cond: (mi.movie_id = miidx.movie_id)
                                                                     ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=672.356..2797.382 rows=1518360 loops=2)
                                                                           Hash Cond: (mi.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.048..1659.997 rows=7417860 loops=2)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.035 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.032 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=384.453..384.454 rows=229962 loops=2)
                                                                           Buckets: 131072 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 3328kB
                                                                           ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.146..240.441 rows=229962 loops=2)
                                                                                 Hash Cond: (miidx.info_type_id = it.id)
                                                                                 ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.044..112.944 rows=690018 loops=2)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.035 rows=1 loops=2)
                                                                                             Filter: ((info)::text = 'rating'::text)
                                                                                             Rows Removed by Filter: 112
                                                   ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=2)
                                                               Filter: ((kind)::text = 'movie'::text)
                                                               Rows Removed by Filter: 6
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.035 rows=1 loops=2)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
 Planning Time: 20.593 ms
 Execution Time: 9263.604 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14a.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=420522.53..420522.54 rows=1 width=64) (actual time=3608.718..3608.718 rows=1 loops=1)
   ->  Gather  (cost=420522.31..420522.52 rows=2 width=64) (actual time=3607.766..3615.581 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=419522.31..419522.32 rows=1 width=64) (actual time=3600.530..3600.531 rows=1 loops=3)
               ->  Hash Join  (cost=369734.11..419522.30 rows=1 width=22) (actual time=3499.443..3600.257 rows=254 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=369733.01..419521.20 rows=1 width=26) (actual time=3330.030..3599.848 rows=328 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=25) (actual time=0.022..248.898 rows=130555 loops=3)
                                 Filter: (production_year > 2010)
                                 Rows Removed by Filter: 712215
                           ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3326.201..3326.201 rows=6989 loops=3)
                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                 ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=3045.819..3294.410 rows=6989 loops=3)
                                       Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                       ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.175..226.014 rows=151410 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.059..162.043 rows=447629 loops=3)
                                                   Filter: ((info)::text < '8.5'::text)
                                                   Rows Removed by Filter: 12383
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.040 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=3045.074..3045.074 rows=7972 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1496kB
                                             ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2474.150..2993.252 rows=7972 loops=3)
                                                   Hash Cond: (mi.movie_id = mk.movie_id)
                                                   ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1882.896..2372.769 rows=204750 loops=3)
                                                         Hash Cond: (mi.info_type_id = it1.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.591..2321.153 rows=235558 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4709682
                                                         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.048 rows=1 loops=3)
                                                                     Filter: ((info)::text = 'countries'::text)
                                                                     Rows Removed by Filter: 112
                                                   ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=590.707..590.707 rows=12364 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=47.548..497.457 rows=12364 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..261.089 rows=1507977 loops=3)
                                                               ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=47.239..47.239 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.692..47.227 rows=3 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                           Rows Removed by Filter: 134167
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 12.747 ms
 Execution Time: 3616.331 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14b.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=426312.24..426312.25 rows=1 width=64) (actual time=3202.927..3202.927 rows=1 loops=1)
   ->  Gather  (cost=426312.02..426312.23 rows=2 width=64) (actual time=3202.715..3209.873 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=425312.02..425312.03 rows=1 width=64) (actual time=3195.708..3195.709 rows=1 loops=3)
               ->  Hash Join  (cost=409759.67..425312.01 rows=1 width=22) (actual time=3182.314..3195.702 rows=0 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=409758.57..425310.91 rows=1 width=26) (actual time=3124.603..3195.450 rows=1 loops=3)
                           Hash Cond: (mi_idx.movie_id = t.id)
                           ->  Hash Join  (cost=2.43..15549.59 rows=1379 width=9) (actual time=0.156..166.632 rows=86616 loops=3)
                                 Hash Cond: (mi_idx.info_type_id = it2.id)
                                 ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=155862 width=13) (actual time=0.045..141.297 rows=125612 loops=3)
                                       Filter: ((info)::text > '6.0'::text)
                                       Rows Removed by Filter: 334399
                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.023..0.026 rows=1 loops=3)
                                             Filter: ((info)::text = 'rating'::text)
                                             Rows Removed by Filter: 112
                           ->  Parallel Hash  (cost=409756.13..409756.13 rows=1 width=33) (actual time=3019.060..3019.060 rows=3 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=361504.10..409756.13 rows=1 width=33) (actual time=2694.920..3018.957 rows=3 loops=3)
                                       Hash Cond: (mk.movie_id = t.id)
                                       ->  Hash Join  (cost=2626.15..50878.06 rows=28 width=4) (actual time=24.077..465.255 rows=6509 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.011..255.707 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=2 width=4) (actual time=23.908..23.909 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=2 width=4) (actual time=1.363..23.891 rows=1 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title}'::text[]))
                                                         Rows Removed by Filter: 134169
                                       ->  Parallel Hash  (cost=358877.94..358877.94 rows=1 width=29) (actual time=2551.910..2551.910 rows=41 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=57070.27..358877.94 rows=1 width=29) (actual time=2105.067..2551.765 rows=41 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=57067.84..358875.48 rows=12 width=33) (actual time=297.475..2551.630 rows=49 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=0.983..2251.459 rows=235558 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4709682
                                                         ->  Parallel Hash  (cost=57067.27..57067.27 rows=46 width=25) (actual time=273.412..273.412 rows=152 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=46 width=25) (actual time=0.455..273.117 rows=152 loops=3)
                                                                     Filter: ((production_year > 2010) AND (((title)::text ~~ '%murder%'::text) OR ((title)::text ~~ '%Murder%'::text) OR ((title)::text ~~ '%Mord%'::text)))
                                                                     Rows Removed by Filter: 842619
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.027..0.038 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 12.745 ms
 Execution Time: 3210.602 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14c.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=421498.92..421498.93 rows=1 width=64) (actual time=3680.576..3680.577 rows=1 loops=1)
   ->  Gather  (cost=421498.70..421498.91 rows=2 width=64) (actual time=3679.628..3687.394 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=420498.70..420498.71 rows=1 width=64) (actual time=3672.462..3672.462 rows=1 loops=3)
               ->  Hash Join  (cost=369734.12..420498.70 rows=1 width=22) (actual time=3359.009..3671.336 rows=1372 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=369733.01..420497.58 rows=1 width=26) (actual time=3358.053..3670.415 rows=1710 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.017..266.213 rows=337640 loops=3)
                                 Filter: (production_year > 2005)
                                 Rows Removed by Filter: 505131
                           ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3355.260..3355.260 rows=6989 loops=3)
                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                 ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=3065.580..3313.560 rows=6989 loops=3)
                                       Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                       ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.171..225.394 rows=151410 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.056..161.685 rows=447629 loops=3)
                                                   Filter: ((info)::text < '8.5'::text)
                                                   Rows Removed by Filter: 12383
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.029 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=3064.806..3064.806 rows=7972 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                             ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2491.759..3012.914 rows=7972 loops=3)
                                                   Hash Cond: (mi.movie_id = mk.movie_id)
                                                   ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1912.495..2403.995 rows=204750 loops=3)
                                                         Hash Cond: (mi.info_type_id = it1.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.004..2352.285 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.035..0.047 rows=1 loops=3)
                                                                     Filter: ((info)::text = 'countries'::text)
                                                                     Rows Removed by Filter: 112
                                                   ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=578.883..578.883 rows=12364 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=33.372..477.449 rows=12364 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.017..255.729 rows=1507977 loops=3)
                                                               ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=33.197..33.197 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.499..33.184 rows=3 loops=3)
                                                                           Filter: ((keyword IS NOT NULL) AND ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[])))
                                                                           Rows Removed by Filter: 134167
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.057..0.057 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.031..0.034 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 12.431 ms
 Execution Time: 3688.219 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=409625.94..409625.95 rows=1 width=64) (actual time=3592.106..3592.106 rows=1 loops=1)
   ->  Gather  (cost=409625.72..409625.93 rows=2 width=64) (actual time=3591.829..3599.248 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=408625.72..408625.73 rows=1 width=64) (actual time=3584.370..3584.371 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=400362.74..408625.68 rows=8 width=60) (actual time=3539.346..3584.284 rows=109 loops=3)
                     Hash Cond: (at.movie_id = t.id)
                     ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.029..35.898 rows=120491 loops=3)
                     ->  Parallel Hash  (cost=400362.70..400362.70 rows=3 width=76) (actual time=3530.502..3530.502 rows=466 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                           ->  Parallel Hash Join  (cost=396456.49..400362.70 rows=3 width=76) (actual time=3469.245..3514.166 rows=466 loops=3)
                                 Hash Cond: (k.id = mk.keyword_id)
                                 ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.132..39.268 rows=44723 loops=3)
                                       Heap Fetches: 134170
                                 ->  Parallel Hash  (cost=396456.03..396456.03 rows=3 width=80) (actual time=3469.020..3469.020 rows=466 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=346083.67..396456.03 rows=3 width=80) (actual time=2996.159..3436.473 rows=466 loops=3)
                                             Hash Cond: (mk.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.010..251.469 rows=1507977 loops=3)
                                             ->  Parallel Hash  (cost=346083.66..346083.66 rows=1 width=72) (actual time=2995.799..2995.799 rows=220 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=294758.03..346083.66 rows=1 width=72) (actual time=2684.715..2995.454 rows=220 loops=3)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.015..259.398 rows=460484 loops=3)
                                                               Filter: (production_year > 2000)
                                                               Rows Removed by Filter: 382286
                                                         ->  Parallel Hash  (cost=294758.02..294758.02 rows=1 width=51) (actual time=2681.404..2681.404 rows=223 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Hash Join  (cost=289846.73..294758.02 rows=1 width=51) (actual time=2654.738..2681.206 rows=223 loops=3)
                                                                     Hash Cond: (mc.company_type_id = ct.id)
                                                                     ->  Parallel Hash Join  (cost=289845.64..294756.93 rows=1 width=55) (actual time=2654.624..2681.018 rows=223 loops=3)
                                                                           Hash Cond: (cn.id = mc.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.030..23.108 rows=28281 loops=3)
                                                                                 Filter: ((country_code)::text = '[us]'::text)
                                                                                 Rows Removed by Filter: 50051
                                                                           ->  Parallel Hash  (cost=289845.63..289845.63 rows=1 width=59) (actual time=2654.372..2654.372 rows=233 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=254710.18..289845.63 rows=1 width=59) (actual time=2403.324..2654.034 rows=233 loops=3)
                                                                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=7675 width=12) (actual time=0.052..246.864 rows=20555 loops=3)
                                                                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))
                                                                                             Rows Removed by Filter: 849155
                                                                                       ->  Parallel Hash  (cost=254710.16..254710.16 rows=2 width=47) (actual time=2402.763..2402.763 rows=590 loops=3)
                                                                                             Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                                             ->  Hash Join  (cost=2.43..254710.16 rows=2 width=47) (actual time=289.986..1144.338 rows=590 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=51) (actual time=289.859..1143.643 rows=590 loops=3)
                                                                                                         Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                                                                                         Rows Removed by Filter: 4944650
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.049 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'release dates'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.057..0.057 rows=4 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.032..0.033 rows=4 loops=3)
 Planning Time: 32.290 ms
 Execution Time: 3600.051 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=411365.11..411365.12 rows=1 width=64) (actual time=2408.817..2408.818 rows=1 loops=1)
   ->  Gather  (cost=411364.89..411365.10 rows=2 width=64) (actual time=2408.539..2416.949 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=410364.89..410364.90 rows=1 width=64) (actual time=2400.851..2400.852 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=402101.92..410364.87 rows=4 width=60) (actual time=2392.849..2400.832 rows=12 loops=3)
                     Hash Cond: (at.movie_id = t.id)
                     ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.040..38.516 rows=120491 loops=3)
                     ->  Parallel Hash  (cost=402101.90..402101.90 rows=2 width=76) (actual time=2345.763..2345.763 rows=50 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=147394.15..402101.90 rows=2 width=76) (actual time=1401.346..2345.645 rows=50 loops=3)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..254710.16 rows=2 width=47) (actual time=307.171..1268.572 rows=590 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=51) (actual time=307.013..1267.859 rows=590 loops=3)
                                             Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                             Rows Removed by Filter: 4944650
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.061 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.049 rows=1 loops=3)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=147391.71..147391.71 rows=1 width=29) (actual time=1076.747..1076.747 rows=144 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=143485.50..147391.71 rows=1 width=29) (actual time=1025.992..1076.501 rows=144 loops=3)
                                             Hash Cond: (k.id = mk.keyword_id)
                                             ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.147..45.487 rows=44723 loops=3)
                                                   Heap Fetches: 134170
                                             ->  Parallel Hash  (cost=143485.07..143485.07 rows=1 width=33) (actual time=1025.656..1025.656 rows=144 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=93112.71..143485.07 rows=1 width=33) (actual time=585.898..1025.473 rows=144 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.008..256.859 rows=1507977 loops=3)
                                                         ->  Parallel Hash  (cost=93112.69..93112.69 rows=1 width=25) (actual time=581.654..581.654 rows=85 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=40186.82..93112.69 rows=1 width=25) (actual time=287.756..581.444 rows=85 loops=3)
                                                                     Hash Cond: (t.id = mc.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=300243 width=21) (actual time=0.011..266.791 rows=238753 loops=3)
                                                                           Filter: ((production_year >= 2005) AND (production_year <= 2010))
                                                                           Rows Removed by Filter: 604018
                                                                     ->  Parallel Hash  (cost=40186.81..40186.81 rows=1 width=4) (actual time=286.096..286.096 rows=93 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Hash Join  (cost=5069.61..40186.81 rows=1 width=4) (actual time=23.428..285.885 rows=93 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=5068.52..40185.72 rows=1 width=8) (actual time=23.307..285.718 rows=93 loops=3)
                                                                                       Hash Cond: (mc.company_id = cn.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=7675 width=12) (actual time=0.063..260.290 rows=20555 loops=3)
                                                                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))
                                                                                             Rows Removed by Filter: 849155
                                                                                       ->  Parallel Hash  (cost=5068.50..5068.50 rows=1 width=4) (actual time=21.977..21.977 rows=0 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..5068.50 rows=1 width=4) (actual time=15.104..21.940 rows=0 loops=3)
                                                                                                   Filter: (((country_code)::text = '[us]'::text) AND ((name)::text = 'YouTube'::text))
                                                                                                   Rows Removed by Filter: 78332
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.061..0.061 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.032..0.034 rows=4 loops=3)
 Planning Time: 32.264 ms
 Execution Time: 2417.750 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15c.sql_explained.sql
SET
SET
                                                                                                                            QUERY PLAN                                                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=424524.77..424524.78 rows=1 width=64) (actual time=3786.117..3786.117 rows=1 loops=1)
   ->  Gather  (cost=424524.55..424524.76 rows=2 width=64) (actual time=3785.750..3794.244 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=423524.55..423524.56 rows=1 width=64) (actual time=3778.137..3778.137 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=419547.77..423524.17 rows=76 width=60) (actual time=3725.568..3777.724 rows=757 loops=3)
                     Hash Cond: (k.id = mk.keyword_id)
                     ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.057..46.744 rows=44723 loops=3)
                           Heap Fetches: 134170
                     ->  Parallel Hash  (cost=419546.40..419546.40 rows=76 width=64) (actual time=3724.933..3724.933 rows=757 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                           ->  Parallel Hash Join  (cost=369174.02..419546.40 rows=76 width=64) (actual time=3241.847..3674.458 rows=757 loops=3)
                                 Hash Cond: (mk.movie_id = t.id)
                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.008..255.929 rows=1507977 loops=3)
                                 ->  Parallel Hash  (cost=369173.97..369173.97 rows=4 width=76) (actual time=3234.303..3234.303 rows=95 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=364262.66..369173.97 rows=4 width=76) (actual time=3213.539..3234.176 rows=95 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Hash Join  (cost=364261.57..369172.86 rows=4 width=80) (actual time=3213.426..3234.028 rows=95 loops=3)
                                                   Hash Cond: (cn.id = mc.company_id)
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.017..17.726 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
                                                   ->  Parallel Hash  (cost=364261.48..364261.48 rows=7 width=84) (actual time=3213.195..3213.196 rows=133 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=330523.34..364261.48 rows=7 width=84) (actual time=2946.950..3212.980 rows=133 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.030..163.953 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=330523.33..330523.33 rows=1 width=72) (actual time=2940.613..2940.613 rows=40 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=278615.36..330523.33 rows=1 width=72) (actual time=2600.653..2940.506 rows=40 loops=3)
                                                                           Hash Cond: (t.id = at.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.024..283.191 rows=583011 loops=3)
                                                                                 Filter: (production_year > 1990)
                                                                                 Rows Removed by Filter: 259760
                                                                           ->  Parallel Hash  (cost=278615.33..278615.33 rows=2 width=51) (actual time=2596.776..2596.776 rows=40 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=270164.12..278615.33 rows=2 width=51) (actual time=2540.713..2596.651 rows=40 loops=3)
                                                                                       Hash Cond: (at.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.053..38.301 rows=120491 loops=3)
                                                                                       ->  Parallel Hash  (cost=270164.10..270164.10 rows=2 width=47) (actual time=2539.670..2539.670 rows=594 loops=3)
                                                                                             Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                                             ->  Hash Join  (cost=2.43..270164.10 rows=2 width=47) (actual time=307.739..1211.664 rows=594 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=51) (actual time=307.610..1210.961 rows=594 loops=3)
                                                                                                         Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                                         Rows Removed by Filter: 4944646
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.047 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'release dates'::text)
                                                                                                               Rows Removed by Filter: 112
                                             ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.056..0.057 rows=4 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.031..0.032 rows=4 loops=3)
 Planning Time: 31.899 ms
 Execution Time: 3795.099 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=397267.91..397267.92 rows=1 width=64) (actual time=2682.629..2682.629 rows=1 loops=1)
   ->  Gather  (cost=397267.69..397267.90 rows=2 width=64) (actual time=2681.401..2690.678 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=396267.69..396267.70 rows=1 width=64) (actual time=2673.581..2673.581 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=345880.45..396258.32 rows=1873 width=38) (actual time=2220.782..2672.343 rows=3782 loops=3)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Parallel Hash Join  (cost=341484.68..391857.62 rows=1873 width=42) (actual time=2144.019..2593.405 rows=3782 loops=3)
                           Hash Cond: (mk.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.008..261.772 rows=1507977 loops=3)
                           ->  Parallel Hash  (cost=341483.66..341483.66 rows=81 width=54) (actual time=2137.707..2137.707 rows=292 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                 ->  Hash Join  (cost=336383.26..341483.66 rows=81 width=54) (actual time=2115.695..2137.321 rows=292 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=336382.17..341482.14 rows=81 width=58) (actual time=2115.569..2137.094 rows=292 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.010..17.851 rows=28281 loops=3)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 50051
                                             ->  Parallel Hash  (cost=336380.22..336380.22 rows=156 width=62) (actual time=2115.445..2115.445 rows=700 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                   ->  Parallel Hash Join  (cost=302641.96..336380.22 rows=156 width=62) (actual time=1794.405..2075.652 rows=700 loops=3)
                                                         Hash Cond: (mc.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.810..166.293 rows=869710 loops=3)
                                                         ->  Parallel Hash  (cost=302641.58..302641.58 rows=30 width=50) (actual time=1792.325..1792.325 rows=195 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=250733.50..302641.58 rows=30 width=50) (actual time=1446.494..1791.972 rows=195 loops=3)
                                                                     Hash Cond: (t.id = at.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.017..282.186 rows=583011 loops=3)
                                                                           Filter: (production_year > 1990)
                                                                           Rows Removed by Filter: 259760
                                                                     ->  Parallel Hash  (cost=250732.96..250732.96 rows=43 width=29) (actual time=1444.110..1444.111 rows=197 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=239269.32..250732.96 rows=43 width=29) (actual time=1386.380..1443.760 rows=197 loops=3)
                                                                                 Hash Cond: (at.movie_id = mi.movie_id)
                                                                                 ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=25) (actual time=0.036..37.913 rows=120491 loops=3)
                                                                                 ->  Parallel Hash  (cost=239268.80..239268.80 rows=42 width=4) (actual time=1386.011..1386.011 rows=3560 loops=3)
                                                                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                                                                       ->  Hash Join  (cost=2.43..239268.80 rows=42 width=4) (actual time=312.699..1289.216 rows=3560 loops=3)
                                                                                             Hash Cond: (mi.info_type_id = it1.id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=4774 width=8) (actual time=53.432..1286.569 rows=3603 loops=3)
                                                                                                   Filter: ((note)::text ~~ '%internet%'::text)
                                                                                                   Rows Removed by Filter: 4941637
                                                                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.054..0.055 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.043 rows=1 loops=3)
                                                                                                         Filter: ((info)::text = 'release dates'::text)
                                                                                                         Rows Removed by Filter: 112
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.068..0.068 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.039..0.041 rows=4 loops=3)
                     ->  Parallel Hash  (cost=3696.98..3696.98 rows=55904 width=4) (actual time=74.624..74.624 rows=44723 loops=3)
                           Buckets: 262144  Batches: 1  Memory Usage: 7360kB
                           ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.061..48.420 rows=44723 loops=3)
                                 Heap Fetches: 134170
 Planning Time: 31.413 ms
 Execution Time: 2691.500 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=683598.14..683598.15 rows=1 width=64) (actual time=6258.361..6258.362 rows=1 loops=1)
   ->  Gather  (cost=683597.92..683598.13 rows=2 width=64) (actual time=6256.915..6266.162 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=682597.92..682597.93 rows=1 width=64) (actual time=6249.585..6249.585 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=666037.80..682597.77 rows=31 width=33) (actual time=6132.084..6249.443 rows=128 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.030..81.298 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=666037.56..666037.56 rows=19 width=25) (actual time=6127.462..6127.462 rows=108 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=661126.21..666037.56 rows=19 width=25) (actual time=6108.605..6127.310 rows=108 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.010..17.683 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=661125.74..661125.74 rows=37 width=29) (actual time=6106.583..6106.583 rows=363 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=627387.45..661125.74 rows=37 width=29) (actual time=5835.508..6106.298 rows=363 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.031..166.459 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=627387.27..627387.27 rows=14 width=37) (actual time=5826.032..5826.032 rows=391 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                   ->  Parallel Hash Join  (cost=547897.96..627387.27 rows=14 width=37) (actual time=5229.458..5817.758 rows=391 loops=3)
                                                         Hash Cond: (n.id = ci.person_id)
                                                         ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.062..391.961 rows=1389164 loops=3)
                                                         ->  Parallel Hash  (cost=547897.79..547897.79 rows=14 width=33) (actual time=5224.455..5224.455 rows=391 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                               ->  Parallel Hash Join  (cost=103031.36..547897.79 rows=14 width=33) (actual time=814.051..5223.161 rows=391 loops=3)
                                                                     Hash Cond: (ci.movie_id = mk.movie_id)
                                                                     ->  Parallel Hash Join  (cost=52153.14..495500.56 rows=405052 width=29) (actual time=287.236..4618.181 rows=388676 loops=3)
                                                                           Hash Cond: (ci.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.044..2339.315 rows=12081448 loops=3)
                                                                           ->  Parallel Hash  (cost=51799.95..51799.95 rows=28255 width=21) (actual time=285.869..285.869 rows=22748 loops=3)
                                                                                 Buckets: 131072  Batches: 1  Memory Usage: 4704kB
                                                                                 ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=28255 width=21) (actual time=0.031..264.164 rows=22748 loops=3)
                                                                                       Filter: ((episode_nr >= 50) AND (episode_nr < 100))
                                                                                       Rows Removed by Filter: 820022
                                                                     ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=515.823..515.823 rows=13947 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                           ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.485..462.375 rows=13947 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..255.258 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.372..20.372 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.839..20.352 rows=1 loops=3)
                                                                                             Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                             Rows Removed by Filter: 134169
 Planning Time: 15.656 ms
 Execution Time: 6266.872 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16b.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=697874.98..697874.99 rows=1 width=64) (actual time=9707.145..9707.145 rows=1 loops=1)
   ->  Gather  (cost=697874.76..697874.97 rows=2 width=64) (actual time=9701.148..10067.965 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=696874.76..696874.77 rows=1 width=64) (actual time=9694.280..9694.280 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=617374.97..696869.01 rows=1150 width=33) (actual time=8532.503..9349.266 rows=1236864 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.042..374.407 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=617360.59..617360.59 rows=1150 width=41) (actual time=7578.496..7578.496 rows=1236864 loops=3)
                           Buckets: 65536 (originally 4096)  Batches: 128 (originally 1)  Memory Usage: 4064kB
                           ->  Parallel Hash Join  (cost=600795.85..617360.59 rows=1150 width=41) (actual time=6590.315..7035.455 rows=1236864 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.039..74.954 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=21) (actual time=6382.142..6382.142 rows=944185 loops=3)
                                       Buckets: 65536 (originally 2048)  Batches: 64 (originally 1)  Memory Usage: 3456kB
                                       ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=21) (actual time=1345.288..5716.392 rows=944185 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.027..2194.717 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=29) (actual time=1345.149..1345.149 rows=22772 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6776kB
                                                   ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=29) (actual time=978.690..1300.846 rows=22772 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=33) (actual time=940.135..1246.898 rows=49517 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.026..159.271 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=25) (actual time=939.783..939.783 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=25) (actual time=525.231..875.493 rows=13947 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.013..211.300 rows=842771 loops=3)
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=525.053..525.053 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.930..460.181 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.038..253.103 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.767..20.768 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.825..20.755 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=37.623..37.623 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.033..23.579 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.778 ms
 Execution Time: 10070.194 ms
(47 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16c.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=698025.50..698025.51 rows=1 width=64) (actual time=7415.823..7415.823 rows=1 loops=1)
   ->  Gather  (cost=698025.28..698025.49 rows=2 width=64) (actual time=7409.962..7558.550 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=697025.28..697025.29 rows=1 width=64) (actual time=7402.172..7402.172 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=617532.05..697023.11 rows=434 width=33) (actual time=6972.468..7369.832 rows=106644 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.061..400.922 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=617526.63..617526.63 rows=434 width=41) (actual time=6047.404..6047.404 rows=106644 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 8 (originally 1)  Memory Usage: 4256kB
                           ->  Parallel Hash Join  (cost=600964.87..617526.63 rows=434 width=41) (actual time=5852.528..5966.232 rows=106644 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.036..81.277 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=600962.51..600962.51 rows=189 width=21) (actual time=5654.644..5654.644 rows=73870 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2368kB
                                       ->  Parallel Hash Join  (cost=140625.02..600962.51 rows=189 width=21) (actual time=1280.782..5493.323 rows=73870 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.026..2308.559 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=140624.89..140624.89 rows=10 width=29) (actual time=1280.487..1280.487 rows=2846 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                                   ->  Parallel Hash Join  (cost=106886.67..140624.89 rows=10 width=29) (actual time=960.099..1253.494 rows=2846 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=101535.88..135274.04 rows=28 width=33) (actual time=918.318..1209.891 rows=3802 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=1.326..166.624 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=101535.82..101535.82 rows=5 width=25) (actual time=915.608..915.608 rows=2309 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..101535.82 rows=5 width=25) (actual time=534.543..852.837 rows=2309 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=397676 width=21) (actual time=0.013..270.138 rows=315635 loops=3)
                                                                                 Filter: (episode_nr < 100)
                                                                                 Rows Removed by Filter: 527135
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=534.318..534.318 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.227..466.240 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..257.991 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.072..21.072 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.873..21.060 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=40.893..40.893 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.035..24.434 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.800 ms
 Execution Time: 7559.261 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=700256.85..700256.86 rows=1 width=64) (actual time=7486.621..7486.621 rows=1 loops=1)
   ->  Gather  (cost=700256.63..700256.84 rows=2 width=64) (actual time=7481.904..7627.969 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=699256.63..699256.64 rows=1 width=64) (actual time=7474.398..7474.399 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=619764.46..699255.04 rows=318 width=33) (actual time=7064.643..7448.892 rows=83152 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.044..397.670 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=619760.48..619760.48 rows=318 width=41) (actual time=6144.893..6144.894 rows=83152 loops=3)
                           Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 3424kB
                           ->  Parallel Hash Join  (cost=603199.22..619760.48 rows=318 width=41) (actual time=5967.372..6074.194 rows=83152 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.034..81.762 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=603197.49..603197.49 rows=138 width=21) (actual time=5769.286..5769.286 rows=56424 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 1920kB
                                       ->  Parallel Hash Join  (cost=142860.13..603197.49 rows=138 width=21) (actual time=1424.596..5567.155 rows=56424 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.372..2328.855 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=142860.03..142860.03 rows=8 width=29) (actual time=1423.851..1423.851 rows=2255 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                                                   ->  Parallel Hash Join  (cost=109121.82..142860.03 rows=8 width=29) (actual time=1100.578..1390.216 rows=2255 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=103771.04..137509.19 rows=20 width=33) (actual time=1059.207..1347.317 rows=2887 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=1.375..167.773 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=103770.99..103770.99 rows=4 width=25) (actual time=1056.248..1056.248 rows=1795 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..103770.99 rows=4 width=25) (actual time=526.215..818.758 rows=1795 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=291411 width=21) (actual time=0.016..255.022 rows=230852 loops=3)
                                                                                 Filter: ((episode_nr >= 5) AND (episode_nr < 100))
                                                                                 Rows Removed by Filter: 611919
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=526.022..526.023 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.749..464.817 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.098..257.789 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.555..20.556 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.872..20.544 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=40.519..40.519 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.036..24.521 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.864 ms
 Execution Time: 7628.713 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17a.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=680693.62..680693.63 rows=1 width=64) (actual time=6845.801..6845.802 rows=1 loops=1)
   ->  Gather  (cost=680693.40..680693.61 rows=2 width=32) (actual time=6840.269..6909.072 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=679693.40..679693.41 rows=1 width=32) (actual time=6833.208..6833.208 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=600795.85..679693.30 rows=40 width=15) (actual time=6561.353..6814.892 rows=86096 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=140320 width=19) (actual time=8.122..434.216 rows=114466 loops=3)
                           Filter: ((name)::text ~~ 'B%'::text)
                           Rows Removed by Filter: 1274697
                     ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=4) (actual time=6067.875..6067.875 rows=944185 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4192kB
                           ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=4) (actual time=1394.110..5655.843 rows=944185 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.362..2208.836 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=12) (actual time=1393.649..1393.649 rows=22772 loops=3)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5304kB
                                       ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=12) (actual time=1029.528..1347.083 rows=22772 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=16) (actual time=991.078..1293.580 rows=49517 loops=3)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.763..159.112 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=989.567..989.568 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=522.690..872.573 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.012..211.962 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=522.430..522.430 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.226..459.288 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.045..252.176 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.076..20.076 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.826..20.051 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=37.558..37.558 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.035..23.747 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 9.372 ms
 Execution Time: 6909.730 ms
(44 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17b.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=64) (actual time=7456.604..7456.604 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=7454.691..7464.119 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=7447.406..7447.407 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=7091.141..7442.728 rows=17435 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.020..219.523 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=7089.497..7089.497 rows=17435 loops=3)
                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4312kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=7032.598..7072.342 rows=17435 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.008..18.485 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=7032.502..7032.502 rows=17435 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4472kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=6701.176..6999.511 rows=17435 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.043..167.514 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=6700.168..6700.168 rows=2214 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=2291.688..4814.684 rows=2214 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=1776.535..4281.801 rows=89570 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.030..2245.440 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=456.534..456.534 rows=12058 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3000kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=184.000..443.346 rows=12058 loops=3)
                                                                           Filter: ((name)::text ~~ 'Z%'::text)
                                                                           Rows Removed by Filter: 1377106
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=515.000..515.000 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.628..464.357 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.045..255.823 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.480..20.480 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.838..20.460 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.500 ms
 Execution Time: 7464.754 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17c.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=64) (actual time=5662.715..5662.715 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=5661.940..5670.452 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=5654.821..5654.822 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=5330.038..5654.576 rows=639 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.020..224.834 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=5314.172..5314.172 rows=639 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=5255.267..5281.441 rows=639 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.007..14.991 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=5255.120..5255.120 rows=639 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=4981.674..5247.386 rows=639 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.034..166.457 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=4969.442..4969.443 rows=83 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=2436.587..4969.248 rows=83 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=1922.109..4453.261 rows=4167 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.028..2269.935 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=621.220..621.220 rows=888 loops=3)
                                                                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=180.261..430.565 rows=888 loops=3)
                                                                           Filter: ((name)::text ~~ 'X%'::text)
                                                                           Rows Removed by Filter: 1388276
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=514.322..514.322 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.609..465.201 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.094..256.548 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.412..20.412 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.848..20.393 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.412 ms
 Execution Time: 5671.094 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17d.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=32) (actual time=7264.546..7264.546 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=7263.750..7272.414 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=7256.713..7256.713 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=6917.785..7255.597 rows=3846 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.034..221.451 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=6912.468..6912.468 rows=3846 loops=3)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=6874.659..6905.743 rows=3846 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.007..17.949 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=6874.564..6874.564 rows=3846 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1048kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=6543.671..6830.612 rows=3846 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.047..165.312 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=6540.891..6540.892 rows=657 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=1286.125..5157.019 rows=657 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=745.952..4636.384 rows=16097 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.593..2277.207 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=741.669..741.670 rows=1739 loops=3)
                                                                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 376kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=1.130..497.219 rows=1739 loops=3)
                                                                           Filter: ((name)::text ~~ '%Bert%'::text)
                                                                           Rows Removed by Filter: 1387425
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=515.244..515.244 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.580..462.907 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.096..254.954 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.386..20.386 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.822..20.366 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.333 ms
 Execution Time: 7273.066 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17e.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=694312.07..694312.08 rows=1 width=32) (actual time=7855.693..7855.693 rows=1 loops=1)
   ->  Gather  (cost=694311.86..694312.07 rows=2 width=32) (actual time=7850.493..8011.119 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=693311.86..693311.87 rows=1 width=32) (actual time=7843.746..7843.747 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=600795.85..693310.60 rows=501 width=15) (actual time=7027.751..7681.892 rows=944185 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.048..375.328 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=4) (actual time=6105.183..6105.183 rows=944185 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4192kB
                           ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=4) (actual time=1368.567..5666.437 rows=944185 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.028..2188.154 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=12) (actual time=1368.440..1368.440 rows=22772 loops=3)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5304kB
                                       ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=12) (actual time=1009.784..1324.893 rows=22772 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=16) (actual time=971.239..1271.252 rows=49517 loops=3)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.040..156.707 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=970.917..970.917 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=524.040..872.760 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.194..212.075 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=523.517..523.517 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.090..462.086 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.954..253.419 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.993..19.993 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.819..19.970 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=37.573..37.573 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.034..23.587 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 9.360 ms
 Execution Time: 8011.739 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17f.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=682238.58..682238.59 rows=1 width=32) (actual time=7088.078..7088.078 rows=1 loops=1)
   ->  Gather  (cost=682238.36..682238.57 rows=2 width=32) (actual time=7080.055..7155.328 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=681238.36..681238.37 rows=1 width=32) (actual time=7073.110..7073.110 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=647498.67..681237.95 rows=167 width=15) (actual time=6481.452..7007.352 rows=371040 loops=3)
                     Hash Cond: (mc.company_id = cn.id)
                     ->  Parallel Hash Join  (cost=641393.41..675132.25 rows=167 width=19) (actual time=6410.331..6837.393 rows=371040 loops=3)
                           Hash Cond: (mc.movie_id = ci.movie_id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.044..168.136 rows=869710 loops=3)
                           ->  Parallel Hash  (cost=641392.63..641392.63 rows=63 width=27) (actual time=6409.760..6409.760 rows=49831 loops=3)
                                 Buckets: 262144 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 13400kB
                                 ->  Parallel Hash Join  (cost=561705.80..641392.63 rows=63 width=27) (actual time=6199.172..6348.712 rows=49831 loops=3)
                                       Hash Cond: (n.id = ci.person_id)
                                       ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=210479 width=19) (actual time=0.059..525.102 rows=178905 loops=3)
                                             Filter: ((name)::text ~~ '%B%'::text)
                                             Rows Removed by Filter: 1210258
                                       ->  Parallel Hash  (cost=561699.31..561699.31 rows=519 width=16) (actual time=5583.145..5583.145 rows=346131 loops=3)
                                             Buckets: 65536 (originally 2048)  Batches: 16 (originally 1)  Memory Usage: 3680kB
                                             ->  Parallel Hash Join  (cost=101361.58..561699.31 rows=519 width=16) (actual time=991.589..5323.636 rows=346131 loops=3)
                                                   Hash Cond: (ci.movie_id = t.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.460..2343.902 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=991.012..991.012 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=529.549..891.186 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.047..222.583 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=529.233..529.233 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.859..466.458 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.055..255.803 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.682..20.682 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.908..20.658 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                     ->  Parallel Hash  (cost=4377.34..4377.34 rows=138234 width=4) (actual time=68.492..68.492 rows=78332 loops=3)
                           Buckets: 262144  Batches: 1  Memory Usage: 11296kB
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.038..22.029 rows=78332 loops=3)
 Planning Time: 9.375 ms
 Execution Time: 7155.933 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18a.sql_explained.sql
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=833190.17..833190.18 rows=1 width=96) (actual time=7505.554..7505.554 rows=1 loops=1)
   ->  Gather  (cost=833189.95..833190.16 rows=2 width=96) (actual time=7505.178..7511.683 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=832189.95..832189.96 rows=1 width=96) (actual time=7498.299..7498.299 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=781706.81..832189.94 rows=1 width=65) (actual time=7213.143..7498.026 rows=137 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.035..219.477 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=781706.80..781706.80 rows=1 width=60) (actual time=7168.364..7168.364 rows=137 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=540867.00..781706.80 rows=1 width=60) (actual time=6461.697..7168.120 rows=137 loops=3)
                                 Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=999.749..1729.134 rows=40621 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.036..1104.815 rows=4945240 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.035 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=3)
                                                   Filter: ((info)::text = 'budget'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=540864.56..540864.56 rows=1 width=13) (actual time=5433.262..5433.262 rows=1145 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                       ->  Parallel Hash Join  (cost=525594.29..540864.56 rows=1 width=13) (actual time=5139.616..5317.244 rows=1145 loops=3)
                                             Hash Cond: (mi_idx.movie_id = ci.movie_id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.201..158.326 rows=153308 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.057..76.170 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.047 rows=1 loops=3)
                                                               Filter: ((info)::text = 'votes'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=525591.38..525591.38 rows=39 width=4) (actual time=5138.831..5138.831 rows=2240 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 440kB
                                                   ->  Parallel Hash Join  (cost=81660.72..525591.38 rows=39 width=4) (actual time=1904.235..3255.711 rows=2240 loops=3)
                                                         Hash Cond: (ci.person_id = n.id)
                                                         ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=941346 width=8) (actual time=300.478..2582.411 rows=793090 loops=3)
                                                               Filter: ((note)::text = ANY ('{(producer),"(executive producer)"}'::text[]))
                                                               Rows Removed by Filter: 11288358
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=72 width=4) (actual time=584.122..584.122 rows=3021 loops=3)
                                                               Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=72 width=4) (actual time=0.364..507.858 rows=3021 loops=3)
                                                                     Filter: (((name)::text ~~ '%Tim%'::text) AND ((gender)::text = 'm'::text))
                                                                     Rows Removed by Filter: 1386143
 Planning Time: 9.776 ms
 Execution Time: 7512.360 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18b.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=886874.06..886874.07 rows=1 width=96) (actual time=5594.663..5594.663 rows=1 loops=1)
   ->  Gather  (cost=886873.83..886874.04 rows=2 width=96) (actual time=5594.199..5601.262 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=885873.83..885873.84 rows=1 width=96) (actual time=5586.775..5586.775 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=832828.60..885873.82 rows=1 width=65) (actual time=5488.942..5586.746 rows=4 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=332069 width=21) (actual time=0.030..266.088 rows=261496 loops=3)
                           Filter: ((production_year >= 2008) AND (production_year <= 2014))
                           Rows Removed by Filter: 581275
                     ->  Parallel Hash  (cost=832828.59..832828.59 rows=1 width=60) (actual time=5291.463..5291.463 rows=5 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=754551.36..832828.59 rows=1 width=60) (actual time=5016.399..5291.339 rows=5 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=255610 width=4) (actual time=187.843..445.366 rows=320518 loops=3)
                                       Filter: ((gender IS NOT NULL) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1068645
                                 ->  Parallel Hash  (cost=754551.35..754551.35 rows=1 width=64) (actual time=4811.397..4811.398 rows=137 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=254530.67..754551.35 rows=1 width=64) (actual time=3644.867..4811.103 rows=137 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=235.127..3041.425 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=254530.66..254530.66 rows=1 width=56) (actual time=1720.265..1720.265 rows=244 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=15184.50..254530.66 rows=1 width=56) (actual time=1549.444..1719.644 rows=244 loops=3)
                                                         Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                         ->  Hash Join  (cost=2.43..239347.45 rows=298 width=47) (actual time=1389.244..1554.747 rows=24086 loops=3)
                                                               Hash Cond: (mi.info_type_id = it1.id)
                                                               ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=33653 width=51) (actual time=973.301..1546.461 rows=24349 loops=3)
                                                                     Filter: ((note IS NULL) AND ((info)::text = ANY ('{Horror,Thriller}'::text[])))
                                                                     Rows Removed by Filter: 4920891
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.028 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'genres'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=15179.85..15179.85 rows=178 width=9) (actual time=159.628..159.628 rows=5283 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 952kB
                                                               ->  Hash Join  (cost=2.43..15179.85 rows=178 width=9) (actual time=0.303..136.514 rows=5283 loops=3)
                                                                     Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.069..132.294 rows=17883 loops=3)
                                                                           Filter: ((info)::text > '8.0'::text)
                                                                           Rows Removed by Filter: 442129
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.075..0.075 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.048 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'rating'::text)
                                                                                 Rows Removed by Filter: 112
 Planning Time: 9.448 ms
 Execution Time: 5602.003 ms
(52 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18c.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=917260.31..917260.32 rows=1 width=96) (actual time=6257.083..6257.083 rows=1 loops=1)
   ->  Gather  (cost=917260.08..917260.29 rows=2 width=96) (actual time=6253.456..6272.879 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=916260.08..916260.09 rows=1 width=96) (actual time=6246.330..6246.331 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=865776.83..916260.00 rows=11 width=65) (actual time=5883.232..6239.547 rows=9358 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.027..221.359 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=865776.69..865776.69 rows=11 width=60) (actual time=5880.486..5880.486 rows=9358 loops=3)
                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2200kB
                           ->  Parallel Hash Join  (cost=785749.31..865776.69 rows=11 width=60) (actual time=5300.149..5832.849 rows=9358 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=4) (actual time=0.050..451.166 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=785748.97..785748.97 rows=27 width=64) (actual time=5299.626..5299.626 rows=18052 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4472kB
                                       ->  Parallel Hash Join  (cost=285728.20..785748.97 rows=27 width=64) (actual time=3560.405..5256.716 rows=18052 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=164.611..2895.694 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=285727.93..285727.93 rows=21 width=56) (actual time=2280.306..2280.306 rows=34172 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 7672kB
                                                   ->  Parallel Hash Join  (cost=15319.64..285727.93 rows=21 width=56) (actual time=2196.866..2246.962 rows=34172 loops=3)
                                                         Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                         ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1644.336..1861.025 rows=62198 loops=3)
                                                               Hash Cond: (mi.info_type_id = it1.id)
                                                               ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1037.849..1843.757 rows=62990 loops=3)
                                                                     Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                     Rows Removed by Filter: 4882250
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.031..0.031 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.015..0.027 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'genres'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=259.134..259.134 rows=153308 loops=3)
                                                               Buckets: 65536 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 2848kB
                                                               ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.163..163.108 rows=153308 loops=3)
                                                                     Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.042..77.577 rows=460012 loops=3)
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.066 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.048 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'votes'::text)
                                                                                 Rows Removed by Filter: 112
 Planning Time: 9.454 ms
 Execution Time: 6273.654 ms
(48 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19a.sql_explained.sql
SET
SET
                                                                                                            QUERY PLAN                                                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=982370.28..982370.29 rows=1 width=64) (actual time=6495.081..6495.081 rows=1 loops=1)
   ->  Gather  (cost=982370.06..982370.27 rows=2 width=64) (actual time=6494.685..6502.886 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=981370.06..981370.07 rows=1 width=64) (actual time=6486.678..6486.679 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=928667.96..981370.06 rows=1 width=32) (actual time=6314.805..6486.604 rows=61 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=240570 width=21) (actual time=0.026..259.708 rows=191519 loops=3)
                           Filter: ((production_year >= 2005) AND (production_year <= 2009))
                           Rows Removed by Filter: 651252
                     ->  Parallel Hash  (cost=928667.95..928667.95 rows=1 width=27) (actual time=6203.405..6203.406 rows=104 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=923756.66..928667.95 rows=1 width=27) (actual time=6177.463..6203.270 rows=104 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.022..22.973 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=923756.65..923756.65 rows=1 width=31) (actual time=6177.170..6177.170 rows=107 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=888167.49..923756.65 rows=1 width=31) (actual time=5910.620..6177.045 rows=107 loops=3)
                                             Hash Cond: (mc.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=131225 width=8) (actual time=0.036..299.884 rows=196998 loops=3)
                                                   Filter: ((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                                   Rows Removed by Filter: 672712
                                             ->  Parallel Hash  (cost=888167.48..888167.48 rows=1 width=23) (actual time=5856.727..5856.727 rows=68 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=833727.94..888167.48 rows=1 width=23) (actual time=5467.384..5856.614 rows=68 loops=3)
                                                         Hash Cond: (chn.id = ci.person_role_id)
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.043..260.744 rows=1046780 loops=3)
                                                         ->  Parallel Hash  (cost=833727.93..833727.93 rows=1 width=27) (actual time=5465.217..5465.217 rows=75 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=578391.87..833727.93 rows=1 width=27) (actual time=4141.158..5465.119 rows=75 loops=3)
                                                                     Hash Cond: (mi.movie_id = ci.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255330.90 rows=2019 width=4) (actual time=428.803..1799.861 rows=150346 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=180.119..1762.299 rows=150368 loops=3)
                                                                                 Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                 Rows Removed by Filter: 4794872
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.061..0.062 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.048 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=578389.42..578389.42 rows=2 width=23) (actual time=3647.680..3647.680 rows=142 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Hash Join  (cost=97799.03..578389.42 rows=2 width=23) (actual time=1640.467..3647.504 rows=142 loops=3)
                                                                                 Hash Cond: (ci.role_id = rt.id)
                                                                                 ->  Parallel Hash Join  (cost=97797.87..578388.18 rows=19 width=27) (actual time=1640.338..3647.331 rows=142 loops=3)
                                                                                       Hash Cond: (ci.person_id = n.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.058..2913.433 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=23) (actual time=692.571..692.571 rows=519 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                                             ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=23) (actual time=567.247..692.037 rows=519 loops=3)
                                                                                                   Hash Cond: (an.person_id = n.id)
                                                                                                   ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.038..79.623 rows=300448 loops=3)
                                                                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=565.802..565.803 rows=2256 loops=3)
                                                                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=216.485..513.629 rows=2256 loops=3)
                                                                                                               Filter: (((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))
                                                                                                               Rows Removed by Filter: 1386908
                                                                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.072..0.072 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=3)
                                                                                             Filter: ((role)::text = 'actress'::text)
                                                                                             Rows Removed by Filter: 11
 Planning Time: 54.935 ms
 Execution Time: 6503.817 ms
(69 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=947597.06..947597.07 rows=1 width=64) (actual time=8326.553..8326.553 rows=1 loops=1)
   ->  Gather  (cost=947596.94..947597.05 rows=1 width=64) (actual time=8326.270..8331.852 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=946596.94..946596.95 rows=1 width=64) (actual time=8320.401..8320.402 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=941685.65..946596.94 rows=1 width=32) (actual time=8308.405..8320.392 rows=8 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.013..23.920 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=941685.64..941685.64 rows=1 width=36) (actual time=8291.880..8291.880 rows=8 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=903714.47..941685.64 rows=1 width=36) (actual time=8175.043..8291.838 rows=8 loops=2)
                                 Hash Cond: (mc.movie_id = t.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=41669 width=8) (actual time=0.027..403.053 rows=99260 loops=2)
                                       Filter: (((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                       Rows Removed by Filter: 1205305
                                 ->  Parallel Hash  (cost=903714.46..903714.46 rows=1 width=44) (actual time=7877.312..7877.312 rows=2 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=849274.92..903714.46 rows=1 width=44) (actual time=7789.152..7877.269 rows=2 loops=2)
                                             Hash Cond: (chn.id = ci.person_role_id)
                                             ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.029..354.915 rows=1570170 loops=2)
                                             ->  Parallel Hash  (cost=849274.91..849274.91 rows=1 width=48) (actual time=7334.269..7334.269 rows=2 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                   ->  Parallel Hash Join  (cost=833137.42..849274.91 rows=1 width=48) (actual time=7277.108..7334.244 rows=2 loops=2)
                                                         Hash Cond: (n.id = ci.person_id)
                                                         ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=23) (actual time=806.123..978.124 rows=648 loops=2)
                                                               Hash Cond: (an.person_id = n.id)
                                                               ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.029..107.328 rows=450672 loops=2)
                                                               ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=804.101..804.101 rows=2704 loops=2)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=331.067..782.917 rows=2704 loops=2)
                                                                           Filter: (((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))
                                                                           Rows Removed by Filter: 2081041
                                                         ->  Parallel Hash  (cost=751477.09..751477.09 rows=1 width=37) (actual time=6355.923..6355.923 rows=8 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=496679.24..751477.09 rows=1 width=37) (actual time=4852.088..6355.856 rows=8 loops=2)
                                                                     Hash Cond: (mi.movie_id = t.id)
                                                                     ->  Hash Join  (cost=2.43..254799.18 rows=291 width=4) (actual time=614.965..2492.324 rows=34739 loops=2)
                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=32862 width=8) (actual time=614.847..2480.001 rows=34739 loops=2)
                                                                                 Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%2007%'::text) OR ((info)::text ~~ 'USA:%2008%'::text)))
                                                                                 Rows Removed by Filter: 7383121
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.030..0.041 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=496676.80..496676.80 rows=1 width=33) (actual time=3858.603..3858.603 rows=8 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Hash Join  (cost=54434.90..496676.80 rows=1 width=33) (actual time=1720.322..3858.513 rows=8 loops=2)
                                                                                 Hash Cond: (ci.role_id = rt.id)
                                                                                 ->  Parallel Hash Join  (cost=54433.73..496675.63 rows=3 width=37) (actual time=503.866..3858.385 rows=36 loops=2)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=298009 width=16) (actual time=0.026..3449.207 rows=356914 loops=2)
                                                                                             Filter: ((note)::text = '(voice)'::text)
                                                                                             Rows Removed by Filter: 17765258
                                                                                       ->  Parallel Hash  (cost=54433.61..54433.61 rows=10 width=21) (actual time=360.333..360.333 rows=4 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=10 width=21) (actual time=70.392..360.270 rows=4 loops=2)
                                                                                                   Filter: ((production_year >= 2007) AND (production_year <= 2008) AND ((title)::text ~~ '%Kung%Fu%Panda%'::text))
                                                                                                   Rows Removed by Filter: 1264152
                                                                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=2)
                                                                                             Filter: ((role)::text = 'actress'::text)
                                                                                             Rows Removed by Filter: 11
 Planning Time: 52.057 ms
 Execution Time: 8332.809 ms
(69 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19c.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=979421.66..979421.67 rows=1 width=64) (actual time=7258.611..7258.611 rows=1 loops=1)
   ->  Gather  (cost=979421.44..979421.65 rows=2 width=64) (actual time=7257.700..7265.716 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=978421.44..978421.45 rows=1 width=64) (actual time=7249.695..7249.695 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=961861.47..978421.43 rows=2 width=32) (actual time=7130.422..7249.262 rows=1192 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.040..78.033 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=961861.46..961861.46 rows=1 width=40) (actual time=7127.459..7127.459 rows=877 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                           ->  Parallel Hash Join  (cost=956950.17..961861.46 rows=1 width=40) (actual time=7103.493..7125.127 rows=877 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.017..17.601 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=956950.15..956950.15 rows=2 width=44) (actual time=7103.290..7103.290 rows=2862 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 856kB
                                       ->  Parallel Hash Join  (cost=923212.00..956950.15 rows=2 width=44) (actual time=6779.931..7069.694 rows=2862 loops=3)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.029..165.911 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=923211.99..923211.99 rows=1 width=52) (actual time=6778.231..6778.231 rows=710 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                   ->  Parallel Hash Join  (cost=868772.46..923211.99 rows=1 width=52) (actual time=6343.780..6740.111 rows=710 loops=3)
                                                         Hash Cond: (chn.id = ci.person_role_id)
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.660..250.496 rows=1046780 loops=3)
                                                         ->  Parallel Hash  (cost=868772.44..868772.44 rows=1 width=56) (actual time=6340.359..6340.359 rows=755 loops=3)
                                                               Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                               ->  Parallel Hash Join  (cost=817446.81..868772.44 rows=1 width=56) (actual time=6002.589..6331.819 rows=755 loops=3)
                                                                     Hash Cond: (t.id = mi.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.037..273.938 rows=460484 loops=3)
                                                                           Filter: (production_year > 2000)
                                                                           Rows Removed by Filter: 382286
                                                                     ->  Parallel Hash  (cost=817446.79..817446.79 rows=2 width=35) (actual time=6001.641..6001.641 rows=840 loops=3)
                                                                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                                           ->  Parallel Hash Join  (cost=562110.73..817446.79 rows=2 width=35) (actual time=4129.539..5461.477 rows=840 loops=3)
                                                                                 Hash Cond: (mi.movie_id = ci.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..255330.90 rows=2019 width=4) (actual time=430.933..1745.347 rows=150346 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=185.293..1708.389 rows=150368 loops=3)
                                                                                             Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                             Rows Removed by Filter: 4794872
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.054 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'release dates'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=562103.89..562103.89 rows=353 width=31) (actual time=3695.061..3695.061 rows=2184 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 568kB
                                                                                       ->  Hash Join  (cost=81911.39..562103.89 rows=353 width=31) (actual time=1473.304..3488.147 rows=2184 loops=3)
                                                                                             Hash Cond: (ci.role_id = rt.id)
                                                                                             ->  Parallel Hash Join  (cost=81910.23..562087.69 rows=4234 width=35) (actual time=1473.180..3487.250 rows=2185 loops=3)
                                                                                                   Hash Cond: (ci.person_id = n.id)
                                                                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.078..2908.027 rows=289159 loops=3)
                                                                                                         Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                                         Rows Removed by Filter: 11792289
                                                                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=533.520..533.520 rows=16670 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=217.703..518.976 rows=16670 loops=3)
                                                                                                               Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                                               Rows Removed by Filter: 1372493
                                                                                             ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.063..0.063 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.034..0.037 rows=1 loops=3)
                                                                                                         Filter: ((role)::text = 'actress'::text)
                                                                                                         Rows Removed by Filter: 11
 Planning Time: 51.991 ms
 Execution Time: 7266.708 ms
(67 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=992869.82..992869.83 rows=1 width=64) (actual time=9615.116..9615.117 rows=1 loops=1)
   ->  Gather  (cost=992869.60..992869.81 rows=2 width=64) (actual time=9561.130..9880.188 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=991869.60..991869.61 rows=1 width=64) (actual time=9562.707..9562.707 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=975303.84..991864.20 rows=1080 width=32) (actual time=9190.466..9409.495 rows=586882 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.043..75.653 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=975297.96..975297.96 rows=470 width=40) (actual time=8993.574..8993.574 rows=262348 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4384kB
                           ->  Parallel Hash Join  (cost=941555.37..975297.96 rows=470 width=40) (actual time=8230.784..8758.767 rows=262348 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Hash Join  (cost=936204.59..969943.78 rows=1294 width=44) (actual time=8191.855..8575.923 rows=1076352 loops=3)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.067..161.595 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=936201.50..936201.50 rows=247 width=52) (actual time=7792.218..7792.218 rows=113945 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 2624kB
                                             ->  Parallel Hash Join  (cost=884874.85..936201.50 rows=247 width=52) (actual time=7495.756..7683.421 rows=113945 loops=3)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.032..270.964 rows=460484 loops=3)
                                                         Filter: (production_year > 2000)
                                                         Rows Removed by Filter: 382286
                                                   ->  Parallel Hash  (cost=884869.20..884869.20 rows=452 width=31) (actual time=7045.567..7045.567 rows=166016 loops=3)
                                                         Buckets: 65536 (originally 2048)  Batches: 16 (originally 1)  Memory Usage: 2912kB
                                                         ->  Parallel Hash Join  (cost=636506.19..884869.20 rows=452 width=31) (actual time=6721.077..6918.807 rows=166016 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Hash Join  (cost=565505.50..808738.07 rows=934 width=35) (actual time=5952.650..6078.800 rows=182242 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Hash Join  (cost=480903.52..721760.35 rows=4089 width=16) (actual time=5151.666..5332.757 rows=182372 loops=3)
                                                                           Hash Cond: (mi.movie_id = ci.movie_id)
                                                                           ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=455.810..1901.798 rows=1012240 loops=3)
                                                                                 Hash Cond: (mi.info_type_id = it.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.049..1142.395 rows=4945240 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.054..0.055 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.051 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'release dates'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=480518.83..480518.83 rows=30581 width=12) (actual time=2967.001..2967.002 rows=92055 loops=3)
                                                                                 Buckets: 65536 (originally 131072)  Batches: 8 (originally 1)  Memory Usage: 2208kB
                                                                                 ->  Hash Join  (cost=1.16..480518.83 rows=30581 width=12) (actual time=911.695..2893.357 rows=92055 loops=3)
                                                                                       Hash Cond: (ci.role_id = rt.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.052..2830.305 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.028..0.028 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.024..0.026 rows=1 loops=3)
                                                                                                   Filter: ((role)::text = 'actress'::text)
                                                                                                   Rows Removed by Filter: 11
                                                                     ->  Parallel Hash  (cost=77318.68..77318.68 rows=396664 width=19) (actual time=552.101..552.101 rows=320518 loops=3)
                                                                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                                                                           ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=396664 width=19) (actual time=182.231..442.406 rows=320518 loops=3)
                                                                                 Filter: ((gender)::text = 'f'::text)
                                                                                 Rows Removed by Filter: 1068645
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=4) (actual time=561.889..561.889 rows=1046780 loops=3)
                                                                     Buckets: 131072  Batches: 64  Memory Usage: 3008kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.074..282.426 rows=1046780 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.024..38.024 rows=28281 loops=3)
                                       Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.024..23.280 rows=28281 loops=3)
                                             Filter: ((country_code)::text = '[us]'::text)
                                             Rows Removed by Filter: 50051
 Planning Time: 51.491 ms
 Execution Time: 9882.790 ms
(65 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=104638.31..104638.32 rows=1 width=68) (actual time=869.771..869.771 rows=1 loops=1)
   ->  Gather  (cost=104638.09..104638.30 rows=2 width=68) (actual time=869.224..876.153 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=103638.09..103638.10 rows=1 width=68) (actual time=862.291..862.291 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=53154.41..103637.73 rows=47 width=45) (actual time=752.425..862.178 rows=47 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.030..228.580 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=53153.83..53153.83 rows=47 width=32) (actual time=527.891..527.891 rows=47 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=37883.38..53153.83 rows=47 width=32) (actual time=527.342..527.550 rows=47 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mc.movie_id)
                                 ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=137.615..137.654 rows=83 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.035..82.018 rows=460012 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.057 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.040 rows=1 loops=3)
                                                   Filter: ((info)::text = 'top 250 rank'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=37857.14..37857.14 rows=1905 width=28) (actual time=389.622..389.622 rows=9552 loops=3)
                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2112kB
                                       ->  Hash Join  (cost=1.06..37857.14 rows=1905 width=28) (actual time=280.248..377.972 rows=9552 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=7618 width=32) (actual time=50.509..374.225 rows=9630 loops=3)
                                                   Filter: (((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND (((note)::text ~~ '%(co-production)%'::text) OR ((note)::text ~~ '%(presents)%'::text)))
                                                   Rows Removed by Filter: 860080
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'production companies'::text)
                                                         Rows Removed by Filter: 3
 Planning Time: 4.111 ms
 Execution Time: 876.662 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1b.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=103766.13..103766.14 rows=1 width=68) (actual time=752.227..752.227 rows=1 loops=1)
   ->  Gather  (cost=103765.91..103766.12 rows=2 width=68) (actual time=751.957..758.416 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=102765.91..102765.92 rows=1 width=68) (actual time=745.133..745.133 rows=1 loops=3)
               ->  Hash Join  (cost=68268.30..102758.62 rows=972 width=45) (actual time=730.204..745.110 rows=1 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=68267.24..102736.53 rows=3890 width=49) (actual time=599.207..744.791 rows=22 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=556503 width=32) (actual time=0.035..272.096 rows=445696 loops=3)
                                 Filter: ((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)
                                 Rows Removed by Filter: 424014
                           ->  Parallel Hash  (cost=68249.11..68249.11 rows=1450 width=29) (actual time=427.917..427.917 rows=1 loops=3)
                                 Buckets: 4096  Batches: 1  Memory Usage: 96kB
                                 ->  Parallel Hash Join  (cost=15317.21..68249.11 rows=1450 width=29) (actual time=373.902..427.781 rows=1 loops=3)
                                       Hash Cond: (t.id = mi_idx.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=300243 width=25) (actual time=0.040..263.437 rows=238753 loops=3)
                                             Filter: ((production_year >= 2005) AND (production_year <= 2010))
                                             Rows Removed by Filter: 604018
                                       ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=4) (actual time=135.992..135.992 rows=3 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 160kB
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=135.934..135.936 rows=3 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.049..79.396 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.069..0.069 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=3)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=3)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 3.877 ms
 Execution Time: 758.920 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=101209.01..101209.02 rows=1 width=68) (actual time=730.203..730.203 rows=1 loops=1)
   ->  Gather  (cost=101208.79..101209.00 rows=2 width=68) (actual time=729.742..736.085 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=100208.79..100208.80 rows=1 width=68) (actual time=722.989..722.989 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=50420.55..100208.75 rows=5 width=45) (actual time=704.243..722.963 rows=1 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=25) (actual time=0.029..246.852 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=50420.11..50420.11 rows=35 width=32) (actual time=458.692..458.692 rows=8 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=35149.70..50420.11 rows=35 width=32) (actual time=458.432..458.504 rows=8 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mc.movie_id)
                                 ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=136.820..136.854 rows=83 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.032..81.025 rows=460012 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.046 rows=1 loops=3)
                                                   Filter: ((info)::text = 'top 250 rank'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=35129.26..35129.26 rows=1441 width=28) (actual time=321.476..321.476 rows=5937 loops=3)
                                       Buckets: 32768 (originally 4096)  Batches: 1 (originally 1)  Memory Usage: 1536kB
                                       ->  Hash Join  (cost=1.06..35129.26 rows=1441 width=28) (actual time=217.805..307.716 rows=5937 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=5762 width=32) (actual time=163.522..305.173 rows=5939 loops=3)
                                                   Filter: (((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND ((note)::text ~~ '%(co-production)%'::text))
                                                   Rows Removed by Filter: 863771
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.065..0.066 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.045..0.046 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'production companies'::text)
                                                         Rows Removed by Filter: 3
 Planning Time: 4.042 ms
 Execution Time: 736.602 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1d.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=102217.02..102217.03 rows=1 width=68) (actual time=790.729..790.729 rows=1 loops=1)
   ->  Gather  (cost=102216.80..102217.01 rows=2 width=68) (actual time=790.392..797.533 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=101216.80..101216.81 rows=1 width=68) (actual time=783.631..783.632 rows=1 loops=3)
               ->  Hash Join  (cost=66690.26..101202.81 rows=1865 width=45) (actual time=768.650..783.608 rows=1 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=66689.20..101161.42 rows=7460 width=49) (actual time=556.666..783.302 rows=26 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=556503 width=32) (actual time=0.045..275.292 rows=445696 loops=3)
                                 Filter: ((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)
                                 Rows Removed by Filter: 424014
                           ->  Parallel Hash  (cost=66654.42..66654.42 rows=2782 width=29) (actual time=462.631..462.631 rows=2 loops=3)
                                 Buckets: 8192  Batches: 1  Memory Usage: 160kB
                                 ->  Parallel Hash Join  (cost=15317.21..66654.42 rows=2782 width=29) (actual time=388.320..462.478 rows=2 loops=3)
                                       Hash Cond: (t.id = mi_idx.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.028..278.207 rows=460484 loops=3)
                                             Filter: (production_year > 2000)
                                             Rows Removed by Filter: 382286
                                       ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=4) (actual time=135.139..135.139 rows=3 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 160kB
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=135.082..135.083 rows=3 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.051..78.647 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.047..0.048 rows=1 loops=3)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=3)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 3.893 ms
 Execution Time: 798.042 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20a.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=690921.15..690921.16 rows=1 width=32) (actual time=5835.552..5835.552 rows=1 loops=1)
   ->  Hash Join  (cost=611431.78..690921.14 rows=1 width=17) (actual time=5337.615..5835.525 rows=33 loops=1)
         Hash Cond: (t.kind_id = kt.id)
         ->  Gather  (cost=611430.68..690920.04 rows=1 width=21) (actual time=5337.483..5842.690 rows=33 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=610430.68..689919.94 rows=1 width=21) (actual time=5364.430..5827.586 rows=11 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.059..390.473 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=610430.67..610430.67 rows=1 width=25) (actual time=5265.876..5265.876 rows=11 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Hash Join  (cost=557690.68..610430.67 rows=1 width=25) (actual time=5227.391..5265.758 rows=11 loops=3)
                                 Hash Cond: (t.id = cc.movie_id)
                                 ->  Parallel Hash Join  (cost=554588.26..607328.24 rows=1 width=37) (actual time=4873.969..5166.064 rows=59 loops=3)
                                       Hash Cond: (t.id = mk.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=952979 width=25) (actual time=0.027..290.627 rows=762424 loops=3)
                                             Filter: (production_year > 1950)
                                             Rows Removed by Filter: 80347
                                       ->  Parallel Hash  (cost=554588.25..554588.25 rows=1 width=12) (actual time=4799.832..4799.832 rows=59 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=111235.39..554588.25 rows=1 width=12) (actual time=1323.358..4799.698 rows=59 loops=3)
                                                   Hash Cond: (ci.movie_id = mk.movie_id)
                                                   ->  Parallel Hash Join  (cost=59349.58..502696.95 rows=1460 width=8) (actual time=615.912..4181.247 rows=185 loops=3)
                                                         Hash Cond: (ci.person_role_id = chn.id)
                                                         ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.027..2284.716 rows=12081448 loops=3)
                                                         ->  Parallel Hash  (cost=59346.31..59346.31 rows=262 width=4) (actual time=554.974..554.974 rows=10 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Seq Scan on char_name chn  (cost=0.00..59346.31 rows=262 width=4) (actual time=39.641..554.867 rows=10 loops=3)
                                                                     Filter: (((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))
                                                                     Rows Removed by Filter: 1046770
                                                   ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=4) (actual time=618.245..618.245 rows=11849 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=4) (actual time=61.033..512.205 rows=11849 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.043..262.115 rows=1507977 loops=3)
                                                               ->  Hash  (cost=3632.40..3632.40 rows=8 width=4) (actual time=60.732..60.732 rows=8 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=4) (actual time=0.213..60.714 rows=8 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                                           Rows Removed by Filter: 134162
                                 ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=99.350..99.350 rows=85941 loops=3)
                                       Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                       ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.244..72.481 rows=85941 loops=3)
                                             Hash Cond: (cc.status_id = cct2.id)
                                             ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.116..54.284 rows=85941 loops=3)
                                                   Hash Cond: (cc.subject_id = cct1.id)
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.026..23.379 rows=135086 loops=3)
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.021..0.021 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'cast'::text)
                                                               Rows Removed by Filter: 3
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.069..0.069 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.047..0.049 rows=2 loops=3)
                                                         Filter: ((kind)::text ~~ '%complete%'::text)
                                                         Rows Removed by Filter: 2
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=1)
                     Filter: ((kind)::text = 'movie'::text)
                     Rows Removed by Filter: 6
 Planning Time: 35.246 ms
 Execution Time: 5843.764 ms
(64 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20b.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=687335.89..687335.90 rows=1 width=32) (actual time=5392.992..5392.992 rows=1 loops=1)
   ->  Gather  (cost=687335.68..687335.89 rows=2 width=32) (actual time=5392.623..5399.435 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=686335.68..686335.69 rows=1 width=32) (actual time=5385.277..5385.277 rows=1 loops=3)
               ->  Hash Join  (cost=635010.03..686335.67 rows=1 width=17) (actual time=5340.730..5385.255 rows=6 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=635008.93..686334.57 rows=1 width=21) (actual time=5340.468..5384.992 rows=6 loops=3)
                           Hash Cond: (t.id = cc.movie_id)
                           ->  Parallel Hash Join  (cost=631906.51..683232.14 rows=1 width=33) (actual time=5233.236..5291.849 rows=17 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.024..264.090 rows=460484 loops=3)
                                       Filter: (production_year > 2000)
                                       Rows Removed by Filter: 382286
                                 ->  Parallel Hash  (cost=631906.50..631906.50 rows=1 width=8) (actual time=4981.341..4981.341 rows=17 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=583654.16..631906.50 rows=1 width=8) (actual time=4755.288..4981.217 rows=17 loops=3)
                                             Hash Cond: (mk.movie_id = ci.movie_id)
                                             ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=4) (actual time=40.717..485.691 rows=11849 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.038..258.033 rows=1507977 loops=3)
                                                   ->  Hash  (cost=3632.40..3632.40 rows=8 width=4) (actual time=40.280..40.280 rows=8 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=4) (actual time=0.150..40.262 rows=8 loops=3)
                                                               Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                               Rows Removed by Filter: 134162
                                             ->  Parallel Hash  (cost=580021.64..580021.64 rows=1 width=4) (actual time=4493.124..4493.125 rows=5 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=136670.44..580021.64 rows=1 width=4) (actual time=1340.862..4493.007 rows=5 loops=3)
                                                         Hash Cond: (ci.person_id = n.id)
                                                         ->  Parallel Hash Join  (cost=59349.58..502696.95 rows=1460 width=8) (actual time=589.678..4000.642 rows=185 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.030..2128.441 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=59346.31..59346.31 rows=262 width=4) (actual time=537.128..537.128 rows=10 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..59346.31 rows=262 width=4) (actual time=24.510..537.000 rows=10 loops=3)
                                                                           Filter: (((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))
                                                                           Rows Removed by Filter: 1046770
                                                         ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=4) (actual time=492.265..492.265 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=4) (actual time=197.547..492.200 rows=1 loops=3)
                                                                     Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                                     Rows Removed by Filter: 1389163
                           ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=92.835..92.835 rows=85941 loops=3)
                                 Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                 ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.200..66.375 rows=85941 loops=3)
                                       Hash Cond: (cc.status_id = cct2.id)
                                       ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.110..48.305 rows=85941 loops=3)
                                             Hash Cond: (cc.subject_id = cct1.id)
                                             ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.028..17.562 rows=135086 loops=3)
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.027..0.027 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'cast'::text)
                                                         Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.034..0.034 rows=2 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.021..0.023 rows=2 loops=3)
                                                   Filter: ((kind)::text ~~ '%complete%'::text)
                                                   Rows Removed by Filter: 2
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.030..0.032 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 35.066 ms
 Execution Time: 5400.532 ms
(67 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20c.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=689631.09..689631.10 rows=1 width=64) (actual time=6454.047..6454.047 rows=1 loops=1)
   ->  Gather  (cost=610141.72..689631.08 rows=1 width=32) (actual time=5857.356..6458.400 rows=5406 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Hash Join  (cost=609141.72..688630.98 rows=1 width=32) (actual time=5849.357..6439.325 rows=1802 loops=3)
               Hash Cond: (t.kind_id = kt.id)
               ->  Parallel Hash Join  (cost=609140.62..688629.88 rows=1 width=36) (actual time=5848.959..6438.032 rows=1906 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.080..385.640 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=609140.61..609140.61 rows=1 width=25) (actual time=5847.329..5847.329 rows=1906 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=557788.53..609140.61 rows=1 width=25) (actual time=5449.429..5791.378 rows=1906 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Hash Join  (cost=3102.42..54447.27 rows=1923 width=29) (actual time=94.584..440.569 rows=7852 loops=3)
                                       Hash Cond: (t.id = cc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.029..274.396 rows=460484 loops=3)
                                             Filter: (production_year > 2000)
                                             Rows Removed by Filter: 382286
                                       ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=94.152..94.152 rows=85941 loops=3)
                                             Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                             ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.241..67.155 rows=85941 loops=3)
                                                   Hash Cond: (cc.status_id = cct2.id)
                                                   ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.106..48.875 rows=85941 loops=3)
                                                         Hash Cond: (cc.subject_id = cct1.id)
                                                         ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.020..17.922 rows=135086 loops=3)
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.023..0.023 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.010..0.012 rows=1 loops=3)
                                                                     Filter: ((kind)::text = 'cast'::text)
                                                                     Rows Removed by Filter: 3
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.066..0.066 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.049..0.051 rows=2 loops=3)
                                                               Filter: ((kind)::text ~~ '%complete%'::text)
                                                               Rows Removed by Filter: 2
                                 ->  Parallel Hash  (cost=554683.94..554683.94 rows=174 width=12) (actual time=5346.124..5346.124 rows=12272 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2776kB
                                       ->  Parallel Hash Join  (cost=109433.18..554683.94 rows=174 width=12) (actual time=1129.334..5136.666 rows=12272 loops=3)
                                             Hash Cond: (ci.movie_id = mk.movie_id)
                                             ->  Parallel Hash Join  (cost=57211.57..500558.94 rows=507378 width=8) (actual time=528.817..4484.469 rows=207862 loops=3)
                                                   Hash Cond: (ci.person_role_id = chn.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.039..2269.590 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=56075.12..56075.12 rows=90916 width=4) (actual time=527.033..527.033 rows=60051 loops=3)
                                                         Buckets: 262144  Batches: 1  Memory Usage: 9152kB
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=4) (actual time=0.065..481.524 rows=60051 loops=3)
                                                               Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                                               Rows Removed by Filter: 986729
                                             ->  Parallel Hash  (cost=52219.86..52219.86 rows=140 width=4) (actual time=599.907..599.907 rows=8030 loops=3)
                                                   Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                   ->  Hash Join  (cost=3967.95..52219.86 rows=140 width=4) (actual time=46.128..488.672 rows=8030 loops=3)
                                                         Hash Cond: (mk.keyword_id = k.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.053..253.733 rows=1507977 loops=3)
                                                         ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=45.905..45.906 rows=10 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.199..45.888 rows=10 loops=3)
                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                     Rows Removed by Filter: 134160
               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=3)
                           Filter: ((kind)::text = 'movie'::text)
                           Rows Removed by Filter: 6
 Planning Time: 33.922 ms
 Execution Time: 6462.076 ms
(64 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21a.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=63661.87..63661.88 rows=1 width=96) (actual time=718.372..718.372 rows=1 loops=1)
   ->  Gather  (cost=63661.76..63661.87 rows=1 width=96) (actual time=718.193..723.767 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=62661.76..62661.77 rows=1 width=96) (actual time=712.437..712.437 rows=1 loops=2)
               ->  Hash Join  (cost=57154.03..62661.75 rows=1 width=118) (actual time=654.890..712.112 rows=705 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=57152.97..62660.68 rows=1 width=122) (actual time=652.624..711.764 rows=752 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.037..60.795 rows=24151 loops=2)
                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                 Rows Removed by Filter: 93348
                           ->  Parallel Hash  (cost=57152.95..57152.95 rows=1 width=107) (actual time=646.920..646.920 rows=1562 loops=2)
                                 Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                 ->  Hash Join  (cost=3473.02..57152.95 rows=1 width=107) (actual time=296.080..556.093 rows=1562 loops=2)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=846.89..54494.99 rows=12124 width=111) (actual time=59.658..534.956 rows=27148 loops=2)
                                             Merge Cond: (ml.movie_id = mk.movie_id)
                                             ->  Merge Join  (cost=651.93..51228.28 rows=260 width=123) (actual time=58.057..493.137 rows=3220 loops=2)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=651.50..46001.67 rows=102 width=111) (actual time=54.783..455.965 rows=656 loops=2)
                                                         Merge Cond: (ml.movie_id = t.id)
                                                         ->  Merge Join  (cost=651.07..37165.42 rows=282 width=90) (actual time=15.416..267.385 rows=1391 loops=2)
                                                               Merge Cond: (mi.movie_id = ml.movie_id)
                                                               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1002971.17 rows=60182 width=4) (actual time=1.327..255.653 rows=2058 loops=2)
                                                                     Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                                                                     Rows Removed by Filter: 255305
                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.559..10.809 rows=3172 loops=2)
                                                                     Sort Key: ml.movie_id
                                                                     Sort Method: quicksort  Memory: 205kB
                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.132..9.280 rows=2315 loops=2)
                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.028..5.007 rows=29997 loops=2)
                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.054..0.054 rows=2 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.033..0.038 rows=2 loops=2)
                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                       Rows Removed by Filter: 16
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=911963 width=21) (actual time=0.035..184.099 rows=51993 loops=2)
                                                               Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                                               Rows Removed by Filter: 110576
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.042..33.553 rows=40588 loops=2)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 39291
                                             ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.017..27.955 rows=102619 loops=2)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.272..18.272 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.091..18.259 rows=1 loops=2)
                                                   Filter: ((keyword)::text = 'sequel'::text)
                                                   Rows Removed by Filter: 134169
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.038..0.040 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 31.641 ms
 Execution Time: 724.598 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=61990.17..61990.18 rows=1 width=96) (actual time=522.378..522.378 rows=1 loops=1)
   ->  Gather  (cost=61990.05..61990.16 rows=1 width=96) (actual time=522.176..527.911 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=60990.05..60990.06 rows=1 width=96) (actual time=516.468..516.468 rows=1 loops=2)
               ->  Hash Join  (cost=55482.32..60990.04 rows=1 width=118) (actual time=485.990..516.433 rows=19 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=55481.26..60988.98 rows=1 width=122) (actual time=485.825..516.263 rows=19 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.036..59.953 rows=24151 loops=2)
                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                 Rows Removed by Filter: 93348
                           ->  Parallel Hash  (cost=55481.25..55481.25 rows=1 width=107) (actual time=452.887..452.887 rows=66 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                 ->  Hash Join  (cost=3474.93..55481.25 rows=1 width=107) (actual time=405.907..452.739 rows=66 loops=2)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=848.79..52824.70 rows=11587 width=111) (actual time=32.150..434.295 rows=2784 loops=2)
                                             Merge Cond: (ml.movie_id = mk.movie_id)
                                             ->  Merge Join  (cost=651.93..49563.13 rows=249 width=123) (actual time=24.862..405.254 rows=770 loops=2)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=651.50..44336.66 rows=97 width=111) (actual time=23.979..371.846 rows=338 loops=2)
                                                         Merge Cond: (ml.movie_id = t.id)
                                                         ->  Merge Join  (cost=651.07..35476.61 rows=237 width=90) (actual time=15.407..186.974 rows=544 loops=2)
                                                               Merge Cond: (mi.movie_id = ml.movie_id)
                                                               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..956609.55 rows=50482 width=4) (actual time=1.468..175.849 rows=1524 loops=2)
                                                                     Filter: ((info)::text = ANY ('{Germany,German}'::text[]))
                                                                     Rows Removed by Filter: 255930
                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.290..10.496 rows=2527 loops=2)
                                                                     Sort Key: ml.movie_id
                                                                     Sort Method: quicksort  Memory: 205kB
                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.127..9.035 rows=2315 loops=2)
                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.027..4.773 rows=29997 loops=2)
                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.047..0.047 rows=2 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.031..0.036 rows=2 loops=2)
                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                       Rows Removed by Filter: 16
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=1038952 width=21) (actual time=0.042..178.215 rows=80664 loops=2)
                                                               Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                               Rows Removed by Filter: 83756
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.024..30.069 rows=42314 loops=2)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 42471
                                             ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.018..20.093 rows=84660 loops=2)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.138..18.138 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.088..18.126 rows=1 loops=2)
                                                   Filter: ((keyword)::text = 'sequel'::text)
                                                   Rows Removed by Filter: 134169
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.038..0.040 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 31.466 ms
 Execution Time: 528.750 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21c.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=54436.16..54436.17 rows=1 width=96) (actual time=611.562..611.563 rows=1 loops=1)
   ->  Hash Join  (cost=22630.14..54436.15 rows=1 width=118) (actual time=286.140..610.710 rows=1874 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=20004.00..51778.36 rows=12060 width=122) (actual time=201.593..589.161 rows=33031 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Merge Join  (cost=208.46..1509126.58 rows=11385503 width=12) (actual time=0.152..379.835 rows=55032 loops=1)
                     Merge Cond: (mi.movie_id = mk.movie_id)
                     ->  Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1194599.22 rows=893642 width=4) (actual time=0.109..317.213 rows=28657 loops=1)
                           Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))
                           Rows Removed by Filter: 414007
                     ->  Materialize  (cost=0.43..153366.95 rows=4523930 width=8) (actual time=0.038..38.679 rows=85569 loops=1)
                           ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.027..22.894 rows=82171 loops=1)
               ->  Sort  (cost=19795.25..19795.61 rows=144 width=130) (actual time=195.650..197.754 rows=33234 loops=1)
                     Sort Key: mc.movie_id
                     Sort Method: quicksort  Memory: 203kB
                     ->  Gather  (cost=7378.71..19790.09 rows=144 width=130) (actual time=86.719..196.250 rows=1130 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Hash Join  (cost=6378.71..18775.69 rows=60 width=130) (actual time=76.281..182.024 rows=377 loops=3)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=6377.65..18773.33 rows=240 width=134) (actual time=76.035..181.652 rows=393 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Merge Join  (cost=651.50..13043.69 rows=1331 width=119) (actual time=12.570..131.293 rows=1672 loops=3)
                                             Merge Cond: (ml.movie_id = mc.movie_id)
                                             ->  Merge Join  (cost=651.07..7805.34 rows=520 width=107) (actual time=12.389..92.514 rows=749 loops=3)
                                                   Merge Cond: (t.id = ml.movie_id)
                                                   ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=789968 width=21) (actual time=0.819..76.768 rows=48445 loops=3)
                                                         Filter: ((production_year >= 1950) AND (production_year <= 2010))
                                                         Rows Removed by Filter: 13625
                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.979..11.167 rows=2315 loops=3)
                                                         Sort Key: ml.movie_id
                                                         Sort Method: quicksort  Memory: 205kB
                                                         Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                         Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.138..9.705 rows=2315 loops=3)
                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.029..5.408 rows=29997 loops=3)
                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.046..0.046 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.028..0.033 rows=2 loops=3)
                                                                           Filter: ((link)::text ~~ '%follow%'::text)
                                                                           Rows Removed by Filter: 16
                                             ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.031..34.893 rows=45394 loops=3)
                                                   Filter: (note IS NULL)
                                                   Rows Removed by Filter: 46200
                                       ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=48.908..48.908 rows=16101 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.028..38.873 rows=16101 loops=3)
                                                   Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                   Rows Removed by Filter: 62232
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=3)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.414..18.414 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.093..18.402 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 32.373 ms
 Execution Time: 613.585 ms
(62 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=414666.61..414666.62 rows=1 width=96) (actual time=3263.639..3263.639 rows=1 loops=1)
   ->  Gather  (cost=414666.39..414666.60 rows=2 width=96) (actual time=3262.041..3269.272 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=413666.39..413666.40 rows=1 width=96) (actual time=3254.296..3254.297 rows=1 loops=3)
               ->  Hash Join  (cost=363451.32..413666.38 rows=1 width=41) (actual time=3095.340..3253.831 rows=950 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=363450.20..413665.27 rows=1 width=45) (actual time=3063.554..3253.257 rows=1009 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=279670 width=25) (actual time=0.008..258.505 rows=220688 loops=3)
                                 Filter: (production_year > 2008)
                                 Rows Removed by Filter: 622082
                           ->  Parallel Hash  (cost=363450.19..363450.19 rows=1 width=40) (actual time=2960.116..2960.116 rows=13395 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4088kB
                                 ->  Hash Join  (cost=358450.15..363450.19 rows=1 width=40) (actual time=2898.114..2944.056 rows=13395 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=358449.06..363449.10 rows=1 width=44) (actual time=2898.012..2940.472 rows=13395 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.037..30.304 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=358449.05..358449.05 rows=1 width=29) (actual time=2897.859..2897.859 rows=14738 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3832kB
                                                   ->  Parallel Hash Join  (cost=323145.98..358449.05 rows=1 width=29) (actual time=2583.607..2868.930 rows=14738 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.015..268.038 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=323145.97..323145.97 rows=1 width=17) (actual time=2582.081..2582.081 rows=5361 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                                                               ->  Parallel Hash Join  (cost=67689.63..323145.97 rows=1 width=17) (actual time=2181.077..2556.684 rows=5361 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255449.73 rows=2405 width=4) (actual time=1344.609..1692.242 rows=196255 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=271735 width=8) (actual time=0.716..1642.459 rows=223112 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Germany,German,USA,American}'::text[]))
                                                                                 Rows Removed by Filter: 4722128
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'countries'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=67687.20..67687.20 rows=1 width=13) (actual time=835.884..835.884 rows=8267 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1752kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..67687.20 rows=1 width=13) (actual time=575.527..803.705 rows=8267 loops=3)
                                                                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..16456.75 rows=4327 width=9) (actual time=0.195..210.450 rows=108039 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=488953 width=13) (actual time=0.037..157.454 rows=390635 loops=3)
                                                                                             Filter: ((info)::text < '7.0'::text)
                                                                                             Rows Removed by Filter: 69377
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.043 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=574.771..574.771 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=37.534..480.043 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..255.395 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=37.353..37.353 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.642..37.340 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.042..0.042 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.029..0.030 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.068..0.068 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.046..0.049 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 80.926 ms
 Execution Time: 3270.515 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22b.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=414463.52..414463.53 rows=1 width=96) (actual time=3339.813..3339.813 rows=1 loops=1)
   ->  Gather  (cost=414463.29..414463.50 rows=2 width=96) (actual time=3338.136..3347.451 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=413463.29..413463.30 rows=1 width=96) (actual time=3330.220..3330.220 rows=1 loops=3)
               ->  Hash Join  (cost=363451.32..413463.29 rows=1 width=41) (actual time=3234.636..3330.186 rows=10 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=363450.20..413462.17 rows=1 width=45) (actual time=3234.320..3329.865 rows=11 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=225511 width=25) (actual time=0.014..261.273 rows=177790 loops=3)
                                 Filter: (production_year > 2009)
                                 Rows Removed by Filter: 664981
                           ->  Parallel Hash  (cost=363450.19..363450.19 rows=1 width=40) (actual time=3038.584..3038.584 rows=13395 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4088kB
                                 ->  Hash Join  (cost=358450.15..363450.19 rows=1 width=40) (actual time=2986.512..3022.739 rows=13395 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=358449.06..363449.10 rows=1 width=44) (actual time=2986.414..3019.203 rows=13395 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.020..19.959 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=358449.05..358449.05 rows=1 width=29) (actual time=2986.283..2986.283 rows=14738 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                                   ->  Parallel Hash Join  (cost=323145.98..358449.05 rows=1 width=29) (actual time=2668.191..2959.245 rows=14738 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.017..274.507 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=323145.97..323145.97 rows=1 width=17) (actual time=2665.480..2665.480 rows=5361 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                                                               ->  Parallel Hash Join  (cost=67689.63..323145.97 rows=1 width=17) (actual time=2252.179..2640.361 rows=5361 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255449.73 rows=2405 width=4) (actual time=1432.261..1792.308 rows=196255 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=271735 width=8) (actual time=0.702..1742.116 rows=223112 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Germany,German,USA,American}'::text[]))
                                                                                 Rows Removed by Filter: 4722128
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.027 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'countries'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=67687.20..67687.20 rows=1 width=13) (actual time=819.193..819.194 rows=8267 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1752kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..67687.20 rows=1 width=13) (actual time=561.125..794.602 rows=8267 loops=3)
                                                                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..16456.75 rows=4327 width=9) (actual time=0.194..214.235 rows=108039 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=488953 width=13) (actual time=0.044..161.377 rows=390635 loops=3)
                                                                                             Filter: ((info)::text < '7.0'::text)
                                                                                             Rows Removed by Filter: 69377
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.048 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=560.362..560.362 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.979..474.590 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.034..254.846 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.711..32.711 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.521..32.696 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.044..0.044 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.029..0.031 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.070..0.070 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.045..0.048 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 80.726 ms
 Execution Time: 3348.702 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22c.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=461803.15..461803.16 rows=1 width=96) (actual time=4086.593..4086.593 rows=1 loops=1)
   ->  Gather  (cost=461802.92..461803.13 rows=2 width=96) (actual time=4084.383..4092.774 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=460802.92..460802.93 rows=1 width=96) (actual time=4076.199..4076.200 rows=1 loops=3)
               ->  Hash Join  (cost=410038.34..460802.92 rows=1 width=41) (actual time=3758.334..4073.046 rows=7163 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=410037.22..460801.80 rows=1 width=45) (actual time=3747.936..4070.866 rows=7732 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.011..268.458 rows=337640 loops=3)
                                 Filter: (production_year > 2005)
                                 Rows Removed by Filter: 505131
                           ->  Parallel Hash  (cost=410037.21..410037.21 rows=1 width=40) (actual time=3741.419..3741.419 rows=21916 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5976kB
                                 ->  Hash Join  (cost=405037.17..410037.21 rows=1 width=40) (actual time=3677.705..3719.785 rows=21916 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=405036.08..410036.12 rows=1 width=44) (actual time=3677.582..3714.021 rows=21916 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.014..19.758 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=405036.07..405036.07 rows=1 width=29) (actual time=3677.464..3677.464 rows=23616 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6520kB
                                                   ->  Parallel Hash Join  (cost=369733.01..405036.07 rows=1 width=29) (actual time=3316.397..3615.666 rows=23616 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.017..278.674 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3315.308..3315.308 rows=6989 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                                               ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=3027.733..3276.938 rows=6989 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.460..227.089 rows=151410 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.343..162.740 rows=447629 loops=3)
                                                                                 Filter: ((info)::text < '8.5'::text)
                                                                                 Rows Removed by Filter: 12383
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=3026.577..3026.577 rows=7972 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1496kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2459.777..2978.299 rows=7972 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1880.255..2369.265 rows=204750 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.014..2317.031 rows=238737 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                                                             Rows Removed by Filter: 4706503
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.049 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'countries'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=579.093..579.093 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.938..476.734 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.037..255.529 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.731..32.731 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.501..32.719 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.042..0.042 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.029..0.031 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.068..0.068 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.045..0.048 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 83.947 ms
 Execution Time: 4094.608 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22d.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=460238.12..460238.13 rows=1 width=96) (actual time=5657.454..5657.455 rows=1 loops=1)
   ->  Gather  (cost=460238.00..460238.11 rows=1 width=96) (actual time=5656.718..5662.383 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=459238.00..459238.01 rows=1 width=96) (actual time=5650.899..5650.900 rows=1 loops=2)
               ->  Hash Join  (cost=454237.96..459238.00 rows=1 width=41) (actual time=5588.430..5641.640 rows=23140 loops=2)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=454236.84..459236.88 rows=1 width=45) (actual time=5588.184..5635.887 rows=24954 loops=2)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=454235.75..459235.79 rows=1 width=49) (actual time=5588.079..5629.803 rows=24954 loops=2)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.015..24.890 rows=63115 loops=2)
                                       Filter: ((country_code)::text <> '[us]'::text)
                                       Rows Removed by Filter: 54384
                                 ->  Parallel Hash  (cost=454235.74..454235.74 rows=1 width=34) (actual time=5587.482..5587.482 rows=35884 loops=2)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6776kB
                                       ->  Parallel Hash Join  (cost=420497.60..454235.74 rows=1 width=34) (actual time=5126.648..5551.602 rows=35884 loops=2)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..234.027 rows=1304564 loops=2)
                                             ->  Parallel Hash  (cost=420497.58..420497.58 rows=1 width=42) (actual time=5126.454..5126.454 rows=2566 loops=2)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                   ->  Parallel Hash Join  (cost=369733.01..420497.58 rows=1 width=42) (actual time=4649.085..5111.156 rows=2566 loops=2)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.015..391.493 rows=506460 loops=2)
                                                               Filter: (production_year > 2005)
                                                               Rows Removed by Filter: 757696
                                                         ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=4648.138..4648.138 rows=10484 loops=2)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                               ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=4264.021..4627.058 rows=10484 loops=2)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.183..329.472 rows=227115 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.079..234.158 rows=671443 loops=2)
                                                                                 Filter: ((info)::text < '8.5'::text)
                                                                                 Rows Removed by Filter: 18574
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=4263.029..4263.029 rows=11958 loops=2)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=3451.892..4210.167 rows=11958 loops=2)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=2677.590..3392.366 rows=307126 loops=2)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.420..3314.281 rows=358105 loops=2)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                                                             Rows Removed by Filter: 7059755
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.054 rows=1 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.043 rows=1 loops=2)
                                                                                                   Filter: ((info)::text = 'countries'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=773.873..773.874 rows=18546 loops=2)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.720..687.456 rows=18546 loops=2)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.039..372.896 rows=2261965 loops=2)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.567..32.567 rows=3 loops=2)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.491..32.542 rows=3 loops=2)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.041..0.041 rows=4 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.028..0.029 rows=4 loops=2)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.058..0.058 rows=2 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.038..0.041 rows=2 loops=2)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 81.659 ms
 Execution Time: 5663.663 ms
(74 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23a.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=418779.45..418779.46 rows=1 width=64) (actual time=2492.305..2492.305 rows=1 loops=1)
   ->  Gather  (cost=418779.23..418779.44 rows=2 width=64) (actual time=2491.956..2500.214 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=417779.23..417779.24 rows=1 width=64) (actual time=2483.790..2483.791 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=413873.01..417779.22 rows=1 width=65) (actual time=2431.333..2483.664 rows=206 loops=3)
                     Hash Cond: (k.id = mk.keyword_id)
                     ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.112..47.393 rows=44723 loops=3)
                           Heap Fetches: 134170
                     ->  Parallel Hash  (cost=413872.58..413872.58 rows=1 width=69) (actual time=2430.475..2430.475 rows=206 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=363500.14..413872.58 rows=1 width=69) (actual time=2349.803..2430.287 rows=206 loops=3)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Hash Join  (cost=363499.05..413871.49 rows=1 width=73) (actual time=2349.689..2430.125 rows=206 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Hash Join  (cost=363496.62..413868.99 rows=26 width=77) (actual time=2349.579..2429.969 rows=206 loops=3)
                                             Hash Cond: (mk.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..256.758 rows=1507977 loops=3)
                                             ->  Parallel Hash  (cost=363496.59..363496.59 rows=3 width=89) (actual time=1993.154..1993.154 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Parallel Hash Join  (cost=358585.30..363496.59 rows=3 width=89) (actual time=1986.765..1993.083 rows=2 loops=3)
                                                         Hash Cond: (cn.id = mc.company_id)
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.016..17.102 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                                                         ->  Parallel Hash  (cost=358585.24..358585.24 rows=5 width=93) (actual time=1973.207..1973.207 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=324847.09..358585.24 rows=5 width=93) (actual time=1917.846..1973.120 rows=2 loops=3)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.009..161.408 rows=869710 loops=3)
                                                                     ->  Parallel Hash  (cost=324847.07..324847.07 rows=2 width=81) (actual time=1705.272..1705.272 rows=2 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=54685.18..324847.07 rows=2 width=81) (actual time=1193.343..1705.184 rows=2 loops=3)
                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=8) (actual time=319.224..1312.863 rows=594 loops=3)
                                                                                       Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                       Rows Removed by Filter: 4944646
                                                                                 ->  Parallel Hash  (cost=54671.45..54671.45 rows=1099 width=73) (actual time=391.801..391.801 rows=344 loops=3)
                                                                                       Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                                                                       ->  Hash Join  (cost=3236.49..54671.45 rows=1099 width=73) (actual time=272.456..391.283 rows=344 loops=3)
                                                                                             Hash Cond: (t.kind_id = kt.id)
                                                                                             ->  Hash Join  (cost=3235.39..54637.93 rows=7692 width=29) (actual time=51.048..390.927 rows=694 loops=3)
                                                                                                   Hash Cond: (t.id = cc.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.024..286.137 rows=460484 loops=3)
                                                                                                         Filter: (production_year > 2000)
                                                                                                         Rows Removed by Filter: 382286
                                                                                                   ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=49.723..49.723 rows=24592 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.146..42.548 rows=24592 loops=3)
                                                                                                               Hash Cond: (cc.status_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.038..21.736 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'complete+verified'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                             ->  Hash  (cost=1.09..1.09 rows=1 width=52) (actual time=0.058..0.058 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=52) (actual time=0.044..0.046 rows=1 loops=3)
                                                                                                         Filter: ((kind)::text = 'movie'::text)
                                                                                                         Rows Removed by Filter: 6
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.044 rows=1 loops=3)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.057..0.057 rows=4 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.034..0.035 rows=4 loops=3)
 Planning Time: 83.145 ms
 Execution Time: 2501.317 ms
(71 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23b.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=400136.80..400136.81 rows=1 width=64) (actual time=4183.509..4183.509 rows=1 loops=1)
   ->  Gather  (cost=400136.69..400136.80 rows=1 width=64) (actual time=4183.171..4188.531 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=399136.69..399136.70 rows=1 width=64) (actual time=4177.332..4177.333 rows=1 loops=2)
               ->  Hash Join  (cost=394225.39..399136.68 rows=1 width=65) (actual time=4174.001..4177.322 rows=8 loops=2)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=394224.29..399135.58 rows=1 width=21) (actual time=4173.745..4177.064 rows=8 loops=2)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=394223.20..399134.49 rows=1 width=25) (actual time=4173.643..4176.960 rows=8 loops=2)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..23.360 rows=42422 loops=2)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 75077
                                 ->  Parallel Hash  (cost=394223.19..394223.19 rows=1 width=29) (actual time=4149.208..4149.208 rows=8 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Hash Join  (cost=360485.03..394223.19 rows=1 width=29) (actual time=4137.985..4149.141 rows=8 loops=2)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Parallel Hash Join  (cost=357249.64..390987.79 rows=1 width=45) (actual time=3872.352..4103.848 rows=6 loops=2)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..230.208 rows=1304564 loops=2)
                                                   ->  Parallel Hash  (cost=357249.63..357249.63 rows=1 width=33) (actual time=3714.594..3714.594 rows=5 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                         ->  Parallel Hash Join  (cost=305924.00..357249.63 rows=1 width=33) (actual time=3438.949..3714.538 rows=5 loops=2)
                                                               Hash Cond: (t.id = mi.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.015..402.538 rows=690726 loops=2)
                                                                     Filter: (production_year > 2000)
                                                                     Rows Removed by Filter: 573430
                                                               ->  Parallel Hash  (cost=305923.99..305923.99 rows=1 width=8) (actual time=3242.363..3242.363 rows=5 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                     ->  Parallel Hash Join  (cost=257671.78..305923.99 rows=1 width=8) (actual time=2917.499..3242.298 rows=5 loops=2)
                                                                           Hash Cond: (mk.movie_id = mi.movie_id)
                                                                           ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=29.487..677.737 rows=566 loops=2)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.029..373.630 rows=2261965 loops=2)
                                                                                 ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=29.290..29.290 rows=4 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.923..29.265 rows=4 loops=2)
                                                                                             Filter: ((keyword)::text = ANY ('{nerd,loner,alienation,dignity}'::text[]))
                                                                                             Rows Removed by Filter: 134166
                                                                           ->  Parallel Hash  (cost=254710.16..254710.16 rows=2 width=4) (actual time=2564.170..2564.170 rows=886 loops=2)
                                                                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                                                 ->  Hash Join  (cost=2.43..254710.16 rows=2 width=4) (actual time=423.606..1655.090 rows=886 loops=2)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=8) (actual time=423.449..1654.107 rows=886 loops=2)
                                                                                             Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                                                                             Rows Removed by Filter: 7416974
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.063..0.063 rows=1 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.052 rows=1 loops=2)
                                                                                                   Filter: ((info)::text = 'release dates'::text)
                                                                                                   Rows Removed by Filter: 112
                                             ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=44.215..44.215 rows=24592 loops=2)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                   ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.148..37.167 rows=24592 loops=2)
                                                         Hash Cond: (cc.status_id = cct1.id)
                                                         ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.029..16.534 rows=135086 loops=2)
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.030..0.031 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'complete+verified'::text)
                                                                     Rows Removed by Filter: 3
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.044..0.044 rows=4 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.027..0.029 rows=4 loops=2)
                     ->  Hash  (cost=1.09..1.09 rows=1 width=52) (actual time=0.066..0.066 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=52) (actual time=0.043..0.045 rows=1 loops=2)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 82.418 ms
 Execution Time: 4189.519 ms
(72 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=419448.86..419448.87 rows=1 width=64) (actual time=2407.497..2407.497 rows=1 loops=1)
   ->  Gather  (cost=419448.64..419448.85 rows=2 width=64) (actual time=2407.012..2414.940 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=418448.64..418448.65 rows=1 width=64) (actual time=2399.272..2399.272 rows=1 loops=3)
               ->  Hash Join  (cost=414542.42..418448.63 rows=2 width=65) (actual time=2353.276..2399.155 rows=209 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=414541.33..418447.54 rows=2 width=69) (actual time=2353.003..2398.820 rows=209 loops=3)
                           Hash Cond: (k.id = mk.keyword_id)
                           ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.106..40.947 rows=44723 loops=3)
                                 Heap Fetches: 134170
                           ->  Parallel Hash  (cost=414540.87..414540.87 rows=3 width=73) (actual time=2352.343..2352.343 rows=209 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                 ->  Parallel Hash Join  (cost=409629.58..414540.87 rows=3 width=73) (actual time=2341.145..2352.192 rows=209 loops=3)
                                       Hash Cond: (cn.id = mc.company_id)
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.036..17.175 rows=28281 loops=3)
                                             Filter: ((country_code)::text = '[us]'::text)
                                             Rows Removed by Filter: 50051
                                       ->  Parallel Hash  (cost=409629.53..409629.53 rows=4 width=77) (actual time=2332.085..2332.085 rows=209 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Hash Join  (cost=359255.99..409629.53 rows=4 width=77) (actual time=2213.320..2331.935 rows=209 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=359253.57..409626.13 rows=360 width=81) (actual time=2213.213..2331.779 rows=209 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..251.064 rows=1507977 loops=3)
                                                         ->  Parallel Hash  (cost=359253.22..359253.22 rows=28 width=93) (actual time=1900.827..1900.828 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=325515.05..359253.22 rows=28 width=93) (actual time=1779.708..1900.739 rows=2 loops=3)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.006..157.239 rows=869710 loops=3)
                                                                     ->  Parallel Hash  (cost=325514.95..325514.95 rows=8 width=81) (actual time=1636.741..1636.741 rows=2 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=55353.07..325514.95 rows=8 width=81) (actual time=1135.296..1636.647 rows=2 loops=3)
                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=8) (actual time=304.593..1234.656 rows=594 loops=3)
                                                                                       Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                       Rows Removed by Filter: 4944646
                                                                                 ->  Parallel Hash  (cost=55283.32..55283.32 rows=5580 width=73) (actual time=401.390..401.390 rows=1684 loops=3)
                                                                                       Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                                                       ->  Hash Join  (cost=3236.54..55283.32 rows=5580 width=73) (actual time=266.810..399.562 rows=1684 loops=3)
                                                                                             Hash Cond: (t.kind_id = kt.id)
                                                                                             ->  Hash Join  (cost=3235.39..55241.01 rows=9766 width=29) (actual time=46.128..398.588 rows=2141 loops=3)
                                                                                                   Hash Cond: (t.id = cc.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=25) (actual time=0.028..285.621 rows=583011 loops=3)
                                                                                                         Filter: (production_year > 1990)
                                                                                                         Rows Removed by Filter: 259760
                                                                                                   ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=44.421..44.422 rows=24592 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.137..37.388 rows=24592 loops=3)
                                                                                                               Hash Cond: (cc.status_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.031..16.773 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.028..0.029 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'complete+verified'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                             ->  Hash  (cost=1.10..1.10 rows=4 width=52) (actual time=0.055..0.055 rows=4 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.10 rows=4 width=52) (actual time=0.041..0.044 rows=4 loops=3)
                                                                                                         Filter: ((kind)::text = ANY ('{movie,"tv movie","video movie","video game"}'::text[]))
                                                                                                         Rows Removed by Filter: 3
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.043 rows=1 loops=3)
                                                               Filter: ((info)::text = 'release dates'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.066..0.066 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.038..0.039 rows=4 loops=3)
 Planning Time: 81.590 ms
 Execution Time: 2415.927 ms
(71 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/24a.sql_explained.sql
SET
SET
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1028775.06..1028775.07 rows=1 width=96) (actual time=7114.757..7114.758 rows=1 loops=1)
   ->  Hash Join  (cost=773581.49..1028775.05 rows=1 width=48) (actual time=6061.872..7114.623 rows=275 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Gather  (cost=773579.07..1028772.62 rows=1 width=52) (actual time=6061.766..7121.061 rows=275 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=772579.07..1027772.52 rows=1 width=52) (actual time=6035.864..7106.170 rows=92 loops=3)
                     Hash Cond: (mi.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=129652 width=8) (actual time=274.884..1731.247 rows=100416 loops=3)
                           Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))
                           Rows Removed by Filter: 4844824
                     ->  Parallel Hash  (cost=772579.06..772579.06 rows=1 width=64) (actual time=5362.122..5362.122 rows=42 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=767667.77..772579.06 rows=1 width=64) (actual time=5341.068..5362.008 rows=42 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.012..19.783 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=767667.75..767667.75 rows=1 width=68) (actual time=5339.232..5339.232 rows=115 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=733929.61..767667.75 rows=1 width=68) (actual time=5147.029..5339.096 rows=115 loops=3)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.006..159.058 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=733929.60..733929.60 rows=1 width=60) (actual time=5072.949..5072.949 rows=13 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=679490.06..733929.60 rows=1 width=60) (actual time=4908.916..5072.876 rows=13 loops=3)
                                                         Hash Cond: (ci.role_id = rt.id)
                                                         ->  Parallel Hash Join  (cost=679488.90..733928.43 rows=1 width=64) (actual time=4908.796..5072.752 rows=13 loops=3)
                                                               Hash Cond: (chn.id = ci.person_role_id)
                                                               ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.039..251.777 rows=1046780 loops=3)
                                                               ->  Parallel Hash  (cost=679488.88..679488.88 rows=1 width=52) (actual time=4694.956..4694.956 rows=13 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=663335.18..679488.88 rows=1 width=52) (actual time=4604.660..4694.831 rows=13 loops=3)
                                                                           Hash Cond: (n.id = ci.person_id)
                                                                           ->  Parallel Hash Join  (cost=81910.23..98047.67 rows=4333 width=23) (actual time=547.864..677.377 rows=3508 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.030..76.605 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=546.906..546.907 rows=16670 loops=3)
                                                                                       Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=223.638..533.552 rows=16670 loops=3)
                                                                                             Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1372493
                                                                           ->  Parallel Hash  (cost=581424.93..581424.93 rows=2 width=41) (actual time=4016.651..4016.652 rows=875 loops=3)
                                                                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                                                 ->  Parallel Hash Join  (cost=100834.61..581424.93 rows=2 width=41) (actual time=880.002..3735.099 rows=875 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=1.075..2815.604 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Parallel Hash  (cost=100834.53..100834.53 rows=7 width=25) (actual time=876.694..876.694 rows=165 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=51046.31..100834.53 rows=7 width=25) (actual time=609.207..876.453 rows=165 loops=3)
                                                                                                   Hash Cond: (t.id = mk.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.030..249.964 rows=130555 loops=3)
                                                                                                         Filter: (production_year > 2010)
                                                                                                         Rows Removed by Filter: 712215
                                                                                                   ->  Parallel Hash  (cost=51045.79..51045.79 rows=42 width=4) (actual time=604.934..604.935 rows=3232 loops=3)
                                                                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                                                                         ->  Hash Join  (cost=2793.88..51045.79 rows=42 width=4) (actual time=30.926..464.507 rows=3232 loops=3)
                                                                                                               Hash Cond: (mk.keyword_id = k.id)
                                                                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.032..251.337 rows=1507977 loops=3)
                                                                                                               ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=29.236..29.236 rows=3 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=0.080..29.221 rows=3 loops=3)
                                                                                                                           Filter: ((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat}'::text[]))
                                                                                                                           Rows Removed by Filter: 134167
                                                         ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                                                     Filter: ((role)::text = 'actress'::text)
                                                                     Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.014..0.025 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 99.397 ms
 Execution Time: 7122.332 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/24b.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1031111.24..1031111.25 rows=1 width=96) (actual time=6833.796..6833.797 rows=1 loops=1)
   ->  Hash Join  (cost=775917.68..1031111.23 rows=1 width=48) (actual time=6832.974..6833.739 rows=45 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Gather  (cost=775915.25..1031108.81 rows=1 width=52) (actual time=6832.865..6841.176 rows=45 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=774915.25..1030108.71 rows=1 width=52) (actual time=6108.308..6825.075 rows=15 loops=3)
                     Hash Cond: (mi.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=129652 width=8) (actual time=278.260..1764.372 rows=100416 loops=3)
                           Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))
                           Rows Removed by Filter: 4844824
                     ->  Parallel Hash  (cost=774915.24..774915.24 rows=1 width=64) (actual time=5048.185..5048.185 rows=8 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Hash Join  (cost=720475.70..774915.24 rows=1 width=64) (actual time=5005.724..5048.107 rows=8 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Hash Join  (cost=720474.54..774914.07 rows=1 width=68) (actual time=5005.618..5048.000 rows=8 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.044..266.112 rows=1046780 loops=3)
                                       ->  Parallel Hash  (cost=720474.52..720474.52 rows=1 width=56) (actual time=4656.254..4656.254 rows=8 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=704320.82..720474.52 rows=1 width=56) (actual time=4623.171..4656.114 rows=8 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Hash Join  (cost=81910.23..98047.67 rows=4333 width=23) (actual time=564.187..695.977 rows=3508 loops=3)
                                                         Hash Cond: (an.person_id = n.id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.023..78.999 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=563.145..563.145 rows=16670 loops=3)
                                                               Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=229.539..547.946 rows=16670 loops=3)
                                                                     Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                     Rows Removed by Filter: 1372493
                                                   ->  Parallel Hash  (cost=622410.58..622410.58 rows=1 width=45) (actual time=3959.598..3959.598 rows=36 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=141820.27..622410.58 rows=1 width=45) (actual time=1156.320..3959.467 rows=36 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.181..2896.783 rows=289159 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                     Rows Removed by Filter: 11792289
                                                               ->  Parallel Hash  (cost=141820.25..141820.25 rows=1 width=29) (actual time=1024.865..1024.865 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Hash Join  (cost=108082.11..141820.25 rows=1 width=29) (actual time=973.141..1024.788 rows=2 loops=3)
                                                                           Hash Cond: (mc.company_id = cn.id)
                                                                           ->  Parallel Hash Join  (cost=103013.59..136751.74 rows=1 width=33) (actual time=817.677..1001.201 rows=21 loops=3)
                                                                                 Hash Cond: (mc.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.010..165.880 rows=869710 loops=3)
                                                                                 ->  Parallel Hash  (cost=103013.58..103013.58 rows=1 width=25) (actual time=726.931..726.931 rows=2 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Hash Join  (cost=54761.74..103013.58 rows=1 width=25) (actual time=525.193..726.804 rows=2 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Hash Join  (cost=51800.14..100051.91 rows=28 width=29) (actual time=492.660..694.266 rows=29 loops=3)
                                                                                                   Hash Cond: (mk.movie_id = t.id)
                                                                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.057..255.822 rows=1507977 loops=3)
                                                                                                   ->  Parallel Hash  (cost=51799.95..51799.95 rows=15 width=21) (actual time=257.965..257.965 rows=3 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=15 width=21) (actual time=109.705..257.878 rows=3 loops=3)
                                                                                                               Filter: ((production_year > 2010) AND ((title)::text ~~ 'Kung Fu Panda%'::text))
                                                                                                               Rows Removed by Filter: 842768
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.475..32.475 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.082..32.457 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat,computer-animated-movie}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                                                           ->  Parallel Hash  (cost=5068.50..5068.50 rows=1 width=4) (actual time=23.509..23.509 rows=0 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..5068.50 rows=1 width=4) (actual time=17.600..23.467 rows=0 loops=3)
                                                                                       Filter: (((country_code)::text = '[us]'::text) AND ((name)::text = 'DreamWorks Animation'::text))
                                                                                       Rows Removed by Filter: 78332
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.030..0.032 rows=1 loops=3)
                                             Filter: ((role)::text = 'actress'::text)
                                             Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 99.290 ms
 Execution Time: 6842.281 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=937486.93..937486.94 rows=1 width=128) (actual time=6008.150..6008.150 rows=1 loops=1)
   ->  Gather  (cost=937486.70..937486.91 rows=2 width=128) (actual time=6007.343..6014.511 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=936486.70..936486.71 rows=1 width=128) (actual time=5999.897..5999.897 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=886003.56..936486.69 rows=1 width=80) (actual time=5758.115..5998.564 rows=1469 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.022..228.286 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=886003.55..886003.55 rows=1 width=79) (actual time=5644.720..5644.720 rows=1469 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                           ->  Parallel Hash Join  (cost=805976.20..886003.55 rows=1 width=79) (actual time=5083.414..5602.430 rows=1469 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.054..448.594 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=805976.19..805976.19 rows=1 width=68) (actual time=5082.826..5082.826 rows=2371 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 664kB
                                       ->  Parallel Hash Join  (cost=305955.51..805976.19 rows=1 width=68) (actual time=3865.026..4995.235 rows=2371 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=166.005..2912.867 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=305955.50..305955.50 rows=1 width=60) (actual time=2028.487..2028.487 rows=3796 loops=3)
                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 984kB
                                                   ->  Parallel Hash Join  (cost=290685.23..305955.50 rows=1 width=60) (actual time=1809.788..1990.624 rows=3796 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.142..160.902 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.036..77.539 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.041..0.041 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=290682.79..290682.79 rows=1 width=51) (actual time=1808.901..1808.901 rows=4146 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 920kB
                                                               ->  Parallel Hash Join  (cost=51384.54..290682.79 rows=1 width=51) (actual time=1650.001..1775.850 rows=4146 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..239300.13 rows=144 width=47) (actual time=1108.540..1229.331 rows=10138 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=16278 width=51) (actual time=772.347..1224.794 rows=10267 loops=3)
                                                                                 Filter: ((info)::text = 'Horror'::text)
                                                                                 Rows Removed by Filter: 4934973
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.090..0.090 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.053..0.066 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'genres'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=51381.24..51381.24 rows=70 width=4) (actual time=541.346..541.346 rows=20699 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3480kB
                                                                           ->  Hash Join  (cost=3129.33..51381.24 rows=70 width=4) (actual time=34.962..475.796 rows=20699 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.041..251.532 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=3129.26..3129.26 rows=5 width=4) (actual time=34.797..34.797 rows=5 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..3129.26 rows=5 width=4) (actual time=0.970..34.773 rows=5 loops=3)
                                                                                             Filter: ((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))
                                                                                             Rows Removed by Filter: 134165
 Planning Time: 29.206 ms
 Execution Time: 6015.517 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25b.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=938224.64..938224.65 rows=1 width=128) (actual time=5582.503..5582.503 rows=1 loops=1)
   ->  Gather  (cost=938224.41..938224.62 rows=2 width=128) (actual time=5582.246..5588.588 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=937224.41..937224.42 rows=1 width=128) (actual time=5574.776..5574.777 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=857197.05..937224.40 rows=1 width=80) (actual time=5419.181..5574.761 rows=2 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.038..447.160 rows=579860 loops=3)
                           Filter: ((gender)::text = 'm'::text)
                           Rows Removed by Filter: 809304
                     ->  Parallel Hash  (cost=857197.04..857197.04 rows=1 width=69) (actual time=5070.419..5070.419 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=617898.78..857197.04 rows=1 width=69) (actual time=5057.723..5070.333 rows=2 loops=3)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..239300.13 rows=144 width=47) (actual time=1108.676..1229.400 rows=10138 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=16278 width=51) (actual time=773.529..1225.029 rows=10267 loops=3)
                                             Filter: ((info)::text = 'Horror'::text)
                                             Rows Removed by Filter: 4934973
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.042..0.043 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.029 rows=1 loops=3)
                                                   Filter: ((info)::text = 'genres'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=617896.35..617896.35 rows=1 width=42) (actual time=3839.257..3839.257 rows=2 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=602626.08..617896.35 rows=1 width=42) (actual time=3834.918..3839.187 rows=2 loops=3)
                                             Hash Cond: (mi_idx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.166..161.294 rows=153308 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.032..78.632 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.042 rows=1 loops=3)
                                                               Filter: ((info)::text = 'votes'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=602623.64..602623.64 rows=1 width=33) (actual time=3663.091..3663.091 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Parallel Hash Join  (cost=554371.45..602623.64 rows=1 width=33) (actual time=3650.301..3663.043 rows=2 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Hash Join  (cost=3129.33..51381.24 rows=70 width=4) (actual time=34.435..477.884 rows=20699 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..254.455 rows=1507977 loops=3)
                                                               ->  Hash  (cost=3129.26..3129.26 rows=5 width=4) (actual time=34.267..34.267 rows=5 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..3129.26 rows=5 width=4) (actual time=0.962..34.246 rows=5 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))
                                                                           Rows Removed by Filter: 134165
                                                         ->  Parallel Hash  (cost=551242.03..551242.03 rows=8 width=29) (actual time=3181.486..3181.486 rows=8 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=51800.14..551242.03 rows=8 width=29) (actual time=2142.325..3181.370 rows=8 loops=3)
                                                                     Hash Cond: (ci.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=211.400..2892.206 rows=414905 loops=3)
                                                                           Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                           Rows Removed by Filter: 11666543
                                                                     ->  Parallel Hash  (cost=51799.95..51799.95 rows=15 width=21) (actual time=246.345..246.345 rows=24 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=15 width=21) (actual time=5.865..246.252 rows=24 loops=3)
                                                                                 Filter: ((production_year > 2010) AND ((title)::text ~~ 'Vampire%'::text))
                                                                                 Rows Removed by Filter: 842746
 Planning Time: 29.790 ms
 Execution Time: 5589.493 ms
(62 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25c.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=968932.69..968932.70 rows=1 width=128) (actual time=6904.572..6904.572 rows=1 loops=1)
   ->  Gather  (cost=968932.46..968932.67 rows=2 width=128) (actual time=6901.689..6910.610 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=967932.46..967932.47 rows=1 width=128) (actual time=6894.174..6894.174 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=917449.32..967932.45 rows=1 width=80) (actual time=6532.771..6888.446 rows=8718 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.019..232.766 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=917449.31..917449.31 rows=1 width=79) (actual time=6526.775..6526.775 rows=8718 loops=3)
                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2648kB
                           ->  Parallel Hash Join  (cost=837421.96..917449.31 rows=1 width=79) (actual time=5953.630..6490.232 rows=8718 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.053..454.123 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=837421.95..837421.95 rows=1 width=68) (actual time=5952.598..5952.598 rows=14300 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3960kB
                                       ->  Parallel Hash Join  (cost=337401.27..837421.95 rows=1 width=68) (actual time=4716.636..5907.727 rows=14300 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=275.481..3007.597 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=337401.26..337401.26 rows=1 width=60) (actual time=2820.894..2820.894 rows=21129 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4824kB
                                                   ->  Parallel Hash Join  (cost=322130.99..337401.26 rows=1 width=60) (actual time=2570.612..2765.529 rows=21129 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.138..164.512 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.030..80.787 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.027..0.030 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=322128.55..322128.55 rows=1 width=51) (actual time=2570.203..2570.204 rows=22680 loops=3)
                                                               Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                               ->  Parallel Hash Join  (cost=51720.34..322128.55 rows=1 width=51) (actual time=2282.188..2521.442 rows=22680 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1716.823..1936.058 rows=62198 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1082.710..1918.633 rows=62990 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                 Rows Removed by Filter: 4882250
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.095..0.095 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.056..0.068 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'genres'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=565.274..565.274 rows=25571 loops=3)
                                                                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                           ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.627..483.889 rows=25571 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.055..252.963 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.464..40.464 rows=7 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.140..40.437 rows=7 loops=3)
                                                                                             Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                             Rows Removed by Filter: 134163
 Planning Time: 28.522 ms
 Execution Time: 6912.173 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26a.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=722071.79..722071.80 rows=1 width=128) (actual time=7138.209..7138.209 rows=1 loops=1)
   ->  Hash Join  (cost=706649.20..722071.78 rows=1 width=53) (actual time=7050.385..7137.191 rows=1728 loops=1)
         Hash Cond: (t.kind_id = kt.id)
         ->  Hash Join  (cost=706648.10..722070.67 rows=1 width=57) (actual time=7007.752..7136.627 rows=1844 loops=1)
               Hash Cond: (mi_idx.info_type_id = it2.id)
               ->  Gather  (cost=706645.67..722068.24 rows=1 width=61) (actual time=7007.664..7241.567 rows=2580 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Parallel Hash Join  (cost=705645.67..721068.14 rows=1 width=61) (actual time=6990.926..7123.636 rows=860 loops=3)
                           Hash Cond: (mi_idx.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=79942 width=13) (actual time=0.049..133.439 rows=64632 loops=3)
                                 Filter: ((info)::text > '7.0'::text)
                                 Rows Removed by Filter: 395380
                           ->  Parallel Hash  (cost=705645.66..705645.66 rows=1 width=68) (actual time=6979.960..6979.960 rows=1906 loops=3)
                                 Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 728kB
                                 ->  Parallel Hash Join  (cost=648661.37..705645.66 rows=1 width=68) (actual time=6441.790..6917.289 rows=1906 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.050..454.751 rows=60051 loops=3)
                                             Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                             Rows Removed by Filter: 986729
                                       ->  Parallel Hash  (cost=648661.29..648661.29 rows=6 width=56) (actual time=6441.558..6441.558 rows=69092 loops=3)
                                             Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 9560kB
                                             ->  Parallel Hash Join  (cost=569172.01..648661.29 rows=6 width=56) (actual time=6002.493..6398.185 rows=69092 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.044..377.373 rows=1389164 loops=3)
                                                   ->  Parallel Hash  (cost=569171.94..569171.94 rows=6 width=45) (actual time=5109.094..5109.095 rows=69092 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2560kB
                                                         ->  Parallel Hash Join  (cost=108834.99..569171.94 rows=6 width=45) (actual time=1001.080..4937.050 rows=69092 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.037..2160.958 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=108834.98..108834.98 rows=1 width=33) (actual time=1000.717..1000.717 rows=532 loops=3)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                     ->  Hash Join  (cost=58439.25..108834.98 rows=1 width=33) (actual time=513.443..987.389 rows=532 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Hash Join  (cost=54471.30..104857.99 rows=3441 width=37) (actual time=459.390..928.156 rows=121797 loops=3)
                                                                                 Hash Cond: (mk.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.034..248.278 rows=1507977 loops=3)
                                                                                 ->  Parallel Hash  (cost=54447.27..54447.27 rows=1923 width=29) (actual time=459.010..459.010 rows=7852 loops=3)
                                                                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2016kB
                                                                                       ->  Hash Join  (cost=3102.42..54447.27 rows=1923 width=29) (actual time=93.136..433.766 rows=7852 loops=3)
                                                                                             Hash Cond: (t.id = cc.movie_id)
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.046..272.185 rows=460484 loops=3)
                                                                                                   Filter: (production_year > 2000)
                                                                                                   Rows Removed by Filter: 382286
                                                                                             ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=92.705..92.705 rows=85941 loops=3)
                                                                                                   Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                                                                                   ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.228..66.045 rows=85941 loops=3)
                                                                                                         Hash Cond: (cc.status_id = cct2.id)
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.127..47.966 rows=85941 loops=3)
                                                                                                               Hash Cond: (cc.subject_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.029..17.463 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.020..0.022 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'cast'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.050..0.050 rows=2 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.039 rows=2 loops=3)
                                                                                                                     Filter: ((kind)::text ~~ '%complete%'::text)
                                                                                                                     Rows Removed by Filter: 2
                                                                           ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=47.669..47.669 rows=10 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.207..47.634 rows=10 loops=3)
                                                                                       Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                                       Rows Removed by Filter: 134160
               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=1)
                           Filter: ((info)::text = 'rating'::text)
                           Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.023..0.025 rows=1 loops=1)
                     Filter: ((kind)::text = 'movie'::text)
                     Rows Removed by Filter: 6
 Planning Time: 86.153 ms
 Execution Time: 7245.057 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26b.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=719517.69..719517.70 rows=1 width=96) (actual time=6520.878..6520.878 rows=1 loops=1)
   ->  Hash Join  (cost=662439.50..719517.69 rows=1 width=38) (actual time=6026.890..6520.802 rows=93 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=662438.44..719516.62 rows=1 width=42) (actual time=6026.781..6520.669 rows=93 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=662437.38..719515.56 rows=1 width=46) (actual time=6026.692..6520.545 rows=180 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=658006.94..714423.11 rows=1 width=54) (actual time=5948.942..6437.575 rows=191 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=657006.94..713423.01 rows=1 width=54) (actual time=5940.133..6428.473 rows=64 loops=3)
                                 Hash Cond: (chn.id = ci.person_role_id)
                                 ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.059..477.698 rows=60051 loops=3)
                                       Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                       Rows Removed by Filter: 986729
                                 ->  Parallel Hash  (cost=657006.93..657006.93 rows=1 width=42) (actual time=5937.135..5937.135 rows=2660 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 344kB
                                       ->  Hash Join  (cost=577517.63..657006.93 rows=1 width=42) (actual time=5110.927..5680.402 rows=2660 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Hash Join  (cost=577515.21..657004.49 rows=6 width=46) (actual time=5110.795..5678.256 rows=5809 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.047..362.549 rows=1389164 loops=3)
                                                   ->  Parallel Hash  (cost=577515.13..577515.13 rows=6 width=50) (actual time=5109.931..5109.932 rows=5809 loops=3)
                                                         Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2136kB
                                                         ->  Parallel Hash Join  (cost=117178.19..577515.13 rows=6 width=50) (actual time=1091.567..4874.293 rows=5809 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.022..2255.541 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=117178.17..117178.17 rows=1 width=38) (actual time=1089.899..1089.899 rows=39 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=101980.10..117178.17 rows=1 width=38) (actual time=1007.358..1089.789 rows=39 loops=3)
                                                                           Hash Cond: (mi_idx.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.054..134.046 rows=17883 loops=3)
                                                                                 Filter: ((info)::text > '8.0'::text)
                                                                                 Rows Removed by Filter: 442129
                                                                           ->  Parallel Hash  (cost=101980.06..101980.06 rows=3 width=25) (actual time=951.852..951.852 rows=480 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Hash Join  (cost=51215.31..101980.06 rows=3 width=25) (actual time=839.730..951.203 rows=480 loops=3)
                                                                                       Hash Cond: (t.kind_id = kt.id)
                                                                                       ->  Parallel Hash Join  (cost=51214.21..101978.87 rows=23 width=29) (actual time=630.347..950.672 rows=1008 loops=3)
                                                                                             Hash Cond: (t.id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.027..275.963 rows=337640 loops=3)
                                                                                                   Filter: (production_year > 2005)
                                                                                                   Rows Removed by Filter: 505131
                                                                                             ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=628.197..628.197 rows=3328 loops=3)
                                                                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                                                                   ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.890..469.727 rows=3328 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.043..252.166 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.426..32.426 rows=4 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.144..32.401 rows=4 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,fight}'::text[]))
                                                                                                                     Rows Removed by Filter: 134166
                                                                                       ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.036..0.038 rows=1 loops=3)
                                                                                                   Filter: ((kind)::text = 'movie'::text)
                                                                                                   Rows Removed by Filter: 6
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.078..0.078 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.057..0.060 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=66.689..66.689 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.022..24.810 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.038..0.038 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.025..0.026 rows=2 loops=1)
                     Filter: ((kind)::text ~~ '%complete%'::text)
                     Rows Removed by Filter: 2
 Planning Time: 86.329 ms
 Execution Time: 6522.837 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26c.sql_explained.sql
SET
SET
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=722078.21..722078.22 rows=1 width=96) (actual time=8301.733..8301.733 rows=1 loops=1)
   ->  Hash Join  (cost=665321.10..722078.20 rows=1 width=38) (actual time=7812.804..8298.572 rows=5400 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Gather  (cost=665320.04..722077.14 rows=1 width=42) (actual time=7812.702..8447.803 rows=6359 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=664320.04..721077.04 rows=1 width=42) (actual time=7805.393..8286.434 rows=2120 loops=3)
                     Hash Cond: (chn.id = ci.person_role_id)
                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.061..462.472 rows=60051 loops=3)
                           Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                           Rows Removed by Filter: 986729
                     ->  Parallel Hash  (cost=664319.99..664319.99 rows=4 width=30) (actual time=7804.416..7804.416 rows=73556 loops=3)
                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 7416kB
                           ->  Parallel Hash Join  (cost=584830.72..664319.99 rows=4 width=30) (actual time=7383.096..7764.676 rows=73556 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.051..385.633 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=584830.67..584830.67 rows=4 width=34) (actual time=6483.940..6483.940 rows=73556 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2304kB
                                       ->  Hash Join  (cost=533504.83..584830.67 rows=4 width=34) (actual time=6181.746..6404.678 rows=73556 loops=3)
                                             Hash Cond: (t.kind_id = kt.id)
                                             ->  Parallel Hash Join  (cost=533503.73..584829.46 rows=26 width=38) (actual time=6177.053..6386.819 rows=81357 loops=3)
                                                   Hash Cond: (t.id = mk.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.044..284.877 rows=460484 loops=3)
                                                         Filter: (production_year > 2000)
                                                         Rows Removed by Filter: 382286
                                                   ->  Parallel Hash  (cost=533503.13..533503.13 rows=48 width=33) (actual time=5704.646..5704.646 rows=232511 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 3616kB
                                                         ->  Hash Join  (cost=72499.97..533503.13 rows=48 width=33) (actual time=855.851..5407.406 rows=232511 loops=3)
                                                               Hash Cond: (cc.status_id = cct2.id)
                                                               ->  Hash Join  (cost=72498.91..533501.03 rows=192 width=37) (actual time=855.750..5339.519 rows=232511 loops=3)
                                                                     Hash Cond: (mk.movie_id = cc.movie_id)
                                                                     ->  Parallel Hash Join  (cost=68068.47..528405.98 rows=138 width=25) (actual time=787.239..4928.399 rows=360905 loops=3)
                                                                           Hash Cond: (ci.movie_id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.029..2183.007 rows=12081448 loops=3)
                                                                           ->  Parallel Hash  (cost=68068.42..68068.42 rows=4 width=13) (actual time=787.049..787.049 rows=6392 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                                 ->  Hash Join  (cost=52224.04..68068.42 rows=4 width=13) (actual time=604.295..753.173 rows=6392 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Hash Join  (cost=52221.61..68064.84 rows=426 width=17) (actual time=604.168..750.193 rows=19234 loops=3)
                                                                                             Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.035..75.914 rows=460012 loops=3)
                                                                                             ->  Parallel Hash  (cost=52219.86..52219.86 rows=140 width=4) (actual time=603.717..603.717 rows=8030 loops=3)
                                                                                                   Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                                                                   ->  Hash Join  (cost=3967.95..52219.86 rows=140 width=4) (actual time=47.887..490.440 rows=8030 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.039..253.281 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=47.664..47.664 rows=10 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.212..47.635 rows=10 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                                                                     Rows Removed by Filter: 134160
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.054..0.057 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=65.852..65.852 rows=135086 loops=3)
                                                                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.031..24.818 rows=135086 loops=3)
                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.038..0.038 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.026..0.027 rows=2 loops=3)
                                                                           Filter: ((kind)::text ~~ '%complete%'::text)
                                                                           Rows Removed by Filter: 2
                                             ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.044..0.046 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'movie'::text)
                                                         Rows Removed by Filter: 6
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.024..0.026 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 85.514 ms
 Execution Time: 8455.893 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27a.sql_explained.sql
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=62724.94..62724.95 rows=1 width=96) (actual time=310.107..310.107 rows=1 loops=1)
   ->  Merge Join  (cost=26778.72..62724.94 rows=1 width=118) (actual time=309.233..309.906 rows=477 loops=1)
         Merge Cond: (mi.movie_id = ml.movie_id)
         ->  Gather Merge  (cost=1000.46..988404.79 rows=132912 width=4) (actual time=9.324..22.519 rows=2822 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..972063.42 rows=55380 width=4) (actual time=1.293..154.482 rows=1126 loops=3)
                     Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                     Rows Removed by Filter: 149267
         ->  Sort  (cost=25778.26..25778.26 rows=1 width=138) (actual time=299.330..299.360 rows=475 loops=1)
               Sort Key: t.id
               Sort Method: quicksort  Memory: 49kB
               ->  Hash Join  (cost=22622.22..25778.25 rows=1 width=138) (actual time=276.489..299.138 rows=172 loops=1)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Merge Join  (cost=19996.08..23150.40 rows=652 width=142) (actual time=252.728..277.966 rows=3278 loops=1)
                           Merge Cond: (mk.movie_id = ml.movie_id)
                           ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.031..19.115 rows=69431 loops=1)
                           ->  Sort  (cost=19995.65..19995.68 rows=14 width=134) (actual time=249.973..250.181 rows=3270 loops=1)
                                 Sort Key: t.id
                                 Sort Method: quicksort  Memory: 62kB
                                 ->  Hash Join  (cost=19698.66..19995.38 rows=14 width=134) (actual time=247.058..249.739 rows=269 loops=1)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Hash Join  (cost=19697.58..19994.16 rows=27 width=138) (actual time=246.965..249.574 rows=269 loops=1)
                                             Hash Cond: (cc.status_id = cct2.id)
                                             ->  Merge Join  (cost=19696.52..19992.51 rows=109 width=142) (actual time=246.878..249.402 rows=333 loops=1)
                                                   Merge Cond: (cc.movie_id = ml.movie_id)
                                                   ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.034..2.104 rows=5140 loops=1)
                                                   ->  Sort  (cost=19696.10..19696.27 rows=69 width=130) (actual time=246.487..246.539 rows=756 loops=1)
                                                         Sort Key: t.id
                                                         Sort Method: quicksort  Memory: 120kB
                                                         ->  Gather  (cost=7378.71..19693.99 rows=69 width=130) (actual time=131.175..247.384 rows=698 loops=1)
                                                               Workers Planned: 2
                                                               Workers Launched: 2
                                                               ->  Parallel Hash Join  (cost=6378.71..18687.09 rows=29 width=130) (actual time=125.494..238.604 rows=233 loops=3)
                                                                     Hash Cond: (mc.company_id = cn.id)
                                                                     ->  Hash Join  (cost=652.57..12960.52 rows=160 width=115) (actual time=24.447..174.322 rows=931 loops=3)
                                                                           Hash Cond: (mc.company_type_id = ct.id)
                                                                           ->  Merge Join  (cost=651.50..12956.00 rows=640 width=119) (actual time=24.312..173.815 rows=1104 loops=3)
                                                                                 Merge Cond: (ml.movie_id = mc.movie_id)
                                                                                 ->  Merge Join  (cost=651.07..7725.24 rows=250 width=107) (actual time=20.038..127.669 rows=444 loops=3)
                                                                                       Merge Cond: (t.id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=379985 width=21) (actual time=0.403..112.169 rows=19945 loops=3)
                                                                                             Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                                                                             Rows Removed by Filter: 42153
                                                                                       ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=13.014..13.198 rows=2315 loops=3)
                                                                                             Sort Key: ml.movie_id
                                                                                             Sort Method: quicksort  Memory: 205kB
                                                                                             Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                             Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                                                             ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.164..11.588 rows=2315 loops=3)
                                                                                                   Hash Cond: (ml.link_type_id = lt.id)
                                                                                                   ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.030..7.174 rows=29997 loops=3)
                                                                                                   ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.053..0.053 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.034..0.040 rows=2 loops=3)
                                                                                                               Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                               Rows Removed by Filter: 16
                                                                                 ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.053..42.511 rows=42275 loops=3)
                                                                                       Filter: (note IS NULL)
                                                                                       Rows Removed by Filter: 42817
                                                                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.046..0.047 rows=1 loops=3)
                                                                                       Filter: ((kind)::text = 'production companies'::text)
                                                                                       Rows Removed by Filter: 3
                                                                     ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=62.822..62.822 rows=16101 loops=3)
                                                                           Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.062..50.298 rows=16101 loops=3)
                                                                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                                 Rows Removed by Filter: 62232
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                                                         Filter: ((kind)::text = 'complete'::text)
                                                         Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.039..0.039 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.025..0.027 rows=2 loops=1)
                                                   Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                                                   Rows Removed by Filter: 2
                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.764..20.765 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.109..20.752 rows=1 loops=1)
                                 Filter: ((keyword)::text = 'sequel'::text)
                                 Rows Removed by Filter: 134169
 Planning Time: 84.257 ms
 Execution Time: 324.670 ms
(87 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27b.sql_explained.sql
SET
SET
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=62047.93..62047.94 rows=1 width=96) (actual time=505.731..505.732 rows=1 loops=1)
   ->  Hash Join  (cost=58902.55..62047.92 rows=1 width=118) (actual time=504.894..505.609 rows=247 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=56276.42..59421.66 rows=47 width=122) (actual time=483.273..483.912 rows=1919 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.032..18.588 rows=69431 loops=1)
               ->  Materialize  (cost=56275.98..56275.99 rows=1 width=138) (actual time=456.947..457.166 rows=1911 loops=1)
                     ->  Sort  (cost=56275.98..56275.99 rows=1 width=138) (actual time=456.935..456.952 rows=247 loops=1)
                           Sort Key: t.id
                           Sort Method: quicksort  Memory: 59kB
                           ->  Hash Join  (cost=55981.58..56275.97 rows=1 width=138) (actual time=456.291..456.675 rows=247 loops=1)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Hash Join  (cost=55980.51..56274.91 rows=1 width=142) (actual time=456.209..456.514 rows=418 loops=1)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Merge Join  (cost=55979.44..56273.83 rows=2 width=146) (actual time=456.130..456.322 rows=418 loops=1)
                                             Merge Cond: (cc.movie_id = ml.movie_id)
                                             ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.041..1.868 rows=4705 loops=1)
                                             ->  Sort  (cost=55979.02..55979.02 rows=1 width=134) (actual time=453.653..453.718 rows=908 loops=1)
                                                   Sort Key: t.id
                                                   Sort Method: quicksort  Memory: 128kB
                                                   ->  Gather  (cost=50471.19..55979.01 rows=1 width=134) (actual time=390.738..453.619 rows=737 loops=1)
                                                         Workers Planned: 1
                                                         Workers Launched: 1
                                                         ->  Parallel Hash Join  (cost=49471.19..54978.91 rows=1 width=134) (actual time=395.681..447.649 rows=368 loops=2)
                                                               Hash Cond: (cn.id = mc.company_id)
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.041..60.977 rows=24151 loops=2)
                                                                     Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                     Rows Removed by Filter: 93348
                                                               ->  Parallel Hash  (cost=49471.16..49471.16 rows=3 width=119) (actual time=382.721..382.721 rows=718 loops=2)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                                                     ->  Hash Join  (cost=653.00..49471.16 rows=3 width=119) (actual time=241.345..352.275 rows=718 loops=2)
                                                                           Hash Cond: (mc.company_type_id = ct.id)
                                                                           ->  Merge Join  (cost=651.94..49470.03 rows=13 width=123) (actual time=241.243..351.949 rows=736 loops=2)
                                                                                 Merge Cond: (ml.movie_id = mc.movie_id)
                                                                                 ->  Merge Join  (cost=651.51..44246.14 rows=5 width=111) (actual time=222.798..326.746 rows=151 loops=2)
                                                                                       Merge Cond: (mi.movie_id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..972063.42 rows=55380 width=4) (actual time=1.447..135.356 rows=1440 loops=2)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                                                                                             Rows Removed by Filter: 187318
                                                                                       ->  Materialize  (cost=651.07..8854.49 rows=33 width=107) (actual time=25.164..191.125 rows=235 loops=2)
                                                                                             ->  Merge Join  (cost=651.07..8854.40 rows=33 width=107) (actual time=25.153..191.017 rows=141 loops=2)
                                                                                                   Merge Cond: (t.id = ml.movie_id)
                                                                                                   ->  Index Scan using title_pkey on title t  (cost=0.43..108402.95 rows=50313 width=21) (actual time=2.821..179.764 rows=4216 loops=2)
                                                                                                         Filter: (production_year = 1998)
                                                                                                         Rows Removed by Filter: 182255
                                                                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.352..10.528 rows=2315 loops=2)
                                                                                                         Sort Key: ml.movie_id
                                                                                                         Sort Method: quicksort  Memory: 205kB
                                                                                                         Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.124..9.129 rows=2315 loops=2)
                                                                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.019..4.871 rows=29997 loops=2)
                                                                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.043..0.044 rows=2 loops=2)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.027..0.032 rows=2 loops=2)
                                                                                                                           Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                                           Rows Removed by Filter: 16
                                                                                 ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.032..22.529 rows=34556 loops=2)
                                                                                       Filter: (note IS NULL)
                                                                                       Rows Removed by Filter: 35332
                                                                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=2)
                                                                                       Filter: ((kind)::text = 'production companies'::text)
                                                                                       Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.025..0.025 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.010..0.012 rows=2 loops=1)
                                                   Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                                                   Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.025..0.026 rows=1 loops=1)
                                             Filter: ((kind)::text = 'complete'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.422..21.422 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.123..21.409 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 85.629 ms
 Execution Time: 507.066 ms
(82 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=64696.47..64696.48 rows=1 width=96) (actual time=546.721..546.721 rows=1 loops=1)
   ->  Hash Join  (cost=61522.37..64696.47 rows=1 width=118) (actual time=521.871..546.413 rows=743 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=58896.24..62065.93 rows=1677 width=122) (actual time=498.051..524.125 rows=11620 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.030..17.655 rows=69431 loops=1)
               ->  Sort  (cost=58895.80..58895.89 rows=36 width=138) (actual time=495.538..496.257 rows=11612 loops=1)
                     Sort Key: ml.movie_id
                     Sort Method: quicksort  Memory: 210kB
                     ->  Hash Join  (cost=58588.08..58894.87 rows=36 width=138) (actual time=490.347..494.592 rows=1150 loops=1)
                           Hash Cond: (cc.subject_id = cct1.id)
                           ->  Hash Join  (cost=58587.01..58893.03 rows=143 width=142) (actual time=490.266..494.185 rows=1436 loops=1)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Merge Join  (cost=58585.95..58888.88 rows=572 width=146) (actual time=490.190..493.709 rows=1436 loops=1)
                                       Merge Cond: (cc.movie_id = ml.movie_id)
                                       ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.035..2.107 rows=5142 loops=1)
                                       ->  Sort  (cost=58585.52..58586.43 rows=363 width=134) (actual time=489.739..490.137 rows=4252 loops=1)
                                             Sort Key: ml.movie_id
                                             Sort Method: quicksort  Memory: 654kB
                                             ->  Gather  (cost=7421.33..58570.09 rows=363 width=134) (actual time=90.313..488.526 rows=3966 loops=1)
                                                   Workers Planned: 2
                                                   Workers Launched: 2
                                                   ->  Hash Join  (cost=6421.33..57533.79 rows=151 width=134) (actual time=87.621..460.272 rows=1322 loops=3)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Parallel Hash Join  (cost=6420.26..57529.46 rows=605 width=138) (actual time=87.404..459.620 rows=1361 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Merge Join  (cost=694.11..51794.52 rows=3349 width=123) (actual time=13.697..409.627 rows=3944 loops=3)
                                                                     Merge Cond: (ml.movie_id = mc.movie_id)
                                                                     ->  Merge Join  (cost=693.68..46534.00 rows=1310 width=111) (actual time=13.496..370.024 rows=1247 loops=3)
                                                                           Merge Cond: (ml.movie_id = t.id)
                                                                           ->  Merge Join  (cost=651.07..37496.27 rows=1747 width=90) (actual time=11.011..162.939 rows=1288 loops=3)
                                                                                 Merge Cond: (mi.movie_id = ml.movie_id)
                                                                                 ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1010698.11 rows=372351 width=4) (actual time=0.271..150.947 rows=11321 loops=3)
                                                                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))
                                                                                       Rows Removed by Filter: 160210
                                                                                 ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=9.669..9.923 rows=2954 loops=3)
                                                                                       Sort Key: ml.movie_id
                                                                                       Sort Method: quicksort  Memory: 205kB
                                                                                       Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                       Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.124..8.469 rows=2315 loops=3)
                                                                                             Hash Cond: (ml.link_type_id = lt.id)
                                                                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.022..4.243 rows=29997 loops=3)
                                                                                             ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.044..0.044 rows=2 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.026..0.032 rows=2 loops=3)
                                                                                                         Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                         Rows Removed by Filter: 16
                                                                           ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=1895923 width=21) (actual time=0.028..196.028 rows=133937 loops=3)
                                                                                 Filter: ((production_year >= 1950) AND (production_year <= 2010))
                                                                                 Rows Removed by Filter: 37735
                                                                     ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.027..35.112 rows=47778 loops=3)
                                                                           Filter: (note IS NULL)
                                                                           Rows Removed by Filter: 47336
                                                               ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=47.931..47.931 rows=16101 loops=3)
                                                                     Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.024..37.651 rows=16101 loops=3)
                                                                           Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                           Rows Removed by Filter: 62232
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=3)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.023..0.023 rows=2 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.010..0.012 rows=2 loops=1)
                                             Filter: ((kind)::text ~~ 'complete%'::text)
                                             Rows Removed by Filter: 2
                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.024..0.025 rows=1 loops=1)
                                       Filter: ((kind)::text = 'cast'::text)
                                       Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.134..21.134 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.126..21.122 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 85.228 ms
 Execution Time: 549.117 ms
(81 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28a.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=468295.89..468295.90 rows=1 width=96) (actual time=3954.007..3954.007 rows=1 loops=1)
   ->  Hash Join  (cost=451069.27..468295.88 rows=1 width=41) (actual time=3753.990..3952.043 rows=4803 loops=1)
         Hash Cond: (mi_idx.info_type_id = it2.id)
         ->  Gather  (cost=451066.84..468293.45 rows=1 width=45) (actual time=3753.865..3955.752 rows=15325 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=450066.84..467293.35 rows=1 width=45) (actual time=3751.409..3939.337 rows=5108 loops=3)
                     Hash Cond: (mi_idx.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.056..156.160 rows=447629 loops=3)
                           Filter: ((info)::text < '8.5'::text)
                           Rows Removed by Filter: 12383
                     ->  Parallel Hash  (cost=450066.83..450066.83 rows=1 width=56) (actual time=3733.892..3733.892 rows=1704 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                           ->  Hash Join  (cost=147280.54..450066.83 rows=1 width=56) (actual time=3245.244..3721.464 rows=1704 loops=3)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Hash Join  (cost=147279.45..450065.74 rows=1 width=60) (actual time=3244.942..3720.854 rows=2155 loops=3)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Hash Join  (cost=147278.39..450064.67 rows=1 width=64) (actual time=3235.733..3719.008 rows=13930 loops=3)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Hash Join  (cost=142847.96..444972.22 rows=1 width=52) (actual time=3152.281..3617.489 rows=15212 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=142845.53..444969.79 rows=1 width=56) (actual time=1348.296..3613.181 rows=17574 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=0.986..2227.633 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Parallel Hash  (cost=142845.52..142845.52 rows=1 width=48) (actual time=1341.393..1341.394 rows=16473 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5144kB
                                                               ->  Parallel Hash Join  (cost=137845.48..142845.52 rows=1 width=48) (actual time=1277.572..1322.172 rows=16473 loops=3)
                                                                     Hash Cond: (cn.id = mc.company_id)
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.038..31.734 rows=42077 loops=3)
                                                                           Filter: ((country_code)::text <> '[us]'::text)
                                                                           Rows Removed by Filter: 36256
                                                                     ->  Parallel Hash  (cost=137845.47..137845.47 rows=1 width=33) (actual time=1277.427..1277.427 rows=17485 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4504kB
                                                                           ->  Hash Join  (cost=102542.40..137845.47 rows=1 width=33) (actual time=963.772..1253.061 rows=17485 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=102541.31..137844.38 rows=1 width=37) (actual time=963.659..1248.451 rows=17485 loops=3)
                                                                                       Hash Cond: (mc.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.013..268.095 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=102541.20..102541.20 rows=9 width=25) (actual time=962.047..962.047 rows=3895 loops=3)
                                                                                             Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 984kB
                                                                                             ->  Hash Join  (cost=51215.33..102541.20 rows=9 width=25) (actual time=577.917..913.585 rows=3895 loops=3)
                                                                                                   Hash Cond: (t.kind_id = kt.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..102539.96 rows=31 width=29) (actual time=577.499..911.539 rows=4924 loops=3)
                                                                                                         Hash Cond: (t.id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.021..270.986 rows=460484 loops=3)
                                                                                                               Filter: (production_year > 2000)
                                                                                                               Rows Removed by Filter: 382286
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=576.605..576.605 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=45.062..485.976 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.023..253.555 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=44.811..44.812 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.695..44.790 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.091..0.091 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.074..0.077 rows=2 loops=3)
                                                                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                                                                               Rows Removed by Filter: 5
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.053..0.053 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.034..0.036 rows=4 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.050 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=72.038..72.038 rows=135086 loops=3)
                                                   Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.032..29.794 rows=135086 loops=3)
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.029..0.029 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.015..0.017 rows=1 loops=3)
                                                   Filter: ((kind)::text = 'crew'::text)
                                                   Rows Removed by Filter: 3
                                 ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.058..0.058 rows=3 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=3 width=4) (actual time=0.033..0.035 rows=3 loops=3)
                                             Filter: ((kind)::text <> 'complete+verified'::text)
                                             Rows Removed by Filter: 1
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.021..0.024 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 109.853 ms
 Execution Time: 3961.426 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28b.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=418889.66..418889.67 rows=1 width=96) (actual time=3086.333..3086.333 rows=1 loops=1)
   ->  Hash Join  (cost=403298.67..418889.65 rows=1 width=41) (actual time=2974.457..3086.249 rows=148 loops=1)
         Hash Cond: (mi_idx.info_type_id = it2.id)
         ->  Gather  (cost=403296.25..418887.22 rows=1 width=45) (actual time=2974.338..3093.130 rows=224 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=402296.25..417887.12 rows=1 width=45) (actual time=2986.970..3077.776 rows=75 loops=3)
                     Hash Cond: (mi_idx.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=124848 width=13) (actual time=0.049..137.412 rows=99992 loops=3)
                           Filter: ((info)::text > '6.5'::text)
                           Rows Removed by Filter: 360020
                     ->  Parallel Hash  (cost=402296.24..402296.24 rows=1 width=56) (actual time=2928.437..2928.437 rows=70 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=350869.64..402296.24 rows=1 width=56) (actual time=2913.334..2927.926 rows=70 loops=3)
                                 Hash Cond: (cc.subject_id = cct1.id)
                                 ->  Hash Join  (cost=350868.57..402295.17 rows=1 width=60) (actual time=2838.698..2927.744 rows=544 loops=3)
                                       Hash Cond: (cc.status_id = cct2.id)
                                       ->  Hash Join  (cost=350867.49..402294.08 rows=1 width=64) (actual time=2825.442..2927.461 rows=1108 loops=3)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Hash Join  (cost=346437.05..397201.63 rows=1 width=52) (actual time=2546.613..2840.035 rows=1608 loops=3)
                                                   Hash Cond: (t.kind_id = kt.id)
                                                   ->  Parallel Hash Join  (cost=346435.94..397200.52 rows=1 width=56) (actual time=2538.455..2839.436 rows=1675 loops=3)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.008..261.728 rows=337640 loops=3)
                                                               Filter: (production_year > 2005)
                                                               Rows Removed by Filter: 505131
                                                         ->  Parallel Hash  (cost=346435.93..346435.93 rows=1 width=31) (actual time=2534.415..2534.415 rows=4086 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1112kB
                                                               ->  Parallel Hash Join  (cost=341435.89..346435.93 rows=1 width=31) (actual time=2506.389..2529.737 rows=4086 loops=3)
                                                                     Hash Cond: (cn.id = mc.company_id)
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.012..17.391 rows=42077 loops=3)
                                                                           Filter: ((country_code)::text <> '[us]'::text)
                                                                           Rows Removed by Filter: 36256
                                                                     ->  Parallel Hash  (cost=341435.88..341435.88 rows=1 width=16) (actual time=2506.259..2506.259 rows=4250 loops=3)
                                                                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                           ->  Hash Join  (cost=306132.81..341435.88 rows=1 width=16) (actual time=2196.641..2474.872 rows=4250 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=306131.72..341434.79 rows=1 width=20) (actual time=2196.532..2473.708 rows=4250 loops=3)
                                                                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.013..264.895 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=306131.71..306131.71 rows=1 width=8) (actual time=2193.526..2193.526 rows=653 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Hash Join  (cost=51216.64..306131.71 rows=1 width=8) (actual time=1897.382..2192.972 rows=653 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..306129.23 rows=21 width=12) (actual time=563.004..2192.416 rows=1510 loops=3)
                                                                                                         Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=55380 width=8) (actual time=0.777..1619.930 rows=44746 loops=3)
                                                                                                               Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                                                                                                               Rows Removed by Filter: 4900494
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=560.740..560.740 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=33.037..472.476 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.023..252.356 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.802..32.802 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.551..32.784 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.036 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'countries'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.053..0.053 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.035..0.036 rows=4 loops=3)
                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.092..0.092 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.075..0.078 rows=2 loops=3)
                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                               Rows Removed by Filter: 5
                                             ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=68.838..68.839 rows=135086 loops=3)
                                                   Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.031..27.630 rows=135086 loops=3)
                                       ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.023..0.023 rows=3 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=3 width=4) (actual time=0.008..0.010 rows=3 loops=3)
                                                   Filter: ((kind)::text <> 'complete+verified'::text)
                                                   Rows Removed by Filter: 1
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.063..0.063 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.039..0.040 rows=1 loops=3)
                                             Filter: ((kind)::text = 'crew'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 113.772 ms
 Execution Time: 3094.450 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28c.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=467734.71..467734.72 rows=1 width=96) (actual time=4010.265..4010.265 rows=1 loops=1)
   ->  Hash Join  (cost=449846.07..467734.70 rows=1 width=41) (actual time=3769.942..4006.676 rows=8373 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=449845.01..467733.64 rows=1 width=45) (actual time=3769.834..4003.756 rows=15126 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=449843.95..467732.57 rows=1 width=49) (actual time=3769.755..3999.718 rows=16719 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=445413.51..462640.12 rows=1 width=61) (actual time=3678.378..3887.545 rows=21489 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=445411.09..462637.70 rows=1 width=65) (actual time=3678.264..3876.300 rows=64628 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=444411.09..461637.60 rows=1 width=65) (actual time=3664.588..3868.117 rows=21543 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=1.347..162.325 rows=447629 loops=3)
                                             Filter: ((info)::text < '8.5'::text)
                                             Rows Removed by Filter: 12383
                                       ->  Parallel Hash  (cost=444411.07..444411.07 rows=1 width=52) (actual time=3649.726..3649.726 rows=7276 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2456kB
                                             ->  Hash Join  (cost=142286.81..444411.07 rows=1 width=52) (actual time=3164.317..3622.867 rows=7276 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=142284.38..444408.65 rows=1 width=56) (actual time=1314.386..3620.692 rows=8340 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=0.995..2288.133 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Parallel Hash  (cost=142284.37..142284.37 rows=1 width=48) (actual time=1296.461..1296.461 rows=7967 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2520kB
                                                               ->  Hash Join  (cost=137284.33..142284.37 rows=1 width=48) (actual time=1253.584..1287.081 rows=7967 loops=3)
                                                                     Hash Cond: (mc.company_type_id = ct.id)
                                                                     ->  Parallel Hash Join  (cost=137283.24..142283.28 rows=1 width=52) (actual time=1253.476..1284.982 rows=7967 loops=3)
                                                                           Hash Cond: (cn.id = mc.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.012..22.210 rows=42077 loops=3)
                                                                                 Filter: ((country_code)::text <> '[us]'::text)
                                                                                 Rows Removed by Filter: 36256
                                                                           ->  Parallel Hash  (cost=137283.23..137283.23 rows=1 width=37) (actual time=1253.352..1253.352 rows=8618 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2328kB
                                                                                 ->  Parallel Hash Join  (cost=101980.16..137283.23 rows=1 width=37) (actual time=940.533..1225.468 rows=8618 loops=3)
                                                                                       Hash Cond: (mc.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.042..274.069 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=101980.08..101980.08 rows=7 width=25) (actual time=934.923..934.923 rows=2691 loops=3)
                                                                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                                                                                             ->  Hash Join  (cost=51215.33..101980.08 rows=7 width=25) (actual time=565.346..889.632 rows=2691 loops=3)
                                                                                                   Hash Cond: (t.kind_id = kt.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..101978.87 rows=23 width=29) (actual time=564.420..888.181 rows=3246 loops=3)
                                                                                                         Hash Cond: (t.id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.019..273.910 rows=337640 loops=3)
                                                                                                               Filter: (production_year > 2005)
                                                                                                               Rows Removed by Filter: 505131
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=563.716..563.716 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=33.617..476.188 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..255.299 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=33.368..33.369 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.636..33.354 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.075..0.075 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.057..0.060 rows=2 loops=3)
                                                                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                                                                               Rows Removed by Filter: 5
                                                                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.051..0.051 rows=4 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.036..0.037 rows=4 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.069..0.069 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.051 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.030..0.033 rows=1 loops=1)
                                       Filter: ((info)::text = 'rating'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.442..69.442 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.029..27.908 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.027..0.027 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=1)
                     Filter: ((kind)::text = 'complete'::text)
                     Rows Removed by Filter: 3
 Planning Time: 109.911 ms
 Execution Time: 4013.440 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29a.sql_explained.sql
SET
SET
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1085189.97..1085189.98 rows=1 width=96) (actual time=9057.048..9057.048 rows=1 loops=1)
   ->  Hash Join  (cost=1002792.89..1085189.96 rows=1 width=48) (actual time=9054.030..9056.563 rows=1620 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=1002791.82..1085188.89 rows=1 width=52) (actual time=9053.913..9056.058 rows=1620 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=1002790.76..1085187.83 rows=1 width=56) (actual time=9053.842..9055.591 rows=1620 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=998360.33..1080095.38 rows=1 width=68) (actual time=8972.635..8976.856 rows=1620 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=997360.33..1079095.28 rows=1 width=68) (actual time=8813.150..8813.324 rows=540 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=227.292..528.383 rows=16670 loops=3)
                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1372493
                                 ->  Parallel Hash  (cost=997360.31..997360.31 rows=1 width=65) (actual time=8279.769..8279.769 rows=540 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                       ->  Hash Join  (cost=980800.35..997360.31 rows=1 width=65) (actual time=8183.099..8255.593 rows=540 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Hash Join  (cost=978174.21..994734.17 rows=1 width=69) (actual time=8160.883..8227.448 rows=58320 loops=3)
                                                   Hash Cond: (ci.role_id = rt.id)
                                                   ->  Parallel Hash Join  (cost=978173.05..994733.01 rows=1 width=73) (actual time=8160.748..8212.812 rows=58320 loops=3)
                                                         Hash Cond: (an.person_id = ci.person_id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.043..77.335 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=978173.04..978173.04 rows=1 width=69) (actual time=8072.727..8072.727 rows=19440 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6072kB
                                                               ->  Parallel Hash Join  (cost=911370.37..978173.04 rows=1 width=69) (actual time=6537.247..7043.781 rows=19440 loops=3)
                                                                     Hash Cond: (ci.person_role_id = chn.id)
                                                                     ->  Parallel Hash Join  (cost=858566.42..925369.09 rows=1 width=57) (actual time=6269.242..6761.628 rows=149955 loops=3)
                                                                           Hash Cond: (pi.person_id = ci.person_id)
                                                                           ->  Hash Join  (cost=2.43..66764.11 rows=10928 width=4) (actual time=0.107..437.946 rows=206842 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.039..274.396 rows=987888 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.040 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.019..0.030 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'trivia'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=858563.98..858563.98 rows=1 width=53) (actual time=6258.974..6258.974 rows=13941 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4344kB
                                                                                 ->  Parallel Hash Join  (cost=396900.01..858563.98 rows=1 width=53) (actual time=2940.947..5789.761 rows=13941 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..460336.89 rows=353886 width=16) (actual time=0.098..2844.457 rows=278900 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11802548
                                                                                       ->  Parallel Hash  (cost=396900.00..396900.00 rows=1 width=37) (actual time=2902.993..2902.993 rows=369 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=391988.71..396900.00 rows=1 width=37) (actual time=2880.573..2902.688 rows=369 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.036..30.778 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=391988.70..391988.70 rows=1 width=41) (actual time=2868.230..2868.230 rows=1603 loops=3)
                                                                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                                         ->  Parallel Hash Join  (cost=358250.56..391988.70 rows=1 width=41) (actual time=2757.716..2758.120 rows=1603 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = t.id)
                                                                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.028..159.310 rows=869710 loops=3)
                                                                                                               ->  Parallel Hash  (cost=358250.54..358250.54 rows=1 width=33) (actual time=2490.782..2490.782 rows=81 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                     ->  Hash Join  (cost=102687.90..358250.54 rows=1 width=33) (actual time=2147.092..2490.681 rows=81 loops=3)
                                                                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                                                                           ->  Parallel Hash Join  (cost=102685.48..358248.12 rows=1 width=37) (actual time=2146.953..2490.524 rows=81 loops=3)
                                                                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=183.904..1764.277 rows=150368 loops=3)
                                                                                                                                       Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                                                                       Rows Removed by Filter: 4794872
                                                                                                                                 ->  Parallel Hash  (cost=102685.41..102685.41 rows=5 width=29) (actual time=709.489..709.489 rows=45 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                       ->  Parallel Hash Join  (cost=54433.65..102685.41 rows=5 width=29) (actual time=672.983..709.381 rows=45 loops=3)
                                                                                                                                             Hash Cond: (mk.movie_id = t.id)
                                                                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.016..253.982 rows=1507977 loops=3)
                                                                                                                                             ->  Parallel Hash  (cost=54433.61..54433.61 rows=3 width=21) (actual time=274.304..274.304 rows=1 loops=3)
                                                                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=3 width=21) (actual time=165.377..274.188 rows=1 loops=3)
                                                                                                                                                         Filter: ((production_year >= 2000) AND (production_year <= 2010) AND ((title)::text = 'Shrek 2'::text))
                                                                                                                                                         Rows Removed by Filter: 842770
                                                                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.079..0.079 rows=1 loops=3)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.053..0.064 rows=1 loops=3)
                                                                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=52803.93..52803.93 rows=1 width=20) (actual time=264.313..264.314 rows=0 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..52803.93 rows=1 width=20) (actual time=181.137..264.268 rows=0 loops=3)
                                                                                 Filter: ((name)::text = 'Queen'::text)
                                                                                 Rows Removed by Filter: 1046779
                                                   ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.074..0.074 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.055..0.058 rows=1 loops=3)
                                                               Filter: ((role)::text = 'actress'::text)
                                                               Rows Removed by Filter: 11
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.157..22.157 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.096..22.130 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'computer-animation'::text)
                                                         Rows Removed by Filter: 134169
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.393..69.393 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.032..28.041 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.021..0.023 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 147.057 ms
 Execution Time: 9060.535 ms
(111 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29b.sql_explained.sql
SET
SET
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1069734.87..1069734.88 rows=1 width=96) (actual time=7687.684..7687.685 rows=1 loops=1)
   ->  Hash Join  (cost=987337.79..1069734.86 rows=1 width=48) (actual time=7686.629..7687.669 rows=15 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=987336.72..1069733.79 rows=1 width=52) (actual time=7686.526..7687.562 rows=15 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=987335.66..1069732.73 rows=1 width=56) (actual time=7686.451..7687.483 rows=15 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=982905.23..1064640.28 rows=1 width=68) (actual time=7607.732..7609.274 rows=15 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=981905.23..1063640.18 rows=1 width=68) (actual time=7495.590..7599.173 rows=5 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=224.915..535.443 rows=16670 loops=3)
                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1372493
                                 ->  Parallel Hash  (cost=981905.21..981905.21 rows=1 width=65) (actual time=7059.580..7059.580 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Hash Join  (cost=965345.25..981905.21 rows=1 width=65) (actual time=7013.468..7059.490 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Hash Join  (cost=962719.11..979279.07 rows=1 width=69) (actual time=6991.302..7037.288 rows=540 loops=3)
                                                   Hash Cond: (ci.role_id = rt.id)
                                                   ->  Parallel Hash Join  (cost=962717.95..979277.91 rows=1 width=73) (actual time=6991.171..7037.014 rows=540 loops=3)
                                                         Hash Cond: (an.person_id = ci.person_id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.026..78.382 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=962717.94..962717.94 rows=1 width=69) (actual time=6920.040..6920.041 rows=180 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=895915.27..962717.94 rows=1 width=69) (actual time=6771.705..6919.868 rows=180 loops=3)
                                                                     Hash Cond: (ci.person_role_id = chn.id)
                                                                     ->  Parallel Hash Join  (cost=843111.32..909913.99 rows=1 width=57) (actual time=6232.252..6654.236 rows=2489 loops=3)
                                                                           Hash Cond: (pi.person_id = ci.person_id)
                                                                           ->  Hash Join  (cost=2.43..66764.11 rows=10928 width=4) (actual time=0.120..446.767 rows=47448 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.034..306.357 rows=987888 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.020..0.031 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'height'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=843108.88..843108.88 rows=1 width=53) (actual time=6197.724..6197.724 rows=7101 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2232kB
                                                                                 ->  Parallel Hash Join  (cost=381444.91..843108.88 rows=1 width=53) (actual time=2660.100..5380.460 rows=7101 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..460336.89 rows=353886 width=16) (actual time=0.108..2783.506 rows=278900 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11802548
                                                                                       ->  Parallel Hash  (cost=381444.90..381444.90 rows=1 width=37) (actual time=2557.696..2557.696 rows=189 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=376533.61..381444.90 rows=1 width=37) (actual time=2542.424..2557.521 rows=189 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..16.969 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=376533.60..376533.60 rows=1 width=41) (actual time=2537.511..2537.511 rows=811 loops=3)
                                                                                                         Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 248kB
                                                                                                         ->  Parallel Hash Join  (cost=342795.46..376533.60 rows=1 width=41) (actual time=2426.736..2426.941 rows=811 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = t.id)
                                                                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.241..160.883 rows=869710 loops=3)
                                                                                                               ->  Parallel Hash  (cost=342795.44..342795.44 rows=1 width=33) (actual time=2159.076..2159.076 rows=45 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                     ->  Hash Join  (cost=102687.84..342795.44 rows=1 width=33) (actual time=1873.761..2158.979 rows=45 loops=3)
                                                                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                                                                           ->  Parallel Hash Join  (cost=102685.41..342793.02 rows=1 width=37) (actual time=1873.635..2158.842 rows=45 loops=3)
                                                                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=227791 width=8) (actual time=147.475..1449.007 rows=129228 loops=3)
                                                                                                                                       Filter: ((info)::text ~~ 'USA:%200%'::text)
                                                                                                                                       Rows Removed by Filter: 4816012
                                                                                                                                 ->  Parallel Hash  (cost=102685.39..102685.39 rows=2 width=29) (actual time=695.182..695.182 rows=45 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                       ->  Parallel Hash Join  (cost=54433.62..102685.39 rows=2 width=29) (actual time=658.840..695.065 rows=45 loops=3)
                                                                                                                                             Hash Cond: (mk.movie_id = t.id)
                                                                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.007..252.033 rows=1507977 loops=3)
                                                                                                                                             ->  Parallel Hash  (cost=54433.61..54433.61 rows=1 width=21) (actual time=262.415..262.415 rows=1 loops=3)
                                                                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=1 width=21) (actual time=252.423..262.343 rows=1 loops=3)
                                                                                                                                                         Filter: ((production_year >= 2000) AND (production_year <= 2005) AND ((title)::text = 'Shrek 2'::text))
                                                                                                                                                         Rows Removed by Filter: 842770
                                                                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.053 rows=1 loops=3)
                                                                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=52803.93..52803.93 rows=1 width=20) (actual time=265.291..265.291 rows=0 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..52803.93 rows=1 width=20) (actual time=181.859..265.252 rows=0 loops=3)
                                                                                 Filter: ((name)::text = 'Queen'::text)
                                                                                 Rows Removed by Filter: 1046779
                                                   ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.045..0.047 rows=1 loops=3)
                                                               Filter: ((role)::text = 'actress'::text)
                                                               Rows Removed by Filter: 11
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.090..22.091 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.094..22.067 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'computer-animation'::text)
                                                         Rows Removed by Filter: 134169
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.528..69.528 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.022..27.823 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.023..0.025 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 146.536 ms
 Execution Time: 7690.085 ms
(111 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29c.sql_explained.sql
SET
SET
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1104796.41..1104796.42 rows=1 width=96) (actual time=8119.086..8119.087 rows=1 loops=1)
   ->  Hash Join  (cost=849233.65..1104796.40 rows=1 width=48) (actual time=7066.778..8113.560 rows=16308 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Hash Join  (cost=849231.22..1104793.97 rows=1 width=52) (actual time=7066.678..8109.532 rows=16308 loops=1)
               Hash Cond: (ci.role_id = rt.id)
               ->  Hash Join  (cost=849230.06..1104792.80 rows=1 width=56) (actual time=7066.603..8105.586 rows=16308 loops=1)
                     Hash Cond: (cc.status_id = cct2.id)
                     ->  Hash Join  (cost=849229.00..1104791.74 rows=1 width=60) (actual time=7016.942..8100.496 rows=28022 loops=1)
                           Hash Cond: (cc.subject_id = cct1.id)
                           ->  Gather  (cost=849227.94..1104790.67 rows=1 width=64) (actual time=7016.870..8099.446 rows=28022 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=848227.94..1103790.57 rows=1 width=64) (actual time=7015.004..8080.799 rows=9341 loops=3)
                                       Hash Cond: (mi.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=178.506..1694.110 rows=150368 loops=3)
                                             Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                             Rows Removed by Filter: 4794872
                                       ->  Parallel Hash  (cost=848227.92..848227.92 rows=1 width=80) (actual time=6365.141..6365.141 rows=3288 loops=3)
                                             Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1304kB
                                             ->  Parallel Hash Join  (cost=793788.39..848227.92 rows=1 width=80) (actual time=5708.021..5998.959 rows=3288 loops=3)
                                                   Hash Cond: (chn.id = ci.person_role_id)
                                                   ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.051..235.827 rows=1046780 loops=3)
                                                   ->  Parallel Hash  (cost=793788.37..793788.37 rows=1 width=68) (actual time=5625.618..5625.618 rows=3428 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1272kB
                                                         ->  Parallel Hash Join  (cost=777228.20..793788.37 rows=1 width=68) (actual time=5415.736..5510.019 rows=3428 loops=3)
                                                               Hash Cond: (n.id = ci.person_id)
                                                               ->  Parallel Hash Join  (cost=148593.14..165153.19 rows=28 width=27) (actual time=1207.557..1320.285 rows=5368 loops=3)
                                                                     Hash Cond: (an.person_id = n.id)
                                                                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.024..69.430 rows=300448 loops=3)
                                                                     ->  Parallel Hash  (cost=148591.56..148591.56 rows=126 width=23) (actual time=1206.373..1206.373 rows=3355 loops=3)
                                                                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                           ->  Hash Join  (cost=81912.66..148591.56 rows=126 width=23) (actual time=537.132..989.226 rows=3355 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Hash Join  (cost=81910.23..148550.34 rows=14247 width=27) (actual time=536.207..986.413 rows=15416 loops=3)
                                                                                       Hash Cond: (pi.person_id = n.id)
                                                                                       ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.023..301.289 rows=987888 loops=3)
                                                                                       ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=535.310..535.310 rows=16670 loops=3)
                                                                                             Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                             ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=218.612..521.452 rows=16670 loops=3)
                                                                                                   Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                                   Rows Removed by Filter: 1372493
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.051 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'trivia'::text)
                                                                                             Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=628635.05..628635.05 rows=1 width=57) (actual time=4187.846..4187.846 rows=3451 loops=3)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1208kB
                                                                     ->  Parallel Hash Join  (cost=148044.74..628635.05 rows=1 width=57) (actual time=1155.748..4001.359 rows=3451 loops=3)
                                                                           Hash Cond: (ci.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.117..2807.137 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Parallel Hash  (cost=148044.70..148044.70 rows=3 width=41) (actual time=1153.179..1153.179 rows=105 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=94621.37..148044.70 rows=3 width=41) (actual time=1056.249..1153.047 rows=105 loops=3)
                                                                                       Hash Cond: (t.id = mc.movie_id)
                                                                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=432897 width=21) (actual time=0.034..275.820 rows=347600 loops=3)
                                                                                             Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                                                             Rows Removed by Filter: 495171
                                                                                       ->  Parallel Hash  (cost=94621.24..94621.24 rows=10 width=20) (actual time=837.734..837.734 rows=144 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=89709.93..94621.24 rows=10 width=20) (actual time=812.670..837.576 rows=144 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.015..21.360 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=89709.68..89709.68 rows=20 width=24) (actual time=812.204..812.204 rows=589 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                                                         ->  Hash Join  (cost=55308.66..89709.68 rows=20 width=24) (actual time=585.414..811.440 rows=589 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = cc.movie_id)
                                                                                                               ->  Parallel Hash Join  (cost=50878.23..84616.67 rows=74 width=12) (actual time=459.478..724.139 rows=1073 loops=3)
                                                                                                                     Hash Cond: (mc.movie_id = mk.movie_id)
                                                                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.037..155.639 rows=869710 loops=3)
                                                                                                                     ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=455.579..455.579 rows=138 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                                           ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=26.902..455.379 rows=138 loops=3)
                                                                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.023..251.089 rows=1507977 loops=3)
                                                                                                                                 ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.341..21.341 rows=1 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.097..21.329 rows=1 loops=3)
                                                                                                                                             Filter: ((keyword)::text = 'computer-animation'::text)
                                                                                                                                             Rows Removed by Filter: 134169
                                                                                                               ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.438..69.438 rows=135086 loops=3)
                                                                                                                     Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                                                                                     ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.038..27.359 rows=135086 loops=3)
                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                                       Filter: ((kind)::text = 'cast'::text)
                                       Rows Removed by Filter: 3
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.028..0.029 rows=1 loops=1)
                                 Filter: ((kind)::text = 'complete+verified'::text)
                                 Rows Removed by Filter: 3
               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.024..0.024 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.012..0.014 rows=1 loops=1)
                           Filter: ((role)::text = 'actress'::text)
                           Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 145.479 ms
 Execution Time: 8127.940 ms
(109 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=139838.09..139838.10 rows=1 width=32) (actual time=1306.498..1306.498 rows=1 loops=1)
   ->  Gather  (cost=139837.88..139838.09 rows=2 width=32) (actual time=1305.639..1313.201 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=138837.88..138837.89 rows=1 width=32) (actual time=1298.653..1298.653 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=88354.74..138837.87 rows=3 width=17) (actual time=933.829..1297.211 rows=2611 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.015..237.173 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=88354.70..88354.70 rows=3 width=8) (actual time=929.852..929.852 rows=2611 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                           ->  Parallel Hash Join  (cost=55672.11..88354.70 rows=3 width=8) (actual time=541.248..848.697 rows=2611 loops=3)
                                 Hash Cond: (mc.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=4793.88..37309.04 rows=44647 width=4) (actual time=24.911..322.980 rows=49377 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.050..164.572 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=4722.92..4722.92 rows=5677 width=4) (actual time=24.670..24.670 rows=3258 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 576kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=5677 width=4) (actual time=0.011..22.348 rows=3258 loops=3)
                                                   Filter: ((country_code)::text = '[de]'::text)
                                                   Rows Removed by Filter: 75074
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=515.351..515.351 rows=13947 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=22.382..463.205 rows=13947 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..253.989 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.217..22.217 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.033..22.192 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.362 ms
 Execution Time: 1313.642 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2b.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=139653.63..139653.64 rows=1 width=32) (actual time=1258.045..1258.045 rows=1 loops=1)
   ->  Gather  (cost=89170.30..139653.63 rows=2 width=17) (actual time=900.494..1262.197 rows=5228 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=88170.30..138653.43 rows=1 width=17) (actual time=894.907..1248.877 rows=1743 loops=3)
               Hash Cond: (t.id = mc.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.018..225.963 rows=842771 loops=3)
               ->  Parallel Hash  (cost=88170.28..88170.28 rows=1 width=8) (actual time=892.912..892.912 rows=1743 loops=3)
                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                     ->  Parallel Hash Join  (cost=55617.21..88170.28 rows=1 width=8) (actual time=537.975..821.112 rows=1743 loops=3)
                           Hash Cond: (mc.movie_id = mk.movie_id)
                           ->  Parallel Hash Join  (cost=4738.98..37254.14 rows=10108 width=4) (actual time=21.711..301.099 rows=18803 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.039..154.308 rows=869710 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=1285 width=4) (actual time=21.586..21.587 rows=780 loops=3)
                                       Buckets: 4096  Batches: 1  Memory Usage: 160kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=1285 width=4) (actual time=0.015..20.976 rows=780 loops=3)
                                             Filter: ((country_code)::text = '[nl]'::text)
                                             Rows Removed by Filter: 77552
                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=515.102..515.102 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.649..461.115 rows=13947 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..252.840 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.395..21.396 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.991..21.375 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
 Planning Time: 4.425 ms
 Execution Time: 1264.332 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2c.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=139600.06..139600.07 rows=1 width=32) (actual time=806.164..806.165 rows=1 loops=1)
   ->  Gather  (cost=89116.82..139600.05 rows=1 width=17) (actual time=806.161..811.810 rows=0 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=88116.82..138599.95 rows=1 width=17) (actual time=799.462..799.463 rows=0 loops=3)
               Hash Cond: (t.id = mc.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (never executed)
               ->  Parallel Hash  (cost=88116.81..88116.81 rows=1 width=8) (actual time=798.963..798.963 rows=0 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 0kB
                     ->  Parallel Hash Join  (cost=55601.29..88116.81 rows=1 width=8) (actual time=798.814..798.814 rows=0 loops=3)
                           Hash Cond: (mc.movie_id = mk.movie_id)
                           ->  Parallel Hash Join  (cost=4723.07..37238.23 rows=92 width=4) (actual time=231.514..285.026 rows=1 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.036..155.207 rows=869710 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=12 width=4) (actual time=21.017..21.017 rows=0 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=12 width=4) (actual time=15.202..20.974 rows=0 loops=3)
                                             Filter: ((country_code)::text = '[sm]'::text)
                                             Rows Removed by Filter: 78332
                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=513.704..513.704 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.748..459.644 rows=13947 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..251.701 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.608..21.608 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.990..21.587 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
 Planning Time: 4.290 ms
 Execution Time: 812.192 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2d.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=141451.03..141451.04 rows=1 width=32) (actual time=1358.032..1358.033 rows=1 loops=1)
   ->  Gather  (cost=141450.82..141451.03 rows=2 width=32) (actual time=1356.389..1363.459 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=140450.82..140450.83 rows=1 width=32) (actual time=1349.973..1349.973 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=17) (actual time=1025.475..1343.250 rows=22772 loops=3)
                     Hash Cond: (mc.company_id = cn.id)
                     ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=21) (actual time=983.851..1286.742 rows=49517 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.026..155.568 rows=869710 loops=3)
                           ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=25) (actual time=983.470..983.470 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                 ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=25) (actual time=528.257..910.886 rows=13947 loops=3)
                                       Hash Cond: (t.id = mk.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.016..229.110 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=528.045..528.045 rows=13947 loops=3)
                                             Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                             ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.657..463.296 rows=13947 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.030..256.244 rows=1507977 loops=3)
                                                   ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.482..20.482 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.064..20.461 rows=1 loops=3)
                                                               Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                               Rows Removed by Filter: 134169
                     ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=40.142..40.142 rows=28281 loops=3)
                           Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.022..26.017 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
 Planning Time: 4.407 ms
 Execution Time: 1363.919 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30a.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=944426.03..944426.04 rows=1 width=128) (actual time=6384.876..6384.877 rows=1 loops=1)
   ->  Hash Join  (cost=927922.43..944426.02 rows=1 width=80) (actual time=6267.680..6384.366 rows=757 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=927921.36..944424.94 rows=1 width=84) (actual time=6267.544..6384.027 rows=757 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=927920.30..944423.88 rows=1 width=88) (actual time=6267.444..6383.524 rows=2492 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=923489.86..939331.43 rows=1 width=100) (actual time=6149.992..6289.700 rows=6214 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=923487.44..939329.00 rows=1 width=104) (actual time=6149.879..6287.572 rows=18687 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=922487.44..938328.90 rows=1 width=104) (actual time=6137.580..6276.670 rows=6229 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.040..81.801 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=922487.42..922487.42 rows=1 width=91) (actual time=6129.123..6129.123 rows=2263 loops=3)
                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                             ->  Parallel Hash Join  (cost=842460.08..922487.42 rows=1 width=91) (actual time=5556.763..6076.634 rows=2263 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.057..451.608 rows=579860 loops=3)
                                                         Filter: ((gender)::text = 'm'::text)
                                                         Rows Removed by Filter: 809304
                                                   ->  Parallel Hash  (cost=842460.07..842460.07 rows=1 width=80) (actual time=5555.633..5555.633 rows=3573 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1176kB
                                                         ->  Parallel Hash Join  (cost=342439.39..842460.07 rows=1 width=80) (actual time=4344.218..5499.406 rows=3573 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=201.061..2971.116 rows=414905 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                     Rows Removed by Filter: 11666543
                                                               ->  Parallel Hash  (cost=342439.38..342439.38 rows=1 width=72) (actual time=2470.669..2470.669 rows=5468 loops=3)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1496kB
                                                                     ->  Parallel Hash Join  (cost=291113.75..342439.38 rows=1 width=72) (actual time=2110.628..2453.176 rows=5468 loops=3)
                                                                           Hash Cond: (t.id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.017..283.273 rows=460484 loops=3)
                                                                                 Filter: (production_year > 2000)
                                                                                 Rows Removed by Filter: 382286
                                                                           ->  Parallel Hash  (cost=291113.73..291113.73 rows=1 width=51) (actual time=2107.328..2107.328 rows=11309 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                                 ->  Hash Join  (cost=51720.34..291113.73 rows=1 width=51) (actual time=1909.163..2068.617 rows=11309 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..291111.24 rows=25 width=55) (actual time=1507.355..2065.103 rows=11907 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=929.480..1474.522 rows=24349 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                                   Rows Removed by Filter: 4920891
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=577.784..577.784 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.397..489.332 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..253.880 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.216..41.216 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.189..41.198 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.070..0.071 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.051 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.031..0.034 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.794..70.794 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.031..28.485 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.023..0.023 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.050..0.050 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.025..0.027 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                     Rows Removed by Filter: 2
 Planning Time: 92.255 ms
 Execution Time: 6388.292 ms
(80 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30b.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=950168.28..950168.29 rows=1 width=128) (actual time=6212.699..6212.699 rows=1 loops=1)
   ->  Hash Join  (cost=933664.68..950168.27 rows=1 width=80) (actual time=6176.509..6212.666 rows=28 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=933663.61..950167.19 rows=1 width=84) (actual time=6176.409..6212.558 rows=28 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=933662.55..950166.13 rows=1 width=88) (actual time=6176.328..6212.460 rows=108 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=929232.11..945073.68 rows=1 width=100) (actual time=6104.071..6128.276 rows=108 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=929229.69..945071.25 rows=1 width=104) (actual time=6103.933..6129.960 rows=324 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=928229.69..944071.15 rows=1 width=104) (actual time=6077.699..6119.711 rows=108 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.191..75.103 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=928229.67..928229.67 rows=1 width=91) (actual time=5987.654..5987.654 rows=36 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=871161.79..928229.67 rows=1 width=91) (actual time=5933.046..5987.394 rows=36 loops=3)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=161 width=21) (actual time=2.369..365.005 rows=178 loops=3)
                                                         Filter: ((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))
                                                         Rows Removed by Filter: 842593
                                                   ->  Parallel Hash  (cost=871161.78..871161.78 rows=1 width=70) (actual time=5622.055..5622.055 rows=4543 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1304kB
                                                         ->  Parallel Hash Join  (cost=791134.44..871161.78 rows=1 width=70) (actual time=5062.430..5577.585 rows=4543 loops=3)
                                                               Hash Cond: (n.id = ci.person_id)
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.043..445.140 rows=579860 loops=3)
                                                                     Filter: ((gender)::text = 'm'::text)
                                                                     Rows Removed by Filter: 809304
                                                               ->  Parallel Hash  (cost=791134.42..791134.42 rows=1 width=59) (actual time=5061.542..5061.542 rows=7458 loops=3)
                                                                     Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1880kB
                                                                     ->  Parallel Hash Join  (cost=291113.75..791134.42 rows=1 width=59) (actual time=3876.749..5008.740 rows=7458 loops=3)
                                                                           Hash Cond: (ci.movie_id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=216.732..2910.561 rows=414905 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                                 Rows Removed by Filter: 11666543
                                                                           ->  Parallel Hash  (cost=291113.73..291113.73 rows=1 width=51) (actual time=2042.165..2042.165 rows=11309 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                                 ->  Hash Join  (cost=51720.34..291113.73 rows=1 width=51) (actual time=1842.075..1996.071 rows=11309 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..291111.24 rows=25 width=55) (actual time=1456.729..1992.554 rows=11907 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=892.416..1417.045 rows=24349 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                                   Rows Removed by Filter: 4920891
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=564.232..564.232 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.914..482.674 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..251.783 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.746..40.746 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.178..40.730 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.035..0.048 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.031..0.033 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.130..70.131 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.023..28.018 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.038..0.038 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.024..0.027 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                     Rows Removed by Filter: 2
 Planning Time: 91.726 ms
 Execution Time: 6215.484 ms
(80 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=974687.78..974687.79 rows=1 width=128) (actual time=6899.654..6899.654 rows=1 loops=1)
   ->  Hash Join  (cost=958184.19..974687.77 rows=1 width=80) (actual time=6680.016..6895.078 rows=8024 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=958183.12..974686.71 rows=1 width=84) (actual time=6679.904..6892.341 rows=14123 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=958182.06..974685.64 rows=1 width=88) (actual time=6679.821..6888.106 rows=18841 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=953751.63..969593.19 rows=1 width=100) (actual time=6601.347..6777.680 rows=26153 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=953749.20..969590.76 rows=1 width=104) (actual time=6601.204..6764.451 rows=78897 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=952749.20..968590.66 rows=1 width=104) (actual time=6595.426..6745.154 rows=26299 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.047..79.025 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=952749.19..952749.19 rows=1 width=91) (actual time=6592.222..6592.222 rows=9085 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3064kB
                                             ->  Parallel Hash Join  (cost=872721.85..952749.19 rows=1 width=91) (actual time=6036.875..6561.755 rows=9085 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.059..447.774 rows=579860 loops=3)
                                                         Filter: ((gender)::text = 'm'::text)
                                                         Rows Removed by Filter: 809304
                                                   ->  Parallel Hash  (cost=872721.83..872721.83 rows=1 width=80) (actual time=6036.285..6036.285 rows=15008 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4664kB
                                                         ->  Parallel Hash Join  (cost=372701.16..872721.83 rows=1 width=80) (actual time=4844.080..6007.577 rows=15008 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=167.768..2953.278 rows=414905 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                     Rows Removed by Filter: 11666543
                                                               ->  Parallel Hash  (cost=372701.14..372701.14 rows=1 width=72) (actual time=2985.648..2985.648 rows=22680 loops=3)
                                                                     Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6968kB
                                                                     ->  Parallel Hash Join  (cost=322218.01..372701.14 rows=1 width=72) (actual time=2545.930..2909.590 rows=22680 loops=3)
                                                                           Hash Cond: (t.id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.021..227.261 rows=842771 loops=3)
                                                                           ->  Parallel Hash  (cost=322218.00..322218.00 rows=1 width=51) (actual time=2544.391..2544.391 rows=22680 loops=3)
                                                                                 Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                                                 ->  Hash Join  (cost=51720.34..322218.00 rows=1 width=51) (actual time=2269.196..2499.073 rows=22680 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..322215.41 rows=60 width=55) (actual time=1753.512..2492.972 rows=24129 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1074.017..1905.798 rows=62990 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                                   Rows Removed by Filter: 4882250
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=566.000..566.000 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.356..483.714 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..252.250 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.199..41.199 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.207..41.184 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.046 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.040 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.034..69.034 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.022..27.704 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.024..0.025 rows=1 loops=1)
                     Filter: ((kind)::text = 'complete+verified'::text)
                     Rows Removed by Filter: 3
 Planning Time: 92.149 ms
 Execution Time: 6905.970 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=975119.34..975119.35 rows=1 width=128) (actual time=7002.817..7002.817 rows=1 loops=1)
   ->  Gather  (cost=975119.11..975119.32 rows=2 width=128) (actual time=7001.428..7010.992 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=974119.11..974119.12 rows=1 width=128) (actual time=6993.372..6993.372 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=923635.97..974119.10 rows=1 width=80) (actual time=6876.986..6993.050 rows=424 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.014..236.100 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=923635.96..923635.96 rows=1 width=83) (actual time=6642.373..6642.373 rows=424 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 168kB
                           ->  Parallel Hash Join  (cost=843608.62..923635.96 rows=1 width=83) (actual time=6124.587..6642.064 rows=424 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.115..462.772 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=843608.60..843608.60 rows=1 width=72) (actual time=6117.071..6117.071 rows=519 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=343587.93..843608.60 rows=1 width=72) (actual time=4546.044..5696.416 rows=519 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=231.147..3004.584 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=343587.91..343587.91 rows=1 width=64) (actual time=2644.745..2644.745 rows=508 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                   ->  Parallel Hash Join  (cost=311072.34..343587.91 rows=1 width=64) (actual time=2401.350..2627.117 rows=508 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Hash Join  (cost=4723.09..37238.26 rows=106 width=4) (actual time=21.235..290.510 rows=605 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.045..163.793 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=16.551..16.551 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=0.527..16.475 rows=3 loops=3)
                                                                           Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                           Rows Removed by Filter: 78329
                                                         ->  Parallel Hash  (cost=306349.24..306349.24 rows=1 width=60) (actual time=2335.801..2335.801 rows=10505 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2456kB
                                                               ->  Parallel Hash Join  (cost=291078.97..306349.24 rows=1 width=60) (actual time=2123.987..2313.457 rows=10505 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.139..165.404 rows=153308 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.033..81.252 rows=460012 loops=3)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.041..0.041 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.027..0.030 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'votes'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=291076.53..291076.53 rows=1 width=51) (actual time=2123.553..2123.553 rows=11309 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2840kB
                                                                           ->  Parallel Hash Join  (cost=51720.34..291076.53 rows=1 width=51) (actual time=1894.977..2056.756 rows=11309 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..239357.37 rows=330 width=47) (actual time=1323.540..1474.256 rows=24086 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=923.716..1465.900 rows=24349 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                             Rows Removed by Filter: 4920891
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.092..0.092 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.052..0.064 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=571.350..571.350 rows=25571 loops=3)
                                                                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                       ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.005..487.089 rows=25571 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.030..253.053 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.837..40.837 rows=7 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.183..40.810 rows=7 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                         Rows Removed by Filter: 134163
 Planning Time: 118.345 ms
 Execution Time: 7012.092 ms
(72 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31b.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=980989.91..980989.92 rows=1 width=128) (actual time=6379.514..6379.514 rows=1 loops=1)
   ->  Gather  (cost=980989.68..980989.89 rows=2 width=128) (actual time=6379.193..6386.821 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=979989.68..979989.69 rows=1 width=128) (actual time=6370.619..6370.619 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=899962.33..979989.67 rows=1 width=80) (actual time=5920.206..6370.565 rows=28 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.050..450.769 rows=579860 loops=3)
                           Filter: ((gender)::text = 'm'::text)
                           Rows Removed by Filter: 809304
                     ->  Parallel Hash  (cost=899962.31..899962.31 rows=1 width=69) (actual time=5862.124..5862.124 rows=28 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=400520.12..899962.31 rows=1 width=69) (actual time=4768.490..5861.982 rows=28 loops=3)
                                 Hash Cond: (t.id = mi.movie_id)
                                 ->  Parallel Hash Join  (cost=57069.28..556511.17 rows=79 width=29) (actual time=2272.197..3432.174 rows=212 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=171.655..3013.401 rows=414905 loops=3)
                                             Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                             Rows Removed by Filter: 11666543
                                       ->  Parallel Hash  (cost=57067.27..57067.27 rows=161 width=21) (actual time=371.526..371.527 rows=178 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=161 width=21) (actual time=4.427..371.203 rows=178 loops=3)
                                                   Filter: ((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))
                                                   Rows Removed by Filter: 842593
                                 ->  Parallel Hash  (cost=343450.83..343450.83 rows=1 width=64) (actual time=2429.678..2429.678 rows=87 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=104094.63..343450.83 rows=1 width=64) (actual time=2302.842..2429.543 rows=87 loops=3)
                                             Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                             ->  Hash Join  (cost=2.43..239357.37 rows=330 width=47) (actual time=1327.941..1481.475 rows=24086 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=926.662..1473.329 rows=24349 loops=3)
                                                         Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                         Rows Removed by Filter: 4920891
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.019..0.032 rows=1 loops=3)
                                                               Filter: ((info)::text = 'genres'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=104092.19..104092.19 rows=1 width=17) (actual time=944.656..944.657 rows=105 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=88821.93..104092.19 rows=1 width=17) (actual time=828.953..944.511 rows=105 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.622..164.608 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.476..81.406 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.073..0.073 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.047 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=88819.49..88819.49 rows=1 width=8) (actual time=764.050..764.050 rows=105 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=40567.20..88819.49 rows=1 width=8) (actual time=389.954..763.884 rows=105 loops=3)
                                                                     Hash Cond: (mk.movie_id = mc.movie_id)
                                                                     ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=39.280..491.135 rows=25571 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.014..259.820 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=39.094..39.095 rows=7 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.244..39.077 rows=7 loops=3)
                                                                                       Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                       Rows Removed by Filter: 134163
                                                                     ->  Parallel Hash  (cost=37102.41..37102.41 rows=1 width=4) (actual time=268.369..268.369 rows=45 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=4723.09..37102.41 rows=1 width=4) (actual time=63.627..268.232 rows=45 loops=3)
                                                                                 Hash Cond: (mc.company_id = cn.id)
                                                                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=39 width=8) (actual time=0.706..244.562 rows=2654 loops=3)
                                                                                       Filter: ((note)::text ~~ '%(Blu-ray)%'::text)
                                                                                       Rows Removed by Filter: 867055
                                                                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=22.805..22.805 rows=3 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=9.520..22.751 rows=3 loops=3)
                                                                                             Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                                             Rows Removed by Filter: 78329
 Planning Time: 125.248 ms
 Execution Time: 6387.928 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31c.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=1005633.28..1005633.29 rows=1 width=128) (actual time=7385.385..7385.385 rows=1 loops=1)
   ->  Gather  (cost=1005633.05..1005633.26 rows=2 width=128) (actual time=7383.502..7393.178 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=1004633.05..1004633.06 rows=1 width=128) (actual time=7375.309..7375.310 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=954149.91..1004633.04 rows=1 width=80) (actual time=7221.707..7374.753 rows=942 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.021..233.281 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=954149.90..954149.90 rows=1 width=83) (actual time=7030.601..7030.602 rows=942 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 344kB
                           ->  Parallel Hash Join  (cost=874660.64..954149.90 rows=1 width=83) (actual time=6368.129..6928.253 rows=942 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.050..385.557 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=874660.62..874660.62 rows=1 width=72) (actual time=6361.653..6361.653 rows=942 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 344kB
                                       ->  Parallel Hash Join  (cost=374639.95..874660.62 rows=1 width=72) (actual time=5089.807..6241.186 rows=942 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=171.605..2996.609 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=374639.93..374639.93 rows=1 width=64) (actual time=3197.561..3197.561 rows=947 loops=3)
                                                   Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                   ->  Parallel Hash Join  (cost=342124.37..374639.93 rows=1 width=64) (actual time=2886.066..3115.755 rows=947 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Hash Join  (cost=4723.09..37238.26 rows=106 width=4) (actual time=22.672..288.911 rows=605 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.031..162.810 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=16.373..16.374 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=0.496..16.307 rows=3 loops=3)
                                                                           Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                           Rows Removed by Filter: 78329
                                                         ->  Parallel Hash  (cost=337401.26..337401.26 rows=1 width=60) (actual time=2825.686..2825.686 rows=21129 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4824kB
                                                               ->  Parallel Hash Join  (cost=322130.99..337401.26 rows=1 width=60) (actual time=2570.261..2764.100 rows=21129 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.140..164.114 rows=153308 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.027..79.894 rows=460012 loops=3)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.041..0.041 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.027..0.030 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'votes'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=322128.55..322128.55 rows=1 width=51) (actual time=2569.773..2569.773 rows=22680 loops=3)
                                                                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                                           ->  Parallel Hash Join  (cost=51720.34..322128.55 rows=1 width=51) (actual time=2282.099..2522.846 rows=22680 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1717.844..1938.859 rows=62198 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1082.242..1921.400 rows=62990 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                             Rows Removed by Filter: 4882250
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.083..0.083 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.056 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=564.161..564.161 rows=25571 loops=3)
                                                                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                       ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.951..481.950 rows=25571 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.029..251.050 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.791..40.791 rows=7 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.185..40.763 rows=7 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                         Rows Removed by Filter: 134163
 Planning Time: 117.243 ms
 Execution Time: 7394.168 ms
(70 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/32a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=75986.58..75986.59 rows=1 width=96) (actual time=390.024..390.024 rows=1 loops=1)
   ->  Gather  (cost=75986.36..75986.57 rows=2 width=96) (actual time=389.779..394.866 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=74986.36..74986.37 rows=1 width=96) (actual time=382.668..382.669 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=24503.19..74986.33 rows=4 width=116) (actual time=382.663..382.664 rows=0 loops=3)
                     Hash Cond: (t2.id = ml.linked_movie_id)
                     ->  Parallel Seq Scan on title t2  (cost=0.00..46532.63 rows=1053463 width=21) (never executed)
                     ->  Parallel Hash  (cost=24503.14..24503.14 rows=4 width=103) (actual time=382.104..382.104 rows=0 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 0kB
                           ->  Hash Join  (cost=2676.61..24503.14 rows=4 width=103) (actual time=379.832..379.832 rows=0 loops=3)
                                 Hash Cond: (ml.link_type_id = lt.id)
                                 ->  Hash Join  (cost=2675.20..24501.72 rows=4 width=25) (actual time=379.703..379.703 rows=0 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=49.07..20347.47 rows=582120 width=29) (actual time=12.653..349.047 rows=96064 loops=3)
                                             Merge Cond: (t1.id = ml.movie_id)
                                             ->  Merge Join  (cost=47.47..247535.04 rows=1884971 width=29) (actual time=12.271..295.359 rows=32619 loops=3)
                                                   Merge Cond: (mk.movie_id = t1.id)
                                                   ->  Parallel Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..115667.54 rows=1884971 width=8) (actual time=0.057..12.286 rows=32619 loops=3)
                                                   ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=21) (actual time=0.049..253.150 rows=187035 loops=3)
                                             ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=12) (actual time=0.045..27.784 rows=120322 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.740..21.740 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=21.141..21.720 rows=1 loops=3)
                                                   Filter: ((keyword)::text = '10,000-mile-club'::text)
                                                   Rows Removed by Filter: 134169
                                 ->  Hash  (cost=1.18..1.18 rows=18 width=86) (actual time=0.078..0.078 rows=18 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=86) (actual time=0.048..0.052 rows=18 loops=3)
 Planning Time: 5.298 ms
 Execution Time: 395.480 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/32b.sql_explained.sql
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=75986.58..75986.59 rows=1 width=96) (actual time=784.371..784.371 rows=1 loops=1)
   ->  Gather  (cost=75986.36..75986.57 rows=2 width=96) (actual time=784.049..790.422 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=74986.36..74986.37 rows=1 width=96) (actual time=777.022..777.023 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=24503.19..74986.33 rows=4 width=116) (actual time=409.207..775.440 rows=1463 loops=3)
                     Hash Cond: (t2.id = ml.linked_movie_id)
                     ->  Parallel Seq Scan on title t2  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.011..236.163 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=24503.14..24503.14 rows=4 width=103) (actual time=407.308..407.308 rows=1463 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 408kB
                           ->  Hash Join  (cost=2676.61..24503.14 rows=4 width=103) (actual time=50.599..343.373 rows=1463 loops=3)
                                 Hash Cond: (ml.link_type_id = lt.id)
                                 ->  Hash Join  (cost=2675.20..24501.72 rows=4 width=25) (actual time=50.475..342.789 rows=1463 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=49.07..20347.47 rows=582120 width=29) (actual time=3.360..312.257 rows=96064 loops=3)
                                             Merge Cond: (t1.id = ml.movie_id)
                                             ->  Merge Join  (cost=47.47..247535.04 rows=1884971 width=29) (actual time=3.184..262.273 rows=32619 loops=3)
                                                   Merge Cond: (mk.movie_id = t1.id)
                                                   ->  Parallel Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..115667.54 rows=1884971 width=8) (actual time=0.023..7.942 rows=32619 loops=3)
                                                   ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=21) (actual time=0.049..225.220 rows=187035 loops=3)
                                             ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=12) (actual time=0.042..24.312 rows=120412 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.356..21.356 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.841..21.343 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
                                 ->  Hash  (cost=1.18..1.18 rows=18 width=86) (actual time=0.075..0.075 rows=18 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=86) (actual time=0.046..0.049 rows=18 loops=3)
 Planning Time: 5.211 ms
 Execution Time: 791.065 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33a.sql_explained.sql
SET
SET
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=154593.22..154593.23 rows=1 width=192) (actual time=1463.738..1463.738 rows=1 loops=1)
   ->  Hash Join  (cost=144214.38..154593.20 rows=1 width=82) (actual time=1463.704..1463.716 rows=8 loops=1)
         Hash Cond: (t2.kind_id = kt2.id)
         ->  Hash Join  (cost=144213.28..154592.10 rows=1 width=86) (actual time=1463.596..1463.606 rows=8 loops=1)
               Hash Cond: (mi_idx1.info_type_id = it1.id)
               ->  Hash Join  (cost=144210.85..154589.67 rows=2 width=90) (actual time=1463.488..1463.514 rows=24 loops=1)
                     Hash Cond: (t1.kind_id = kt1.id)
                     ->  Merge Join  (cost=144209.75..154588.52 rows=12 width=94) (actual time=1463.406..1463.425 rows=24 loops=1)
                           Merge Cond: (ml.movie_id = t1.id)
                           ->  Merge Join  (cost=144209.32..146403.23 rows=12 width=85) (actual time=1442.057..1442.069 rows=24 loops=1)
                                 Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                 ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.033..2.514 rows=8479 loops=1)
                                 ->  Sort  (cost=144208.90..144208.91 rows=4 width=72) (actual time=1438.584..1438.586 rows=22 loops=1)
                                       Sort Key: ml.movie_id
                                       Sort Method: quicksort  Memory: 26kB
                                       ->  Hash Join  (cost=137529.19..144208.86 rows=4 width=72) (actual time=1399.035..1438.491 rows=8 loops=1)
                                             Hash Cond: (cn1.id = mc1.company_id)
                                             ->  Seq Scan on company_name cn1  (cost=0.00..5932.46 rows=85390 width=23) (actual time=0.027..47.514 rows=84843 loops=1)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 150154
                                             ->  Hash  (cost=137529.07..137529.07 rows=10 width=57) (actual time=1383.578..1383.578 rows=29 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                   ->  Merge Join  (cost=132176.15..137529.07 rows=10 width=57) (actual time=1357.564..1383.556 rows=29 loops=1)
                                                         Merge Cond: (mc1.movie_id = ml.movie_id)
                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..131550.35 rows=2609129 width=8) (actual time=0.024..26.280 rows=61895 loops=1)
                                                         ->  Sort  (cost=132175.72..132175.73 rows=2 width=49) (actual time=1349.955..1349.957 rows=29 loops=1)
                                                               Sort Key: ml.movie_id
                                                               Sort Method: quicksort  Memory: 26kB
                                                               ->  Gather  (cost=127279.79..132175.71 rows=2 width=49) (actual time=1293.505..1350.263 rows=11 loops=1)
                                                                     Workers Planned: 1
                                                                     Workers Launched: 1
                                                                     ->  Parallel Hash Join  (cost=126279.79..131175.51 rows=1 width=49) (actual time=1289.955..1323.032 rows=6 loops=2)
                                                                           Hash Cond: (cn2.id = mc2.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.017..21.541 rows=117498 loops=2)
                                                                           ->  Parallel Hash  (cost=126279.78..126279.78 rows=1 width=34) (actual time=1286.976..1286.976 rows=6 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                 ->  Parallel Hash Join  (cost=92541.63..126279.78 rows=1 width=34) (actual time=894.010..1286.910 rows=6 loops=2)
                                                                                       Hash Cond: (mc2.movie_id = t2.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.031..235.408 rows=1304564 loops=2)
                                                                                       ->  Parallel Hash  (cost=92541.62..92541.62 rows=1 width=42) (actual time=892.199..892.199 rows=3 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Hash Join  (cost=76393.09..92541.62 rows=1 width=42) (actual time=640.961..892.139 rows=3 loops=2)
                                                                                                   Hash Cond: (mi_idx2.info_type_id = it2.id)
                                                                                                   ->  Parallel Hash Join  (cost=76390.66..92538.93 rows=96 width=46) (actual time=638.737..891.984 rows=153 loops=2)
                                                                                                         Hash Cond: (mi_idx2.movie_id = t2.id)
                                                                                                         ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=273383 width=13) (actual time=0.041..218.105 rows=327480 loops=2)
                                                                                                               Filter: ((info)::text < '3.0'::text)
                                                                                                               Rows Removed by Filter: 362537
                                                                                                         ->  Parallel Hash  (cost=76386.05..76386.05 rows=369 width=33) (actual time=638.415..638.415 rows=122 loops=2)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                               ->  Hash Join  (cost=75275.92..76386.05 rows=369 width=33) (actual time=573.861..638.202 rows=122 loops=2)
                                                                                                                     Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                     ->  Merge Join  (cost=75274.64..76377.59 rows=2212 width=37) (actual time=573.679..637.823 rows=2166 loops=2)
                                                                                                                           Merge Cond: (t2.id = ml.linked_movie_id)
                                                                                                                           ->  Sort  (cost=72580.89..73046.92 rows=186410 width=25) (actual time=552.429..586.656 rows=222854 loops=2)
                                                                                                                                 Sort Key: t2.id
                                                                                                                                 Sort Method: external merge  Disk: 8048kB
                                                                                                                                 Worker 0:  Sort Method: external merge  Disk: 7936kB
                                                                                                                                 ->  Parallel Seq Scan on title t2  (cost=0.00..51799.95 rows=186410 width=25) (actual time=0.028..402.326 rows=222930 loops=2)
                                                                                                                                       Filter: ((production_year >= 2005) AND (production_year <= 2008))
                                                                                                                                       Rows Removed by Filter: 1041226
                                                                                                                           ->  Sort  (cost=2693.63..2768.62 rows=29997 width=12) (actual time=21.228..23.542 rows=29997 loops=2)
                                                                                                                                 Sort Key: ml.linked_movie_id
                                                                                                                                 Sort Method: quicksort  Memory: 2175kB
                                                                                                                                 Worker 0:  Sort Method: quicksort  Memory: 2175kB
                                                                                                                                 ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.040..6.649 rows=29997 loops=2)
                                                                                                                     ->  Hash  (cost=1.25..1.25 rows=3 width=4) (actual time=0.067..0.067 rows=2 loops=2)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on link_type lt  (cost=0.00..1.25 rows=3 width=4) (actual time=0.050..0.055 rows=2 loops=2)
                                                                                                                                 Filter: ((link)::text = ANY ('{sequel,follows,"followed by"}'::text[]))
                                                                                                                                 Rows Removed by Filter: 16
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=2)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=2)
                                                                                                               Filter: ((info)::text = 'rating'::text)
                                                                                                               Rows Removed by Filter: 112
                           ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=25) (actual time=0.016..18.901 rows=22690 loops=1)
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                                 Filter: ((kind)::text = 'tv series'::text)
                                 Rows Removed by Filter: 6
               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.035 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.025 rows=1 loops=1)
                           Filter: ((info)::text = 'rating'::text)
                           Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=1 width=4) (actual time=0.031..0.033 rows=1 loops=1)
                     Filter: ((kind)::text = 'tv series'::text)
                     Rows Removed by Filter: 6
 Planning Time: 112.251 ms
 Execution Time: 1467.168 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33b.sql_explained.sql
SET
SET
                                                                                                                                    QUERY PLAN                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=126526.42..126526.43 rows=1 width=192) (actual time=1270.493..1270.493 rows=1 loops=1)
   ->  Hash Join  (cost=121630.57..126526.40 rows=1 width=82) (actual time=1240.940..1270.475 rows=4 loops=1)
         Hash Cond: (mi_idx2.info_type_id = it2.id)
         ->  Hash Join  (cost=121628.15..126523.97 rows=1 width=86) (actual time=1240.831..1270.366 rows=8 loops=1)
               Hash Cond: (t2.kind_id = kt2.id)
               ->  Gather  (cost=121627.05..126522.87 rows=1 width=90) (actual time=1240.746..1275.155 rows=42 loops=1)
                     Workers Planned: 1
                     Workers Launched: 1
                     ->  Parallel Hash Join  (cost=120627.05..125522.77 rows=1 width=90) (actual time=1234.301..1263.688 rows=21 loops=2)
                           Hash Cond: (cn2.id = mc2.company_id)
                           ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.005..16.455 rows=117498 loops=2)
                           ->  Parallel Hash  (cost=120627.03..120627.03 rows=1 width=75) (actual time=1233.226..1233.226 rows=21 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=86888.89..120627.03 rows=1 width=75) (actual time=880.657..1233.144 rows=21 loops=2)
                                       Hash Cond: (mc2.movie_id = t2.id)
                                       ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.006..231.857 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=86888.88..86888.88 rows=1 width=83) (actual time=842.433..842.433 rows=6 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                             ->  Hash Join  (cost=70741.00..86888.88 rows=1 width=83) (actual time=719.215..842.390 rows=6 loops=2)
                                                   Hash Cond: (mi_idx1.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=70738.57..86886.45 rows=1 width=87) (actual time=719.096..842.268 rows=18 loops=2)
                                                         Hash Cond: (mi_idx2.movie_id = t2.id)
                                                         ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=273383 width=13) (actual time=0.018..214.153 rows=327480 loops=2)
                                                               Filter: ((info)::text < '3.0'::text)
                                                               Rows Removed by Filter: 362537
                                                         ->  Parallel Hash  (cost=70738.56..70738.56 rows=1 width=74) (actual time=594.345..594.345 rows=9 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=21387.24..70738.56 rows=1 width=74) (actual time=356.810..594.258 rows=9 loops=2)
                                                                     Hash Cond: (t2.id = ml.linked_movie_id)
                                                                     ->  Parallel Seq Scan on title t2  (cost=0.00..49166.29 rows=49337 width=25) (actual time=0.019..349.056 rows=59782 loops=2)
                                                                           Filter: (production_year = 2007)
                                                                           Rows Removed by Filter: 1204374
                                                                     ->  Parallel Hash  (cost=21387.06..21387.06 rows=15 width=49) (actual time=231.068..231.068 rows=590 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                           ->  Hash Join  (cost=14591.57..21387.06 rows=15 width=49) (actual time=145.457..230.713 rows=590 loops=2)
                                                                                 Hash Cond: (t1.kind_id = kt1.id)
                                                                                 ->  Merge Join  (cost=14590.47..21385.52 rows=102 width=53) (actual time=145.377..230.453 rows=716 loops=2)
                                                                                       Merge Cond: (t1.id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using title_pkey on title t1  (cost=0.43..87333.68 rows=1053463 width=25) (actual time=0.014..76.101 rows=81444 loops=2)
                                                                                       ->  Sort  (cost=14590.04..14590.65 rows=246 width=44) (actual time=144.511..144.609 rows=1431 loops=2)
                                                                                             Sort Key: ml.movie_id
                                                                                             Sort Method: quicksort  Memory: 213kB
                                                                                             Worker 0:  Sort Method: quicksort  Memory: 213kB
                                                                                             ->  Hash Join  (cost=6611.72..14580.27 rows=246 width=44) (actual time=62.618..143.435 rows=1431 loops=2)
                                                                                                   Hash Cond: (mc1.company_id = cn1.id)
                                                                                                   ->  Merge Join  (cost=651.94..8551.02 rows=26465 width=29) (actual time=10.362..87.722 rows=29022 loops=2)
                                                                                                         Merge Cond: (ml.movie_id = mc1.movie_id)
                                                                                                         ->  Merge Join  (cost=651.06..2920.55 rows=5051 width=21) (actual time=10.245..37.609 rows=6192 loops=2)
                                                                                                               Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                                                                                               ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.036..18.093 rows=63901 loops=2)
                                                                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=8) (actual time=10.178..10.695 rows=6443 loops=2)
                                                                                                                     Sort Key: ml.movie_id
                                                                                                                     Sort Method: quicksort  Memory: 205kB
                                                                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=8) (actual time=0.140..9.065 rows=2315 loops=2)
                                                                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.028..4.830 rows=29997 loops=2)
                                                                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.047..0.047 rows=2 loops=2)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.031..0.036 rows=2 loops=2)
                                                                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                                                       Rows Removed by Filter: 16
                                                                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..131550.35 rows=2609129 width=8) (actual time=0.026..33.770 rows=111067 loops=2)
                                                                                                   ->  Hash  (cost=5932.46..5932.46 rows=2185 width=23) (actual time=52.231..52.231 rows=2340 loops=2)
                                                                                                         Buckets: 4096  Batches: 1  Memory Usage: 160kB
                                                                                                         ->  Seq Scan on company_name cn1  (cost=0.00..5932.46 rows=2185 width=23) (actual time=0.038..50.666 rows=2340 loops=2)
                                                                                                               Filter: ((country_code)::text = '[nl]'::text)
                                                                                                               Rows Removed by Filter: 232657
                                                                                 ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.028..0.028 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=1 width=4) (actual time=0.016..0.018 rows=1 loops=2)
                                                                                             Filter: ((kind)::text = 'tv series'::text)
                                                                                             Rows Removed by Filter: 6
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.043 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.029..0.029 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=1 width=4) (actual time=0.018..0.020 rows=1 loops=1)
                           Filter: ((kind)::text = 'tv series'::text)
                           Rows Removed by Filter: 6
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 112.905 ms
 Execution Time: 1276.516 ms
(90 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33c.sql_explained.sql
SET
SET
                                                                                                                                       QUERY PLAN                                                                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=141754.28..141754.29 rows=1 width=192) (actual time=1586.252..1586.252 rows=1 loops=1)
   ->  Hash Join  (cost=133569.54..141754.26 rows=1 width=82) (actual time=1474.163..1586.118 rows=114 loops=1)
         Hash Cond: (t1.kind_id = kt1.id)
         ->  Merge Join  (cost=133568.42..141753.15 rows=1 width=86) (actual time=1474.067..1585.981 rows=114 loops=1)
               Merge Cond: (t1.id = ml.movie_id)
               ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=25) (actual time=0.024..115.051 rows=152917 loops=1)
               ->  Sort  (cost=133567.99..133568.00 rows=1 width=77) (actual time=1453.282..1453.292 rows=114 loops=1)
                     Sort Key: mc1.movie_id
                     Sort Method: quicksort  Memory: 42kB
                     ->  Hash Join  (cost=131373.01..133567.98 rows=1 width=77) (actual time=1440.924..1453.150 rows=114 loops=1)
                           Hash Cond: (mi_idx1.info_type_id = it1.id)
                           ->  Merge Join  (cost=131370.59..133565.36 rows=70 width=81) (actual time=1440.837..1453.014 rows=342 loops=1)
                                 Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                 ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.026..9.084 rows=50698 loops=1)
                                 ->  Sort  (cost=131370.16..131370.22 rows=23 width=68) (actual time=1438.354..1438.380 rows=347 loops=1)
                                       Sort Key: mc1.movie_id
                                       Sort Method: quicksort  Memory: 42kB
                                       ->  Gather  (cost=124052.14..131369.64 rows=23 width=68) (actual time=1407.386..1455.034 rows=121 loops=1)
                                             Workers Planned: 1
                                             Workers Launched: 1
                                             ->  Hash Join  (cost=123052.14..130367.34 rows=14 width=68) (actual time=1402.678..1431.044 rows=60 loops=2)
                                                   Hash Cond: (t2.kind_id = kt2.id)
                                                   ->  Parallel Hash Join  (cost=123051.03..130366.03 rows=47 width=72) (actual time=1402.445..1430.826 rows=70 loops=2)
                                                         Hash Cond: (cn2.id = mc2.company_id)
                                                         ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.010..16.152 rows=117498 loops=2)
                                                         ->  Parallel Hash  (cost=123050.62..123050.62 rows=33 width=57) (actual time=1400.690..1400.690 rows=70 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=89312.34..123050.62 rows=33 width=57) (actual time=1013.263..1400.612 rows=70 loops=2)
                                                                     Hash Cond: (mc2.movie_id = t2.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.009..229.905 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=89311.94..89311.94 rows=32 width=65) (actual time=1010.307..1010.307 rows=38 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=33182.88..89311.94 rows=32 width=65) (actual time=555.533..1010.160 rows=38 loops=2)
                                                                                 Hash Cond: (t2.id = ml.linked_movie_id)
                                                                                 ->  Parallel Seq Scan on title t2  (cost=0.00..51799.95 rows=432897 width=25) (actual time=0.030..404.000 rows=521400 loops=2)
                                                                                       Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                                                       Rows Removed by Filter: 742756
                                                                                 ->  Parallel Hash  (cost=33181.88..33181.88 rows=80 width=40) (actual time=549.933..549.933 rows=49 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Parallel Hash Join  (cost=26712.90..33181.88 rows=80 width=40) (actual time=478.450..549.719 rows=49 loops=2)
                                                                                             Hash Cond: (mc1.company_id = cn1.id)
                                                                                             ->  Hash Join  (cost=21066.29..27534.89 rows=149 width=25) (actual time=404.915..475.867 rows=63 loops=2)
                                                                                                   Hash Cond: (mi_idx2.info_type_id = it2.id)
                                                                                                   ->  Parallel Hash Join  (cost=21063.87..27486.73 rows=16791 width=29) (actual time=404.457..475.090 rows=6846 loops=2)
                                                                                                         Hash Cond: (ml.linked_movie_id = mi_idx2.movie_id)
                                                                                                         ->  Merge Join  (cost=869.16..5648.12 rows=10916 width=16) (actual time=9.386..37.635 rows=5049 loops=2)
                                                                                                               Merge Cond: (mc1.movie_id = ml.movie_id)
                                                                                                               ->  Parallel Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..116330.44 rows=1087137 width=8) (actual time=0.088..21.018 rows=49939 loops=2)
                                                                                                               ->  Sort  (cost=868.72..881.22 rows=5000 width=8) (actual time=9.168..9.572 rows=6226 loops=2)
                                                                                                                     Sort Key: ml.movie_id
                                                                                                                     Sort Method: quicksort  Memory: 205kB
                                                                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                                     ->  Hash Join  (cost=1.29..561.53 rows=5000 width=8) (actual time=0.095..8.206 rows=2315 loops=2)
                                                                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.037..4.089 rows=29997 loops=2)
                                                                                                                           ->  Hash  (cost=1.25..1.25 rows=3 width=4) (actual time=0.040..0.040 rows=2 loops=2)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.25 rows=3 width=4) (actual time=0.033..0.037 rows=2 loops=2)
                                                                                                                                       Filter: ((link)::text = ANY ('{sequel,follows,"followed by"}'::text[]))
                                                                                                                                       Rows Removed by Filter: 16
                                                                                                         ->  Parallel Hash  (cost=15122.68..15122.68 rows=291762 width=13) (actual time=353.897..353.897 rows=351960 loops=2)
                                                                                                               Buckets: 131072  Batches: 16  Memory Usage: 3328kB
                                                                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=291762 width=13) (actual time=0.024..228.528 rows=351960 loops=2)
                                                                                                                     Filter: ((info)::text < '3.5'::text)
                                                                                                                     Rows Removed by Filter: 338058
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=2)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.046 rows=1 loops=2)
                                                                                                               Filter: ((info)::text = 'rating'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=73895 width=23) (actual time=72.308..72.309 rows=63115 loops=2)
                                                                                                   Buckets: 131072  Batches: 1  Memory Usage: 8256kB
                                                                                                   ->  Parallel Seq Scan on company_name cn1  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.020..37.704 rows=63115 loops=2)
                                                                                                         Filter: ((country_code)::text <> '[us]'::text)
                                                                                                         Rows Removed by Filter: 54384
                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.059..0.059 rows=2 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=2 width=4) (actual time=0.037..0.039 rows=2 loops=2)
                                                               Filter: ((kind)::text = ANY ('{"tv series",episode}'::text[]))
                                                               Rows Removed by Filter: 5
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.025 rows=1 loops=1)
                                       Filter: ((info)::text = 'rating'::text)
                                       Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.036..0.036 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=2 width=4) (actual time=0.013..0.015 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{"tv series",episode}'::text[]))
                     Rows Removed by Filter: 5
 Planning Time: 109.944 ms
 Execution Time: 1604.211 ms
(92 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=389853.80..389853.81 rows=1 width=32) (actual time=2979.906..2979.906 rows=1 loops=1)
   ->  Gather  (cost=389853.58..389853.79 rows=2 width=32) (actual time=2979.586..2985.124 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=388853.58..388853.59 rows=1 width=32) (actual time=2973.149..2973.150 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=337023.30..388853.51 rows=30 width=17) (actual time=2789.008..2973.061 rows=69 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.016..270.012 rows=337640 loops=3)
                           Filter: (production_year > 2005)
                           Rows Removed by Filter: 505131
                     ->  Parallel Hash  (cost=337022.38..337022.38 rows=74 width=8) (actual time=2653.987..2653.987 rows=589 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=50880.48..337022.38 rows=74 width=8) (actual time=606.136..2653.452 rows=589 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..285615.00 rows=60182 width=4) (actual time=0.973..2041.008 rows=51299 loops=3)
                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                                       Rows Removed by Filter: 4893941
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=601.510..601.510 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=33.923..472.993 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..253.934 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.350..33.350 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.831..33.297 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.824 ms
 Execution Time: 2985.516 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3b.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=340923.67..340923.68 rows=1 width=32) (actual time=2106.682..2106.682 rows=1 loops=1)
   ->  Gather  (cost=340923.45..340923.66 rows=2 width=32) (actual time=2106.370..2111.940 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=339923.45..339923.46 rows=1 width=32) (actual time=2100.035..2100.036 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=290135.26..339923.45 rows=1 width=17) (actual time=2068.175..2100.022 rows=2 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.012..248.319 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=290135.24..290135.24 rows=1 width=8) (actual time=1834.007..1834.007 rows=7 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=50880.48..290135.24 rows=1 width=8) (actual time=690.860..1833.897 rows=7 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=158 width=4) (actual time=73.603..1237.865 rows=762 loops=3)
                                       Filter: ((info)::text = 'Bulgaria'::text)
                                       Rows Removed by Filter: 4944478
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=595.439..595.439 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.206..471.592 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..252.488 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.568..33.568 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.843..33.518 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.576 ms
 Execution Time: 2112.388 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=409155.23..409155.24 rows=1 width=32) (actual time=4099.289..4099.289 rows=1 loops=1)
   ->  Gather  (cost=409155.02..409155.23 rows=2 width=32) (actual time=4098.853..4104.212 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=408155.02..408155.03 rows=1 width=32) (actual time=4092.471..4092.471 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=354417.68..408154.42 rows=241 width=17) (actual time=3740.002..4091.159 rows=2417 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.011..280.946 rows=583011 loops=3)
                           Filter: (production_year > 1990)
                           Rows Removed by Filter: 259760
                     ->  Parallel Hash  (cost=354413.34..354413.34 rows=347 width=8) (actual time=3734.419..3734.420 rows=4054 loops=3)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                           ->  Parallel Hash Join  (cost=50880.48..354413.34 rows=347 width=8) (actual time=604.239..2842.077 rows=4054 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=4) (actual time=1.041..2208.262 rows=235558 loops=3)
                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                       Rows Removed by Filter: 4709682
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=599.197..599.198 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.133..471.168 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..252.555 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.242..33.242 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.827..33.190 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.964 ms
 Execution Time: 4104.611 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4a.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=118372.74..118372.75 rows=1 width=64) (actual time=1177.610..1177.611 rows=1 loops=1)
   ->  Gather  (cost=67607.95..118372.73 rows=2 width=22) (actual time=921.315..1182.469 rows=740 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=66607.95..117372.53 rows=1 width=22) (actual time=924.306..1170.334 rows=247 loops=3)
               Hash Cond: (t.id = mi_idx.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.012..265.714 rows=337640 loops=3)
                     Filter: (production_year > 2005)
                     Rows Removed by Filter: 505131
               ->  Parallel Hash  (cost=66607.92..66607.92 rows=2 width=13) (actual time=858.505..858.505 rows=1940 loops=3)
                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                     ->  Parallel Hash Join  (cost=50882.90..66607.92 rows=2 width=13) (actual time=589.187..784.112 rows=1940 loops=3)
                           Hash Cond: (mi_idx.movie_id = mk.movie_id)
                           ->  Hash Join  (cost=2.43..15720.19 rows=1934 width=9) (actual time=0.170..178.844 rows=117663 loops=3)
                                 Hash Cond: (mi_idx.info_type_id = it.id)
                                 ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=218500 width=13) (actual time=0.033..144.689 rows=174440 loops=3)
                                       Filter: ((info)::text > '5.0'::text)
                                       Rows Removed by Filter: 285572
                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.063..0.064 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.047..0.049 rows=1 loops=3)
                                             Filter: ((info)::text = 'rating'::text)
                                             Rows Removed by Filter: 112
                           ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=588.453..588.453 rows=4317 loops=3)
                                 Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                 ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.208..472.310 rows=4317 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..253.408 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.577..33.578 rows=30 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.867..33.527 rows=30 loops=3)
                                                   Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                   Rows Removed by Filter: 134140
 Planning Time: 4.095 ms
 Execution Time: 1183.397 ms
(35 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4b.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=116799.72..116799.73 rows=1 width=64) (actual time=878.204..878.204 rows=1 loops=1)
   ->  Gather  (cost=67011.42..116799.71 rows=1 width=22) (actual time=804.736..883.760 rows=6 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=66011.42..115799.61 rows=1 width=22) (actual time=843.522..871.561 rows=2 loops=3)
               Hash Cond: (t.id = mi_idx.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.012..249.845 rows=130555 loops=3)
                     Filter: (production_year > 2010)
                     Rows Removed by Filter: 712215
               ->  Parallel Hash  (cost=66011.41..66011.41 rows=1 width=13) (actual time=603.906..603.906 rows=7 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=17758.80..66011.41 rows=1 width=13) (actual time=299.045..603.771 rows=7 loops=3)
                           Hash Cond: (mk.movie_id = mi_idx.movie_id)
                           ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=35.318..474.869 rows=4317 loops=3)
                                 Hash Cond: (mk.keyword_id = k.id)
                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..254.381 rows=1507977 loops=3)
                                 ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=34.710..34.710 rows=30 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.979..34.665 rows=30 loops=3)
                                             Filter: ((keyword)::text ~~ '%sequel%'::text)
                                             Rows Removed by Filter: 134140
                           ->  Parallel Hash  (cost=15132.23..15132.23 rows=23 width=9) (actual time=127.868..127.868 rows=102 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Hash Join  (cost=2.43..15132.23 rows=23 width=9) (actual time=1.387..127.738 rows=102 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=2615 width=13) (actual time=0.157..126.700 rows=2794 loops=3)
                                             Filter: ((info)::text > '9.0'::text)
                                             Rows Removed by Filter: 457218
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.047 rows=1 loops=3)
                                                   Filter: ((info)::text = 'rating'::text)
                                                   Rows Removed by Filter: 112
 Planning Time: 4.162 ms
 Execution Time: 884.214 ms
(35 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=119900.33..119900.34 rows=1 width=64) (actual time=1250.792..1250.792 rows=1 loops=1)
   ->  Gather  (cost=119900.11..119900.32 rows=2 width=64) (actual time=1250.307..1257.449 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=118900.11..118900.12 rows=1 width=64) (actual time=1243.458..1243.458 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=66992.13..118900.10 rows=2 width=22) (actual time=874.101..1242.072 rows=1567 loops=3)
                     Hash Cond: (t.id = mi_idx.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.013..289.909 rows=583011 loops=3)
                           Filter: (production_year > 1990)
                           Rows Removed by Filter: 259760
                     ->  Parallel Hash  (cost=66992.09..66992.09 rows=3 width=13) (actual time=872.341..872.341 rows=2697 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=50882.90..66992.09 rows=3 width=13) (actual time=603.853..829.721 rows=2697 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                 ->  Hash Join  (cost=2.43..16099.73 rows=3167 width=9) (actual time=0.184..205.689 rows=149656 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=357862 width=13) (actual time=0.038..156.307 rows=287152 loops=3)
                                             Filter: ((info)::text > '2.0'::text)
                                             Rows Removed by Filter: 172860
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.069..0.070 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.050..0.053 rows=1 loops=3)
                                                   Filter: ((info)::text = 'rating'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=603.001..603.001 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=35.015..479.277 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..259.708 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.990..33.990 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.897..33.940 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 4.121 ms
 Execution Time: 1257.956 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5a.sql_explained.sql
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=372724.06..372724.07 rows=1 width=32) (actual time=260.791..260.791 rows=1 loops=1)
   ->  Gather  (cost=372723.84..372724.05 rows=2 width=32) (actual time=260.660..262.803 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=371723.84..371723.85 rows=1 width=32) (actual time=253.923..253.923 rows=1 loops=3)
               ->  Hash Join  (cost=85882.87..371723.72 rows=48 width=17) (actual time=253.920..253.920 rows=0 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=85879.33..371720.05 rows=48 width=21) (actual time=253.604..253.605 rows=0 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..285615.00 rows=60182 width=8) (never executed)
                                 Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                           ->  Parallel Hash  (cost=85877.27..85877.27 rows=165 width=25) (actual time=253.217..253.217 rows=0 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                 ->  Parallel Hash Join  (cost=35112.01..85877.27 rows=165 width=25) (actual time=253.127..253.128 rows=0 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (never executed)
                                             Filter: (production_year > 2005)
                                       ->  Parallel Hash  (cost=35106.92..35106.92 rows=407 width=4) (actual time=253.088..253.088 rows=0 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                             ->  Hash Join  (cost=1.06..35106.92 rows=407 width=4) (actual time=253.061..253.062 rows=0 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=1629 width=8) (actual time=8.981..251.349 rows=8008 loops=3)
                                                         Filter: (((note)::text ~~ '%(theatrical)%'::text) AND ((note)::text ~~ '%(France)%'::text))
                                                         Rows Removed by Filter: 861701
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.035 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.095..0.095 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.034..0.048 rows=113 loops=3)
 Planning Time: 4.620 ms
 Execution Time: 263.229 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5b.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=328691.22..328691.23 rows=1 width=32) (actual time=245.894..245.894 rows=1 loops=1)
   ->  Gather  (cost=328691.00..328691.21 rows=2 width=32) (actual time=245.745..247.877 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=327691.00..327691.01 rows=1 width=32) (actual time=239.245..239.246 rows=1 loops=3)
               ->  Hash Join  (cost=87607.92..327691.00 rows=1 width=17) (actual time=239.243..239.243 rows=0 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=87604.38..327687.46 rows=1 width=21) (actual time=238.923..238.924 rows=0 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=221252 width=8) (never executed)
                                 Filter: ((info)::text = ANY ('{USA,America}'::text[]))
                           ->  Parallel Hash  (cost=87604.36..87604.36 rows=1 width=25) (actual time=238.561..238.561 rows=0 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                 ->  Parallel Hash Join  (cost=37816.17..87604.36 rows=1 width=25) (actual time=238.469..238.470 rows=0 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (never executed)
                                             Filter: (production_year > 2010)
                                       ->  Parallel Hash  (cost=37816.09..37816.09 rows=6 width=4) (actual time=238.430..238.430 rows=0 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                             ->  Hash Join  (cost=1.06..37816.09 rows=6 width=4) (actual time=238.399..238.400 rows=0 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=25 width=8) (actual time=4.342..238.080 rows=473 loops=3)
                                                         Filter: (((note)::text ~~ '%(VHS)%'::text) AND ((note)::text ~~ '%(USA)%'::text) AND ((note)::text ~~ '%(1994)%'::text))
                                                         Rows Removed by Filter: 869237
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.028..0.029 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.099..0.099 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.030..0.044 rows=113 loops=3)
 Planning Time: 4.489 ms
 Execution Time: 248.338 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5c.sql_explained.sql
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=391106.63..391106.64 rows=1 width=32) (actual time=2999.785..2999.785 rows=1 loops=1)
   ->  Gather  (cost=391106.42..391106.63 rows=2 width=32) (actual time=2999.325..3006.005 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=390106.42..390106.43 rows=1 width=32) (actual time=2992.560..2992.560 rows=1 loops=3)
               ->  Hash Join  (cost=87874.47..390061.87 rows=17818 width=17) (actual time=758.856..2992.314 rows=223 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=87870.93..390009.80 rows=17818 width=21) (actual time=758.527..2991.848 rows=223 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.010..2304.245 rows=235558 loops=3)
                                 Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                 Rows Removed by Filter: 4709682
                           ->  Parallel Hash  (cost=87706.73..87706.73 rows=13136 width=25) (actual time=659.731..659.732 rows=256 loops=3)
                                 Buckets: 32768  Batches: 1  Memory Usage: 352kB
                                 ->  Parallel Hash Join  (cost=35744.04..87706.73 rows=13136 width=25) (actual time=313.207..658.906 rows=256 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.032..294.660 rows=583011 loops=3)
                                             Filter: (production_year > 1990)
                                             Rows Removed by Filter: 259760
                                       ->  Parallel Hash  (cost=35507.44..35507.44 rows=18928 width=4) (actual time=300.318..300.318 rows=266 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 608kB
                                             ->  Hash Join  (cost=1.06..35507.44 rows=18928 width=4) (actual time=213.311..299.965 rows=266 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=75712 width=8) (actual time=0.024..289.587 rows=98543 loops=3)
                                                         Filter: (((note)::text !~~ '%(TV)%'::text) AND ((note)::text ~~ '%(USA)%'::text))
                                                         Rows Removed by Filter: 771167
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.027..0.029 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.097..0.097 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.034..0.048 rows=113 loops=3)
 Planning Time: 4.384 ms
 Execution Time: 3006.470 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=622340.59..622340.60 rows=1 width=96) (actual time=4825.988..4825.988 rows=1 loops=1)
   ->  Gather  (cost=622340.37..622340.58 rows=2 width=96) (actual time=4825.770..4831.177 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=621340.37..621340.38 rows=1 width=96) (actual time=4819.028..4819.028 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=571552.17..621340.36 rows=1 width=48) (actual time=4787.801..4818.995 rows=2 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.018..246.805 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=39) (actual time=4554.569..4554.569 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=39) (actual time=3454.774..4554.448 rows=2 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=796.932..4095.934 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.034..2144.676 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=491.176..491.176 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=198.434..491.094 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=458.421..458.421 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=128.700..458.332 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..254.123 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=21.943..21.943 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.577..21.923 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.633 ms
 Execution Time: 4831.823 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6b.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=622719.90..622719.91 rows=1 width=96) (actual time=5245.693..5245.693 rows=1 loops=1)
   ->  Gather  (cost=622719.67..622719.88 rows=2 width=96) (actual time=5244.944..5251.822 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=621719.67..621719.68 rows=1 width=96) (actual time=5237.908..5237.908 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=544400.32..621719.67 rows=1 width=48) (actual time=5085.476..5237.898 rows=4 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=204.256..509.104 rows=1 loops=3)
                           Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                           Rows Removed by Filter: 1389163
                     ->  Parallel Hash  (cost=544400.31..544400.31 rows=1 width=37) (actual time=4728.216..4728.216 rows=128 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=101052.25..544400.31 rows=1 width=37) (actual time=1007.372..4727.905 rows=128 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=49166.44..492513.86 rows=167 width=29) (actual time=265.230..4170.003 rows=1033 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.038..2317.764 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=49166.29..49166.29 rows=12 width=21) (actual time=248.874..248.874 rows=146 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=12 width=21) (actual time=111.775..248.590 rows=146 loops=3)
                                                   Filter: (production_year > 2014)
                                                   Rows Removed by Filter: 842625
                                 ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=557.281..557.282 rows=11849 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                       ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.447..491.790 rows=11849 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..259.612 rows=1507977 loops=3)
                                             ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=44.217..44.217 rows=8 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.186..44.192 rows=8 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                         Rows Removed by Filter: 134162
 Planning Time: 4.748 ms
 Execution Time: 5252.365 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=621712.31..621712.32 rows=1 width=96) (actual time=4914.843..4914.843 rows=1 loops=1)
   ->  Gather  (cost=621712.09..621712.30 rows=2 width=96) (actual time=4914.599..4920.025 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=620712.09..620712.10 rows=1 width=96) (actual time=4907.928..4907.928 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=543392.73..620712.08 rows=1 width=48) (actual time=4762.623..4907.913 rows=1 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=194.814..485.383 rows=1 loops=3)
                           Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                           Rows Removed by Filter: 1389163
                     ->  Parallel Hash  (cost=543392.72..543392.72 rows=1 width=37) (actual time=4421.927..4421.927 rows=11 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=100044.67..543392.72 rows=1 width=37) (actual time=1716.784..4421.785 rows=11 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=49166.44..492513.86 rows=167 width=29) (actual time=246.250..3962.742 rows=1033 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.035..2129.737 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=49166.29..49166.29 rows=12 width=21) (actual time=230.239..230.239 rows=146 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=12 width=21) (actual time=100.967..229.969 rows=146 loops=3)
                                                   Filter: (production_year > 2014)
                                                   Rows Removed by Filter: 842625
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=458.742..458.748 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=174.510..458.653 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..254.513 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=21.901..21.902 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.587..21.881 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.408 ms
 Execution Time: 4920.635 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6d.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=624885.62..624885.63 rows=1 width=96) (actual time=4971.577..4971.577 rows=1 loops=1)
   ->  Gather  (cost=624885.39..624885.60 rows=2 width=96) (actual time=4970.980..4976.941 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=623885.39..623885.40 rows=1 width=96) (actual time=4964.076..4964.076 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=572559.75..623885.39 rows=1 width=48) (actual time=4815.256..4964.009 rows=29 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.013..274.038 rows=460484 loops=3)
                           Filter: (production_year > 2000)
                           Rows Removed by Filter: 382286
                     ->  Parallel Hash  (cost=572559.74..572559.74 rows=1 width=39) (actual time=4641.513..4641.513 rows=37 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=129206.67..572559.74 rows=1 width=39) (actual time=1347.180..4641.332 rows=37 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=806.822..4100.890 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.033..2135.477 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=501.049..501.049 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=201.170..500.979 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=540.234..540.234 rows=11849 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                       ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.041..482.497 rows=11849 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..250.451 rows=1507977 loops=3)
                                             ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=43.844..43.844 rows=8 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.177..43.820 rows=8 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                         Rows Removed by Filter: 134162
 Planning Time: 4.675 ms
 Execution Time: 4977.409 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6e.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=623878.03..623878.04 rows=1 width=96) (actual time=5009.515..5009.515 rows=1 loops=1)
   ->  Gather  (cost=623877.81..623878.02 rows=2 width=96) (actual time=5009.240..5016.513 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=622877.81..622877.82 rows=1 width=96) (actual time=5002.097..5002.098 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=571552.17..622877.80 rows=1 width=48) (actual time=4964.341..5002.072 rows=2 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.013..282.753 rows=460484 loops=3)
                           Filter: (production_year > 2000)
                           Rows Removed by Filter: 382286
                     ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=39) (actual time=4672.266..4672.266 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=39) (actual time=3544.078..4672.134 rows=2 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=823.469..4207.671 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.038..2235.168 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=510.039..510.039 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=204.804..509.969 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=464.356..464.357 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=131.634..464.258 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..259.679 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=21.928..21.928 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.599..21.905 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.488 ms
 Execution Time: 5017.093 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6f.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=652048.60..652048.61 rows=1 width=96) (actual time=6971.127..6971.127 rows=1 loops=1)
   ->  Gather  (cost=652048.38..652048.59 rows=2 width=96) (actual time=6967.460..7096.876 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=651048.38..651048.39 rows=1 width=96) (actual time=6960.831..6960.831 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=565020.96..651031.37 rows=2268 width=48) (actual time=6345.936..6852.786 rows=261826 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.055..384.238 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=564992.61..564992.61 rows=2268 width=37) (actual time=5421.732..5421.732 rows=261826 loops=3)
                           Buckets: 65536 (originally 8192)  Batches: 16 (originally 1)  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=104652.02..564992.61 rows=2268 width=37) (actual time=944.035..5152.501 rows=261826 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.030..2198.479 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=104651.25..104651.25 rows=62 width=41) (actual time=943.885..943.885 rows=4722 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1336kB
                                       ->  Parallel Hash Join  (cost=51885.81..104651.25 rows=62 width=41) (actual time=545.278..884.551 rows=4722 loops=3)
                                             Hash Cond: (t.id = mk.movie_id)
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.012..274.203 rows=460484 loops=3)
                                                   Filter: (production_year > 2000)
                                                   Rows Removed by Filter: 382286
                                             ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=545.040..545.040 rows=11849 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                                   ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=43.916..485.170 rows=11849 loops=3)
                                                         Hash Cond: (mk.keyword_id = k.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..253.518 rows=1507977 loops=3)
                                                         ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=43.698..43.698 rows=8 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.175..43.670 rows=8 loops=3)
                                                                     Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                                     Rows Removed by Filter: 134162
 Planning Time: 4.737 ms
 Execution Time: 7099.422 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7a.sql_explained.sql
SET
SET
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=693399.56..693399.57 rows=1 width=64) (actual time=5951.701..5951.701 rows=1 loops=1)
   ->  Gather  (cost=693399.34..693399.55 rows=2 width=64) (actual time=5951.471..5958.162 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=692399.34..692399.35 rows=1 width=64) (actual time=5943.496..5943.497 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=675186.31..692399.33 rows=1 width=32) (actual time=5848.944..5943.473 rows=11 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..16090.49 rows=299338 width=4) (actual time=0.039..124.604 rows=224897 loops=3)
                           Filter: ((name)::text ~~ '%a%'::text)
                           Rows Removed by Filter: 75550
                     ->  Parallel Hash  (cost=675186.30..675186.30 rows=1 width=44) (actual time=5796.229..5796.229 rows=5 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=622849.52..675186.30 rows=1 width=44) (actual time=5751.025..5796.100 rows=5 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=622267.21..674603.97 rows=1 width=52) (actual time=5496.088..5784.535 rows=130 loops=3)
                                       Hash Cond: (t.id = ci.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=143147 width=21) (actual time=0.026..269.656 rows=113395 loops=3)
                                             Filter: ((production_year >= 1980) AND (production_year <= 1995))
                                             Rows Removed by Filter: 729375
                                       ->  Parallel Hash  (cost=622267.19..622267.19 rows=1 width=31) (actual time=5495.010..5495.011 rows=890 loops=3)
                                             Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                             ->  Parallel Hash Join  (cost=161930.27..622267.19 rows=1 width=31) (actual time=1114.349..4862.055 rows=890 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.040..2303.596 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=161930.25..161930.25 rows=1 width=23) (actual time=1078.738..1078.738 rows=6 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=66488.22..161930.25 rows=1 width=23) (actual time=341.966..1078.625 rows=6 loops=3)
                                                               Hash Cond: (n.id = pi.person_id)
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..94683.23 rows=202346 width=19) (actual time=0.058..730.716 rows=181097 loops=3)
                                                                     Filter: (((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'B%'::text))))
                                                                     Rows Removed by Filter: 1208067
                                                               ->  Parallel Hash  (cost=66488.21..66488.21 rows=1 width=4) (actual time=328.190..328.190 rows=21 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Hash Join  (cost=2.43..66488.21 rows=1 width=4) (actual time=6.247..328.105 rows=21 loops=3)
                                                                           Hash Cond: (pi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on person_info pi  (cost=0.00..66485.75 rows=12 width=8) (actual time=6.128..327.956 rows=21 loops=3)
                                                                                 Filter: ((note)::text = 'Volker Boehm'::text)
                                                                                 Rows Removed by Filter: 987867
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.049 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'mini biography'::text)
                                                                                       Rows Removed by Filter: 112
                                 ->  Hash  (cost=561.48..561.48 rows=1666 width=4) (actual time=11.437..11.437 rows=5186 loops=3)
                                       Buckets: 8192 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 247kB
                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=4) (actual time=0.203..9.726 rows=5186 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.046..5.075 rows=29997 loops=3)
                                             ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.078..0.078 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.041..0.043 rows=1 loops=3)
                                                         Filter: ((link)::text = 'features'::text)
                                                         Rows Removed by Filter: 17
 Planning Time: 15.583 ms
 Execution Time: 5959.017 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7b.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=663974.41..663974.42 rows=1 width=64) (actual time=5319.331..5319.331 rows=1 loops=1)
   ->  Gather  (cost=663974.19..663974.40 rows=2 width=64) (actual time=5317.317..5325.601 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=662974.19..662974.20 rows=1 width=64) (actual time=5309.708..5309.709 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=645761.16..662974.18 rows=1 width=32) (actual time=5269.987..5309.689 rows=5 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..16090.49 rows=299338 width=4) (actual time=0.041..121.417 rows=224897 loops=3)
                           Filter: ((name)::text ~~ '%a%'::text)
                           Rows Removed by Filter: 75550
                     ->  Parallel Hash  (cost=645761.15..645761.15 rows=1 width=44) (actual time=5165.774..5165.774 rows=3 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Hash Join  (cost=201453.00..645761.15 rows=1 width=44) (actual time=4734.659..5165.491 rows=3 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=200870.69..645178.82 rows=1 width=52) (actual time=2915.848..5154.167 rows=7 loops=3)
                                       Hash Cond: (n.id = pi.person_id)
                                       ->  Parallel Hash Join  (cost=134382.47..578648.77 rows=11153 width=48) (actual time=1050.769..4825.761 rows=11015 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Hash Join  (cost=82162.96..525510.35 rows=350058 width=27) (actual time=484.892..4473.213 rows=304108 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.033..2267.782 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=40251 width=19) (actual time=483.918..483.918 rows=30659 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 6048kB
                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40251 width=19) (actual time=0.095..460.620 rows=30659 loops=3)
                                                               Filter: (((name_pcode_cf)::text ~~ 'D%'::text) AND ((gender)::text = 'm'::text))
                                                               Rows Removed by Filter: 1358505
                                             ->  Parallel Hash  (cost=51799.95..51799.95 rows=33565 width=21) (actual time=286.163..286.163 rows=25355 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 5376kB
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=33565 width=21) (actual time=0.035..259.806 rows=25355 loops=3)
                                                         Filter: ((production_year >= 1980) AND (production_year <= 1984))
                                                         Rows Removed by Filter: 817416
                                       ->  Parallel Hash  (cost=66488.21..66488.21 rows=1 width=4) (actual time=327.022..327.022 rows=21 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=2.43..66488.21 rows=1 width=4) (actual time=6.659..326.942 rows=21 loops=3)
                                                   Hash Cond: (pi.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on person_info pi  (cost=0.00..66485.75 rows=12 width=8) (actual time=6.535..326.790 rows=21 loops=3)
                                                         Filter: ((note)::text = 'Volker Boehm'::text)
                                                         Rows Removed by Filter: 987867
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.053 rows=1 loops=3)
                                                               Filter: ((info)::text = 'mini biography'::text)
                                                               Rows Removed by Filter: 112
                                 ->  Hash  (cost=561.48..561.48 rows=1666 width=4) (actual time=11.263..11.263 rows=5186 loops=3)
                                       Buckets: 8192 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 247kB
                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=4) (actual time=0.186..9.600 rows=5186 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.044..4.974 rows=29997 loops=3)
                                             ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=3)
                                                         Filter: ((link)::text = 'features'::text)
                                                         Rows Removed by Filter: 17
 Planning Time: 14.275 ms
 Execution Time: 5326.307 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7c.sql_explained.sql
SET
SET
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=697422.31..697422.32 rows=1 width=64) (actual time=9028.426..9028.427 rows=1 loops=1)
   ->  Gather  (cost=697422.09..697422.30 rows=2 width=64) (actual time=9022.110..9738.698 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=696422.09..696422.10 rows=1 width=64) (actual time=9014.642..9014.642 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=678258.59..696422.08 rows=2 width=109) (actual time=8812.241..8885.526 rows=22728 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..17029.39 rows=302423 width=4) (actual time=0.049..125.678 rows=228698 loops=3)
                           Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%a%'::text) OR ((name)::text ~~ 'A%'::text)))
                           Rows Removed by Filter: 71749
                     ->  Parallel Hash  (cost=678258.58..678258.58 rows=1 width=121) (actual time=8601.048..8601.048 rows=13386 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 2592kB
                           ->  Hash Join  (cost=624016.03..678258.58 rows=1 width=121) (actual time=7814.392..8505.249 rows=13386 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=623371.14..677606.36 rows=189 width=129) (actual time=7795.508..8456.263 rows=176455 loops=3)
                                       Hash Cond: (t.id = ci.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=649194 width=4) (actual time=0.046..297.198 rows=518532 loops=3)
                                             Filter: ((production_year >= 1980) AND (production_year <= 2010))
                                             Rows Removed by Filter: 324238
                                       ->  Parallel Hash  (cost=623367.30..623367.30 rows=307 width=125) (actual time=7232.334..7232.334 rows=305764 loops=3)
                                             Buckets: 8192 (originally 1024)  Batches: 256 (originally 1)  Memory Usage: 3232kB
                                             ->  Parallel Hash Join  (cost=163029.14..623367.30 rows=307 width=125) (actual time=1331.922..5354.657 rows=305764 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.046..2284.461 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=163028.71..163028.71 rows=35 width=117) (actual time=1331.447..1331.447 rows=4354 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 11384kB
                                                         ->  Parallel Hash Join  (cost=98354.03..163028.71 rows=35 width=117) (actual time=1222.134..1293.368 rows=4354 loops=3)
                                                               Hash Cond: (pi.person_id = n.id)
                                                               ->  Hash Join  (cost=2.43..63495.30 rows=306 width=98) (actual time=0.120..349.674 rows=28061 loops=3)
                                                                     Hash Cond: (pi.info_type_id = it.id)
                                                                     ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=34617 width=102) (actual time=0.048..331.728 rows=28061 loops=3)
                                                                           Filter: (note IS NOT NULL)
                                                                           Rows Removed by Filter: 959827
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.055 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'mini biography'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=94683.23..94683.23 rows=199790 width=19) (actual time=783.184..783.184 rows=169207 loops=3)
                                                                     Buckets: 65536  Batches: 8  Memory Usage: 4032kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..94683.23 rows=199790 width=19) (actual time=0.081..717.605 rows=169207 loops=3)
                                                                           Filter: (((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'A%'::text))))
                                                                           Rows Removed by Filter: 1219957
                                 ->  Hash  (cost=561.57..561.57 rows=6666 width=4) (actual time=18.634..18.635 rows=21505 loops=3)
                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 1013kB
                                       ->  Hash Join  (cost=1.32..561.57 rows=6666 width=4) (actual time=0.164..11.928 rows=21505 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.042..5.049 rows=29997 loops=3)
                                             ->  Hash  (cost=1.27..1.27 rows=4 width=4) (actual time=0.071..0.071 rows=4 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.27 rows=4 width=4) (actual time=0.039..0.044 rows=4 loops=3)
                                                         Filter: ((link)::text = ANY ('{references,"referenced in",features,"featured in"}'::text[]))
                                                         Rows Removed by Filter: 14
 Planning Time: 14.538 ms
 Execution Time: 9739.659 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8a.sql_explained.sql
SET
SET
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=631023.55..631023.56 rows=1 width=64) (actual time=3692.143..3692.143 rows=1 loops=1)
   ->  Gather  (cost=631023.33..631023.54 rows=2 width=64) (actual time=3691.461..3698.593 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=630023.33..630023.34 rows=1 width=64) (actual time=3684.262..3684.262 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=579540.20..630023.33 rows=1 width=33) (actual time=3481.690..3684.213 rows=21 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.013..223.778 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=579540.18..579540.18 rows=1 width=24) (actual time=3357.159..3357.159 rows=21 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=563388.51..579540.18 rows=1 width=24) (actual time=3318.962..3357.037 rows=21 loops=3)
                                 Hash Cond: (an1.person_id = ci.person_id)
                                 ->  Parallel Hash Join  (cost=81879.04..98016.48 rows=3793 width=24) (actual time=504.709..621.684 rows=1344 loops=3)
                                       Hash Cond: (an1.person_id = n1.id)
                                       ->  Parallel Seq Scan on aka_name an1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.031..72.756 rows=300448 loops=3)
                                       ->  Parallel Hash  (cost=81659.82..81659.82 rows=17538 width=4) (actual time=503.621..503.621 rows=6970 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 1376kB
                                             ->  Parallel Seq Scan on name n1  (cost=0.00..81659.82 rows=17538 width=4) (actual time=0.222..497.741 rows=6970 loops=3)
                                                   Filter: (((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))
                                                   Rows Removed by Filter: 1382193
                                 ->  Parallel Hash  (cost=481509.44..481509.44 rows=2 width=12) (actual time=2734.970..2734.970 rows=2479 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 504kB
                                       ->  Hash Join  (cost=39896.72..481509.44 rows=2 width=12) (actual time=1082.912..2620.965 rows=2479 loops=3)
                                             Hash Cond: (ci.role_id = rt.id)
                                             ->  Parallel Hash Join  (cost=39895.56..481508.19 rows=25 width=16) (actual time=297.505..2619.436 rows=6533 loops=3)
                                                   Hash Cond: (ci.movie_id = mc.movie_id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=40775 width=12) (actual time=0.719..2312.917 rows=31032 loops=3)
                                                         Filter: ((note)::text = '(voice: English version)'::text)
                                                         Rows Removed by Filter: 12050416
                                                   ->  Parallel Hash  (cost=39892.48..39892.48 rows=246 width=4) (actual time=296.237..296.237 rows=16109 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2968kB
                                                         ->  Parallel Hash Join  (cost=4773.19..39892.48 rows=246 width=4) (actual time=24.818..266.151 rows=16109 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=8470 width=8) (actual time=0.087..234.932 rows=16299 loops=3)
                                                                     Filter: (((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text))
                                                                     Rows Removed by Filter: 853411
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=4022 width=4) (actual time=24.629..24.629 rows=2251 loops=3)
                                                                     Buckets: 8192  Batches: 1  Memory Usage: 384kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=4022 width=4) (actual time=0.041..23.176 rows=2251 loops=3)
                                                                           Filter: ((country_code)::text = '[jp]'::text)
                                                                           Rows Removed by Filter: 76082
                                             ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.063..0.063 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=3)
                                                         Filter: ((role)::text = 'actress'::text)
                                                         Rows Removed by Filter: 11
 Planning Time: 9.477 ms
 Execution Time: 3699.262 ms
(48 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8b.sql_explained.sql
SET
SET
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=642938.22..642938.23 rows=1 width=64) (actual time=5126.436..5126.437 rows=1 loops=1)
   ->  Gather  (cost=642938.11..642938.22 rows=1 width=64) (actual time=5126.111..5131.368 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=641938.11..641938.12 rows=1 width=64) (actual time=5120.715..5120.715 rows=1 loops=2)
               ->  Hash Join  (cost=637200.09..641938.10 rows=1 width=33) (actual time=5101.472..5120.677 rows=3 loops=2)
                     Hash Cond: (ci.role_id = rt.id)
                     ->  Parallel Hash Join  (cost=637198.93..641936.94 rows=1 width=37) (actual time=5101.245..5120.448 rows=3 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=4022 width=4) (actual time=0.015..22.269 rows=3376 loops=2)
                                 Filter: ((country_code)::text = '[jp]'::text)
                                 Rows Removed by Filter: 114122
                           ->  Parallel Hash  (cost=637198.91..637198.91 rows=1 width=41) (actual time=5097.293..5097.293 rows=3 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=596664.89..637198.91 rows=1 width=41) (actual time=4885.380..5097.214 rows=3 loops=2)
                                       Hash Cond: (mc.movie_id = ci.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..40532.74 rows=338 width=8) (actual time=0.082..354.579 rows=4284 loops=2)
                                             Filter: (((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text) AND (((note)::text ~~ '%(2006)%'::text) OR ((note)::text ~~ '%(2007)%'::text)))
                                             Rows Removed by Filter: 1300280
                                       ->  Parallel Hash  (cost=596664.88..596664.88 rows=1 width=45) (actual time=4741.604..4741.604 rows=4 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=580513.21..596664.88 rows=1 width=45) (actual time=4703.665..4741.533 rows=4 loops=2)
                                                   Hash Cond: (an.person_id = ci.person_id)
                                                   ->  Parallel Hash Join  (cost=81879.04..98016.48 rows=3793 width=24) (actual time=739.964..912.391 rows=2016 loops=2)
                                                         Hash Cond: (an.person_id = n.id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.016..107.568 rows=450672 loops=2)
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=17538 width=4) (actual time=739.117..739.117 rows=10456 loops=2)
                                                               Buckets: 65536  Batches: 1  Memory Usage: 1376kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=17538 width=4) (actual time=0.132..730.869 rows=10456 loops=2)
                                                                     Filter: (((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))
                                                                     Rows Removed by Filter: 2073290
                                                   ->  Parallel Hash  (cost=498634.15..498634.15 rows=1 width=33) (actual time=3828.796..3828.796 rows=113 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                         ->  Parallel Hash Join  (cost=57067.49..498634.15 rows=1 width=33) (actual time=423.218..3828.607 rows=113 loops=2)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=40775 width=12) (actual time=0.875..3444.080 rows=46548 loops=2)
                                                                     Filter: ((note)::text = '(voice: English version)'::text)
                                                                     Rows Removed by Filter: 18075624
                                                               ->  Parallel Hash  (cost=57067.27..57067.27 rows=18 width=21) (actual time=377.801..377.801 rows=4 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=18 width=21) (actual time=286.880..377.740 rows=4 loops=2)
                                                                           Filter: ((production_year >= 2006) AND (production_year <= 2007) AND (((title)::text ~~ 'One Piece%'::text) OR ((title)::text ~~ 'Dragon Ball Z%'::text)))
                                                                           Rows Removed by Filter: 1264152
                     ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.030..0.032 rows=1 loops=2)
                                 Filter: ((role)::text = 'actress'::text)
                                 Rows Removed by Filter: 11
 Planning Time: 9.436 ms
 Execution Time: 5132.040 ms
(50 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8c.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=767932.80..767932.81 rows=1 width=64) (actual time=8150.923..8150.923 rows=1 loops=1)
   ->  Gather  (cost=767932.58..767932.79 rows=2 width=64) (actual time=8146.661..8305.608 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=766932.58..766932.59 rows=1 width=64) (actual time=8139.401..8139.401 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=243772.58..752972.57 rows=2792002 width=33) (actual time=7624.603..7905.859 rows=829204 loops=3)
                     Hash Cond: (ci.person_id = a1.person_id)
                     ->  Parallel Hash Join  (cost=118006.90..594573.48 rows=1215217 width=21) (actual time=5692.205..6005.404 rows=656886 loops=3)
                           Hash Cond: (ci.movie_id = t.id)
                           ->  Hash Join  (cost=1.16..457349.15 rows=1258484 width=8) (actual time=2568.229..3980.776 rows=909648 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.044..2182.019 rows=12081448 loops=3)
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.031..0.032 rows=1 loops=3)
                                             Filter: ((role)::text = 'writer'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=110366.87..110366.87 rows=395029 width=25) (actual time=1460.754..1460.754 rows=384599 loops=3)
                                 Buckets: 65536  Batches: 32  Memory Usage: 2784kB
                                 ->  Parallel Hash Join  (cost=44347.81..110366.87 rows=395029 width=25) (actual time=1050.096..1326.460 rows=384599 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.017..267.222 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=37865.94..37865.94 rows=395029 width=4) (actual time=508.976..508.976 rows=384599 loops=3)
                                             Buckets: 131072  Batches: 16  Memory Usage: 3872kB
                                             ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=4) (actual time=39.004..401.299 rows=384599 loops=3)
                                                   Hash Cond: (mc.company_id = cn.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.019..161.610 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.483..38.484 rows=28281 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.035..24.674 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                     ->  Parallel Hash  (cost=118870.18..118870.18 rows=375560 width=24) (actual time=1409.708..1409.708 rows=300448 loops=3)
                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=22047.10..118870.18 rows=375560 width=24) (actual time=956.694..1308.460 rows=300448 loops=3)
                                 Hash Cond: (n1.id = a1.person_id)
                                 ->  Parallel Seq Scan on name n1  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.051..419.482 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=15151.60..15151.60 rows=375560 width=20) (actual time=187.293..187.293 rows=300448 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 3680kB
                                       ->  Parallel Seq Scan on aka_name a1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.050..87.880 rows=300448 loops=3)
 Planning Time: 8.949 ms
 Execution Time: 8306.344 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8d.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=767932.80..767932.81 rows=1 width=64) (actual time=7057.199..7057.199 rows=1 loops=1)
   ->  Gather  (cost=767932.58..767932.79 rows=2 width=64) (actual time=7053.333..7206.632 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=766932.58..766932.59 rows=1 width=64) (actual time=7046.431..7046.431 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=243772.58..752972.57 rows=2792002 width=33) (actual time=6946.257..7015.711 rows=107668 loops=3)
                     Hash Cond: (ci.person_id = an1.person_id)
                     ->  Parallel Hash Join  (cost=118006.90..594573.48 rows=1215217 width=21) (actual time=5399.545..5499.892 rows=95179 loops=3)
                           Hash Cond: (ci.movie_id = t.id)
                           ->  Hash Join  (cost=1.16..457349.15 rows=1258484 width=8) (actual time=3052.562..3893.013 rows=92134 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.039..2210.932 rows=12081448 loops=3)
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=3)
                                             Filter: ((role)::text = 'costume designer'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=110366.87..110366.87 rows=395029 width=25) (actual time=1470.598..1470.599 rows=384599 loops=3)
                                 Buckets: 65536  Batches: 32  Memory Usage: 2784kB
                                 ->  Parallel Hash Join  (cost=44347.81..110366.87 rows=395029 width=25) (actual time=1058.602..1338.527 rows=384599 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.017..267.213 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=37865.94..37865.94 rows=395029 width=4) (actual time=503.458..503.458 rows=384599 loops=3)
                                             Buckets: 131072  Batches: 16  Memory Usage: 3872kB
                                             ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=4) (actual time=37.624..394.176 rows=384599 loops=3)
                                                   Hash Cond: (mc.company_id = cn.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.017..159.534 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=37.165..37.165 rows=28281 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.035..24.189 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                     ->  Parallel Hash  (cost=118870.18..118870.18 rows=375560 width=24) (actual time=1407.527..1407.528 rows=300448 loops=3)
                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=22047.10..118870.18 rows=375560 width=24) (actual time=957.112..1306.408 rows=300448 loops=3)
                                 Hash Cond: (n1.id = an1.person_id)
                                 ->  Parallel Seq Scan on name n1  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.052..421.453 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=15151.60..15151.60 rows=375560 width=20) (actual time=186.609..186.610 rows=300448 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 3680kB
                                       ->  Parallel Seq Scan on aka_name an1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.056..87.697 rows=300448 loops=3)
 Planning Time: 8.742 ms
 Execution Time: 7207.307 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9a.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=727877.31..727877.32 rows=1 width=96) (actual time=4602.756..4602.757 rows=1 loops=1)
   ->  Gather  (cost=674329.47..727877.30 rows=1 width=49) (actual time=4309.517..4609.543 rows=121 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=673329.47..726877.20 rows=1 width=49) (actual time=4342.350..4595.433 rows=40 loops=3)
               Hash Cond: (t.id = ci.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=466073 width=21) (actual time=0.022..268.053 rows=369296 loops=3)
                     Filter: ((production_year >= 2005) AND (production_year <= 2015))
                     Rows Removed by Filter: 473475
               ->  Parallel Hash  (cost=673329.45..673329.45 rows=1 width=40) (actual time=4285.937..4285.937 rows=114 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=668418.17..673329.45 rows=1 width=40) (actual time=4261.306..4285.788 rows=114 loops=3)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.019..21.694 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
                           ->  Parallel Hash  (cost=668418.15..668418.15 rows=1 width=44) (actual time=4260.945..4260.945 rows=116 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=613978.62..668418.15 rows=1 width=44) (actual time=3893.028..4260.820 rows=116 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.031..239.125 rows=1046780 loops=3)
                                       ->  Parallel Hash  (cost=613978.60..613978.60 rows=1 width=32) (actual time=3889.958..3889.958 rows=124 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=578389.44..613978.60 rows=1 width=32) (actual time=3590.156..3889.831 rows=124 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=131225 width=8) (actual time=0.017..285.637 rows=196998 loops=3)
                                                         Filter: ((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                                         Rows Removed by Filter: 672712
                                                   ->  Parallel Hash  (cost=578389.42..578389.42 rows=2 width=24) (actual time=3582.825..3582.826 rows=142 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Hash Join  (cost=97799.03..578389.42 rows=2 width=24) (actual time=1631.543..3582.705 rows=142 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Hash Join  (cost=97797.87..578388.18 rows=19 width=28) (actual time=1631.432..3582.548 rows=142 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.081..2834.927 rows=289159 loops=3)
                                                                           Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                           Rows Removed by Filter: 11792289
                                                                     ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=24) (actual time=705.727..705.728 rows=519 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=24) (actual time=587.437..705.232 rows=519 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.038..73.732 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=4) (actual time=585.939..585.939 rows=2256 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=4) (actual time=216.037..512.055 rows=2256 loops=3)
                                                                                             Filter: (((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1386908
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.039..0.041 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actress'::text)
                                                                           Rows Removed by Filter: 11
 Planning Time: 16.045 ms
 Execution Time: 4610.316 ms
(54 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9b.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=691306.83..691306.84 rows=1 width=128) (actual time=4339.622..4339.623 rows=1 loops=1)
   ->  Gather  (cost=638698.30..691306.82 rows=1 width=64) (actual time=4227.057..4346.285 rows=40 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=637698.30..690306.72 rows=1 width=64) (actual time=4155.853..4332.270 rows=13 loops=3)
               Hash Cond: (t.id = ci.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=215591 width=21) (actual time=0.015..254.546 rows=170942 loops=3)
                     Filter: ((production_year >= 2007) AND (production_year <= 2010))
                     Rows Removed by Filter: 671829
               ->  Parallel Hash  (cost=637698.28..637698.28 rows=1 width=55) (actual time=4056.414..4056.414 rows=31 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=632787.00..637698.28 rows=1 width=55) (actual time=4032.539..4056.297 rows=31 loops=3)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.023..21.421 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
                           ->  Parallel Hash  (cost=632786.98..632786.98 rows=1 width=59) (actual time=4031.897..4031.897 rows=31 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=594815.82..632786.98 rows=1 width=59) (actual time=3778.905..4031.818 rows=31 loops=3)
                                       Hash Cond: (mc.movie_id = ci.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=41669 width=8) (actual time=0.016..267.059 rows=66173 loops=3)
                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                             Rows Removed by Filter: 803537
                                       ->  Parallel Hash  (cost=594815.80..594815.80 rows=1 width=51) (actual time=3756.580..3756.580 rows=79 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=540376.27..594815.80 rows=1 width=51) (actual time=3384.742..3756.479 rows=79 loops=3)
                                                   Hash Cond: (chn.id = ci.person_role_id)
                                                   ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.050..243.947 rows=1046780 loops=3)
                                                   ->  Parallel Hash  (cost=540376.25..540376.25 rows=1 width=39) (actual time=3382.659..3382.659 rows=88 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Hash Join  (cost=97799.03..540376.25 rows=1 width=39) (actual time=1836.629..3382.546 rows=88 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Hash Join  (cost=97797.87..540375.04 rows=15 width=43) (actual time=1836.520..3382.408 rows=88 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=298009 width=16) (actual time=0.063..2337.051 rows=237943 loops=3)
                                                                           Filter: ((note)::text = '(voice)'::text)
                                                                           Rows Removed by Filter: 11843505
                                                                     ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=39) (actual time=1010.315..1010.315 rows=432 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                                           ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=39) (actual time=893.141..1009.857 rows=432 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.032..73.942 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=891.688..891.688 rows=1803 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 504kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=215.617..500.432 rows=1803 loops=3)
                                                                                             Filter: (((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1387361
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.035..0.037 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actress'::text)
                                                                           Rows Removed by Filter: 11
 Planning Time: 15.950 ms
 Execution Time: 4347.050 ms
(54 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9c.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=750479.65..750479.66 rows=1 width=128) (actual time=5194.902..5194.903 rows=1 loops=1)
   ->  Gather  (cost=750479.42..750479.63 rows=2 width=128) (actual time=5191.063..5266.087 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=749479.42..749479.43 rows=1 width=128) (actual time=5183.901..5183.901 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=732915.55..749475.64 rows=378 width=64) (actual time=5069.647..5182.427 rows=2715 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.071..71.196 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=732913.48..732913.48 rows=165 width=56) (actual time=5066.888..5066.888 rows=1501 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=682429.67..732913.48 rows=165 width=56) (actual time=4710.656..5049.835 rows=1501 loops=3)
                                 Hash Cond: (t.id = ci.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.015..216.462 rows=842771 loops=3)
                                 ->  Parallel Hash  (cost=682427.61..682427.61 rows=165 width=47) (actual time=4708.925..4708.925 rows=1501 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                       ->  Parallel Hash Join  (cost=648686.41..682427.61 rows=165 width=47) (actual time=4370.605..4651.014 rows=1501 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=643335.63..677075.64 rows=453 width=51) (actual time=4329.610..4608.674 rows=4128 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.022..154.989 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=643333.50..643333.50 rows=170 width=43) (actual time=4328.508..4328.508 rows=1895 loops=3)
                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 600kB
                                                         ->  Parallel Hash Join  (cost=155467.08..643333.50 rows=170 width=43) (actual time=4071.141..4280.583 rows=1895 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Hash Join  (cost=81911.39..562103.89 rows=353 width=31) (actual time=1445.036..3405.367 rows=2184 loops=3)
                                                                     Hash Cond: (ci.role_id = rt.id)
                                                                     ->  Parallel Hash Join  (cost=81910.23..562087.69 rows=4234 width=35) (actual time=1444.967..3404.485 rows=2185 loops=3)
                                                                           Hash Cond: (ci.person_id = n.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.241..2825.268 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=533.622..533.623 rows=16670 loops=3)
                                                                                 Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=220.359..520.751 rows=16670 loops=3)
                                                                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                       Rows Removed by Filter: 1372493
                                                                     ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.050..0.052 rows=1 loops=3)
                                                                                 Filter: ((role)::text = 'actress'::text)
                                                                                 Rows Removed by Filter: 11
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=641.433..641.433 rows=1046780 loops=3)
                                                                     Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.058..298.343 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.572..39.572 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4352kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.023..25.754 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 15.825 ms
 Execution Time: 5266.844 ms
(51 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9d.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=756571.53..756571.54 rows=1 width=128) (actual time=6584.804..6584.804 rows=1 loops=1)
   ->  Gather  (cost=756571.30..756571.51 rows=2 width=128) (actual time=6577.338..6801.709 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=755571.30..755571.31 rows=1 width=128) (actual time=6569.921..6569.921 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=738933.47..755496.36 rows=7494 width=64) (actual time=6383.959..6497.349 rows=161027 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.063..74.287 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=738892.70..738892.70 rows=3262 width=56) (actual time=6193.903..6193.903 rows=57856 loops=3)
                           Buckets: 32768 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2848kB
                           ->  Parallel Hash Join  (cost=688395.99..738892.70 rows=3262 width=56) (actual time=5894.549..6138.277 rows=57856 loops=3)
                                 Hash Cond: (t.id = ci.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.023..227.816 rows=842771 loops=3)
                                 ->  Parallel Hash  (cost=688355.22..688355.22 rows=3262 width=47) (actual time=5341.275..5341.276 rows=57856 loops=3)
                                       Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2432kB
                                       ->  Parallel Hash Join  (cost=654556.12..688355.22 rows=3262 width=47) (actual time=5048.361..5286.701 rows=57856 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=649205.34..682980.87 rows=8976 width=51) (actual time=5007.783..5216.167 rows=142133 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.038..157.819 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=649163.11..649163.11 rows=3378 width=43) (actual time=4615.574..4615.574 rows=85164 loops=3)
                                                         Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2976kB
                                                         ->  Parallel Hash Join  (cost=158158.83..649163.11 rows=3378 width=43) (actual time=4304.821..4523.723 rows=85164 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Hash Join  (cost=84603.14..567826.09 rows=6986 width=31) (actual time=3509.011..3618.143 rows=92002 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Hash Join  (cost=1.16..480518.83 rows=30581 width=12) (actual time=916.702..2910.284 rows=92055 loops=3)
                                                                           Hash Cond: (ci.role_id = rt.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.251..2847.066 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.031..0.032 rows=1 loops=3)
                                                                                       Filter: ((role)::text = 'actress'::text)
                                                                                       Rows Removed by Filter: 11
                                                                     ->  Parallel Hash  (cost=77318.68..77318.68 rows=396664 width=19) (actual time=551.306..551.307 rows=320518 loops=3)
                                                                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                                                                           ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=396664 width=19) (actual time=182.965..442.244 rows=320518 loops=3)
                                                                                 Filter: ((gender)::text = 'f'::text)
                                                                                 Rows Removed by Filter: 1068645
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=636.203..636.203 rows=1046780 loops=3)
                                                                     Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.066..292.800 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.706..39.706 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.022..25.474 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 15.421 ms
 Execution Time: 6802.908 ms
(51 rows)

