execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10a.sql_explained.sql
SET
SET
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=629274.70..629274.71 rows=1 width=64) (actual time=3842.941..3842.941 rows=1 loops=1)
   ->  Gather  (cost=629274.48..629274.69 rows=2 width=64) (actual time=3842.488..3849.726 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=628274.48..628274.49 rows=1 width=64) (actual time=3835.660..3835.661 rows=1 loops=3)
               ->  Hash Join  (cost=567292.56..628274.47 rows=2 width=33) (actual time=3460.600..3835.586 rows=35 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=567291.47..628273.38 rows=2 width=37) (actual time=3460.314..3835.282 rows=35 loops=3)
                           Hash Cond: (chn.id = ci.person_role_id)
                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.039..248.040 rows=1046780 loops=3)
                           ->  Parallel Hash  (cost=567291.40..567291.40 rows=5 width=25) (actual time=3458.890..3458.890 rows=37 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=516526.82..567291.40 rows=5 width=25) (actual time=3329.809..3458.737 rows=37 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.016..264.272 rows=337640 loops=3)
                                             Filter: (production_year > 2005)
                                             Rows Removed by Filter: 505131
                                       ->  Parallel Hash  (cost=516526.68..516526.68 rows=11 width=16) (actual time=3156.356..3156.356 rows=92 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=483987.14..516526.68 rows=11 width=16) (actual time=2919.969..3156.187 rows=92 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Hash Join  (cost=4733.23..37248.39 rows=6486 width=8) (actual time=22.389..297.096 rows=2930 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.010..154.180 rows=869710 loops=3)
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=825 width=4) (actual time=21.846..21.846 rows=454 loops=3)
                                                               Buckets: 2048  Batches: 1  Memory Usage: 112kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=825 width=4) (actual time=0.039..21.371 rows=454 loops=3)
                                                                     Filter: ((country_code)::text = '[ru]'::text)
                                                                     Rows Removed by Filter: 77879
                                                   ->  Parallel Hash  (cost=479245.16..479245.16 rows=700 width=8) (actual time=2857.968..2857.968 rows=8625 loops=3)
                                                         Buckets: 32768 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 1552kB
                                                         ->  Hash Join  (cost=1.16..479245.16 rows=700 width=8) (actual time=0.274..2729.412 rows=8625 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=8405 width=12) (actual time=0.172..2724.397 rows=10763 loops=3)
                                                                     Filter: (((note)::text ~~ '%(voice)%'::text) AND ((note)::text ~~ '%(uncredited)%'::text))
                                                                     Rows Removed by Filter: 12070685
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.041..0.041 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.028..0.031 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actor'::text)
                                                                           Rows Removed by Filter: 11
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.061..0.061 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.041..0.042 rows=4 loops=3)
 Planning Time: 8.266 ms
 Execution Time: 3850.412 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10b.sql_explained.sql
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=612898.77..612898.78 rows=1 width=64) (actual time=4441.935..4441.935 rows=1 loops=1)
   ->  Gather  (cost=612898.55..612898.76 rows=2 width=64) (actual time=4438.592..4495.700 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=611898.55..611898.56 rows=1 width=64) (actual time=4431.594..4431.595 rows=1 loops=3)
               ->  Hash Join  (cost=160692.60..611898.28 rows=55 width=33) (actual time=4431.587..4431.588 rows=0 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=160691.51..611896.89 rows=55 width=37) (actual time=4431.305..4431.396 rows=0 loops=3)
                           Hash Cond: (ci.person_role_id = chn.id)
                           ->  Hash Join  (cost=87135.83..530671.90 rows=115 width=25) (actual time=3438.988..3438.988 rows=0 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Hash Join  (cost=87134.66..530665.85 rows=1377 width=29) (actual time=1911.482..3438.762 rows=871 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=551821 width=12) (actual time=316.551..2811.279 rows=478480 loops=3)
                                             Filter: ((note)::text ~~ '%(producer)%'::text)
                                             Rows Removed by Filter: 11602968
                                       ->  Parallel Hash  (cost=87121.90..87121.90 rows=1021 width=29) (actual time=573.635..573.635 rows=420 loops=3)
                                             Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                             ->  Parallel Hash Join  (cost=37329.47..87121.90 rows=1021 width=29) (actual time=307.274..573.100 rows=420 loops=3)
                                                   Hash Cond: (t.id = mc.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.020..248.285 rows=130555 loops=3)
                                                         Filter: (production_year > 2010)
                                                         Rows Removed by Filter: 712215
                                                   ->  Parallel Hash  (cost=37248.39..37248.39 rows=6486 width=8) (actual time=303.563..303.563 rows=2930 loops=3)
                                                         Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                         ->  Parallel Hash Join  (cost=4733.23..37248.39 rows=6486 width=8) (actual time=23.261..301.269 rows=2930 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.009..157.055 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=825 width=4) (actual time=22.565..22.565 rows=454 loops=3)
                                                                     Buckets: 2048  Batches: 1  Memory Usage: 112kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=825 width=4) (actual time=0.064..22.045 rows=454 loops=3)
                                                                           Filter: ((country_code)::text = '[ru]'::text)
                                                                           Rows Removed by Filter: 77879
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.045..0.047 rows=1 loops=3)
                                             Filter: ((role)::text = 'actor'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=634.110..634.110 rows=1046780 loops=3)
                                 Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                 ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.063..291.788 rows=1046780 loops=3)
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.061..0.061 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.035..0.036 rows=4 loops=3)
 Planning Time: 7.914 ms
 Execution Time: 4496.636 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10c.sql_explained.sql
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=652016.30..652016.31 rows=1 width=64) (actual time=4966.517..4966.518 rows=1 loops=1)
   ->  Gather  (cost=652016.08..652016.29 rows=2 width=64) (actual time=4963.016..5055.621 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=651016.08..651016.09 rows=1 width=64) (actual time=4956.238..4956.239 rows=1 loops=3)
               ->  Hash Join  (cost=609518.31..650122.02 rows=178812 width=33) (actual time=4915.021..4956.204 rows=3 loops=3)
                     Hash Cond: (ci.role_id = rt.id)
                     ->  Hash Join  (cost=609517.04..649485.59 rows=178812 width=37) (actual time=4914.728..4955.909 rows=3 loops=3)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=609515.95..648517.80 rows=178812 width=41) (actual time=4914.626..4955.804 rows=3 loops=3)
                                 Hash Cond: (mc.movie_id = t.id)
                                 ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=8) (actual time=30.707..392.006 rows=384599 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.006..155.275 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=30.380..30.381 rows=28281 loops=3)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.024..19.264 rows=28281 loops=3)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=600222.44..600222.44 rows=185178 width=45) (actual time=4409.152..4409.152 rows=4 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 544kB
                                       ->  Parallel Hash Join  (cost=136144.88..600222.44 rows=185178 width=45) (actual time=4304.067..4407.799 rows=4 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Hash Join  (cost=73555.68..529520.84 rows=266824 width=24) (actual time=3654.338..3781.142 rows=5 loops=3)
                                                   Hash Cond: (ci.person_role_id = chn.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=551821 width=12) (actual time=296.393..2756.816 rows=478480 loops=3)
                                                         Filter: ((note)::text ~~ '%(producer)%'::text)
                                                         Rows Removed by Filter: 11602968
                                                   ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=632.631..632.631 rows=1046780 loops=3)
                                                         Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.047..293.055 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=49166.29..49166.29 rows=731112 width=21) (actual time=501.555..501.555 rows=583011 loops=3)
                                                   Buckets: 65536  Batches: 32  Memory Usage: 3616kB
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.039..297.596 rows=583011 loops=3)
                                                         Filter: (production_year > 1990)
                                                         Rows Removed by Filter: 259760
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.037..0.037 rows=4 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.025..0.027 rows=4 loops=3)
                     ->  Hash  (cost=1.12..1.12 rows=12 width=4) (actual time=0.058..0.058 rows=12 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on role_type rt  (cost=0.00..1.12 rows=12 width=4) (actual time=0.035..0.037 rows=12 loops=3)
 Planning Time: 7.871 ms
 Execution Time: 5056.303 ms
(44 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11a.sql_explained.sql
SET
SET
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=25460.06..25460.07 rows=1 width=96) (actual time=330.709..330.709 rows=1 loops=1)
   ->  Gather  (cost=19952.24..25460.06 rows=1 width=118) (actual time=284.068..335.585 rows=310 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Parallel Hash Join  (cost=18952.24..24459.96 rows=1 width=118) (actual time=280.467..325.077 rows=155 loops=2)
               Hash Cond: (cn.id = mc.company_id)
               ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.013..45.129 rows=24151 loops=2)
                     Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                     Rows Removed by Filter: 93348
               ->  Parallel Hash  (cost=18952.23..18952.23 rows=1 width=103) (actual time=276.712..276.712 rows=332 loops=2)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Hash Join  (cost=8687.12..18952.23 rows=1 width=103) (actual time=150.318..276.404 rows=332 loops=2)
                           Hash Cond: (mk.keyword_id = k.id)
                           ->  Merge Join  (cost=6060.98..16306.51 rows=7458 width=107) (actual time=104.514..243.780 rows=16065 loops=2)
                                 Merge Cond: (ml.movie_id = mk.movie_id)
                                 ->  Merge Join  (cost=6016.36..13086.62 rows=160 width=115) (actual time=104.437..205.539 rows=1397 loops=2)
                                       Merge Cond: (t.id = ml.movie_id)
                                       ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=379985 width=21) (actual time=0.109..99.145 rows=26100 loops=2)
                                             Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                             Rows Removed by Filter: 56295
                                       ->  Sort  (cost=6015.92..6018.59 rows=1065 width=94) (actual time=102.999..103.322 rows=4393 loops=2)
                                             Sort Key: mc.movie_id
                                             Sort Method: quicksort  Memory: 536kB
                                             Worker 0:  Sort Method: quicksort  Memory: 536kB
                                             ->  Hash Join  (cost=652.13..5962.37 rows=1065 width=94) (actual time=13.102..100.855 rows=4393 loops=2)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Merge Join  (cost=651.06..5938.28 rows=4260 width=98) (actual time=13.007..99.437 rows=5069 loops=2)
                                                         Merge Cond: (mc.movie_id = ml.movie_id)
                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.069..80.782 rows=49142 loops=2)
                                                               Filter: (note IS NULL)
                                                               Rows Removed by Filter: 50735
                                                         ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.790..13.176 rows=5369 loops=2)
                                                               Sort Key: ml.movie_id
                                                               Sort Method: quicksort  Memory: 205kB
                                                               Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                               ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.146..11.571 rows=2315 loops=2)
                                                                     Hash Cond: (ml.link_type_id = lt.id)
                                                                     ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.019..7.235 rows=29997 loops=2)
                                                                     ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.056..0.057 rows=2 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.039..0.045 rows=2 loops=2)
                                                                                 Filter: ((link)::text ~~ '%follow%'::text)
                                                                                 Rows Removed by Filter: 16
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=2)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                                 ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.014..26.538 rows=96539 loops=2)
                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=31.002..31.002 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.422..30.981 rows=1 loops=2)
                                       Filter: ((keyword)::text = 'sequel'::text)
                                       Rows Removed by Filter: 134169
 Planning Time: 13.783 ms
 Execution Time: 336.600 ms
(56 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=37292.30..37292.31 rows=1 width=96) (actual time=649.361..649.362 rows=1 loops=1)
   ->  Hash Join  (cost=15626.08..37292.29 rows=1 width=118) (actual time=402.315..649.339 rows=14 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=12999.94..34666.15 rows=1 width=122) (actual time=380.652..627.669 rows=56 loops=1)
               Merge Cond: (ml.movie_id = mk.movie_id)
               ->  Merge Join  (cost=12999.51..31520.71 rows=1 width=130) (actual time=361.234..608.223 rows=14 loops=1)
                     Merge Cond: (t.id = ml.movie_id)
                     ->  Gather Merge  (cost=1000.45..93601.60 rows=5 width=21) (actual time=277.142..556.643 rows=3 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=2 width=21) (actual time=142.215..457.924 rows=4 loops=3)
                                 Filter: (((title)::text ~~ '%Money%'::text) AND (production_year = 1998))
                                 Rows Removed by Filter: 292970
                     ->  Sort  (cost=11999.06..11999.54 rows=192 width=109) (actual time=84.038..84.067 rows=450 loops=1)
                           Sort Key: mc.movie_id
                           Sort Method: quicksort  Memory: 61kB
                           ->  Gather  (cost=7378.27..11991.77 rows=192 width=109) (actual time=64.917..85.057 rows=450 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Hash Join  (cost=6378.27..10972.57 rows=80 width=109) (actual time=57.766..76.549 rows=150 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=6377.21..10969.78 rows=321 width=113) (actual time=57.559..76.297 rows=153 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Merge Join  (cost=651.06..5238.97 rows=1775 width=98) (actual time=8.511..27.725 rows=692 loops=3)
                                                   Merge Cond: (mc.movie_id = ml.movie_id)
                                                   ->  Parallel Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..116330.44 rows=530595 width=12) (actual time=0.035..17.599 rows=16381 loops=3)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 16912
                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=8.375..8.485 rows=1516 loops=3)
                                                         Sort Key: ml.movie_id
                                                         Sort Method: quicksort  Memory: 103kB
                                                         Worker 0:  Sort Method: quicksort  Memory: 103kB
                                                         Worker 1:  Sort Method: quicksort  Memory: 103kB
                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.156..7.685 rows=1158 loops=3)
                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.035..3.668 rows=29997 loops=3)
                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.046..0.046 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.030..0.035 rows=1 loops=3)
                                                                           Filter: ((link)::text ~~ '%follows%'::text)
                                                                           Rows Removed by Filter: 17
                                             ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=47.438..47.438 rows=16101 loops=3)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.029..36.577 rows=16101 loops=3)
                                                         Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                         Rows Removed by Filter: 62232
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.071..0.071 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.048..0.050 rows=1 loops=3)
                                                   Filter: ((kind)::text = 'production companies'::text)
                                                   Rows Removed by Filter: 3
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.030..12.583 rows=69469 loops=1)
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.600..21.600 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.142..21.588 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 13.724 ms
 Execution Time: 683.925 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11c.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=26126.74..26126.75 rows=1 width=96) (actual time=649.893..649.893 rows=1 loops=1)
   ->  Hash Join  (cost=22974.01..26126.73 rows=1 width=60) (actual time=503.648..646.139 rows=6946 loops=1)
         Hash Cond: (ml.link_type_id = lt.id)
         ->  Hash Join  (cost=22972.60..26125.32 rows=1 width=64) (actual time=503.537..644.475 rows=6946 loops=1)
               Hash Cond: (mk.keyword_id = k.id)
               ->  Merge Join  (cost=20178.73..23330.26 rows=454 width=68) (actual time=279.656..532.583 rows=780776 loops=1)
                     Merge Cond: (mk.movie_id = ml.movie_id)
                     ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.048..24.710 rows=77819 loops=1)
                     ->  Sort  (cost=20178.30..20178.32 rows=10 width=76) (actual time=278.270..326.740 rows=780794 loops=1)
                           Sort Key: mc.movie_id
                           Sort Method: quicksort  Memory: 1609kB
                           ->  Gather  (cost=6420.11..20178.13 rows=10 width=76) (actual time=67.382..273.542 rows=8393 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Hash Join  (cost=5420.11..19177.13 rows=4 width=76) (actual time=60.684..216.565 rows=2798 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=5419.02..19176.02 rows=5 width=80) (actual time=60.484..215.486 rows=2801 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Merge Join  (cost=4.62..13682.01 rows=30328 width=65) (actual time=1.424..181.489 rows=34978 loops=3)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=2.03..8120.68 rows=11307 width=29) (actual time=0.872..116.244 rows=9909 loops=3)
                                                         Merge Cond: (t.id = ml.movie_id)
                                                         ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..89967.34 rows=952979 width=21) (actual time=0.103..97.670 rows=59309 loops=3)
                                                               Filter: (production_year > 1950)
                                                               Rows Removed by Filter: 2750
                                                         ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=8) (actual time=0.059..8.404 rows=29997 loops=3)
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1335700 width=36) (actual time=0.053..54.341 rows=77952 loops=3)
                                                         Filter: (note IS NOT NULL)
                                                         Rows Removed by Filter: 66955
                                             ->  Parallel Hash  (cost=5414.09..5414.09 rows=25 width=23) (actual time=29.028..29.028 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=25 width=23) (actual time=0.311..28.921 rows=30 loops=3)
                                                         Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '20th Century Fox%'::text) OR ((name)::text ~~ 'Twentieth Century Fox%'::text)))
                                                         Rows Removed by Filter: 78303
                                       ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.055..0.055 rows=3 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=3 width=4) (actual time=0.034..0.036 rows=3 loops=3)
                                                   Filter: ((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))
                                                   Rows Removed by Filter: 1
               ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=45.651..45.651 rows=3 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=1.795..45.634 rows=3 loops=1)
                           Filter: ((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))
                           Rows Removed by Filter: 134167
         ->  Hash  (cost=1.18..1.18 rows=18 width=4) (actual time=0.054..0.054 rows=18 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=4) (actual time=0.036..0.039 rows=18 loops=1)
 Planning Time: 15.305 ms
 Execution Time: 651.156 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11d.sql_explained.sql
SET
SET
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=34220.63..34220.64 rows=1 width=96) (actual time=341.288..341.289 rows=1 loops=1)
   ->  Hash Join  (cost=26974.32..34220.25 rows=51 width=60) (actual time=257.964..335.734 rows=14899 loops=1)
         Hash Cond: (cn.id = mc.company_id)
         ->  Seq Scan on company_name cn  (cost=0.00..5932.46 rows=210072 width=23) (actual time=0.028..55.409 rows=210031 loops=1)
               Filter: ((country_code)::text <> '[pl]'::text)
               Rows Removed by Filter: 24966
         ->  Hash  (cost=26973.61..26973.61 rows=57 width=45) (actual time=257.840..257.840 rows=14916 loops=1)
               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1231kB
               ->  Hash Join  (cost=21742.73..26973.61 rows=57 width=45) (actual time=213.114..251.469 rows=14916 loops=1)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Merge Join  (cost=21741.65..26972.11 rows=76 width=49) (actual time=213.005..247.704 rows=15510 loops=1)
                           Merge Cond: (mc.movie_id = ml.movie_id)
                           ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1335700 width=36) (actual time=0.025..27.182 rows=42219 loops=1)
                                 Filter: (note IS NOT NULL)
                                 Rows Removed by Filter: 41437
                           ->  Sort  (cost=21741.22..21741.29 rows=28 width=29) (actual time=212.711..213.764 rows=15913 loops=1)
                                 Sort Key: mk.movie_id
                                 Sort Method: quicksort  Memory: 159kB
                                 ->  Gather  (cost=3836.65..21740.54 rows=28 width=29) (actual time=44.164..212.091 rows=1460 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 2
                                       ->  Hash Join  (cost=2836.65..20737.74 rows=12 width=29) (actual time=39.013..201.255 rows=487 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Hash Join  (cost=2835.24..20736.30 rows=12 width=33) (actual time=38.822..200.905 rows=487 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Merge Join  (cost=41.37..16560.07 rows=526594 width=37) (actual time=0.639..162.350 rows=95464 loops=3)
                                                         Merge Cond: (ml.movie_id = mk.movie_id)
                                                         ->  Merge Join  (cost=2.03..8120.68 rows=11307 width=29) (actual time=0.385..95.879 rows=9909 loops=3)
                                                               Merge Cond: (t.id = ml.movie_id)
                                                               ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..89967.34 rows=952979 width=21) (actual time=0.027..79.088 rows=59309 loops=3)
                                                                     Filter: (production_year > 1950)
                                                                     Rows Removed by Filter: 2750
                                                               ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=8) (actual time=0.054..6.992 rows=29997 loops=3)
                                                         ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.049..37.464 rows=175267 loops=3)
                                                   ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=29.671..29.671 rows=3 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=1.224..29.656 rows=3 loops=3)
                                                               Filter: ((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))
                                                               Rows Removed by Filter: 134167
                                             ->  Hash  (cost=1.18..1.18 rows=18 width=4) (actual time=0.052..0.052 rows=18 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=4) (actual time=0.027..0.030 rows=18 loops=3)
                     ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.058..0.058 rows=3 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=3 width=4) (actual time=0.037..0.039 rows=3 loops=1)
                                 Filter: ((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))
                                 Rows Removed by Filter: 1
 Planning Time: 13.329 ms
 Execution Time: 342.264 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12a.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=346907.90..346907.91 rows=1 width=96) (actual time=3539.098..3539.098 rows=1 loops=1)
   ->  Gather  (cost=346907.78..346907.89 rows=1 width=96) (actual time=3538.734..3544.445 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=345907.78..345907.79 rows=1 width=96) (actual time=3533.370..3533.371 rows=1 loops=2)
               ->  Hash Join  (cost=340996.48..345907.77 rows=1 width=41) (actual time=3504.337..3533.174 rows=198 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=340995.42..345906.71 rows=1 width=45) (actual time=3504.100..3532.839 rows=354 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.011..23.573 rows=42422 loops=2)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 75077
                           ->  Parallel Hash  (cost=340995.41..340995.41 rows=1 width=30) (actual time=3503.646..3503.646 rows=967 loops=2)
                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                 ->  Parallel Hash Join  (cost=307257.26..340995.41 rows=1 width=30) (actual time=2963.163..3363.018 rows=967 loops=2)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.011..232.267 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=307257.25..307257.25 rows=1 width=34) (actual time=2956.762..2956.762 rows=278 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=254758.25..307257.25 rows=1 width=34) (actual time=2562.736..2956.329 rows=278 loops=2)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=186410 width=21) (actual time=0.034..378.235 rows=222930 loops=2)
                                                         Filter: ((production_year >= 2005) AND (production_year <= 2008))
                                                         Rows Removed by Filter: 1041226
                                                   ->  Parallel Hash  (cost=254758.24..254758.24 rows=1 width=13) (actual time=2543.364..2543.364 rows=972 loops=2)
                                                         Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                         ->  Parallel Hash Join  (cost=15184.50..254758.24 rows=1 width=13) (actual time=2165.388..2446.130 rows=972 loops=2)
                                                               Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                               ->  Hash Join  (cost=2.43..239572.30 rows=1028 width=4) (actual time=1940.922..2201.650 rows=136360 loops=2)
                                                                     Hash Cond: (mi.info_type_id = it1.id)
                                                                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=116213 width=8) (actual time=1346.645..2167.312 rows=137322 loops=2)
                                                                           Filter: ((info)::text = ANY ('{Drama,Horror}'::text[]))
                                                                           Rows Removed by Filter: 7280538
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.048..0.049 rows=1 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.029 rows=1 loops=2)
                                                                                 Filter: ((info)::text = 'genres'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=15179.85..15179.85 rows=178 width=9) (actual time=224.206..224.206 rows=7924 loops=2)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                     ->  Hash Join  (cost=2.43..15179.85 rows=178 width=9) (actual time=0.192..198.784 rows=7924 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.052..192.504 rows=26824 loops=2)
                                                                                 Filter: ((info)::text > '8.0'::text)
                                                                                 Rows Removed by Filter: 663193
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.034..0.035 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 14.305 ms
 Execution Time: 3545.177 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12b.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348978.79..348978.80 rows=1 width=64) (actual time=3728.396..3728.396 rows=1 loops=1)
   ->  Gather  (cost=348978.68..348978.79 rows=1 width=64) (actual time=3728.113..3733.608 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347978.68..347978.69 rows=1 width=64) (actual time=3722.841..3722.841 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343067.38..347978.67 rows=1 width=60) (actual time=3709.682..3722.824 rows=5 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.010..23.065 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343067.37..343067.37 rows=1 width=64) (actual time=3695.172..3695.172 rows=16 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102227.57..343067.37 rows=1 width=64) (actual time=2705.613..3695.117 rows=16 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=1500.092..2595.943 rows=60932 loops=2)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.029..1656.997 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'budget'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102225.13..102225.13 rows=1 width=33) (actual time=1092.896..1092.896 rows=16 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=86954.86..102225.13 rows=1 width=33) (actual time=1092.808..1092.826 rows=16 loops=2)
                                             Hash Cond: (mi_idx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=198.635..198.638 rows=5 loops=2)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.022..114.663 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.058 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=2)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86951.75..86951.75 rows=55 width=29) (actual time=894.095..894.095 rows=1984 loops=2)
                                                   Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 376kB
                                                   ->  Hash Join  (cost=54436.04..86951.75 rows=55 width=29) (actual time=460.833..883.591 rows=1984 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Parallel Hash Join  (cost=54434.96..86950.06 rows=111 width=33) (actual time=460.711..882.584 rows=1984 loops=2)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.006..232.491 rows=1304564 loops=2)
                                                               ->  Parallel Hash  (cost=54433.61..54433.61 rows=108 width=21) (actual time=459.736..459.736 rows=1268 loops=2)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=108 width=21) (actual time=0.682..457.697 rows=1268 loops=2)
                                                                           Filter: ((production_year > 2000) AND (((title)::text ~~ 'Birdemic%'::text) OR ((title)::text ~~ '%Movie%'::text)))
                                                                           Rows Removed by Filter: 1262888
                                                         ->  Hash  (cost=1.06..1.06 rows=2 width=4) (actual time=0.056..0.056 rows=2 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.06 rows=2 width=4) (actual time=0.034..0.036 rows=2 loops=2)
                                                                     Filter: ((kind IS NOT NULL) AND (((kind)::text = 'production companies'::text) OR ((kind)::text = 'distributors'::text)))
                                                                     Rows Removed by Filter: 2
 Planning Time: 14.041 ms
 Execution Time: 3734.364 ms
(53 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12c.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=363505.12..363505.13 rows=1 width=96) (actual time=3857.465..3857.465 rows=1 loops=1)
   ->  Gather  (cost=363505.00..363505.11 rows=1 width=96) (actual time=3856.852..3862.910 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=362505.00..362505.01 rows=1 width=96) (actual time=3851.477..3851.478 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=357593.71..362504.99 rows=1 width=41) (actual time=3819.118..3850.242 rows=2356 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.011..24.235 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=357593.68..357593.68 rows=2 width=26) (actual time=3818.466..3818.466 rows=7768 loops=2)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1176kB
                           ->  Hash Join  (cost=323855.49..357593.68 rows=2 width=26) (actual time=3585.109..3798.321 rows=7768 loops=2)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=323854.42..357592.57 rows=10 width=30) (actual time=3357.317..3793.895 rows=22503 loops=2)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..236.140 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=323854.40..323854.40 rows=2 width=34) (actual time=3357.074..3357.074 rows=3982 loops=2)
                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                             ->  Parallel Hash Join  (cost=270431.08..323854.40 rows=2 width=34) (actual time=2876.021..3349.450 rows=3982 loops=2)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=432897 width=21) (actual time=0.033..397.450 rows=521400 loops=2)
                                                         Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                         Rows Removed by Filter: 742756
                                                   ->  Parallel Hash  (cost=270431.01..270431.01 rows=5 width=13) (actual time=2875.298..2875.298 rows=11094 loops=2)
                                                         Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1592kB
                                                         ->  Parallel Hash Join  (cost=15354.10..270431.01 rows=5 width=13) (actual time=2499.403..2848.615 rows=11094 loops=2)
                                                               Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                               ->  Hash Join  (cost=2.43..255074.87 rows=1187 width=4) (actual time=2235.735..2548.931 rows=162628 loops=2)
                                                                     Hash Cond: (mi.info_type_id = it1.id)
                                                                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=134092 width=8) (actual time=1557.274..2508.281 rows=163656 loops=2)
                                                                           Filter: ((info)::text = ANY ('{Drama,Horror,Western,Family}'::text[]))
                                                                           Rows Removed by Filter: 7254204
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.029 rows=1 loops=2)
                                                                                 Filter: ((info)::text = 'genres'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=15342.82..15342.82 rows=708 width=9) (actual time=263.569..263.569 rows=60786 loops=2)
                                                                     Buckets: 131072 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 6832kB
                                                                     ->  Hash Join  (cost=2.43..15342.82 rows=708 width=9) (actual time=0.163..224.642 rows=60786 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=79942 width=13) (actual time=0.053..203.022 rows=96948 loops=2)
                                                                                 Filter: ((info)::text > '7.0'::text)
                                                                                 Rows Removed by Filter: 593070
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.039 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=2)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
 Planning Time: 13.889 ms
 Execution Time: 3863.744 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13a.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=345137.34..345137.35 rows=1 width=96) (actual time=3391.595..3391.596 rows=1 loops=1)
   ->  Gather  (cost=345137.12..345137.33 rows=2 width=96) (actual time=3386.196..3408.675 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=344137.12..344137.13 rows=1 width=96) (actual time=3378.453..3378.453 rows=1 loops=3)
               ->  Hash Join  (cost=293653.26..344137.03 rows=11 width=65) (actual time=3192.914..3362.392 rows=37034 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=293652.16..344135.60 rows=79 width=69) (actual time=2966.580..3351.541 rows=44730 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.025..221.268 rows=842771 loops=3)
                           ->  Parallel Hash  (cost=293651.17..293651.17 rows=79 width=60) (actual time=2965.895..2965.895 rows=44730 loops=3)
                                 Buckets: 262144 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 13880kB
                                 ->  Parallel Hash Join  (cost=52811.08..293651.17 rows=79 width=60) (actual time=1193.863..2833.246 rows=44730 loops=3)
                                       Hash Cond: (mi.movie_id = mc.movie_id)
                                       ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=465.418..1969.756 rows=1012240 loops=3)
                                             Hash Cond: (mi.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.046..1197.577 rows=4945240 loops=3)
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.033..0.033 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.019..0.030 rows=1 loops=3)
                                                         Filter: ((info)::text = 'release dates'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=52805.23..52805.23 rows=274 width=13) (actual time=726.796..726.796 rows=10503 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2040kB
                                             ->  Hash Join  (cost=20112.16..52805.23 rows=274 width=13) (actual time=646.931..697.701 rows=10503 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Hash Join  (cost=20111.09..52798.24 rows=1095 width=17) (actual time=645.391..693.555 rows=27966 loops=3)
                                                         Hash Cond: (mc.movie_id = miidx.movie_id)
                                                         ->  Parallel Hash Join  (cost=4793.88..37309.04 rows=44647 width=8) (actual time=26.181..326.106 rows=49377 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.010..163.448 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=5677 width=4) (actual time=26.054..26.054 rows=3258 loops=3)
                                                                     Buckets: 16384  Batches: 1  Memory Usage: 576kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=5677 width=4) (actual time=0.028..23.939 rows=3258 loops=3)
                                                                           Filter: ((country_code)::text = '[de]'::text)
                                                                           Rows Removed by Filter: 75074
                                                         ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=293.081..293.081 rows=153308 loops=3)
                                                               Buckets: 131072 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 3360kB
                                                               ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.169..167.290 rows=153308 loops=3)
                                                                     Hash Cond: (miidx.info_type_id = it.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.047..80.909 rows=460012 loops=3)
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.046 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'rating'::text)
                                                                                 Rows Removed by Filter: 112
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.070..0.070 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.044..0.046 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 20.522 ms
 Execution Time: 3409.479 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13b.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348980.78..348980.79 rows=1 width=96) (actual time=4244.928..4244.928 rows=1 loops=1)
   ->  Gather  (cost=348980.66..348980.77 rows=1 width=96) (actual time=4244.696..4250.042 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347980.66..347980.67 rows=1 width=96) (actual time=4239.383..4239.384 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343069.37..347980.65 rows=1 width=41) (actual time=4212.519..4239.240 rows=186 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.011..23.288 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343069.35..343069.35 rows=1 width=26) (actual time=4211.033..4211.034 rows=313 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102229.55..343069.35 rows=1 width=26) (actual time=2432.433..4210.829 rows=313 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=674.337..2768.742 rows=1518360 loops=2)
                                       Hash Cond: (mi.info_type_id = it2.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.027..1648.915 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102227.11..102227.11 rows=1 width=38) (actual time=1295.779..1295.779 rows=58 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=86956.85..102227.11 rows=1 width=38) (actual time=1137.339..1295.692 rows=58 loops=2)
                                             Hash Cond: (miidx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.144..239.059 rows=229962 loops=2)
                                                   Hash Cond: (miidx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.021..115.699 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86954.33..86954.33 rows=7 width=29) (actual time=1032.437..1032.437 rows=178 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=54438.22..86954.33 rows=7 width=29) (actual time=904.510..1032.227 rows=178 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Hash Join  (cost=54437.16..86953.12 rows=29 width=33) (actual time=682.283..1032.025 rows=384 loops=2)
                                                               Hash Cond: (t.kind_id = kt.id)
                                                               ->  Parallel Hash Join  (cost=54436.06..86951.16 rows=202 width=37) (actual time=611.030..1031.596 rows=1330 loops=2)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.006..233.251 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=54433.61..54433.61 rows=196 width=25) (actual time=610.766..610.766 rows=1109 loops=2)
                                                                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=196 width=25) (actual time=0.481..607.985 rows=1109 loops=2)
                                                                                 Filter: (((title)::text <> ''::text) AND (((title)::text ~~ '%Champion%'::text) OR ((title)::text ~~ '%Loser%'::text)))
                                                                                 Rows Removed by Filter: 1263047
                                                               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.043..0.044 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=2)
                                                                           Filter: ((kind)::text = 'movie'::text)
                                                                           Rows Removed by Filter: 6
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
 Planning Time: 21.098 ms
 Execution Time: 4251.045 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13c.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348980.78..348980.79 rows=1 width=96) (actual time=4052.777..4052.777 rows=1 loops=1)
   ->  Gather  (cost=348980.66..348980.77 rows=1 width=96) (actual time=4052.515..4057.831 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347980.66..347980.67 rows=1 width=96) (actual time=4047.179..4047.179 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343069.37..347980.65 rows=1 width=41) (actual time=4024.627..4047.116 rows=26 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.012..22.898 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343069.35..343069.35 rows=1 width=26) (actual time=4019.511..4019.511 rows=81 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102229.55..343069.35 rows=1 width=26) (actual time=2304.188..4019.392 rows=81 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=667.088..2745.513 rows=1518360 loops=2)
                                       Hash Cond: (mi.info_type_id = it2.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.039..1627.301 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102227.11..102227.11 rows=1 width=38) (actual time=1130.062..1130.062 rows=16 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=86956.85..102227.11 rows=1 width=38) (actual time=1023.376..1130.010 rows=16 loops=2)
                                             Hash Cond: (miidx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.148..239.023 rows=229962 loops=2)
                                                   Hash Cond: (miidx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.030..115.781 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.044 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86954.33..86954.33 rows=7 width=29) (actual time=868.272..868.272 rows=40 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=54438.22..86954.33 rows=7 width=29) (actual time=765.309..868.167 rows=40 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Hash Join  (cost=54437.16..86953.12 rows=29 width=33) (actual time=556.623..868.036 rows=90 loops=2)
                                                               Hash Cond: (t.kind_id = kt.id)
                                                               ->  Parallel Hash Join  (cost=54436.06..86951.16 rows=202 width=37) (actual time=469.741..867.889 rows=184 loops=2)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.016..230.446 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=54433.61..54433.61 rows=196 width=25) (actual time=469.332..469.332 rows=147 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=196 width=25) (actual time=3.977..469.069 rows=147 loops=2)
                                                                                 Filter: (((title)::text <> ''::text) AND (((title)::text ~~ 'Champion%'::text) OR ((title)::text ~~ 'Loser%'::text)))
                                                                                 Rows Removed by Filter: 1264009
                                                               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.033..0.035 rows=1 loops=2)
                                                                           Filter: ((kind)::text = 'movie'::text)
                                                                           Rows Removed by Filter: 6
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.052..0.053 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
 Planning Time: 20.944 ms
 Execution Time: 4058.757 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13d.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=346725.46..346725.47 rows=1 width=96) (actual time=9030.601..9030.602 rows=1 loops=1)
   ->  Gather  (cost=346725.34..346725.45 rows=1 width=96) (actual time=9024.642..9251.370 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=345725.34..345725.35 rows=1 width=96) (actual time=9021.234..9021.234 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=340435.70..345724.28 rows=141 width=41) (actual time=8688.857..8895.779 rows=335195 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.019..23.305 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=340432.26..340432.26 rows=275 width=26) (actual time=8639.537..8639.538 rows=959748 loops=2)
                           Buckets: 65536 (originally 1024)  Batches: 64 (originally 1)  Memory Usage: 4352kB
                           ->  Hash Join  (cost=306684.12..340432.26 rows=275 width=26) (actual time=6548.727..7998.624 rows=959748 loops=2)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=306683.05..340425.77 rows=1004 width=30) (actual time=6488.606..7517.379 rows=4061793 loops=2)
                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.028..234.640 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=306680.43..306680.43 rows=210 width=34) (actual time=5875.686..5875.686 rows=362366 loops=2)
                                             Buckets: 65536 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 3680kB
                                             ->  Hash Join  (cost=256185.00..306680.43 rows=210 width=34) (actual time=4987.869..5644.665 rows=362366 loops=2)
                                                   Hash Cond: (t.kind_id = kt.id)
                                                   ->  Parallel Hash Join  (cost=256183.90..306673.14 rows=1468 width=38) (actual time=4972.003..5538.143 rows=559492 loops=2)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.037..324.411 rows=1264156 loops=2)
                                                         ->  Parallel Hash  (cost=256165.55..256165.55 rows=1468 width=13) (actual time=4152.807..4152.807 rows=559492 loops=2)
                                                               Buckets: 131072 (originally 4096)  Batches: 16 (originally 1)  Memory Usage: 4384kB
                                                               ->  Parallel Hash Join  (cost=15319.64..256165.55 rows=1468 width=13) (actual time=3583.546..3928.616 rows=559492 loops=2)
                                                                     Hash Cond: (mi.movie_id = miidx.movie_id)
                                                                     ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=672.154..2794.279 rows=1518360 loops=2)
                                                                           Hash Cond: (mi.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.046..1659.848 rows=7417860 loops=2)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.021..0.032 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=384.439..384.439 rows=229962 loops=2)
                                                                           Buckets: 131072 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 3328kB
                                                                           ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.154..241.943 rows=229962 loops=2)
                                                                                 Hash Cond: (miidx.info_type_id = it.id)
                                                                                 ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.047..114.438 rows=690018 loops=2)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=2)
                                                                                             Filter: ((info)::text = 'rating'::text)
                                                                                             Rows Removed by Filter: 112
                                                   ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.033..0.035 rows=1 loops=2)
                                                               Filter: ((kind)::text = 'movie'::text)
                                                               Rows Removed by Filter: 6
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=2)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
 Planning Time: 20.816 ms
 Execution Time: 9252.430 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14a.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=420522.53..420522.54 rows=1 width=64) (actual time=3630.330..3630.330 rows=1 loops=1)
   ->  Gather  (cost=420522.31..420522.52 rows=2 width=64) (actual time=3629.343..3637.707 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=419522.31..419522.32 rows=1 width=64) (actual time=3622.116..3622.116 rows=1 loops=3)
               ->  Hash Join  (cost=369734.11..419522.30 rows=1 width=22) (actual time=3517.184..3621.830 rows=254 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=369733.01..419521.20 rows=1 width=26) (actual time=3343.404..3621.365 rows=328 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=25) (actual time=0.026..255.330 rows=130555 loops=3)
                                 Filter: (production_year > 2010)
                                 Rows Removed by Filter: 712215
                           ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3339.572..3339.572 rows=6989 loops=3)
                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                 ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=3050.098..3300.498 rows=6989 loops=3)
                                       Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                       ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.176..227.787 rows=151410 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.060..163.859 rows=447629 loops=3)
                                                   Filter: ((info)::text < '8.5'::text)
                                                   Rows Removed by Filter: 12383
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.029 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=3048.988..3048.988 rows=7972 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                             ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2479.546..2999.884 rows=7972 loops=3)
                                                   Hash Cond: (mi.movie_id = mk.movie_id)
                                                   ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1885.922..2375.666 rows=204750 loops=3)
                                                         Hash Cond: (mi.info_type_id = it1.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.056..2324.188 rows=235558 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4709682
                                                         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.054 rows=1 loops=3)
                                                                     Filter: ((info)::text = 'countries'::text)
                                                                     Rows Removed by Filter: 112
                                                   ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=593.191..593.191 rows=12364 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=47.533..498.323 rows=12364 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..262.011 rows=1507977 loops=3)
                                                               ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=47.207..47.208 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.850..47.195 rows=3 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                           Rows Removed by Filter: 134167
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 12.689 ms
 Execution Time: 3638.415 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14b.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=426312.24..426312.25 rows=1 width=64) (actual time=3199.023..3199.024 rows=1 loops=1)
   ->  Gather  (cost=426312.02..426312.23 rows=2 width=64) (actual time=3198.727..3205.674 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=425312.02..425312.03 rows=1 width=64) (actual time=3191.672..3191.673 rows=1 loops=3)
               ->  Hash Join  (cost=409759.67..425312.01 rows=1 width=22) (actual time=3178.156..3191.663 rows=0 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=409758.57..425310.91 rows=1 width=26) (actual time=3133.802..3191.370 rows=1 loops=3)
                           Hash Cond: (mi_idx.movie_id = t.id)
                           ->  Hash Join  (cost=2.43..15549.59 rows=1379 width=9) (actual time=0.161..167.025 rows=86616 loops=3)
                                 Hash Cond: (mi_idx.info_type_id = it2.id)
                                 ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=155862 width=13) (actual time=0.048..141.614 rows=125612 loops=3)
                                       Filter: ((info)::text > '6.0'::text)
                                       Rows Removed by Filter: 334399
                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=3)
                                             Filter: ((info)::text = 'rating'::text)
                                             Rows Removed by Filter: 112
                           ->  Parallel Hash  (cost=409756.13..409756.13 rows=1 width=33) (actual time=3014.540..3014.540 rows=3 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=361504.10..409756.13 rows=1 width=33) (actual time=2746.759..3014.429 rows=3 loops=3)
                                       Hash Cond: (mk.movie_id = t.id)
                                       ->  Hash Join  (cost=2626.15..50878.06 rows=28 width=4) (actual time=23.674..465.941 rows=6509 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..256.608 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=2 width=4) (actual time=23.433..23.433 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=2 width=4) (actual time=1.317..23.415 rows=1 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title}'::text[]))
                                                         Rows Removed by Filter: 134169
                                       ->  Parallel Hash  (cost=358877.94..358877.94 rows=1 width=29) (actual time=2546.695..2546.696 rows=41 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=57070.27..358877.94 rows=1 width=29) (actual time=2102.686..2546.541 rows=41 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=57067.84..358875.48 rows=12 width=33) (actual time=331.387..2546.396 rows=49 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.034..2241.043 rows=235558 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4709682
                                                         ->  Parallel Hash  (cost=57067.27..57067.27 rows=46 width=25) (actual time=278.690..278.690 rows=152 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=46 width=25) (actual time=0.971..278.403 rows=152 loops=3)
                                                                     Filter: ((production_year > 2010) AND (((title)::text ~~ '%murder%'::text) OR ((title)::text ~~ '%Murder%'::text) OR ((title)::text ~~ '%Mord%'::text)))
                                                                     Rows Removed by Filter: 842619
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.046 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.069..0.069 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 12.822 ms
 Execution Time: 3206.443 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14c.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=421498.92..421498.93 rows=1 width=64) (actual time=3549.148..3549.148 rows=1 loops=1)
   ->  Gather  (cost=421498.70..421498.91 rows=2 width=64) (actual time=3548.249..3556.166 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=420498.70..420498.71 rows=1 width=64) (actual time=3541.518..3541.519 rows=1 loops=3)
               ->  Hash Join  (cost=369734.12..420498.70 rows=1 width=22) (actual time=3235.510..3540.389 rows=1372 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=369733.01..420497.58 rows=1 width=26) (actual time=3233.326..3539.447 rows=1710 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.024..260.853 rows=337640 loops=3)
                                 Filter: (production_year > 2005)
                                 Rows Removed by Filter: 505131
                           ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3230.835..3230.835 rows=6989 loops=3)
                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                 ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2959.159..3203.621 rows=6989 loops=3)
                                       Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                       ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.168..222.867 rows=151410 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.053..159.212 rows=447629 loops=3)
                                                   Filter: ((info)::text < '8.5'::text)
                                                   Rows Removed by Filter: 12383
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2957.984..2957.984 rows=7972 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                             ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2402.789..2913.793 rows=7972 loops=3)
                                                   Hash Cond: (mi.movie_id = mk.movie_id)
                                                   ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1838.764..2320.438 rows=204750 loops=3)
                                                         Hash Cond: (mi.info_type_id = it1.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=0.972..2268.671 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.051 rows=1 loops=3)
                                                                     Filter: ((info)::text = 'countries'::text)
                                                                     Rows Removed by Filter: 112
                                                   ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=563.676..563.676 rows=12364 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=34.165..474.404 rows=12364 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.017..252.240 rows=1507977 loops=3)
                                                               ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=34.017..34.018 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.698..34.005 rows=3 loops=3)
                                                                           Filter: ((keyword IS NOT NULL) AND ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[])))
                                                                           Rows Removed by Filter: 134167
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.065..0.065 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.040..0.043 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 12.263 ms
 Execution Time: 3556.992 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=409625.94..409625.95 rows=1 width=64) (actual time=3567.138..3567.138 rows=1 loops=1)
   ->  Gather  (cost=409625.72..409625.93 rows=2 width=64) (actual time=3566.866..3574.260 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=408625.72..408625.73 rows=1 width=64) (actual time=3559.600..3559.600 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=400362.74..408625.68 rows=8 width=60) (actual time=3511.218..3559.512 rows=109 loops=3)
                     Hash Cond: (at.movie_id = t.id)
                     ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.039..37.101 rows=120491 loops=3)
                     ->  Parallel Hash  (cost=400362.70..400362.70 rows=3 width=76) (actual time=3504.655..3504.655 rows=466 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                           ->  Parallel Hash Join  (cost=396456.49..400362.70 rows=3 width=76) (actual time=3444.109..3488.389 rows=466 loops=3)
                                 Hash Cond: (k.id = mk.keyword_id)
                                 ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.079..38.531 rows=44723 loops=3)
                                       Heap Fetches: 134170
                                 ->  Parallel Hash  (cost=396456.03..396456.03 rows=3 width=80) (actual time=3443.942..3443.942 rows=466 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=346083.67..396456.03 rows=3 width=80) (actual time=2998.466..3439.968 rows=466 loops=3)
                                             Hash Cond: (mk.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.015..255.085 rows=1507977 loops=3)
                                             ->  Parallel Hash  (cost=346083.66..346083.66 rows=1 width=72) (actual time=2995.758..2995.758 rows=220 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=294758.03..346083.66 rows=1 width=72) (actual time=2681.368..2995.421 rows=220 loops=3)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.018..261.684 rows=460484 loops=3)
                                                               Filter: (production_year > 2000)
                                                               Rows Removed by Filter: 382286
                                                         ->  Parallel Hash  (cost=294758.02..294758.02 rows=1 width=51) (actual time=2679.080..2679.080 rows=223 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Hash Join  (cost=289846.73..294758.02 rows=1 width=51) (actual time=2651.666..2678.895 rows=223 loops=3)
                                                                     Hash Cond: (mc.company_type_id = ct.id)
                                                                     ->  Parallel Hash Join  (cost=289845.64..294756.93 rows=1 width=55) (actual time=2651.524..2678.677 rows=223 loops=3)
                                                                           Hash Cond: (cn.id = mc.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.023..23.848 rows=28281 loops=3)
                                                                                 Filter: ((country_code)::text = '[us]'::text)
                                                                                 Rows Removed by Filter: 50051
                                                                           ->  Parallel Hash  (cost=289845.63..289845.63 rows=1 width=59) (actual time=2651.264..2651.264 rows=233 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=254710.18..289845.63 rows=1 width=59) (actual time=2398.818..2650.933 rows=233 loops=3)
                                                                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=7675 width=12) (actual time=0.055..249.833 rows=20555 loops=3)
                                                                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))
                                                                                             Rows Removed by Filter: 849155
                                                                                       ->  Parallel Hash  (cost=254710.16..254710.16 rows=2 width=47) (actual time=2396.788..2396.788 rows=590 loops=3)
                                                                                             Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                                             ->  Hash Join  (cost=2.43..254710.16 rows=2 width=47) (actual time=290.872..1142.570 rows=590 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=51) (actual time=290.737..1141.880 rows=590 loops=3)
                                                                                                         Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                                                                                         Rows Removed by Filter: 4944650
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.055 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'release dates'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.089..0.089 rows=4 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.063..0.064 rows=4 loops=3)
 Planning Time: 32.328 ms
 Execution Time: 3575.044 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=411365.11..411365.12 rows=1 width=64) (actual time=2324.624..2324.625 rows=1 loops=1)
   ->  Gather  (cost=411364.89..411365.10 rows=2 width=64) (actual time=2324.420..2332.281 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=410364.89..410364.90 rows=1 width=64) (actual time=2317.166..2317.167 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=402101.92..410364.87 rows=4 width=60) (actual time=2312.037..2317.143 rows=12 loops=3)
                     Hash Cond: (at.movie_id = t.id)
                     ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.036..36.935 rows=120491 loops=3)
                     ->  Parallel Hash  (cost=402101.90..402101.90 rows=2 width=76) (actual time=2263.797..2263.797 rows=50 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=147394.15..402101.90 rows=2 width=76) (actual time=1356.956..2263.673 rows=50 loops=3)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..254710.16 rows=2 width=47) (actual time=298.620..1221.997 rows=590 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=51) (actual time=298.471..1221.262 rows=590 loops=3)
                                             Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                             Rows Removed by Filter: 4944650
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.060 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.048 rows=1 loops=3)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=147391.71..147391.71 rows=1 width=29) (actual time=1041.326..1041.326 rows=144 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=143485.50..147391.71 rows=1 width=29) (actual time=996.590..1041.093 rows=144 loops=3)
                                             Hash Cond: (k.id = mk.keyword_id)
                                             ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.053..39.419 rows=44723 loops=3)
                                                   Heap Fetches: 134170
                                             ->  Parallel Hash  (cost=143485.07..143485.07 rows=1 width=33) (actual time=996.403..996.403 rows=144 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=93112.71..143485.07 rows=1 width=33) (actual time=569.765..996.237 rows=144 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.015..249.908 rows=1507977 loops=3)
                                                         ->  Parallel Hash  (cost=93112.69..93112.69 rows=1 width=25) (actual time=561.372..561.372 rows=85 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=40186.82..93112.69 rows=1 width=25) (actual time=279.952..561.181 rows=85 loops=3)
                                                                     Hash Cond: (t.id = mc.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=300243 width=21) (actual time=0.023..254.753 rows=238753 loops=3)
                                                                           Filter: ((production_year >= 2005) AND (production_year <= 2010))
                                                                           Rows Removed by Filter: 604018
                                                                     ->  Parallel Hash  (cost=40186.81..40186.81 rows=1 width=4) (actual time=278.186..278.186 rows=93 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Hash Join  (cost=5069.61..40186.81 rows=1 width=4) (actual time=23.646..278.007 rows=93 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=5068.52..40185.72 rows=1 width=8) (actual time=23.529..277.840 rows=93 loops=3)
                                                                                       Hash Cond: (mc.company_id = cn.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=7675 width=12) (actual time=0.066..252.121 rows=20555 loops=3)
                                                                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))
                                                                                             Rows Removed by Filter: 849155
                                                                                       ->  Parallel Hash  (cost=5068.50..5068.50 rows=1 width=4) (actual time=22.300..22.300 rows=0 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..5068.50 rows=1 width=4) (actual time=15.641..22.267 rows=0 loops=3)
                                                                                                   Filter: (((country_code)::text = '[us]'::text) AND ((name)::text = 'YouTube'::text))
                                                                                                   Rows Removed by Filter: 78332
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.056..0.056 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.029..0.031 rows=4 loops=3)
 Planning Time: 32.402 ms
 Execution Time: 2333.073 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15c.sql_explained.sql
SET
SET
                                                                                                                            QUERY PLAN                                                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=424524.77..424524.78 rows=1 width=64) (actual time=3908.405..3908.405 rows=1 loops=1)
   ->  Gather  (cost=424524.55..424524.76 rows=2 width=64) (actual time=3908.214..3917.217 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=423524.55..423524.56 rows=1 width=64) (actual time=3899.894..3899.895 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=419547.77..423524.17 rows=76 width=60) (actual time=3844.859..3899.498 rows=757 loops=3)
                     Hash Cond: (k.id = mk.keyword_id)
                     ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.058..49.213 rows=44723 loops=3)
                           Heap Fetches: 134170
                     ->  Parallel Hash  (cost=419546.40..419546.40 rows=76 width=64) (actual time=3844.004..3844.004 rows=757 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                           ->  Parallel Hash Join  (cost=369174.02..419546.40 rows=76 width=64) (actual time=3260.872..3686.067 rows=757 loops=3)
                                 Hash Cond: (mk.movie_id = t.id)
                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.015..254.544 rows=1507977 loops=3)
                                 ->  Parallel Hash  (cost=369173.97..369173.97 rows=4 width=76) (actual time=3247.948..3247.949 rows=95 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=364262.66..369173.97 rows=4 width=76) (actual time=3226.792..3247.820 rows=95 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Hash Join  (cost=364261.57..369172.86 rows=4 width=80) (actual time=3226.672..3247.664 rows=95 loops=3)
                                                   Hash Cond: (cn.id = mc.company_id)
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.013..18.120 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
                                                   ->  Parallel Hash  (cost=364261.48..364261.48 rows=7 width=84) (actual time=3226.458..3226.458 rows=133 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=330523.34..364261.48 rows=7 width=84) (actual time=2955.061..3226.239 rows=133 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.048..166.937 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=330523.33..330523.33 rows=1 width=72) (actual time=2951.005..2951.005 rows=40 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=278615.36..330523.33 rows=1 width=72) (actual time=2619.704..2950.893 rows=40 loops=3)
                                                                           Hash Cond: (t.id = at.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.017..285.010 rows=583011 loops=3)
                                                                                 Filter: (production_year > 1990)
                                                                                 Rows Removed by Filter: 259760
                                                                           ->  Parallel Hash  (cost=278615.33..278615.33 rows=2 width=51) (actual time=2605.272..2605.272 rows=40 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=270164.12..278615.33 rows=2 width=51) (actual time=2547.586..2605.134 rows=40 loops=3)
                                                                                       Hash Cond: (at.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.037..39.845 rows=120491 loops=3)
                                                                                       ->  Parallel Hash  (cost=270164.10..270164.10 rows=2 width=47) (actual time=2546.725..2546.725 rows=594 loops=3)
                                                                                             Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                                             ->  Hash Join  (cost=2.43..270164.10 rows=2 width=47) (actual time=315.463..1221.852 rows=594 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=51) (actual time=315.327..1221.139 rows=594 loops=3)
                                                                                                         Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                                         Rows Removed by Filter: 4944646
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.063 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.052 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'release dates'::text)
                                                                                                               Rows Removed by Filter: 112
                                             ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.059..0.059 rows=4 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.030..0.032 rows=4 loops=3)
 Planning Time: 33.058 ms
 Execution Time: 3918.213 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=397267.91..397267.92 rows=1 width=64) (actual time=2547.786..2547.786 rows=1 loops=1)
   ->  Gather  (cost=397267.69..397267.90 rows=2 width=64) (actual time=2546.313..2554.226 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=396267.69..396267.70 rows=1 width=64) (actual time=2539.000..2539.000 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=345880.45..396258.32 rows=1873 width=38) (actual time=2100.849..2537.771 rows=3782 loops=3)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Parallel Hash Join  (cost=341484.68..391857.62 rows=1873 width=42) (actual time=2029.136..2463.992 rows=3782 loops=3)
                           Hash Cond: (mk.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.015..250.035 rows=1507977 loops=3)
                           ->  Parallel Hash  (cost=341483.66..341483.66 rows=81 width=54) (actual time=2021.327..2021.327 rows=292 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Hash Join  (cost=336383.26..341483.66 rows=81 width=54) (actual time=2000.787..2021.036 rows=292 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=336382.17..341482.14 rows=81 width=58) (actual time=2000.680..2020.829 rows=292 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.010..16.575 rows=28281 loops=3)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 50051
                                             ->  Parallel Hash  (cost=336380.22..336380.22 rows=156 width=62) (actual time=2000.554..2000.554 rows=700 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                   ->  Parallel Hash Join  (cost=302641.96..336380.22 rows=156 width=62) (actual time=1679.083..1951.208 rows=700 loops=3)
                                                         Hash Cond: (mc.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.053..157.981 rows=869710 loops=3)
                                                         ->  Parallel Hash  (cost=302641.58..302641.58 rows=30 width=50) (actual time=1676.921..1676.921 rows=195 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=250733.50..302641.58 rows=30 width=50) (actual time=1338.737..1676.584 rows=195 loops=3)
                                                                     Hash Cond: (t.id = at.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.021..275.211 rows=583011 loops=3)
                                                                           Filter: (production_year > 1990)
                                                                           Rows Removed by Filter: 259760
                                                                     ->  Parallel Hash  (cost=250732.96..250732.96 rows=43 width=29) (actual time=1336.282..1336.282 rows=197 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=239269.32..250732.96 rows=43 width=29) (actual time=1280.350..1335.881 rows=197 loops=3)
                                                                                 Hash Cond: (at.movie_id = mi.movie_id)
                                                                                 ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=25) (actual time=0.040..35.980 rows=120491 loops=3)
                                                                                 ->  Parallel Hash  (cost=239268.80..239268.80 rows=42 width=4) (actual time=1280.051..1280.051 rows=3560 loops=3)
                                                                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                                                                       ->  Hash Join  (cost=2.43..239268.80 rows=42 width=4) (actual time=293.686..1194.016 rows=3560 loops=3)
                                                                                             Hash Cond: (mi.info_type_id = it1.id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=4774 width=8) (actual time=53.183..1191.345 rows=3603 loops=3)
                                                                                                   Filter: ((note)::text ~~ '%internet%'::text)
                                                                                                   Rows Removed by Filter: 4941637
                                                                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.050 rows=1 loops=3)
                                                                                                         Filter: ((info)::text = 'release dates'::text)
                                                                                                         Rows Removed by Filter: 112
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.052..0.052 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.032..0.034 rows=4 loops=3)
                     ->  Parallel Hash  (cost=3696.98..3696.98 rows=55904 width=4) (actual time=69.068..69.068 rows=44723 loops=3)
                           Buckets: 262144  Batches: 1  Memory Usage: 7328kB
                           ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.057..45.667 rows=44723 loops=3)
                                 Heap Fetches: 134170
 Planning Time: 31.597 ms
 Execution Time: 2555.043 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=683598.14..683598.15 rows=1 width=64) (actual time=6060.619..6060.620 rows=1 loops=1)
   ->  Gather  (cost=683597.92..683598.13 rows=2 width=64) (actual time=6059.414..6067.033 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=682597.92..682597.93 rows=1 width=64) (actual time=6052.230..6052.231 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=666037.80..682597.77 rows=31 width=33) (actual time=5944.003..6052.093 rows=128 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.030..73.399 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=666037.56..666037.56 rows=19 width=25) (actual time=5938.081..5938.081 rows=108 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=661126.21..666037.56 rows=19 width=25) (actual time=5919.596..5937.941 rows=108 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..16.503 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=661125.74..661125.74 rows=37 width=29) (actual time=5918.430..5918.430 rows=363 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                       ->  Parallel Hash Join  (cost=627387.45..661125.74 rows=37 width=29) (actual time=5656.913..5918.208 rows=363 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.038..158.509 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=627387.27..627387.27 rows=14 width=37) (actual time=5645.900..5645.900 rows=391 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                   ->  Parallel Hash Join  (cost=547897.96..627387.27 rows=14 width=37) (actual time=5048.633..5633.549 rows=391 loops=3)
                                                         Hash Cond: (n.id = ci.person_id)
                                                         ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.062..384.741 rows=1389164 loops=3)
                                                         ->  Parallel Hash  (cost=547897.79..547897.79 rows=14 width=33) (actual time=5046.800..5046.800 rows=391 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                               ->  Parallel Hash Join  (cost=103031.36..547897.79 rows=14 width=33) (actual time=800.220..5046.051 rows=391 loops=3)
                                                                     Hash Cond: (ci.movie_id = mk.movie_id)
                                                                     ->  Parallel Hash Join  (cost=52153.14..495500.56 rows=405052 width=29) (actual time=272.433..4460.375 rows=388676 loops=3)
                                                                           Hash Cond: (ci.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.025..2173.736 rows=12081448 loops=3)
                                                                           ->  Parallel Hash  (cost=51799.95..51799.95 rows=28255 width=21) (actual time=271.237..271.237 rows=22748 loops=3)
                                                                                 Buckets: 131072  Batches: 1  Memory Usage: 4768kB
                                                                                 ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=28255 width=21) (actual time=0.022..251.407 rows=22748 loops=3)
                                                                                       Filter: ((episode_nr >= 50) AND (episode_nr < 100))
                                                                                       Rows Removed by Filter: 820022
                                                                     ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=509.893..509.893 rows=13947 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                           ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.319..461.080 rows=13947 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..252.747 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.172..21.172 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.003..21.154 rows=1 loops=3)
                                                                                             Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                             Rows Removed by Filter: 134169
 Planning Time: 15.500 ms
 Execution Time: 6067.742 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16b.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=697874.98..697874.99 rows=1 width=64) (actual time=10053.937..10053.938 rows=1 loops=1)
   ->  Gather  (cost=697874.76..697874.97 rows=2 width=64) (actual time=10047.337..10402.135 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=696874.76..696874.77 rows=1 width=64) (actual time=10040.071..10040.071 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=617374.97..696869.01 rows=1150 width=33) (actual time=8785.930..9694.523 rows=1236864 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.049..400.023 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=617360.59..617360.59 rows=1150 width=41) (actual time=7797.982..7797.982 rows=1236864 loops=3)
                           Buckets: 65536 (originally 4096)  Batches: 128 (originally 1)  Memory Usage: 4064kB
                           ->  Parallel Hash Join  (cost=600795.85..617360.59 rows=1150 width=41) (actual time=6770.796..7248.887 rows=1236864 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.030..80.455 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=21) (actual time=6554.264..6554.264 rows=944185 loops=3)
                                       Buckets: 65536 (originally 2048)  Batches: 64 (originally 1)  Memory Usage: 3456kB
                                       ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=21) (actual time=1385.754..5885.424 rows=944185 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.040..2314.353 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=29) (actual time=1385.572..1385.572 rows=22772 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6776kB
                                                   ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=29) (actual time=999.188..1337.327 rows=22772 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=33) (actual time=955.645..1276.550 rows=49517 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.033..167.776 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=25) (actual time=955.216..955.216 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=25) (actual time=526.854..885.698 rows=13947 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.021..217.658 rows=842771 loops=3)
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=526.641..526.641 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.342..469.089 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..261.415 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.215..21.215 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.059..21.203 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=42.607..42.607 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.031..25.978 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.666 ms
 Execution Time: 10404.229 ms
(47 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16c.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=698025.50..698025.51 rows=1 width=64) (actual time=7355.665..7355.665 rows=1 loops=1)
   ->  Gather  (cost=698025.28..698025.49 rows=2 width=64) (actual time=7348.797..7496.542 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=697025.28..697025.29 rows=1 width=64) (actual time=7341.327..7341.327 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=617532.05..697023.11 rows=434 width=33) (actual time=6912.946..7308.650 rows=106644 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.046..398.534 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=617526.63..617526.63 rows=434 width=41) (actual time=5989.724..5989.724 rows=106644 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 8 (originally 1)  Memory Usage: 4256kB
                           ->  Parallel Hash Join  (cost=600964.87..617526.63 rows=434 width=41) (actual time=5794.310..5907.891 rows=106644 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.026..79.102 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=600962.51..600962.51 rows=189 width=21) (actual time=5597.496..5597.496 rows=73870 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2368kB
                                       ->  Parallel Hash Join  (cost=140625.02..600962.51 rows=189 width=21) (actual time=1354.304..5414.486 rows=73870 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.077..2290.177 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=140624.89..140624.89 rows=10 width=29) (actual time=1353.472..1353.472 rows=2846 loops=3)
                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 920kB
                                                   ->  Parallel Hash Join  (cost=106886.67..140624.89 rows=10 width=29) (actual time=940.543..1232.327 rows=2846 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=101535.88..135274.04 rows=28 width=33) (actual time=898.871..1188.900 rows=3802 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.183..163.264 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=101535.82..101535.82 rows=5 width=25) (actual time=897.815..897.815 rows=2309 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 600kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..101535.82 rows=5 width=25) (actual time=530.438..843.083 rows=2309 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=397676 width=21) (actual time=0.018..265.895 rows=315635 loops=3)
                                                                                 Filter: (episode_nr < 100)
                                                                                 Rows Removed by Filter: 527135
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=530.207..530.207 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.974..466.734 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..259.069 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.790..20.791 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.034..20.780 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=40.774..40.774 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.033..25.520 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 15.069 ms
 Execution Time: 7497.338 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=700256.85..700256.86 rows=1 width=64) (actual time=7301.335..7301.336 rows=1 loops=1)
   ->  Gather  (cost=700256.63..700256.84 rows=2 width=64) (actual time=7297.428..7431.134 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=699256.63..699256.64 rows=1 width=64) (actual time=7290.358..7290.358 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=619764.46..699255.04 rows=318 width=33) (actual time=6884.187..7264.857 rows=83152 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.196..384.237 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=619760.48..619760.48 rows=318 width=41) (actual time=5980.886..5980.886 rows=83152 loops=3)
                           Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 3424kB
                           ->  Parallel Hash Join  (cost=603199.22..619760.48 rows=318 width=41) (actual time=5807.676..5912.785 rows=83152 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.025..76.059 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=603197.49..603197.49 rows=138 width=21) (actual time=5616.820..5616.820 rows=56424 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 1920kB
                                       ->  Parallel Hash Join  (cost=142860.13..603197.49 rows=138 width=21) (actual time=1400.893..5426.841 rows=56424 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.031..2184.700 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=142860.03..142860.03 rows=8 width=29) (actual time=1400.353..1400.353 rows=2255 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 664kB
                                                   ->  Parallel Hash Join  (cost=109121.82..142860.03 rows=8 width=29) (actual time=1090.797..1374.050 rows=2255 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=103771.04..137509.19 rows=20 width=33) (actual time=1051.157..1332.986 rows=2887 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.145..158.535 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=103770.99..103770.99 rows=4 width=25) (actual time=1050.394..1050.394 rows=1795 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..103770.99 rows=4 width=25) (actual time=523.626..812.531 rows=1795 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=291411 width=21) (actual time=0.024..253.041 rows=230852 loops=3)
                                                                                 Filter: ((episode_nr >= 5) AND (episode_nr < 100))
                                                                                 Rows Removed by Filter: 611919
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=523.435..523.435 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.510..463.166 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.038..255.425 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.352..21.353 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.045..21.339 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.535..38.535 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.026..24.389 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.819 ms
 Execution Time: 7433.474 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17a.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=680693.62..680693.63 rows=1 width=64) (actual time=6726.251..6726.251 rows=1 loops=1)
   ->  Gather  (cost=680693.40..680693.61 rows=2 width=32) (actual time=6720.967..6790.912 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=679693.40..679693.41 rows=1 width=32) (actual time=6714.082..6714.082 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=600795.85..679693.30 rows=40 width=15) (actual time=6449.384..6695.785 rows=86096 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=140320 width=19) (actual time=7.777..427.556 rows=114466 loops=3)
                           Filter: ((name)::text ~~ 'B%'::text)
                           Rows Removed by Filter: 1274697
                     ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=4) (actual time=5961.426..5961.426 rows=944185 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4192kB
                           ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=4) (actual time=1375.520..5526.325 rows=944185 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=1.268..2143.993 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=12) (actual time=1374.161..1374.161 rows=22772 loops=3)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5304kB
                                       ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=12) (actual time=1010.392..1329.056 rows=22772 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=16) (actual time=970.588..1273.959 rows=49517 loops=3)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.096..159.021 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=970.191..970.191 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=525.832..875.567 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.030..212.303 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=525.634..525.634 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.075..460.493 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..252.330 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.939..20.940 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.060..20.915 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.829..38.829 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.026..24.669 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 9.259 ms
 Execution Time: 6791.560 ms
(44 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17b.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=64) (actual time=8176.449..8176.449 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=8174.087..8184.073 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=8166.822..8166.823 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=7803.797..8162.123 rows=17435 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.032..220.014 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=7801.634..7801.634 rows=17435 loops=3)
                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4312kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=7745.338..7784.085 rows=17435 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.022..18.007 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=7745.233..7745.233 rows=17435 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4472kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=7413.267..7714.343 rows=17435 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.038..169.940 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=7412.344..7412.344 rows=2214 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=2320.367..4807.705 rows=2214 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=1804.738..4273.530 rows=89570 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.033..2207.722 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=459.257..459.257 rows=12058 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3032kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=184.414..445.156 rows=12058 loops=3)
                                                                           Filter: ((name)::text ~~ 'Z%'::text)
                                                                           Rows Removed by Filter: 1377106
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=515.496..515.496 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.668..465.569 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..256.776 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.514..21.514 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.016..21.494 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.139 ms
 Execution Time: 8184.700 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17c.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=64) (actual time=5540.334..5540.334 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=5539.740..5547.084 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=5533.011..5533.011 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=5218.307..5532.769 rows=639 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.034..214.079 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=5203.258..5203.258 rows=639 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=5143.964..5170.003 rows=639 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.020..14.703 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=5143.819..5143.819 rows=639 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=4858.817..5124.682 rows=639 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.034..158.760 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=4855.059..4855.059 rows=83 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=2389.705..4854.859 rows=83 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=1881.595..4345.330 rows=4167 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.027..2177.850 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=611.981..611.981 rows=888 loops=3)
                                                                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=174.525..419.954 rows=888 loops=3)
                                                                           Filter: ((name)::text ~~ 'X%'::text)
                                                                           Rows Removed by Filter: 1388276
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=507.939..507.939 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.290..459.588 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..251.454 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.064..21.064 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.999..21.045 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.302 ms
 Execution Time: 5547.738 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17d.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=32) (actual time=6856.260..6856.260 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=6855.524..6864.183 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=6848.415..6848.415 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=6509.808..6847.301 rows=3846 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.041..221.562 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=6504.136..6504.136 rows=3846 loops=3)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=6466.254..6497.514 rows=3846 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.021..17.929 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=6466.141..6466.141 rows=3846 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1048kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=6133.545..6421.972 rows=3846 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.029..165.721 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=6130.931..6130.931 rows=657 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=1284.512..5129.561 rows=657 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=740.206..4613.307 rows=16097 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.341..2262.662 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=736.801..736.802 rows=1739 loops=3)
                                                                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 344kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=4.354..500.346 rows=1739 loops=3)
                                                                           Filter: ((name)::text ~~ '%Bert%'::text)
                                                                           Rows Removed by Filter: 1387425
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=510.265..510.265 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.755..460.412 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..252.171 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.619..21.619 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.018..21.600 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.367 ms
 Execution Time: 6864.813 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17e.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=694312.07..694312.08 rows=1 width=32) (actual time=7805.087..7805.088 rows=1 loops=1)
   ->  Gather  (cost=694311.86..694312.07 rows=2 width=32) (actual time=7799.588..7958.061 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=693311.86..693311.87 rows=1 width=32) (actual time=7792.921..7792.922 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=600795.85..693310.60 rows=501 width=15) (actual time=6977.824..7630.907 rows=944185 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.054..376.935 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=4) (actual time=6053.915..6053.915 rows=944185 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4192kB
                           ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=4) (actual time=1407.646..5618.433 rows=944185 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.028..2207.467 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=12) (actual time=1407.527..1407.527 rows=22772 loops=3)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5304kB
                                       ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=12) (actual time=1032.447..1347.615 rows=22772 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=16) (actual time=993.136..1293.447 rows=49517 loops=3)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.030..158.019 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=992.794..992.795 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=524.452..876.160 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.546..212.531 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=523.751..523.751 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.319..463.478 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.044..254.022 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.145..21.145 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.012..21.123 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.356..38.356 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.025..24.465 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 9.180 ms
 Execution Time: 7959.853 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17f.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=682238.58..682238.59 rows=1 width=32) (actual time=7186.260..7186.260 rows=1 loops=1)
   ->  Gather  (cost=682238.36..682238.57 rows=2 width=32) (actual time=7179.060..7271.639 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=681238.36..681238.37 rows=1 width=32) (actual time=7171.746..7171.746 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=647498.67..681237.95 rows=167 width=15) (actual time=6575.475..7105.890 rows=371040 loops=3)
                     Hash Cond: (mc.company_id = cn.id)
                     ->  Parallel Hash Join  (cost=641393.41..675132.25 rows=167 width=19) (actual time=6503.522..6934.587 rows=371040 loops=3)
                           Hash Cond: (mc.movie_id = ci.movie_id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.046..168.928 rows=869710 loops=3)
                           ->  Parallel Hash  (cost=641392.63..641392.63 rows=63 width=27) (actual time=6503.032..6503.032 rows=49831 loops=3)
                                 Buckets: 262144 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 13432kB
                                 ->  Parallel Hash Join  (cost=561705.80..641392.63 rows=63 width=27) (actual time=6286.720..6440.678 rows=49831 loops=3)
                                       Hash Cond: (n.id = ci.person_id)
                                       ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=210479 width=19) (actual time=0.058..520.828 rows=178905 loops=3)
                                             Filter: ((name)::text ~~ '%B%'::text)
                                             Rows Removed by Filter: 1210258
                                       ->  Parallel Hash  (cost=561699.31..561699.31 rows=519 width=16) (actual time=5676.348..5676.348 rows=346131 loops=3)
                                             Buckets: 65536 (originally 2048)  Batches: 16 (originally 1)  Memory Usage: 3680kB
                                             ->  Parallel Hash Join  (cost=101361.58..561699.31 rows=519 width=16) (actual time=1011.190..5408.652 rows=346131 loops=3)
                                                   Hash Cond: (ci.movie_id = t.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.028..2354.840 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=1011.050..1011.051 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=532.011..896.461 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=1.266..225.613 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=530.543..530.543 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=22.120..471.436 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.023..261.143 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.986..21.986 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.015..21.958 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                     ->  Parallel Hash  (cost=4377.34..4377.34 rows=138234 width=4) (actual time=69.170..69.170 rows=78332 loops=3)
                           Buckets: 262144  Batches: 1  Memory Usage: 11296kB
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.024..23.524 rows=78332 loops=3)
 Planning Time: 9.240 ms
 Execution Time: 7272.250 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18a.sql_explained.sql
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=833190.17..833190.18 rows=1 width=96) (actual time=5905.051..5905.051 rows=1 loops=1)
   ->  Gather  (cost=833189.95..833190.16 rows=2 width=96) (actual time=5904.729..5911.825 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=832189.95..832189.96 rows=1 width=96) (actual time=5897.995..5897.995 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=781706.81..832189.94 rows=1 width=65) (actual time=5625.163..5897.725 rows=137 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.037..219.229 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=781706.80..781706.80 rows=1 width=60) (actual time=5568.619..5568.619 rows=137 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=540867.00..781706.80 rows=1 width=60) (actual time=4858.330..5568.334 rows=137 loops=3)
                                 Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=1004.819..1738.252 rows=40621 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.036..1112.479 rows=4945240 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=3)
                                                   Filter: ((info)::text = 'budget'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=540864.56..540864.56 rows=1 width=13) (actual time=3824.478..3824.478 rows=1145 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                       ->  Parallel Hash Join  (cost=525594.29..540864.56 rows=1 width=13) (actual time=3419.450..3596.537 rows=1145 loops=3)
                                             Hash Cond: (mi_idx.movie_id = ci.movie_id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.162..157.467 rows=153308 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.032..75.271 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.047..0.049 rows=1 loops=3)
                                                               Filter: ((info)::text = 'votes'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=525591.38..525591.38 rows=39 width=4) (actual time=3419.158..3419.158 rows=2240 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                   ->  Parallel Hash Join  (cost=81660.72..525591.38 rows=39 width=4) (actual time=1908.647..3300.478 rows=2240 loops=3)
                                                         Hash Cond: (ci.person_id = n.id)
                                                         ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=941346 width=8) (actual time=311.994..2624.334 rows=793090 loops=3)
                                                               Filter: ((note)::text = ANY ('{(producer),"(executive producer)"}'::text[]))
                                                               Rows Removed by Filter: 11288358
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=72 width=4) (actual time=587.965..587.965 rows=3021 loops=3)
                                                               Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=72 width=4) (actual time=0.172..510.666 rows=3021 loops=3)
                                                                     Filter: (((name)::text ~~ '%Tim%'::text) AND ((gender)::text = 'm'::text))
                                                                     Rows Removed by Filter: 1386143
 Planning Time: 9.587 ms
 Execution Time: 5912.520 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18b.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=886874.06..886874.07 rows=1 width=96) (actual time=5333.376..5333.376 rows=1 loops=1)
   ->  Gather  (cost=886873.83..886874.04 rows=2 width=96) (actual time=5333.031..5339.821 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=885873.83..885873.84 rows=1 width=96) (actual time=5326.010..5326.010 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=832828.60..885873.82 rows=1 width=65) (actual time=5248.273..5325.978 rows=4 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=332069 width=21) (actual time=0.045..257.762 rows=261496 loops=3)
                           Filter: ((production_year >= 2008) AND (production_year <= 2014))
                           Rows Removed by Filter: 581275
                     ->  Parallel Hash  (cost=832828.59..832828.59 rows=1 width=60) (actual time=5039.137..5039.137 rows=5 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=754551.36..832828.59 rows=1 width=60) (actual time=4767.691..5039.021 rows=5 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=255610 width=4) (actual time=185.401..438.434 rows=320518 loops=3)
                                       Filter: ((gender IS NOT NULL) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1068645
                                 ->  Parallel Hash  (cost=754551.35..754551.35 rows=1 width=64) (actual time=4566.168..4566.168 rows=137 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=254530.67..754551.35 rows=1 width=64) (actual time=3458.023..4565.910 rows=137 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=163.021..2870.927 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=254530.66..254530.66 rows=1 width=56) (actual time=1645.438..1645.438 rows=244 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=15184.50..254530.66 rows=1 width=56) (actual time=1481.149..1644.777 rows=244 loops=3)
                                                         Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                         ->  Hash Join  (cost=2.43..239347.45 rows=298 width=47) (actual time=1324.890..1483.537 rows=24086 loops=3)
                                                               Hash Cond: (mi.info_type_id = it1.id)
                                                               ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=33653 width=51) (actual time=929.117..1475.266 rows=24349 loops=3)
                                                                     Filter: ((note IS NULL) AND ((info)::text = ANY ('{Horror,Thriller}'::text[])))
                                                                     Rows Removed by Filter: 4920891
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.015..0.027 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'genres'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=15179.85..15179.85 rows=178 width=9) (actual time=155.819..155.819 rows=5283 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 952kB
                                                               ->  Hash Join  (cost=2.43..15179.85 rows=178 width=9) (actual time=0.251..133.298 rows=5283 loops=3)
                                                                     Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.064..129.073 rows=17883 loops=3)
                                                                           Filter: ((info)::text > '8.0'::text)
                                                                           Rows Removed by Filter: 442129
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.074..0.074 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.048 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'rating'::text)
                                                                                 Rows Removed by Filter: 112
 Planning Time: 9.180 ms
 Execution Time: 5340.532 ms
(52 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18c.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=917260.31..917260.32 rows=1 width=96) (actual time=6302.592..6302.593 rows=1 loops=1)
   ->  Gather  (cost=917260.08..917260.29 rows=2 width=96) (actual time=6298.776..6318.730 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=916260.08..916260.09 rows=1 width=96) (actual time=6292.026..6292.026 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=865776.83..916260.00 rows=11 width=65) (actual time=5929.951..6285.226 rows=9358 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.040..218.849 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=865776.69..865776.69 rows=11 width=60) (actual time=5927.546..5927.546 rows=9358 loops=3)
                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2200kB
                           ->  Parallel Hash Join  (cost=785749.31..865776.69 rows=11 width=60) (actual time=5351.029..5882.547 rows=9358 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=4) (actual time=0.055..448.986 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=785748.97..785748.97 rows=27 width=64) (actual time=5350.407..5350.407 rows=18052 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4472kB
                                       ->  Parallel Hash Join  (cost=285728.20..785748.97 rows=27 width=64) (actual time=3575.803..5306.382 rows=18052 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=213.503..2949.608 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=285727.93..285727.93 rows=21 width=56) (actual time=2269.568..2269.568 rows=34172 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 7704kB
                                                   ->  Parallel Hash Join  (cost=15319.64..285727.93 rows=21 width=56) (actual time=2186.145..2236.761 rows=34172 loops=3)
                                                         Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                         ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1675.621..1895.276 rows=62198 loops=3)
                                                               Hash Cond: (mi.info_type_id = it1.id)
                                                               ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1056.358..1877.917 rows=62990 loops=3)
                                                                     Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                     Rows Removed by Filter: 4882250
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.031..0.031 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.028 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'genres'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=259.481..259.481 rows=153308 loops=3)
                                                               Buckets: 65536 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 2880kB
                                                               ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.162..163.786 rows=153308 loops=3)
                                                                     Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.043..78.036 rows=460012 loops=3)
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.048 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'votes'::text)
                                                                                 Rows Removed by Filter: 112
 Planning Time: 8.993 ms
 Execution Time: 6319.502 ms
(48 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19a.sql_explained.sql
SET
SET
                                                                                                            QUERY PLAN                                                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=982370.28..982370.29 rows=1 width=64) (actual time=6321.071..6321.072 rows=1 loops=1)
   ->  Gather  (cost=982370.06..982370.27 rows=2 width=64) (actual time=6320.770..6328.544 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=981370.06..981370.07 rows=1 width=64) (actual time=6313.279..6313.279 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=928667.96..981370.06 rows=1 width=32) (actual time=6168.335..6313.210 rows=61 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=240570 width=21) (actual time=0.061..254.122 rows=191519 loops=3)
                           Filter: ((production_year >= 2005) AND (production_year <= 2009))
                           Rows Removed by Filter: 651252
                     ->  Parallel Hash  (cost=928667.95..928667.95 rows=1 width=27) (actual time=6034.854..6034.854 rows=104 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=923756.66..928667.95 rows=1 width=27) (actual time=6008.773..6034.736 rows=104 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.025..23.116 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=923756.65..923756.65 rows=1 width=31) (actual time=6008.467..6008.467 rows=107 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=888167.49..923756.65 rows=1 width=31) (actual time=5746.793..6008.361 rows=107 loops=3)
                                             Hash Cond: (mc.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=131225 width=8) (actual time=0.035..291.730 rows=196998 loops=3)
                                                   Filter: ((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                                   Rows Removed by Filter: 672712
                                             ->  Parallel Hash  (cost=888167.48..888167.48 rows=1 width=23) (actual time=5696.322..5696.322 rows=68 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=833727.94..888167.48 rows=1 width=23) (actual time=5323.110..5696.226 rows=68 loops=3)
                                                         Hash Cond: (chn.id = ci.person_role_id)
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.037..245.059 rows=1046780 loops=3)
                                                         ->  Parallel Hash  (cost=833727.93..833727.93 rows=1 width=27) (actual time=5320.990..5320.990 rows=75 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=578391.87..833727.93 rows=1 width=27) (actual time=4026.404..5320.877 rows=75 loops=3)
                                                                     Hash Cond: (mi.movie_id = ci.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255330.90 rows=2019 width=4) (actual time=419.069..1749.494 rows=150346 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=179.119..1712.126 rows=150368 loops=3)
                                                                                 Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                 Rows Removed by Filter: 4794872
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.056 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.044 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=578389.42..578389.42 rows=2 width=23) (actual time=3553.830..3553.830 rows=142 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Hash Join  (cost=97799.03..578389.42 rows=2 width=23) (actual time=1605.265..3553.682 rows=142 loops=3)
                                                                                 Hash Cond: (ci.role_id = rt.id)
                                                                                 ->  Parallel Hash Join  (cost=97797.87..578388.18 rows=19 width=27) (actual time=1605.142..3553.512 rows=142 loops=3)
                                                                                       Hash Cond: (ci.person_id = n.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.065..2827.330 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=23) (actual time=684.219..684.219 rows=519 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                                             ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=23) (actual time=564.955..683.725 rows=519 loops=3)
                                                                                                   Hash Cond: (an.person_id = n.id)
                                                                                                   ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.031..73.580 rows=300448 loops=3)
                                                                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=563.663..563.663 rows=2256 loops=3)
                                                                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=215.601..511.916 rows=2256 loops=3)
                                                                                                               Filter: (((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))
                                                                                                               Rows Removed by Filter: 1386908
                                                                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.070..0.070 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.039..0.042 rows=1 loops=3)
                                                                                             Filter: ((role)::text = 'actress'::text)
                                                                                             Rows Removed by Filter: 11
 Planning Time: 52.525 ms
 Execution Time: 6329.448 ms
(69 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=947597.06..947597.07 rows=1 width=64) (actual time=8364.020..8364.020 rows=1 loops=1)
   ->  Gather  (cost=947596.94..947597.05 rows=1 width=64) (actual time=8363.728..8369.523 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=946596.94..946596.95 rows=1 width=64) (actual time=8357.620..8357.621 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=941685.65..946596.94 rows=1 width=32) (actual time=8335.766..8357.595 rows=8 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..23.083 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=941685.64..941685.64 rows=1 width=36) (actual time=8329.963..8329.963 rows=8 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=903714.47..941685.64 rows=1 width=36) (actual time=8212.269..8329.902 rows=8 loops=2)
                                 Hash Cond: (mc.movie_id = t.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=41669 width=8) (actual time=0.025..405.053 rows=99260 loops=2)
                                       Filter: (((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                       Rows Removed by Filter: 1205305
                                 ->  Parallel Hash  (cost=903714.46..903714.46 rows=1 width=44) (actual time=7913.363..7913.363 rows=2 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=849274.92..903714.46 rows=1 width=44) (actual time=7824.413..7913.320 rows=2 loops=2)
                                             Hash Cond: (chn.id = ci.person_role_id)
                                             ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.030..361.218 rows=1570170 loops=2)
                                             ->  Parallel Hash  (cost=849274.91..849274.91 rows=1 width=48) (actual time=7363.855..7363.855 rows=2 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                   ->  Parallel Hash Join  (cost=833137.42..849274.91 rows=1 width=48) (actual time=7306.085..7363.809 rows=2 loops=2)
                                                         Hash Cond: (n.id = ci.person_id)
                                                         ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=23) (actual time=799.334..973.093 rows=648 loops=2)
                                                               Hash Cond: (an.person_id = n.id)
                                                               ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.114..109.593 rows=450672 loops=2)
                                                               ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=797.188..797.188 rows=2704 loops=2)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=327.620..777.562 rows=2704 loops=2)
                                                                           Filter: (((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))
                                                                           Rows Removed by Filter: 2081041
                                                         ->  Parallel Hash  (cost=751477.09..751477.09 rows=1 width=37) (actual time=6390.544..6390.544 rows=8 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=496679.24..751477.09 rows=1 width=37) (actual time=4866.915..6390.457 rows=8 loops=2)
                                                                     Hash Cond: (mi.movie_id = t.id)
                                                                     ->  Hash Join  (cost=2.43..254799.18 rows=291 width=4) (actual time=620.563..2521.329 rows=34739 loops=2)
                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=32862 width=8) (actual time=620.442..2509.049 rows=34739 loops=2)
                                                                                 Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%2007%'::text) OR ((info)::text ~~ 'USA:%2008%'::text)))
                                                                                 Rows Removed by Filter: 7383121
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.030..0.042 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=496676.80..496676.80 rows=1 width=33) (actual time=3864.241..3864.241 rows=8 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Hash Join  (cost=54434.90..496676.80 rows=1 width=33) (actual time=1652.079..3864.150 rows=8 loops=2)
                                                                                 Hash Cond: (ci.role_id = rt.id)
                                                                                 ->  Parallel Hash Join  (cost=54433.73..496675.63 rows=3 width=37) (actual time=492.929..3864.017 rows=36 loops=2)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=298009 width=16) (actual time=0.081..3454.217 rows=356914 loops=2)
                                                                                             Filter: ((note)::text = '(voice)'::text)
                                                                                             Rows Removed by Filter: 17765258
                                                                                       ->  Parallel Hash  (cost=54433.61..54433.61 rows=10 width=21) (actual time=361.374..361.374 rows=4 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=10 width=21) (actual time=51.540..361.311 rows=4 loops=2)
                                                                                                   Filter: ((production_year >= 2007) AND (production_year <= 2008) AND ((title)::text ~~ '%Kung%Fu%Panda%'::text))
                                                                                                   Rows Removed by Filter: 1264152
                                                                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=2)
                                                                                             Filter: ((role)::text = 'actress'::text)
                                                                                             Rows Removed by Filter: 11
 Planning Time: 52.262 ms
 Execution Time: 8370.518 ms
(69 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19c.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=979421.66..979421.67 rows=1 width=64) (actual time=8325.502..8325.502 rows=1 loops=1)
   ->  Gather  (cost=979421.44..979421.65 rows=2 width=64) (actual time=8324.713..8332.255 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=978421.44..978421.45 rows=1 width=64) (actual time=8317.178..8317.179 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=961861.47..978421.43 rows=2 width=32) (actual time=8201.380..8316.752 rows=1192 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.053..74.242 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=961861.46..961861.46 rows=1 width=40) (actual time=8198.546..8198.546 rows=877 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                           ->  Parallel Hash Join  (cost=956950.17..961861.46 rows=1 width=40) (actual time=8174.844..8195.877 rows=877 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..17.146 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=956950.15..956950.15 rows=2 width=44) (actual time=8174.678..8174.678 rows=2862 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                       ->  Parallel Hash Join  (cost=923212.00..956950.15 rows=2 width=44) (actual time=7863.043..8145.052 rows=2862 loops=3)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.029..157.812 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=923211.99..923211.99 rows=1 width=52) (actual time=7861.418..7861.418 rows=710 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                   ->  Parallel Hash Join  (cost=868772.46..923211.99 rows=1 width=52) (actual time=7419.096..7808.555 rows=710 loops=3)
                                                         Hash Cond: (chn.id = ci.person_role_id)
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.217..240.243 rows=1046780 loops=3)
                                                         ->  Parallel Hash  (cost=868772.44..868772.44 rows=1 width=56) (actual time=7417.783..7417.783 rows=755 loops=3)
                                                               Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                               ->  Parallel Hash Join  (cost=817446.81..868772.44 rows=1 width=56) (actual time=7084.688..7409.497 rows=755 loops=3)
                                                                     Hash Cond: (t.id = mi.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.048..269.337 rows=460484 loops=3)
                                                                           Filter: (production_year > 2000)
                                                                           Rows Removed by Filter: 382286
                                                                     ->  Parallel Hash  (cost=817446.79..817446.79 rows=2 width=35) (actual time=7084.054..7084.054 rows=840 loops=3)
                                                                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                                           ->  Parallel Hash Join  (cost=562110.73..817446.79 rows=2 width=35) (actual time=3939.739..5190.281 rows=840 loops=3)
                                                                                 Hash Cond: (mi.movie_id = ci.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..255330.90 rows=2019 width=4) (actual time=411.846..1646.678 rows=150346 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=172.496..1610.112 rows=150368 loops=3)
                                                                                             Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                             Rows Removed by Filter: 4794872
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.048 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'release dates'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=562103.89..562103.89 rows=353 width=31) (actual time=3522.646..3522.646 rows=2184 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 568kB
                                                                                       ->  Hash Join  (cost=81911.39..562103.89 rows=353 width=31) (actual time=1428.239..3362.197 rows=2184 loops=3)
                                                                                             Hash Cond: (ci.role_id = rt.id)
                                                                                             ->  Parallel Hash Join  (cost=81910.23..562087.69 rows=4234 width=35) (actual time=1428.123..3361.304 rows=2185 loops=3)
                                                                                                   Hash Cond: (ci.person_id = n.id)
                                                                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.073..2786.552 rows=289159 loops=3)
                                                                                                         Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                                         Rows Removed by Filter: 11792289
                                                                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=529.165..529.165 rows=16670 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=216.180..516.465 rows=16670 loops=3)
                                                                                                               Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                                               Rows Removed by Filter: 1372493
                                                                                             ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.035..0.037 rows=1 loops=3)
                                                                                                         Filter: ((role)::text = 'actress'::text)
                                                                                                         Rows Removed by Filter: 11
 Planning Time: 51.979 ms
 Execution Time: 8333.238 ms
(67 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=992869.82..992869.83 rows=1 width=64) (actual time=9533.299..9533.299 rows=1 loops=1)
   ->  Gather  (cost=992869.60..992869.81 rows=2 width=64) (actual time=9477.652..9796.973 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=991869.60..991869.61 rows=1 width=64) (actual time=9484.376..9484.376 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=975303.84..991864.20 rows=1080 width=32) (actual time=9110.381..9331.017 rows=586882 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.035..76.585 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=975297.96..975297.96 rows=470 width=40) (actual time=8912.156..8912.156 rows=262348 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4384kB
                           ->  Parallel Hash Join  (cost=941555.37..975297.96 rows=470 width=40) (actual time=8166.568..8689.023 rows=262348 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Hash Join  (cost=936204.59..969943.78 rows=1294 width=44) (actual time=8125.749..8504.014 rows=1076352 loops=3)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.041..162.726 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=936201.50..936201.50 rows=247 width=52) (actual time=7724.986..7724.986 rows=113945 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 2624kB
                                             ->  Parallel Hash Join  (cost=884874.85..936201.50 rows=247 width=52) (actual time=7430.004..7618.843 rows=113945 loops=3)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.045..266.732 rows=460484 loops=3)
                                                         Filter: (production_year > 2000)
                                                         Rows Removed by Filter: 382286
                                                   ->  Parallel Hash  (cost=884869.20..884869.20 rows=452 width=31) (actual time=6985.103..6985.103 rows=166016 loops=3)
                                                         Buckets: 65536 (originally 2048)  Batches: 16 (originally 1)  Memory Usage: 2912kB
                                                         ->  Parallel Hash Join  (cost=636506.19..884869.20 rows=452 width=31) (actual time=6652.238..6844.758 rows=166016 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Hash Join  (cost=565505.50..808738.07 rows=934 width=35) (actual time=5887.171..6010.249 rows=182242 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Hash Join  (cost=480903.52..721760.35 rows=4089 width=16) (actual time=5090.535..5273.051 rows=182372 loops=3)
                                                                           Hash Cond: (mi.movie_id = ci.movie_id)
                                                                           ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=449.989..1868.616 rows=1012240 loops=3)
                                                                                 Hash Cond: (mi.info_type_id = it.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.266..1107.085 rows=4945240 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.046 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'release dates'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=480518.83..480518.83 rows=30581 width=12) (actual time=2952.002..2952.002 rows=92055 loops=3)
                                                                                 Buckets: 65536 (originally 131072)  Batches: 8 (originally 1)  Memory Usage: 2208kB
                                                                                 ->  Hash Join  (cost=1.16..480518.83 rows=30581 width=12) (actual time=905.040..2876.478 rows=92055 loops=3)
                                                                                       Hash Cond: (ci.role_id = rt.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.057..2813.485 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.030..0.030 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=3)
                                                                                                   Filter: ((role)::text = 'actress'::text)
                                                                                                   Rows Removed by Filter: 11
                                                                     ->  Parallel Hash  (cost=77318.68..77318.68 rows=396664 width=19) (actual time=545.940..545.940 rows=320518 loops=3)
                                                                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                                                                           ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=396664 width=19) (actual time=179.409..436.098 rows=320518 loops=3)
                                                                                 Filter: ((gender)::text = 'f'::text)
                                                                                 Rows Removed by Filter: 1068645
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=4) (actual time=561.510..561.511 rows=1046780 loops=3)
                                                                     Buckets: 131072  Batches: 64  Memory Usage: 3008kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.077..281.774 rows=1046780 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.590..39.590 rows=28281 loops=3)
                                       Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.027..24.806 rows=28281 loops=3)
                                             Filter: ((country_code)::text = '[us]'::text)
                                             Rows Removed by Filter: 50051
 Planning Time: 51.565 ms
 Execution Time: 9797.961 ms
(65 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=104638.31..104638.32 rows=1 width=68) (actual time=848.266..848.266 rows=1 loops=1)
   ->  Gather  (cost=104638.09..104638.30 rows=2 width=68) (actual time=847.784..853.493 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=103638.09..103638.10 rows=1 width=68) (actual time=841.240..841.240 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=53154.41..103637.73 rows=47 width=45) (actual time=729.444..841.134 rows=47 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.034..221.901 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=53153.83..53153.83 rows=47 width=32) (actual time=513.326..513.326 rows=47 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=37883.38..53153.83 rows=47 width=32) (actual time=512.860..513.026 rows=47 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mc.movie_id)
                                 ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=131.624..131.660 rows=83 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.028..75.840 rows=460012 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.043 rows=1 loops=3)
                                                   Filter: ((info)::text = 'top 250 rank'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=37857.14..37857.14 rows=1905 width=28) (actual time=381.135..381.135 rows=9552 loops=3)
                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2112kB
                                       ->  Hash Join  (cost=1.06..37857.14 rows=1905 width=28) (actual time=275.541..369.543 rows=9552 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=7618 width=32) (actual time=52.690..365.781 rows=9630 loops=3)
                                                   Filter: (((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND (((note)::text ~~ '%(co-production)%'::text) OR ((note)::text ~~ '%(presents)%'::text)))
                                                   Rows Removed by Filter: 860080
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'production companies'::text)
                                                         Rows Removed by Filter: 3
 Planning Time: 4.111 ms
 Execution Time: 854.010 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1b.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=103766.13..103766.14 rows=1 width=68) (actual time=742.714..742.714 rows=1 loops=1)
   ->  Gather  (cost=103765.91..103766.12 rows=2 width=68) (actual time=742.535..748.426 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=102765.91..102765.92 rows=1 width=68) (actual time=736.051..736.051 rows=1 loops=3)
               ->  Hash Join  (cost=68268.30..102758.62 rows=972 width=45) (actual time=721.301..736.036 rows=1 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=68267.24..102736.53 rows=3890 width=49) (actual time=606.851..735.720 rows=22 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=556503 width=32) (actual time=0.035..268.908 rows=445696 loops=3)
                                 Filter: ((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)
                                 Rows Removed by Filter: 424014
                           ->  Parallel Hash  (cost=68249.11..68249.11 rows=1450 width=29) (actual time=422.093..422.093 rows=1 loops=3)
                                 Buckets: 4096  Batches: 1  Memory Usage: 64kB
                                 ->  Parallel Hash Join  (cost=15317.21..68249.11 rows=1450 width=29) (actual time=393.482..421.986 rows=1 loops=3)
                                       Hash Cond: (t.id = mi_idx.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=300243 width=25) (actual time=0.038..259.838 rows=238753 loops=3)
                                             Filter: ((production_year >= 2005) AND (production_year <= 2010))
                                             Rows Removed by Filter: 604018
                                       ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=4) (actual time=133.941..133.941 rows=3 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 160kB
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=133.877..133.879 rows=3 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.048..77.116 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=3)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.038..0.040 rows=1 loops=3)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 3.889 ms
 Execution Time: 748.961 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=101209.01..101209.02 rows=1 width=68) (actual time=714.599..714.599 rows=1 loops=1)
   ->  Gather  (cost=101208.79..101209.00 rows=2 width=68) (actual time=714.233..720.397 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=100208.79..100208.80 rows=1 width=68) (actual time=707.834..707.835 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=50420.55..100208.75 rows=5 width=45) (actual time=688.905..707.813 rows=1 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=25) (actual time=0.037..242.395 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=50420.11..50420.11 rows=35 width=32) (actual time=447.961..447.961 rows=8 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=35149.70..50420.11 rows=35 width=32) (actual time=447.624..447.713 rows=8 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mc.movie_id)
                                 ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=133.557..133.591 rows=83 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.033..77.760 rows=460012 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.063..0.063 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.044 rows=1 loops=3)
                                                   Filter: ((info)::text = 'top 250 rank'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=35129.26..35129.26 rows=1441 width=28) (actual time=313.948..313.948 rows=5937 loops=3)
                                       Buckets: 32768 (originally 4096)  Batches: 1 (originally 1)  Memory Usage: 1536kB
                                       ->  Hash Join  (cost=1.06..35129.26 rows=1441 width=28) (actual time=213.870..301.413 rows=5937 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=5762 width=32) (actual time=137.823..298.883 rows=5939 loops=3)
                                                   Filter: (((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND ((note)::text ~~ '%(co-production)%'::text))
                                                   Rows Removed by Filter: 863771
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'production companies'::text)
                                                         Rows Removed by Filter: 3
 Planning Time: 3.877 ms
 Execution Time: 720.901 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1d.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=102217.02..102217.03 rows=1 width=68) (actual time=766.854..766.854 rows=1 loops=1)
   ->  Gather  (cost=102216.80..102217.01 rows=2 width=68) (actual time=766.630..772.859 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=101216.80..101216.81 rows=1 width=68) (actual time=760.239..760.239 rows=1 loops=3)
               ->  Hash Join  (cost=66690.26..101202.81 rows=1865 width=45) (actual time=741.651..760.217 rows=1 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=66689.20..101161.42 rows=7460 width=49) (actual time=630.067..759.907 rows=26 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=556503 width=32) (actual time=0.037..266.489 rows=445696 loops=3)
                                 Filter: ((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)
                                 Rows Removed by Filter: 424014
                           ->  Parallel Hash  (cost=66654.42..66654.42 rows=2782 width=29) (actual time=448.405..448.405 rows=2 loops=3)
                                 Buckets: 8192  Batches: 1  Memory Usage: 160kB
                                 ->  Parallel Hash Join  (cost=15317.21..66654.42 rows=2782 width=29) (actual time=354.385..448.274 rows=2 loops=3)
                                       Hash Cond: (t.id = mi_idx.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.041..267.403 rows=460484 loops=3)
                                             Filter: (production_year > 2000)
                                             Rows Removed by Filter: 382286
                                       ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=4) (actual time=132.118..132.118 rows=3 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 160kB
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=132.015..132.017 rows=3 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.040..75.766 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.065 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.047 rows=1 loops=3)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=3)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 3.838 ms
 Execution Time: 773.356 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20a.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=690921.15..690921.16 rows=1 width=32) (actual time=5773.671..5773.672 rows=1 loops=1)
   ->  Hash Join  (cost=611431.78..690921.14 rows=1 width=17) (actual time=5772.969..5773.645 rows=33 loops=1)
         Hash Cond: (t.kind_id = kt.id)
         ->  Gather  (cost=611430.68..690920.04 rows=1 width=21) (actual time=5772.835..5780.815 rows=33 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=610430.68..689919.94 rows=1 width=21) (actual time=5476.314..5765.794 rows=11 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.063..375.901 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=610430.67..610430.67 rows=1 width=25) (actual time=5219.273..5219.273 rows=11 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=557690.68..610430.67 rows=1 width=25) (actual time=5132.496..5219.147 rows=11 loops=3)
                                 Hash Cond: (t.id = cc.movie_id)
                                 ->  Parallel Hash Join  (cost=554588.26..607328.24 rows=1 width=37) (actual time=4883.556..5120.120 rows=59 loops=3)
                                       Hash Cond: (t.id = mk.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=952979 width=25) (actual time=0.673..288.329 rows=762424 loops=3)
                                             Filter: (production_year > 1950)
                                             Rows Removed by Filter: 80347
                                       ->  Parallel Hash  (cost=554588.25..554588.25 rows=1 width=12) (actual time=4756.752..4756.752 rows=59 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=111235.39..554588.25 rows=1 width=12) (actual time=1322.954..4756.615 rows=59 loops=3)
                                                   Hash Cond: (ci.movie_id = mk.movie_id)
                                                   ->  Parallel Hash Join  (cost=59349.58..502696.95 rows=1460 width=8) (actual time=609.833..4142.454 rows=185 loops=3)
                                                         Hash Cond: (ci.person_role_id = chn.id)
                                                         ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.034..2245.914 rows=12081448 loops=3)
                                                         ->  Parallel Hash  (cost=59346.31..59346.31 rows=262 width=4) (actual time=555.739..555.739 rows=10 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Seq Scan on char_name chn  (cost=0.00..59346.31 rows=262 width=4) (actual time=33.630..555.627 rows=10 loops=3)
                                                                     Filter: (((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))
                                                                     Rows Removed by Filter: 1046770
                                                   ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=4) (actual time=613.958..613.958 rows=11849 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=4) (actual time=62.228..512.267 rows=11849 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.057..262.132 rows=1507977 loops=3)
                                                               ->  Hash  (cost=3632.40..3632.40 rows=8 width=4) (actual time=61.866..61.867 rows=8 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=4) (actual time=0.217..61.849 rows=8 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                                           Rows Removed by Filter: 134162
                                 ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=98.707..98.707 rows=85941 loops=3)
                                       Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                       ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.235..72.276 rows=85941 loops=3)
                                             Hash Cond: (cc.status_id = cct2.id)
                                             ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.107..54.048 rows=85941 loops=3)
                                                   Hash Cond: (cc.subject_id = cct1.id)
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.027..23.286 rows=135086 loops=3)
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'cast'::text)
                                                               Rows Removed by Filter: 3
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.075..0.075 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.054..0.056 rows=2 loops=3)
                                                         Filter: ((kind)::text ~~ '%complete%'::text)
                                                         Rows Removed by Filter: 2
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.041..0.043 rows=1 loops=1)
                     Filter: ((kind)::text = 'movie'::text)
                     Rows Removed by Filter: 6
 Planning Time: 34.874 ms
 Execution Time: 5781.884 ms
(64 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20b.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=687335.89..687335.90 rows=1 width=32) (actual time=5408.017..5408.017 rows=1 loops=1)
   ->  Gather  (cost=687335.68..687335.89 rows=2 width=32) (actual time=5407.585..5415.277 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=686335.68..686335.69 rows=1 width=32) (actual time=5400.534..5400.534 rows=1 loops=3)
               ->  Hash Join  (cost=635010.03..686335.67 rows=1 width=17) (actual time=5371.050..5400.513 rows=6 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=635008.93..686334.57 rows=1 width=21) (actual time=5370.753..5400.214 rows=6 loops=3)
                           Hash Cond: (t.id = cc.movie_id)
                           ->  Parallel Hash Join  (cost=631906.51..683232.14 rows=1 width=33) (actual time=5268.883..5306.270 rows=17 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.041..267.351 rows=460484 loops=3)
                                       Filter: (production_year > 2000)
                                       Rows Removed by Filter: 382286
                                 ->  Parallel Hash  (cost=631906.50..631906.50 rows=1 width=8) (actual time=4992.334..4992.334 rows=17 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=583654.16..631906.50 rows=1 width=8) (actual time=4765.688..4992.200 rows=17 loops=3)
                                             Hash Cond: (mk.movie_id = ci.movie_id)
                                             ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=4) (actual time=41.995..488.907 rows=11849 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.030..259.634 rows=1507977 loops=3)
                                                   ->  Hash  (cost=3632.40..3632.40 rows=8 width=4) (actual time=41.732..41.738 rows=8 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=4) (actual time=0.169..41.714 rows=8 loops=3)
                                                               Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                               Rows Removed by Filter: 134162
                                             ->  Parallel Hash  (cost=580021.64..580021.64 rows=1 width=4) (actual time=4500.902..4500.902 rows=5 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=136670.44..580021.64 rows=1 width=4) (actual time=1336.248..4500.751 rows=5 loops=3)
                                                         Hash Cond: (ci.person_id = n.id)
                                                         ->  Parallel Hash Join  (cost=59349.58..502696.95 rows=1460 width=8) (actual time=623.277..4010.535 rows=185 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.028..2135.514 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=59346.31..59346.31 rows=262 width=4) (actual time=535.631..535.631 rows=10 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..59346.31 rows=262 width=4) (actual time=23.949..535.503 rows=10 loops=3)
                                                                           Filter: (((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))
                                                                           Rows Removed by Filter: 1046770
                                                         ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=4) (actual time=490.116..490.116 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=4) (actual time=196.819..490.056 rows=1 loops=3)
                                                                     Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                                     Rows Removed by Filter: 1389163
                           ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=93.635..93.635 rows=85941 loops=3)
                                 Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                 ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.194..67.297 rows=85941 loops=3)
                                       Hash Cond: (cc.status_id = cct2.id)
                                       ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.109..49.198 rows=85941 loops=3)
                                             Hash Cond: (cc.subject_id = cct1.id)
                                             ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.028..18.688 rows=135086 loops=3)
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.027..0.027 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'cast'::text)
                                                         Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.034..0.034 rows=2 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.021..0.022 rows=2 loops=3)
                                                   Filter: ((kind)::text ~~ '%complete%'::text)
                                                   Rows Removed by Filter: 2
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.038..0.040 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 34.933 ms
 Execution Time: 5416.240 ms
(67 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20c.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=689631.09..689631.10 rows=1 width=64) (actual time=6438.046..6438.046 rows=1 loops=1)
   ->  Gather  (cost=610141.72..689631.08 rows=1 width=32) (actual time=5843.480..6441.855 rows=5406 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Hash Join  (cost=609141.72..688630.98 rows=1 width=32) (actual time=5836.020..6423.416 rows=1802 loops=3)
               Hash Cond: (t.kind_id = kt.id)
               ->  Parallel Hash Join  (cost=609140.62..688629.88 rows=1 width=36) (actual time=5835.701..6422.107 rows=1906 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.056..384.302 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=609140.61..609140.61 rows=1 width=25) (actual time=5834.047..5834.048 rows=1906 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=557788.53..609140.61 rows=1 width=25) (actual time=5442.909..5776.488 rows=1906 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Hash Join  (cost=3102.42..54447.27 rows=1923 width=29) (actual time=94.517..436.921 rows=7852 loops=3)
                                       Hash Cond: (t.id = cc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.064..272.034 rows=460484 loops=3)
                                             Filter: (production_year > 2000)
                                             Rows Removed by Filter: 382286
                                       ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=94.040..94.040 rows=85941 loops=3)
                                             Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                             ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.219..67.204 rows=85941 loops=3)
                                                   Hash Cond: (cc.status_id = cct2.id)
                                                   ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.103..48.936 rows=85941 loops=3)
                                                         Hash Cond: (cc.subject_id = cct1.id)
                                                         ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.021..18.159 rows=135086 loops=3)
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.023..0.023 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.011 rows=1 loops=3)
                                                                     Filter: ((kind)::text = 'cast'::text)
                                                                     Rows Removed by Filter: 3
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.049..0.049 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.035 rows=2 loops=3)
                                                               Filter: ((kind)::text ~~ '%complete%'::text)
                                                               Rows Removed by Filter: 2
                                 ->  Parallel Hash  (cost=554683.94..554683.94 rows=174 width=12) (actual time=5335.119..5335.119 rows=12272 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2776kB
                                       ->  Parallel Hash Join  (cost=109433.18..554683.94 rows=174 width=12) (actual time=1136.899..5101.576 rows=12272 loops=3)
                                             Hash Cond: (ci.movie_id = mk.movie_id)
                                             ->  Parallel Hash Join  (cost=57211.57..500558.94 rows=507378 width=8) (actual time=530.012..4443.872 rows=207862 loops=3)
                                                   Hash Cond: (ci.person_role_id = chn.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.041..2272.846 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=56075.12..56075.12 rows=90916 width=4) (actual time=528.254..528.254 rows=60051 loops=3)
                                                         Buckets: 262144  Batches: 1  Memory Usage: 9152kB
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=4) (actual time=0.054..483.108 rows=60051 loops=3)
                                                               Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                                               Rows Removed by Filter: 986729
                                             ->  Parallel Hash  (cost=52219.86..52219.86 rows=140 width=4) (actual time=606.147..606.147 rows=8030 loops=3)
                                                   Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                   ->  Hash Join  (cost=3967.95..52219.86 rows=140 width=4) (actual time=46.549..490.870 rows=8030 loops=3)
                                                         Hash Cond: (mk.keyword_id = k.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.052..255.218 rows=1507977 loops=3)
                                                         ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=46.293..46.293 rows=10 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.218..46.275 rows=10 loops=3)
                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                     Rows Removed by Filter: 134160
               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.039..0.041 rows=1 loops=3)
                           Filter: ((kind)::text = 'movie'::text)
                           Rows Removed by Filter: 6
 Planning Time: 33.756 ms
 Execution Time: 6445.563 ms
(64 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21a.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=63661.87..63661.88 rows=1 width=96) (actual time=689.171..689.171 rows=1 loops=1)
   ->  Gather  (cost=63661.76..63661.87 rows=1 width=96) (actual time=688.882..694.932 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=62661.76..62661.77 rows=1 width=96) (actual time=683.324..683.325 rows=1 loops=2)
               ->  Hash Join  (cost=57154.03..62661.75 rows=1 width=118) (actual time=633.492..683.013 rows=705 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=57152.97..62660.68 rows=1 width=122) (actual time=624.595..682.668 rows=752 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.039..59.661 rows=24151 loops=2)
                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                 Rows Removed by Filter: 93348
                           ->  Parallel Hash  (cost=57152.95..57152.95 rows=1 width=107) (actual time=618.986..618.986 rows=1562 loops=2)
                                 Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                 ->  Hash Join  (cost=3473.02..57152.95 rows=1 width=107) (actual time=285.835..529.954 rows=1562 loops=2)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=846.89..54494.99 rows=12124 width=111) (actual time=53.814..508.153 rows=27148 loops=2)
                                             Merge Cond: (ml.movie_id = mk.movie_id)
                                             ->  Merge Join  (cost=651.93..51228.28 rows=260 width=123) (actual time=52.221..468.110 rows=3220 loops=2)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=651.50..46001.67 rows=102 width=111) (actual time=49.189..429.734 rows=656 loops=2)
                                                         Merge Cond: (ml.movie_id = t.id)
                                                         ->  Merge Join  (cost=651.07..37165.42 rows=282 width=90) (actual time=15.464..255.721 rows=1391 loops=2)
                                                               Merge Cond: (mi.movie_id = ml.movie_id)
                                                               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1002971.17 rows=60182 width=4) (actual time=1.390..243.961 rows=2058 loops=2)
                                                                     Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                                                                     Rows Removed by Filter: 255305
                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.587..10.835 rows=3172 loops=2)
                                                                     Sort Key: ml.movie_id
                                                                     Sort Method: quicksort  Memory: 205kB
                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.137..9.308 rows=2315 loops=2)
                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.029..5.032 rows=29997 loops=2)
                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.059..0.059 rows=2 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.038..0.044 rows=2 loops=2)
                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                       Rows Removed by Filter: 16
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=911963 width=21) (actual time=0.042..169.534 rows=51993 loops=2)
                                                               Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                                               Rows Removed by Filter: 110576
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.049..34.747 rows=40588 loops=2)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 39291
                                             ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.042..26.159 rows=102619 loops=2)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.961..18.961 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.105..18.948 rows=1 loops=2)
                                                   Filter: ((keyword)::text = 'sequel'::text)
                                                   Rows Removed by Filter: 134169
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 31.722 ms
 Execution Time: 695.860 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=61990.17..61990.18 rows=1 width=96) (actual time=522.959..522.959 rows=1 loops=1)
   ->  Gather  (cost=61990.05..61990.16 rows=1 width=96) (actual time=522.694..528.369 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=60990.05..60990.06 rows=1 width=96) (actual time=516.741..516.741 rows=1 loops=2)
               ->  Hash Join  (cost=55482.32..60990.04 rows=1 width=118) (actual time=453.905..516.688 rows=19 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=55481.26..60988.98 rows=1 width=122) (actual time=453.721..516.499 rows=19 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.039..65.109 rows=24151 loops=2)
                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                 Rows Removed by Filter: 93348
                           ->  Parallel Hash  (cost=55481.25..55481.25 rows=1 width=107) (actual time=447.626..447.626 rows=66 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                 ->  Hash Join  (cost=3474.93..55481.25 rows=1 width=107) (actual time=404.796..447.458 rows=66 loops=2)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=848.79..52824.70 rows=11587 width=111) (actual time=31.900..428.147 rows=2784 loops=2)
                                             Merge Cond: (ml.movie_id = mk.movie_id)
                                             ->  Merge Join  (cost=651.93..49563.13 rows=249 width=123) (actual time=25.795..399.541 rows=770 loops=2)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=651.50..44336.66 rows=97 width=111) (actual time=24.874..366.328 rows=338 loops=2)
                                                         Merge Cond: (ml.movie_id = t.id)
                                                         ->  Merge Join  (cost=651.07..35476.61 rows=237 width=90) (actual time=15.792..184.567 rows=544 loops=2)
                                                               Merge Cond: (mi.movie_id = ml.movie_id)
                                                               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..956609.55 rows=50482 width=4) (actual time=1.480..173.014 rows=1524 loops=2)
                                                                     Filter: ((info)::text = ANY ('{Germany,German}'::text[]))
                                                                     Rows Removed by Filter: 255930
                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.731..10.929 rows=2527 loops=2)
                                                                     Sort Key: ml.movie_id
                                                                     Sort Method: quicksort  Memory: 205kB
                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.148..9.423 rows=2315 loops=2)
                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.029..5.116 rows=29997 loops=2)
                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.059..0.059 rows=2 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.041..0.047 rows=2 loops=2)
                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                       Rows Removed by Filter: 16
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=1038952 width=21) (actual time=0.063..175.107 rows=80664 loops=2)
                                                               Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                               Rows Removed by Filter: 83756
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.028..29.887 rows=42314 loops=2)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 42471
                                             ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.026..19.679 rows=84660 loops=2)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.007..19.007 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.070..18.995 rows=1 loops=2)
                                                   Filter: ((keyword)::text = 'sequel'::text)
                                                   Rows Removed by Filter: 134169
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 32.623 ms
 Execution Time: 529.309 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21c.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=54436.16..54436.17 rows=1 width=96) (actual time=621.220..621.220 rows=1 loops=1)
   ->  Hash Join  (cost=22630.14..54436.15 rows=1 width=118) (actual time=302.109..620.361 rows=1874 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=20004.00..51778.36 rows=12060 width=122) (actual time=204.262..585.617 rows=33031 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Merge Join  (cost=208.46..1509126.58 rows=11385503 width=12) (actual time=0.140..373.206 rows=55032 loops=1)
                     Merge Cond: (mi.movie_id = mk.movie_id)
                     ->  Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1194599.22 rows=893642 width=4) (actual time=0.099..311.096 rows=28657 loops=1)
                           Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))
                           Rows Removed by Filter: 414007
                     ->  Materialize  (cost=0.43..153366.95 rows=4523930 width=8) (actual time=0.037..38.126 rows=85569 loops=1)
                           ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.026..22.236 rows=82171 loops=1)
               ->  Sort  (cost=19795.25..19795.61 rows=144 width=130) (actual time=198.582..200.657 rows=33234 loops=1)
                     Sort Key: mc.movie_id
                     Sort Method: quicksort  Memory: 203kB
                     ->  Gather  (cost=7378.71..19790.09 rows=144 width=130) (actual time=81.726..199.059 rows=1130 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Hash Join  (cost=6378.71..18775.69 rows=60 width=130) (actual time=75.245..185.966 rows=377 loops=3)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=6377.65..18773.33 rows=240 width=134) (actual time=75.059..185.649 rows=393 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Merge Join  (cost=651.50..13043.69 rows=1331 width=119) (actual time=13.960..135.451 rows=1672 loops=3)
                                             Merge Cond: (ml.movie_id = mc.movie_id)
                                             ->  Merge Join  (cost=651.07..7805.34 rows=520 width=107) (actual time=13.764..94.586 rows=749 loops=3)
                                                   Merge Cond: (t.id = ml.movie_id)
                                                   ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=789968 width=21) (actual time=0.135..77.381 rows=48445 loops=3)
                                                         Filter: ((production_year >= 1950) AND (production_year <= 2010))
                                                         Rows Removed by Filter: 13625
                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.362..12.545 rows=2315 loops=3)
                                                         Sort Key: ml.movie_id
                                                         Sort Method: quicksort  Memory: 205kB
                                                         Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                         Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.145..11.097 rows=2315 loops=3)
                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.031..6.762 rows=29997 loops=3)
                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.051..0.051 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.034..0.039 rows=2 loops=3)
                                                                           Filter: ((link)::text ~~ '%follow%'::text)
                                                                           Rows Removed by Filter: 16
                                             ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.052..36.977 rows=45325 loops=3)
                                                   Filter: (note IS NULL)
                                                   Rows Removed by Filter: 46125
                                       ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=48.711..48.711 rows=16101 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.026..38.642 rows=16101 loops=3)
                                                   Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                   Rows Removed by Filter: 62232
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.035 rows=1 loops=3)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=31.600..31.600 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.764..31.587 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 32.225 ms
 Execution Time: 623.177 ms
(62 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=414666.61..414666.62 rows=1 width=96) (actual time=3311.451..3311.451 rows=1 loops=1)
   ->  Gather  (cost=414666.39..414666.60 rows=2 width=96) (actual time=3309.971..3317.465 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=413666.39..413666.40 rows=1 width=96) (actual time=3302.288..3302.288 rows=1 loops=3)
               ->  Hash Join  (cost=363451.32..413666.38 rows=1 width=41) (actual time=3145.055..3301.818 rows=950 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=363450.20..413665.27 rows=1 width=45) (actual time=3123.335..3301.262 rows=1009 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=279670 width=25) (actual time=0.009..258.351 rows=220688 loops=3)
                                 Filter: (production_year > 2008)
                                 Rows Removed by Filter: 622082
                           ->  Parallel Hash  (cost=363450.19..363450.19 rows=1 width=40) (actual time=3009.199..3009.199 rows=13395 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4088kB
                                 ->  Hash Join  (cost=358450.15..363450.19 rows=1 width=40) (actual time=2948.617..2993.991 rows=13395 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=358449.06..363449.10 rows=1 width=44) (actual time=2948.522..2990.402 rows=13395 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.041..29.724 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=358449.05..358449.05 rows=1 width=29) (actual time=2948.369..2948.369 rows=14738 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3832kB
                                                   ->  Parallel Hash Join  (cost=323145.98..358449.05 rows=1 width=29) (actual time=2636.713..2923.159 rows=14738 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.019..268.651 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=323145.97..323145.97 rows=1 width=17) (actual time=2635.213..2635.213 rows=5361 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                                                               ->  Parallel Hash Join  (cost=67689.63..323145.97 rows=1 width=17) (actual time=2230.455..2610.195 rows=5361 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255449.73 rows=2405 width=4) (actual time=1381.307..1732.886 rows=196255 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=271735 width=8) (actual time=0.733..1683.215 rows=223112 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Germany,German,USA,American}'::text[]))
                                                                                 Rows Removed by Filter: 4722128
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'countries'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=67687.20..67687.20 rows=1 width=13) (actual time=848.553..848.553 rows=8267 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1752kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..67687.20 rows=1 width=13) (actual time=589.627..817.383 rows=8267 loops=3)
                                                                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..16456.75 rows=4327 width=9) (actual time=0.196..209.916 rows=108039 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=488953 width=13) (actual time=0.048..157.071 rows=390635 loops=3)
                                                                                             Filter: ((info)::text < '7.0'::text)
                                                                                             Rows Removed by Filter: 69377
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.044 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=588.896..588.897 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=38.997..483.127 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..256.737 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=38.677..38.677 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.626..38.664 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.040..0.040 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.028..0.029 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.060..0.060 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.039..0.042 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 82.382 ms
 Execution Time: 3318.427 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22b.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=414463.52..414463.53 rows=1 width=96) (actual time=3231.913..3231.913 rows=1 loops=1)
   ->  Gather  (cost=414463.29..414463.50 rows=2 width=96) (actual time=3230.442..3238.303 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=413463.29..413463.30 rows=1 width=96) (actual time=3222.836..3222.837 rows=1 loops=3)
               ->  Hash Join  (cost=363451.32..413463.29 rows=1 width=41) (actual time=3129.785..3222.806 rows=10 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=363450.20..413462.17 rows=1 width=45) (actual time=3129.487..3222.503 rows=11 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=225511 width=25) (actual time=0.009..249.232 rows=177790 loops=3)
                                 Filter: (production_year > 2009)
                                 Rows Removed by Filter: 664981
                           ->  Parallel Hash  (cost=363450.19..363450.19 rows=1 width=40) (actual time=2943.933..2943.933 rows=13395 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4088kB
                                 ->  Hash Join  (cost=358450.15..363450.19 rows=1 width=40) (actual time=2895.394..2929.169 rows=13395 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=358449.06..363449.10 rows=1 width=44) (actual time=2895.299..2925.646 rows=13395 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.009..18.854 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=358449.05..358449.05 rows=1 width=29) (actual time=2895.188..2895.188 rows=14738 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3832kB
                                                   ->  Parallel Hash Join  (cost=323145.98..358449.05 rows=1 width=29) (actual time=2588.678..2871.370 rows=14738 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.015..266.545 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=323145.97..323145.97 rows=1 width=17) (actual time=2586.072..2586.073 rows=5361 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                                                               ->  Parallel Hash Join  (cost=67689.63..323145.97 rows=1 width=17) (actual time=2183.233..2559.064 rows=5361 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255449.73 rows=2405 width=4) (actual time=1349.948..1698.367 rows=196255 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=271735 width=8) (actual time=0.696..1648.186 rows=223112 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Germany,German,USA,American}'::text[]))
                                                                                 Rows Removed by Filter: 4722128
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.027 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'countries'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=67687.20..67687.20 rows=1 width=13) (actual time=832.552..832.552 rows=8267 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1720kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..67687.20 rows=1 width=13) (actual time=573.744..800.942 rows=8267 loops=3)
                                                                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..16456.75 rows=4327 width=9) (actual time=0.191..209.281 rows=108039 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=488953 width=13) (actual time=0.045..156.512 rows=390635 loops=3)
                                                                                             Filter: ((info)::text < '7.0'::text)
                                                                                             Rows Removed by Filter: 69377
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.045 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=573.006..573.006 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=30.635..469.813 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.029..252.004 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=30.321..30.321 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.484..30.306 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.043..0.043 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.028..0.030 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.054..0.054 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.031..0.033 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 81.156 ms
 Execution Time: 3239.296 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22c.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=461803.15..461803.16 rows=1 width=96) (actual time=3937.603..3937.603 rows=1 loops=1)
   ->  Gather  (cost=461802.92..461803.13 rows=2 width=96) (actual time=3935.661..3943.155 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=460802.92..460802.93 rows=1 width=96) (actual time=3928.171..3928.172 rows=1 loops=3)
               ->  Hash Join  (cost=410038.34..460802.92 rows=1 width=41) (actual time=3615.961..3925.032 rows=7163 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=410037.22..460801.80 rows=1 width=45) (actual time=3606.135..3922.885 rows=7732 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.013..264.368 rows=337640 loops=3)
                                 Filter: (production_year > 2005)
                                 Rows Removed by Filter: 505131
                           ->  Parallel Hash  (cost=410037.21..410037.21 rows=1 width=40) (actual time=3601.312..3601.312 rows=21916 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5976kB
                                 ->  Hash Join  (cost=405037.17..410037.21 rows=1 width=40) (actual time=3541.660..3581.490 rows=21916 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=405036.08..410036.12 rows=1 width=44) (actual time=3541.565..3575.783 rows=21916 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.011..18.899 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=405036.07..405036.07 rows=1 width=29) (actual time=3541.457..3541.457 rows=23616 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6520kB
                                                   ->  Parallel Hash Join  (cost=369733.01..405036.07 rows=1 width=29) (actual time=3206.392..3497.230 rows=23616 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.011..271.006 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3205.477..3205.477 rows=6989 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                                               ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2932.300..3176.251 rows=6989 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.158..221.840 rows=151410 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.042..157.792 rows=447629 loops=3)
                                                                                 Filter: ((info)::text < '8.5'::text)
                                                                                 Rows Removed by Filter: 12383
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.029 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2931.587..2931.587 rows=7972 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2376.040..2884.941 rows=7972 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1818.705..2298.603 rows=204750 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=0.969..2246.575 rows=238737 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                                                             Rows Removed by Filter: 4706503
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.048 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'countries'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=556.935..556.936 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=30.998..469.783 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.033..251.819 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=30.786..30.787 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.473..30.774 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.040..0.041 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.028..0.030 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.052..0.052 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.030..0.033 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 81.356 ms
 Execution Time: 3944.746 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22d.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=460238.12..460238.13 rows=1 width=96) (actual time=5644.820..5644.820 rows=1 loops=1)
   ->  Gather  (cost=460238.00..460238.11 rows=1 width=96) (actual time=5644.093..5649.966 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=459238.00..459238.01 rows=1 width=96) (actual time=5638.307..5638.307 rows=1 loops=2)
               ->  Hash Join  (cost=454237.96..459238.00 rows=1 width=41) (actual time=5575.656..5629.133 rows=23140 loops=2)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=454236.84..459236.88 rows=1 width=45) (actual time=5575.415..5623.390 rows=24954 loops=2)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=454235.75..459235.79 rows=1 width=49) (actual time=5575.316..5617.308 rows=24954 loops=2)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.010..25.084 rows=63115 loops=2)
                                       Filter: ((country_code)::text <> '[us]'::text)
                                       Rows Removed by Filter: 54384
                                 ->  Parallel Hash  (cost=454235.74..454235.74 rows=1 width=34) (actual time=5574.787..5574.787 rows=35884 loops=2)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6808kB
                                       ->  Parallel Hash Join  (cost=420497.60..454235.74 rows=1 width=34) (actual time=5113.653..5536.394 rows=35884 loops=2)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.016..232.048 rows=1304564 loops=2)
                                             ->  Parallel Hash  (cost=420497.58..420497.58 rows=1 width=42) (actual time=5113.389..5113.389 rows=2566 loops=2)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                   ->  Parallel Hash Join  (cost=369733.01..420497.58 rows=1 width=42) (actual time=4640.612..5097.035 rows=2566 loops=2)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.015..385.312 rows=506460 loops=2)
                                                               Filter: (production_year > 2005)
                                                               Rows Removed by Filter: 757696
                                                         ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=4640.231..4640.231 rows=10484 loops=2)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                               ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=4253.375..4617.390 rows=10484 loops=2)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.167..331.052 rows=227115 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.065..235.564 rows=671443 loops=2)
                                                                                 Filter: ((info)::text < '8.5'::text)
                                                                                 Rows Removed by Filter: 18574
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=4252.795..4252.796 rows=11958 loops=2)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=3463.809..4220.991 rows=11958 loops=2)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=2688.313..3403.402 rows=307126 loops=2)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.434..3325.038 rows=358105 loops=2)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                                                             Rows Removed by Filter: 7059755
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.057 rows=1 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.045 rows=1 loops=2)
                                                                                                   Filter: ((info)::text = 'countries'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=774.935..774.935 rows=18546 loops=2)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=30.768..685.602 rows=18546 loops=2)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.036..372.446 rows=2261965 loops=2)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=30.584..30.585 rows=3 loops=2)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.484..30.559 rows=3 loops=2)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.038..0.038 rows=4 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.025..0.026 rows=4 loops=2)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.046..0.046 rows=2 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.026..0.029 rows=2 loops=2)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 81.066 ms
 Execution Time: 5650.902 ms
(74 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23a.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=418779.45..418779.46 rows=1 width=64) (actual time=2347.411..2347.412 rows=1 loops=1)
   ->  Gather  (cost=418779.23..418779.44 rows=2 width=64) (actual time=2346.924..2353.621 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=417779.23..417779.24 rows=1 width=64) (actual time=2339.372..2339.372 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=413873.01..417779.22 rows=1 width=65) (actual time=2292.008..2339.253 rows=206 loops=3)
                     Hash Cond: (k.id = mk.keyword_id)
                     ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.102..42.329 rows=44723 loops=3)
                           Heap Fetches: 134170
                     ->  Parallel Hash  (cost=413872.58..413872.58 rows=1 width=69) (actual time=2291.193..2291.193 rows=206 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Hash Join  (cost=363500.14..413872.58 rows=1 width=69) (actual time=2237.525..2291.041 rows=206 loops=3)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Hash Join  (cost=363499.05..413871.49 rows=1 width=73) (actual time=2237.415..2290.885 rows=206 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Hash Join  (cost=363496.62..413868.99 rows=26 width=77) (actual time=2237.308..2290.730 rows=206 loops=3)
                                             Hash Cond: (mk.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.031..251.080 rows=1507977 loops=3)
                                             ->  Parallel Hash  (cost=363496.59..363496.59 rows=3 width=89) (actual time=1859.538..1859.538 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Parallel Hash Join  (cost=358585.30..363496.59 rows=3 width=89) (actual time=1853.447..1859.477 rows=2 loops=3)
                                                         Hash Cond: (cn.id = mc.company_id)
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..16.240 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                                                         ->  Parallel Hash  (cost=358585.24..358585.24 rows=5 width=93) (actual time=1840.495..1840.495 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=324847.09..358585.24 rows=5 width=93) (actual time=1786.678..1840.430 rows=2 loops=3)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.328..154.105 rows=869710 loops=3)
                                                                     ->  Parallel Hash  (cost=324847.07..324847.07 rows=2 width=81) (actual time=1579.907..1579.907 rows=2 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=54685.18..324847.07 rows=2 width=81) (actual time=1119.502..1579.815 rows=2 loops=3)
                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=8) (actual time=297.426..1195.322 rows=594 loops=3)
                                                                                       Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                       Rows Removed by Filter: 4944646
                                                                                 ->  Parallel Hash  (cost=54671.45..54671.45 rows=1099 width=73) (actual time=384.022..384.022 rows=344 loops=3)
                                                                                       Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                                                                       ->  Hash Join  (cost=3236.49..54671.45 rows=1099 width=73) (actual time=268.035..383.533 rows=344 loops=3)
                                                                                             Hash Cond: (t.kind_id = kt.id)
                                                                                             ->  Hash Join  (cost=3235.39..54637.93 rows=7692 width=29) (actual time=51.478..383.183 rows=694 loops=3)
                                                                                                   Hash Cond: (t.id = cc.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.034..278.003 rows=460484 loops=3)
                                                                                                         Filter: (production_year > 2000)
                                                                                                         Rows Removed by Filter: 382286
                                                                                                   ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=49.885..49.885 rows=24592 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.142..42.489 rows=24592 loops=3)
                                                                                                               Hash Cond: (cc.status_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.036..21.630 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.023..0.024 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'complete+verified'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                             ->  Hash  (cost=1.09..1.09 rows=1 width=52) (actual time=0.047..0.048 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=52) (actual time=0.033..0.035 rows=1 loops=3)
                                                                                                         Filter: ((kind)::text = 'movie'::text)
                                                                                                         Rows Removed by Filter: 6
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.043 rows=1 loops=3)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.054..0.054 rows=4 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.031..0.032 rows=4 loops=3)
 Planning Time: 81.557 ms
 Execution Time: 2354.848 ms
(71 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23b.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=400136.80..400136.81 rows=1 width=64) (actual time=4247.696..4247.697 rows=1 loops=1)
   ->  Gather  (cost=400136.69..400136.80 rows=1 width=64) (actual time=4247.354..4253.220 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=399136.69..399136.70 rows=1 width=64) (actual time=4241.741..4241.741 rows=1 loops=2)
               ->  Hash Join  (cost=394225.39..399136.68 rows=1 width=65) (actual time=4238.350..4241.720 rows=8 loops=2)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=394224.29..399135.58 rows=1 width=21) (actual time=4238.070..4241.438 rows=8 loops=2)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=394223.20..399134.49 rows=1 width=25) (actual time=4237.971..4241.337 rows=8 loops=2)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.008..23.774 rows=42422 loops=2)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 75077
                                 ->  Parallel Hash  (cost=394223.19..394223.19 rows=1 width=29) (actual time=4213.218..4213.218 rows=8 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Hash Join  (cost=360485.03..394223.19 rows=1 width=29) (actual time=4202.092..4213.156 rows=8 loops=2)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Parallel Hash Join  (cost=357249.64..390987.79 rows=1 width=45) (actual time=3878.909..4165.465 rows=6 loops=2)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.749..229.958 rows=1304564 loops=2)
                                                   ->  Parallel Hash  (cost=357249.63..357249.63 rows=1 width=33) (actual time=3776.391..3776.391 rows=5 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                         ->  Parallel Hash Join  (cost=305924.00..357249.63 rows=1 width=33) (actual time=3502.158..3776.353 rows=5 loops=2)
                                                               Hash Cond: (t.id = mi.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.009..401.089 rows=690726 loops=2)
                                                                     Filter: (production_year > 2000)
                                                                     Rows Removed by Filter: 573430
                                                               ->  Parallel Hash  (cost=305923.99..305923.99 rows=1 width=8) (actual time=3305.723..3305.723 rows=5 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Hash Join  (cost=257671.78..305923.99 rows=1 width=8) (actual time=2919.057..3305.651 rows=5 loops=2)
                                                                           Hash Cond: (mk.movie_id = mi.movie_id)
                                                                           ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=30.647..681.958 rows=566 loops=2)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.042..378.931 rows=2261965 loops=2)
                                                                                 ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=28.241..28.242 rows=4 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.838..28.217 rows=4 loops=2)
                                                                                             Filter: ((keyword)::text = ANY ('{nerd,loner,alienation,dignity}'::text[]))
                                                                                             Rows Removed by Filter: 134166
                                                                           ->  Parallel Hash  (cost=254710.16..254710.16 rows=2 width=4) (actual time=2623.316..2623.316 rows=886 loops=2)
                                                                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                                                 ->  Hash Join  (cost=2.43..254710.16 rows=2 width=4) (actual time=428.023..1690.234 rows=886 loops=2)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=8) (actual time=427.903..1689.318 rows=886 loops=2)
                                                                                             Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                                                                             Rows Removed by Filter: 7416974
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.048 rows=1 loops=2)
                                                                                                   Filter: ((info)::text = 'release dates'::text)
                                                                                                   Rows Removed by Filter: 112
                                             ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=46.617..46.617 rows=24592 loops=2)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                   ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.123..39.489 rows=24592 loops=2)
                                                         Hash Cond: (cc.status_id = cct1.id)
                                                         ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.025..18.753 rows=135086 loops=2)
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.020..0.021 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'complete+verified'::text)
                                                                     Rows Removed by Filter: 3
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.043..0.043 rows=4 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.027..0.028 rows=4 loops=2)
                     ->  Hash  (cost=1.09..1.09 rows=1 width=52) (actual time=0.083..0.084 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=52) (actual time=0.032..0.034 rows=1 loops=2)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 83.543 ms
 Execution Time: 4254.177 ms
(72 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=419448.86..419448.87 rows=1 width=64) (actual time=2386.324..2386.325 rows=1 loops=1)
   ->  Gather  (cost=419448.64..419448.85 rows=2 width=64) (actual time=2385.981..2393.182 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=418448.64..418448.65 rows=1 width=64) (actual time=2378.336..2378.336 rows=1 loops=3)
               ->  Hash Join  (cost=414542.42..418448.63 rows=2 width=65) (actual time=2331.061..2378.216 rows=209 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=414541.33..418447.54 rows=2 width=69) (actual time=2330.794..2377.880 rows=209 loops=3)
                           Hash Cond: (k.id = mk.keyword_id)
                           ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.143..42.196 rows=44723 loops=3)
                                 Heap Fetches: 134170
                           ->  Parallel Hash  (cost=414540.87..414540.87 rows=3 width=73) (actual time=2330.126..2330.126 rows=209 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                 ->  Parallel Hash Join  (cost=409629.58..414540.87 rows=3 width=73) (actual time=2318.099..2329.959 rows=209 loops=3)
                                       Hash Cond: (cn.id = mc.company_id)
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.012..16.088 rows=28281 loops=3)
                                             Filter: ((country_code)::text = '[us]'::text)
                                             Rows Removed by Filter: 50051
                                       ->  Parallel Hash  (cost=409629.53..409629.53 rows=4 width=77) (actual time=2310.970..2310.970 rows=209 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=359255.99..409629.53 rows=4 width=77) (actual time=2166.229..2310.808 rows=209 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=359253.57..409626.13 rows=360 width=81) (actual time=2166.121..2310.647 rows=209 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..249.093 rows=1507977 loops=3)
                                                         ->  Parallel Hash  (cost=359253.22..359253.22 rows=28 width=93) (actual time=1881.356..1881.356 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=325515.05..359253.22 rows=28 width=93) (actual time=1810.812..1881.286 rows=2 loops=3)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.067..155.315 rows=869710 loops=3)
                                                                     ->  Parallel Hash  (cost=325514.95..325514.95 rows=8 width=81) (actual time=1619.363..1619.363 rows=2 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=55353.07..325514.95 rows=8 width=81) (actual time=1124.173..1619.277 rows=2 loops=3)
                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=8) (actual time=301.061..1218.966 rows=594 loops=3)
                                                                                       Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                       Rows Removed by Filter: 4944646
                                                                                 ->  Parallel Hash  (cost=55283.32..55283.32 rows=5580 width=73) (actual time=399.696..399.696 rows=1684 loops=3)
                                                                                       Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                                                       ->  Hash Join  (cost=3236.54..55283.32 rows=5580 width=73) (actual time=266.435..397.859 rows=1684 loops=3)
                                                                                             Hash Cond: (t.kind_id = kt.id)
                                                                                             ->  Hash Join  (cost=3235.39..55241.01 rows=9766 width=29) (actual time=47.951..396.894 rows=2141 loops=3)
                                                                                                   Hash Cond: (t.id = cc.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=25) (actual time=0.034..281.970 rows=583011 loops=3)
                                                                                                         Filter: (production_year > 1990)
                                                                                                         Rows Removed by Filter: 259760
                                                                                                   ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=46.459..46.459 rows=24592 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.123..39.353 rows=24592 loops=3)
                                                                                                               Hash Cond: (cc.status_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.028..18.661 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.019..0.020 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'complete+verified'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                             ->  Hash  (cost=1.10..1.10 rows=4 width=52) (actual time=0.045..0.045 rows=4 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.10 rows=4 width=52) (actual time=0.031..0.034 rows=4 loops=3)
                                                                                                         Filter: ((kind)::text = ANY ('{movie,"tv movie","video movie","video game"}'::text[]))
                                                                                                         Rows Removed by Filter: 3
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.043 rows=1 loops=3)
                                                               Filter: ((info)::text = 'release dates'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.064..0.064 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.037..0.038 rows=4 loops=3)
 Planning Time: 81.589 ms
 Execution Time: 2394.209 ms
(71 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/24a.sql_explained.sql
SET
SET
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1028775.06..1028775.07 rows=1 width=96) (actual time=7048.198..7048.199 rows=1 loops=1)
   ->  Hash Join  (cost=773581.49..1028775.05 rows=1 width=48) (actual time=6011.151..7048.066 rows=275 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Gather  (cost=773579.07..1028772.62 rows=1 width=52) (actual time=6011.044..7054.675 rows=275 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=772579.07..1027772.52 rows=1 width=52) (actual time=5985.427..7039.756 rows=92 loops=3)
                     Hash Cond: (mi.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=129652 width=8) (actual time=346.803..1708.521 rows=100416 loops=3)
                           Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))
                           Rows Removed by Filter: 4844824
                     ->  Parallel Hash  (cost=772579.06..772579.06 rows=1 width=64) (actual time=5318.525..5318.525 rows=42 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=767667.77..772579.06 rows=1 width=64) (actual time=5298.373..5318.426 rows=42 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.012..20.257 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=767667.75..767667.75 rows=1 width=68) (actual time=5295.173..5295.173 rows=115 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=733929.61..767667.75 rows=1 width=68) (actual time=5105.365..5295.053 rows=115 loops=3)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.026..156.260 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=733929.60..733929.60 rows=1 width=60) (actual time=5031.769..5031.769 rows=13 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Hash Join  (cost=679490.06..733929.60 rows=1 width=60) (actual time=4855.005..5031.697 rows=13 loops=3)
                                                         Hash Cond: (ci.role_id = rt.id)
                                                         ->  Parallel Hash Join  (cost=679488.90..733928.43 rows=1 width=64) (actual time=4854.878..5031.565 rows=13 loops=3)
                                                               Hash Cond: (chn.id = ci.person_role_id)
                                                               ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.041..247.024 rows=1046780 loops=3)
                                                               ->  Parallel Hash  (cost=679488.88..679488.88 rows=1 width=52) (actual time=4658.425..4658.425 rows=13 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=663335.18..679488.88 rows=1 width=52) (actual time=4576.527..4658.288 rows=13 loops=3)
                                                                           Hash Cond: (n.id = ci.person_id)
                                                                           ->  Parallel Hash Join  (cost=81910.23..98047.67 rows=4333 width=23) (actual time=543.672..670.940 rows=3508 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.036..75.665 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=542.548..542.548 rows=16670 loops=3)
                                                                                       Buckets: 65536  Batches: 1  Memory Usage: 3264kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=222.032..529.193 rows=16670 loops=3)
                                                                                             Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1372493
                                                                           ->  Parallel Hash  (cost=581424.93..581424.93 rows=2 width=41) (actual time=3986.563..3986.564 rows=875 loops=3)
                                                                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                                                 ->  Parallel Hash Join  (cost=100834.61..581424.93 rows=2 width=41) (actual time=898.083..3772.404 rows=875 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.059..2835.031 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Parallel Hash  (cost=100834.53..100834.53 rows=7 width=25) (actual time=895.130..895.130 rows=165 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=51046.31..100834.53 rows=7 width=25) (actual time=624.077..894.898 rows=165 loops=3)
                                                                                                   Hash Cond: (t.id = mk.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.032..253.889 rows=130555 loops=3)
                                                                                                         Filter: (production_year > 2010)
                                                                                                         Rows Removed by Filter: 712215
                                                                                                   ->  Parallel Hash  (cost=51045.79..51045.79 rows=42 width=4) (actual time=619.429..619.430 rows=3232 loops=3)
                                                                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                                                                         ->  Hash Join  (cost=2793.88..51045.79 rows=42 width=4) (actual time=28.841..463.223 rows=3232 loops=3)
                                                                                                               Hash Cond: (mk.keyword_id = k.id)
                                                                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.043..251.760 rows=1507977 loops=3)
                                                                                                               ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=27.770..27.770 rows=3 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=0.065..27.755 rows=3 loops=3)
                                                                                                                           Filter: ((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat}'::text[]))
                                                                                                                           Rows Removed by Filter: 134167
                                                         ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.070..0.071 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.048..0.050 rows=1 loops=3)
                                                                     Filter: ((role)::text = 'actress'::text)
                                                                     Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.014..0.025 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 99.421 ms
 Execution Time: 7055.907 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/24b.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1031111.24..1031111.25 rows=1 width=96) (actual time=6804.488..6804.488 rows=1 loops=1)
   ->  Hash Join  (cost=775917.68..1031111.23 rows=1 width=48) (actual time=5739.568..6804.425 rows=45 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Gather  (cost=775915.25..1031108.81 rows=1 width=52) (actual time=5739.459..6812.075 rows=45 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=774915.25..1030108.71 rows=1 width=52) (actual time=6086.377..6795.667 rows=15 loops=3)
                     Hash Cond: (mi.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=129652 width=8) (actual time=199.880..1748.229 rows=100416 loops=3)
                           Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))
                           Rows Removed by Filter: 4844824
                     ->  Parallel Hash  (cost=774915.24..774915.24 rows=1 width=64) (actual time=5034.737..5034.737 rows=8 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Hash Join  (cost=720475.70..774915.24 rows=1 width=64) (actual time=4992.693..5034.642 rows=8 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Hash Join  (cost=720474.54..774914.07 rows=1 width=68) (actual time=4992.579..5034.526 rows=8 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.039..262.395 rows=1046780 loops=3)
                                       ->  Parallel Hash  (cost=720474.52..720474.52 rows=1 width=56) (actual time=4646.813..4646.813 rows=8 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                             ->  Parallel Hash Join  (cost=704320.82..720474.52 rows=1 width=56) (actual time=4618.770..4646.683 rows=8 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Hash Join  (cost=81910.23..98047.67 rows=4333 width=23) (actual time=557.757..689.095 rows=3508 loops=3)
                                                         Hash Cond: (an.person_id = n.id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.032..77.790 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=556.960..556.960 rows=16670 loops=3)
                                                               Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=227.116..541.918 rows=16670 loops=3)
                                                                     Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                     Rows Removed by Filter: 1372493
                                                   ->  Parallel Hash  (cost=622410.58..622410.58 rows=1 width=45) (actual time=3957.012..3957.012 rows=36 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=141820.27..622410.58 rows=1 width=45) (actual time=1088.628..3956.894 rows=36 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.058..2902.449 rows=289159 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                     Rows Removed by Filter: 11792289
                                                               ->  Parallel Hash  (cost=141820.25..141820.25 rows=1 width=29) (actual time=1016.453..1016.453 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Hash Join  (cost=108082.11..141820.25 rows=1 width=29) (actual time=965.250..1016.379 rows=2 loops=3)
                                                                           Hash Cond: (mc.company_id = cn.id)
                                                                           ->  Parallel Hash Join  (cost=103013.59..136751.74 rows=1 width=33) (actual time=785.768..991.824 rows=21 loops=3)
                                                                                 Hash Cond: (mc.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.029..162.231 rows=869710 loops=3)
                                                                                 ->  Parallel Hash  (cost=103013.58..103013.58 rows=1 width=25) (actual time=721.579..721.579 rows=2 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Hash Join  (cost=54761.74..103013.58 rows=1 width=25) (actual time=521.799..721.484 rows=2 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Hash Join  (cost=51800.14..100051.91 rows=28 width=29) (actual time=490.443..690.123 rows=29 loops=3)
                                                                                                   Hash Cond: (mk.movie_id = t.id)
                                                                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.060..251.509 rows=1507977 loops=3)
                                                                                                   ->  Parallel Hash  (cost=51799.95..51799.95 rows=15 width=21) (actual time=258.346..258.347 rows=3 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=15 width=21) (actual time=138.110..258.261 rows=3 loops=3)
                                                                                                               Filter: ((production_year > 2010) AND ((title)::text ~~ 'Kung Fu Panda%'::text))
                                                                                                               Rows Removed by Filter: 842768
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=31.293..31.293 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.088..31.274 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat,computer-animated-movie}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                                                           ->  Parallel Hash  (cost=5068.50..5068.50 rows=1 width=4) (actual time=24.445..24.445 rows=0 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..5068.50 rows=1 width=4) (actual time=18.336..24.402 rows=0 loops=3)
                                                                                       Filter: (((country_code)::text = '[us]'::text) AND ((name)::text = 'DreamWorks Animation'::text))
                                                                                       Rows Removed by Filter: 78332
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.060..0.061 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=3)
                                             Filter: ((role)::text = 'actress'::text)
                                             Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 99.106 ms
 Execution Time: 6813.194 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=937486.93..937486.94 rows=1 width=128) (actual time=5966.160..5966.160 rows=1 loops=1)
   ->  Gather  (cost=937486.70..937486.91 rows=2 width=128) (actual time=5965.261..5971.697 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=936486.70..936486.71 rows=1 width=128) (actual time=5958.049..5958.050 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=886003.56..936486.69 rows=1 width=80) (actual time=5724.132..5956.713 rows=1469 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.030..230.293 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=886003.55..886003.55 rows=1 width=79) (actual time=5600.155..5600.155 rows=1469 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 440kB
                           ->  Parallel Hash Join  (cost=805976.20..886003.55 rows=1 width=79) (actual time=5033.876..5554.310 rows=1469 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.052..449.886 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=805976.19..805976.19 rows=1 width=68) (actual time=5033.263..5033.263 rows=2371 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 664kB
                                       ->  Parallel Hash Join  (cost=305955.51..805976.19 rows=1 width=68) (actual time=3826.950..4949.630 rows=2371 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=270.268..2891.030 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=305955.50..305955.50 rows=1 width=60) (actual time=2004.679..2004.679 rows=3796 loops=3)
                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 984kB
                                                   ->  Parallel Hash Join  (cost=290685.23..305955.50 rows=1 width=60) (actual time=1793.396..1973.067 rows=3796 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.137..161.490 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.027..78.035 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.029 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=290682.79..290682.79 rows=1 width=51) (actual time=1790.761..1790.761 rows=4146 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 920kB
                                                               ->  Parallel Hash Join  (cost=51384.54..290682.79 rows=1 width=51) (actual time=1644.286..1771.064 rows=4146 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..239300.13 rows=144 width=47) (actual time=1105.635..1227.392 rows=10138 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=16278 width=51) (actual time=770.731..1222.868 rows=10267 loops=3)
                                                                                 Filter: ((info)::text = 'Horror'::text)
                                                                                 Rows Removed by Filter: 4934973
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.083..0.083 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.047..0.059 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'genres'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=51381.24..51381.24 rows=70 width=4) (actual time=538.510..538.510 rows=20699 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3480kB
                                                                           ->  Hash Join  (cost=3129.33..51381.24 rows=70 width=4) (actual time=33.097..474.979 rows=20699 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.043..252.402 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=3129.26..3129.26 rows=5 width=4) (actual time=32.931..32.931 rows=5 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..3129.26 rows=5 width=4) (actual time=0.988..32.907 rows=5 loops=3)
                                                                                             Filter: ((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))
                                                                                             Rows Removed by Filter: 134165
 Planning Time: 28.838 ms
 Execution Time: 5972.615 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25b.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=938224.64..938224.65 rows=1 width=128) (actual time=5822.340..5822.341 rows=1 loops=1)
   ->  Gather  (cost=938224.41..938224.62 rows=2 width=128) (actual time=5822.035..5829.471 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=937224.41..937224.42 rows=1 width=128) (actual time=5814.568..5814.568 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=857197.05..937224.40 rows=1 width=80) (actual time=5570.986..5814.542 rows=2 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.040..457.035 rows=579860 loops=3)
                           Filter: ((gender)::text = 'm'::text)
                           Rows Removed by Filter: 809304
                     ->  Parallel Hash  (cost=857197.04..857197.04 rows=1 width=69) (actual time=5300.066..5300.066 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=617898.78..857197.04 rows=1 width=69) (actual time=5286.564..5299.975 rows=2 loops=3)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..239300.13 rows=144 width=47) (actual time=1172.184..1297.920 rows=10138 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=16278 width=51) (actual time=817.035..1293.532 rows=10267 loops=3)
                                             Filter: ((info)::text = 'Horror'::text)
                                             Rows Removed by Filter: 4934973
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.019..0.031 rows=1 loops=3)
                                                   Filter: ((info)::text = 'genres'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=617896.35..617896.35 rows=1 width=42) (actual time=4000.367..4000.367 rows=2 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=602626.08..617896.35 rows=1 width=42) (actual time=3996.035..4000.303 rows=2 loops=3)
                                             Hash Cond: (mi_idx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.182..163.744 rows=153308 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.037..80.750 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.074..0.074 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.049 rows=1 loops=3)
                                                               Filter: ((info)::text = 'votes'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=602623.64..602623.64 rows=1 width=33) (actual time=3821.780..3821.781 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Parallel Hash Join  (cost=554371.45..602623.64 rows=1 width=33) (actual time=3808.659..3821.686 rows=2 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Hash Join  (cost=3129.33..51381.24 rows=70 width=4) (actual time=34.565..484.474 rows=20699 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.036..261.185 rows=1507977 loops=3)
                                                               ->  Hash  (cost=3129.26..3129.26 rows=5 width=4) (actual time=34.377..34.377 rows=5 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..3129.26 rows=5 width=4) (actual time=0.953..34.355 rows=5 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))
                                                                           Rows Removed by Filter: 134165
                                                         ->  Parallel Hash  (cost=551242.03..551242.03 rows=8 width=29) (actual time=3333.547..3333.548 rows=8 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=51800.14..551242.03 rows=8 width=29) (actual time=2175.859..3333.436 rows=8 loops=3)
                                                                     Hash Cond: (ci.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=205.374..3037.962 rows=414905 loops=3)
                                                                           Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                           Rows Removed by Filter: 11666543
                                                                     ->  Parallel Hash  (cost=51799.95..51799.95 rows=15 width=21) (actual time=252.460..252.461 rows=24 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=15 width=21) (actual time=8.259..252.362 rows=24 loops=3)
                                                                                 Filter: ((production_year > 2010) AND ((title)::text ~~ 'Vampire%'::text))
                                                                                 Rows Removed by Filter: 842746
 Planning Time: 29.253 ms
 Execution Time: 5830.277 ms
(62 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25c.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=968932.69..968932.70 rows=1 width=128) (actual time=6678.307..6678.307 rows=1 loops=1)
   ->  Gather  (cost=968932.46..968932.67 rows=2 width=128) (actual time=6675.986..6683.518 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=967932.46..967932.47 rows=1 width=128) (actual time=6668.989..6668.989 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=917449.32..967932.45 rows=1 width=80) (actual time=6313.348..6663.327 rows=8718 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.030..229.873 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=917449.31..917449.31 rows=1 width=79) (actual time=6307.109..6307.109 rows=8718 loops=3)
                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                           ->  Parallel Hash Join  (cost=837421.96..917449.31 rows=1 width=79) (actual time=5757.293..6274.259 rows=8718 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.055..444.131 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=837421.95..837421.95 rows=1 width=68) (actual time=5756.399..5756.399 rows=14300 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3992kB
                                       ->  Parallel Hash Join  (cost=337401.27..837421.95 rows=1 width=68) (actual time=4571.458..5715.758 rows=14300 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=166.474..2914.402 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=337401.26..337401.26 rows=1 width=60) (actual time=2734.080..2734.080 rows=21129 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4792kB
                                                   ->  Parallel Hash Join  (cost=322130.99..337401.26 rows=1 width=60) (actual time=2487.556..2677.215 rows=21129 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.136..160.792 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.030..76.873 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.027..0.030 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=322128.55..322128.55 rows=1 width=51) (actual time=2487.185..2487.185 rows=22680 loops=3)
                                                               Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                               ->  Parallel Hash Join  (cost=51720.34..322128.55 rows=1 width=51) (actual time=2214.138..2446.691 rows=22680 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1649.924..1864.806 rows=62198 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1043.669..1847.371 rows=62990 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                 Rows Removed by Filter: 4882250
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.085..0.085 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.048..0.060 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'genres'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=564.124..564.124 rows=25571 loops=3)
                                                                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                           ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=39.091..482.665 rows=25571 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.045..252.979 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=38.929..38.929 rows=7 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.132..38.902 rows=7 loops=3)
                                                                                             Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                             Rows Removed by Filter: 134163
 Planning Time: 28.220 ms
 Execution Time: 6684.961 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26a.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=722071.79..722071.80 rows=1 width=128) (actual time=7421.874..7421.874 rows=1 loops=1)
   ->  Hash Join  (cost=706649.20..722071.78 rows=1 width=53) (actual time=7329.926..7420.863 rows=1728 loops=1)
         Hash Cond: (t.kind_id = kt.id)
         ->  Hash Join  (cost=706648.10..722070.67 rows=1 width=57) (actual time=7271.350..7420.290 rows=1844 loops=1)
               Hash Cond: (mi_idx.info_type_id = it2.id)
               ->  Gather  (cost=706645.67..722068.24 rows=1 width=61) (actual time=7271.188..7530.904 rows=2580 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Parallel Hash Join  (cost=705645.67..721068.14 rows=1 width=61) (actual time=7266.035..7405.912 rows=860 loops=3)
                           Hash Cond: (mi_idx.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=79942 width=13) (actual time=0.059..136.808 rows=64632 loops=3)
                                 Filter: ((info)::text > '7.0'::text)
                                 Rows Removed by Filter: 395380
                           ->  Parallel Hash  (cost=705645.66..705645.66 rows=1 width=68) (actual time=7258.618..7258.618 rows=1906 loops=3)
                                 Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 728kB
                                 ->  Parallel Hash Join  (cost=648661.37..705645.66 rows=1 width=68) (actual time=6694.149..7195.868 rows=1906 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.059..479.279 rows=60051 loops=3)
                                             Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                             Rows Removed by Filter: 986729
                                       ->  Parallel Hash  (cost=648661.29..648661.29 rows=6 width=56) (actual time=6693.927..6693.927 rows=69092 loops=3)
                                             Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 9560kB
                                             ->  Parallel Hash Join  (cost=569172.01..648661.29 rows=6 width=56) (actual time=6230.933..6643.885 rows=69092 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.056..396.646 rows=1389164 loops=3)
                                                   ->  Parallel Hash  (cost=569171.94..569171.94 rows=6 width=45) (actual time=5310.407..5310.407 rows=69092 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2560kB
                                                         ->  Parallel Hash Join  (cost=108834.99..569171.94 rows=6 width=45) (actual time=1019.600..5100.256 rows=69092 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.044..2293.584 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=108834.98..108834.98 rows=1 width=33) (actual time=1019.169..1019.169 rows=532 loops=3)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                     ->  Hash Join  (cost=58439.25..108834.98 rows=1 width=33) (actual time=530.158..1015.119 rows=532 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Hash Join  (cost=54471.30..104857.99 rows=3441 width=37) (actual time=474.976..956.364 rows=121797 loops=3)
                                                                                 Hash Cond: (mk.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.042..258.857 rows=1507977 loops=3)
                                                                                 ->  Parallel Hash  (cost=54447.27..54447.27 rows=1923 width=29) (actual time=474.519..474.519 rows=7852 loops=3)
                                                                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2016kB
                                                                                       ->  Hash Join  (cost=3102.42..54447.27 rows=1923 width=29) (actual time=95.193..444.589 rows=7852 loops=3)
                                                                                             Hash Cond: (t.id = cc.movie_id)
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.060..281.214 rows=460484 loops=3)
                                                                                                   Filter: (production_year > 2000)
                                                                                                   Rows Removed by Filter: 382286
                                                                                             ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=94.740..94.740 rows=85941 loops=3)
                                                                                                   Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                                                                                   ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.223..67.618 rows=85941 loops=3)
                                                                                                         Hash Cond: (cc.status_id = cct2.id)
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.120..49.345 rows=85941 loops=3)
                                                                                                               Hash Cond: (cc.subject_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.021..18.582 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.020..0.022 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'cast'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.041..0.042 rows=2 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.027..0.029 rows=2 loops=3)
                                                                                                                     Filter: ((kind)::text ~~ '%complete%'::text)
                                                                                                                     Rows Removed by Filter: 2
                                                                           ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=47.084..47.084 rows=10 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.197..47.046 rows=10 loops=3)
                                                                                       Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                                       Rows Removed by Filter: 134160
               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.025 rows=1 loops=1)
                           Filter: ((info)::text = 'rating'::text)
                           Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.023..0.025 rows=1 loops=1)
                     Filter: ((kind)::text = 'movie'::text)
                     Rows Removed by Filter: 6
 Planning Time: 86.553 ms
 Execution Time: 7534.593 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26b.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=719517.69..719517.70 rows=1 width=96) (actual time=6371.467..6371.467 rows=1 loops=1)
   ->  Hash Join  (cost=662439.50..719517.69 rows=1 width=38) (actual time=5889.641..6371.392 rows=93 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=662438.44..719516.62 rows=1 width=42) (actual time=5889.541..6371.267 rows=93 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=662437.38..719515.56 rows=1 width=46) (actual time=5889.461..6371.151 rows=180 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=658006.94..714423.11 rows=1 width=54) (actual time=5810.174..6285.060 rows=191 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=657006.94..713423.01 rows=1 width=54) (actual time=5801.917..6276.424 rows=64 loops=3)
                                 Hash Cond: (chn.id = ci.person_role_id)
                                 ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.052..464.006 rows=60051 loops=3)
                                       Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                       Rows Removed by Filter: 986729
                                 ->  Parallel Hash  (cost=657006.93..657006.93 rows=1 width=42) (actual time=5798.724..5798.724 rows=2660 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                       ->  Hash Join  (cost=577517.63..657006.93 rows=1 width=42) (actual time=4997.533..5569.126 rows=2660 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Hash Join  (cost=577515.21..657004.49 rows=6 width=46) (actual time=4997.415..5567.001 rows=5809 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.040..364.932 rows=1389164 loops=3)
                                                   ->  Parallel Hash  (cost=577515.13..577515.13 rows=6 width=50) (actual time=4996.981..4996.981 rows=5809 loops=3)
                                                         Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2136kB
                                                         ->  Parallel Hash Join  (cost=117178.19..577515.13 rows=6 width=50) (actual time=1087.600..4705.839 rows=5809 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.030..2089.163 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=117178.17..117178.17 rows=1 width=38) (actual time=1086.483..1086.483 rows=39 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=101980.10..117178.17 rows=1 width=38) (actual time=1007.865..1086.371 rows=39 loops=3)
                                                                           Hash Cond: (mi_idx.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.066..127.777 rows=17883 loops=3)
                                                                                 Filter: ((info)::text > '8.0'::text)
                                                                                 Rows Removed by Filter: 442129
                                                                           ->  Parallel Hash  (cost=101980.06..101980.06 rows=3 width=25) (actual time=954.683..954.683 rows=480 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Hash Join  (cost=51215.31..101980.06 rows=3 width=25) (actual time=844.626..954.087 rows=480 loops=3)
                                                                                       Hash Cond: (t.kind_id = kt.id)
                                                                                       ->  Parallel Hash Join  (cost=51214.21..101978.87 rows=23 width=29) (actual time=641.940..953.568 rows=1008 loops=3)
                                                                                             Hash Cond: (t.id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.034..268.553 rows=337640 loops=3)
                                                                                                   Filter: (production_year > 2005)
                                                                                                   Rows Removed by Filter: 505131
                                                                                             ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=638.745..638.746 rows=3328 loops=3)
                                                                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                                                                   ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=30.531..464.727 rows=3328 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.048..249.938 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=30.188..30.188 rows=4 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.131..30.164 rows=4 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,fight}'::text[]))
                                                                                                                     Rows Removed by Filter: 134166
                                                                                       ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.042..0.042 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=3)
                                                                                                   Filter: ((kind)::text = 'movie'::text)
                                                                                                   Rows Removed by Filter: 6
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.048..0.050 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.182..69.182 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.015..27.474 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.027..0.028 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.014..0.016 rows=2 loops=1)
                     Filter: ((kind)::text ~~ '%complete%'::text)
                     Rows Removed by Filter: 2
 Planning Time: 86.301 ms
 Execution Time: 6373.277 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26c.sql_explained.sql
SET
SET
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=722078.21..722078.22 rows=1 width=96) (actual time=8319.309..8319.309 rows=1 loops=1)
   ->  Hash Join  (cost=665321.10..722078.20 rows=1 width=38) (actual time=7824.659..8316.255 rows=5400 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Gather  (cost=665320.04..722077.14 rows=1 width=42) (actual time=7824.574..8466.223 rows=6359 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=664320.04..721077.04 rows=1 width=42) (actual time=7817.204..8304.344 rows=2120 loops=3)
                     Hash Cond: (chn.id = ci.person_role_id)
                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.056..468.356 rows=60051 loops=3)
                           Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                           Rows Removed by Filter: 986729
                     ->  Parallel Hash  (cost=664319.99..664319.99 rows=4 width=30) (actual time=7816.187..7816.187 rows=73556 loops=3)
                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 7384kB
                           ->  Parallel Hash Join  (cost=584830.72..664319.99 rows=4 width=30) (actual time=7391.895..7777.693 rows=73556 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.040..388.508 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=584830.67..584830.67 rows=4 width=34) (actual time=6488.484..6488.484 rows=73556 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2304kB
                                       ->  Hash Join  (cost=533504.83..584830.67 rows=4 width=34) (actual time=6174.789..6397.521 rows=73556 loops=3)
                                             Hash Cond: (t.kind_id = kt.id)
                                             ->  Parallel Hash Join  (cost=533503.73..584829.46 rows=26 width=38) (actual time=6172.349..6379.692 rows=81357 loops=3)
                                                   Hash Cond: (t.id = mk.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.044..283.492 rows=460484 loops=3)
                                                         Filter: (production_year > 2000)
                                                         Rows Removed by Filter: 382286
                                                   ->  Parallel Hash  (cost=533503.13..533503.13 rows=48 width=33) (actual time=5698.198..5698.198 rows=232511 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 3616kB
                                                         ->  Hash Join  (cost=72499.97..533503.13 rows=48 width=33) (actual time=835.356..5409.191 rows=232511 loops=3)
                                                               Hash Cond: (cc.status_id = cct2.id)
                                                               ->  Hash Join  (cost=72498.91..533501.03 rows=192 width=37) (actual time=835.252..5341.455 rows=232511 loops=3)
                                                                     Hash Cond: (mk.movie_id = cc.movie_id)
                                                                     ->  Parallel Hash Join  (cost=68068.47..528405.98 rows=138 width=25) (actual time=764.312..4936.843 rows=360905 loops=3)
                                                                           Hash Cond: (ci.movie_id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.029..2216.326 rows=12081448 loops=3)
                                                                           ->  Parallel Hash  (cost=68068.42..68068.42 rows=4 width=13) (actual time=764.130..764.130 rows=6392 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                                 ->  Hash Join  (cost=52224.04..68068.42 rows=4 width=13) (actual time=592.748..743.356 rows=6392 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Hash Join  (cost=52221.61..68064.84 rows=426 width=17) (actual time=592.624..740.216 rows=19234 loops=3)
                                                                                             Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.031..77.694 rows=460012 loops=3)
                                                                                             ->  Parallel Hash  (cost=52219.86..52219.86 rows=140 width=4) (actual time=592.191..592.191 rows=8030 loops=3)
                                                                                                   Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                                                                   ->  Hash Join  (cost=3967.95..52219.86 rows=140 width=4) (actual time=45.550..485.826 rows=8030 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.039..250.550 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=45.259..45.260 rows=10 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.206..45.231 rows=10 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                                                                     Rows Removed by Filter: 134160
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.053..0.056 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=68.183..68.183 rows=135086 loops=3)
                                                                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.021..27.042 rows=135086 loops=3)
                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.045..0.045 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.034 rows=2 loops=3)
                                                                           Filter: ((kind)::text ~~ '%complete%'::text)
                                                                           Rows Removed by Filter: 2
                                             ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.032..0.033 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'movie'::text)
                                                         Rows Removed by Filter: 6
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.023..0.024 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.011..0.013 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 85.277 ms
 Execution Time: 8473.618 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27a.sql_explained.sql
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=62724.94..62724.95 rows=1 width=96) (actual time=307.077..307.078 rows=1 loops=1)
   ->  Merge Join  (cost=26778.72..62724.94 rows=1 width=118) (actual time=306.227..306.880 rows=477 loops=1)
         Merge Cond: (mi.movie_id = ml.movie_id)
         ->  Gather Merge  (cost=1000.46..988404.79 rows=132912 width=4) (actual time=9.152..20.808 rows=2822 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..972063.42 rows=55380 width=4) (actual time=1.449..152.450 rows=1126 loops=3)
                     Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                     Rows Removed by Filter: 148910
         ->  Sort  (cost=25778.26..25778.26 rows=1 width=138) (actual time=296.655..296.685 rows=475 loops=1)
               Sort Key: t.id
               Sort Method: quicksort  Memory: 49kB
               ->  Hash Join  (cost=22622.22..25778.25 rows=1 width=138) (actual time=272.979..296.460 rows=172 loops=1)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Merge Join  (cost=19996.08..23150.40 rows=652 width=142) (actual time=250.986..277.159 rows=3278 loops=1)
                           Merge Cond: (mk.movie_id = ml.movie_id)
                           ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.030..20.177 rows=69431 loops=1)
                           ->  Sort  (cost=19995.65..19995.68 rows=14 width=134) (actual time=248.097..248.304 rows=3270 loops=1)
                                 Sort Key: t.id
                                 Sort Method: quicksort  Memory: 62kB
                                 ->  Hash Join  (cost=19698.66..19995.38 rows=14 width=134) (actual time=245.156..247.864 rows=269 loops=1)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Hash Join  (cost=19697.58..19994.16 rows=27 width=138) (actual time=245.066..247.702 rows=269 loops=1)
                                             Hash Cond: (cc.status_id = cct2.id)
                                             ->  Merge Join  (cost=19696.52..19992.51 rows=109 width=142) (actual time=244.989..247.538 rows=333 loops=1)
                                                   Merge Cond: (cc.movie_id = ml.movie_id)
                                                   ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.034..2.186 rows=5140 loops=1)
                                                   ->  Sort  (cost=19696.10..19696.27 rows=69 width=130) (actual time=244.542..244.594 rows=756 loops=1)
                                                         Sort Key: t.id
                                                         Sort Method: quicksort  Memory: 120kB
                                                         ->  Gather  (cost=7378.71..19693.99 rows=69 width=130) (actual time=124.087..245.422 rows=698 loops=1)
                                                               Workers Planned: 2
                                                               Workers Launched: 2
                                                               ->  Parallel Hash Join  (cost=6378.71..18687.09 rows=29 width=130) (actual time=120.133..236.391 rows=233 loops=3)
                                                                     Hash Cond: (mc.company_id = cn.id)
                                                                     ->  Hash Join  (cost=652.57..12960.52 rows=160 width=115) (actual time=23.206..172.546 rows=931 loops=3)
                                                                           Hash Cond: (mc.company_type_id = ct.id)
                                                                           ->  Merge Join  (cost=651.50..12956.00 rows=640 width=119) (actual time=23.067..172.039 rows=1104 loops=3)
                                                                                 Merge Cond: (ml.movie_id = mc.movie_id)
                                                                                 ->  Merge Join  (cost=651.07..7725.24 rows=250 width=107) (actual time=20.263..126.535 rows=444 loops=3)
                                                                                       Merge Cond: (t.id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=379985 width=21) (actual time=0.746..111.283 rows=19945 loops=3)
                                                                                             Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                                                                             Rows Removed by Filter: 42153
                                                                                       ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.788..12.974 rows=2315 loops=3)
                                                                                             Sort Key: ml.movie_id
                                                                                             Sort Method: quicksort  Memory: 205kB
                                                                                             Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                             Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                                                             ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.151..11.502 rows=2315 loops=3)
                                                                                                   Hash Cond: (ml.link_type_id = lt.id)
                                                                                                   ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.033..7.103 rows=29997 loops=3)
                                                                                                   ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.056..0.056 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.039..0.045 rows=2 loops=3)
                                                                                                               Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                               Rows Removed by Filter: 16
                                                                                 ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.063..41.880 rows=42233 loops=3)
                                                                                       Filter: (note IS NULL)
                                                                                       Rows Removed by Filter: 42715
                                                                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.080..0.080 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.068..0.070 rows=1 loops=3)
                                                                                       Filter: ((kind)::text = 'production companies'::text)
                                                                                       Rows Removed by Filter: 3
                                                                     ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=62.362..62.362 rows=16101 loops=3)
                                                                           Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.074..50.369 rows=16101 loops=3)
                                                                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                                 Rows Removed by Filter: 62232
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                                                         Filter: ((kind)::text = 'complete'::text)
                                                         Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.036..0.036 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.022..0.025 rows=2 loops=1)
                                                   Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                                                   Rows Removed by Filter: 2
                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.906..18.906 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.088..18.895 rows=1 loops=1)
                                 Filter: ((keyword)::text = 'sequel'::text)
                                 Rows Removed by Filter: 134169
 Planning Time: 84.370 ms
 Execution Time: 320.264 ms
(87 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27b.sql_explained.sql
SET
SET
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=62047.93..62047.94 rows=1 width=96) (actual time=510.687..510.687 rows=1 loops=1)
   ->  Hash Join  (cost=58902.55..62047.92 rows=1 width=118) (actual time=509.834..510.548 rows=247 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=56276.42..59421.66 rows=47 width=122) (actual time=490.079..490.721 rows=1919 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.031..19.190 rows=69431 loops=1)
               ->  Materialize  (cost=56275.98..56275.99 rows=1 width=138) (actual time=463.107..463.331 rows=1911 loops=1)
                     ->  Sort  (cost=56275.98..56275.99 rows=1 width=138) (actual time=463.095..463.112 rows=247 loops=1)
                           Sort Key: t.id
                           Sort Method: quicksort  Memory: 59kB
                           ->  Hash Join  (cost=55981.58..56275.97 rows=1 width=138) (actual time=462.430..462.831 rows=247 loops=1)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Hash Join  (cost=55980.51..56274.91 rows=1 width=142) (actual time=462.355..462.675 rows=418 loops=1)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Merge Join  (cost=55979.44..56273.83 rows=2 width=146) (actual time=462.275..462.482 rows=418 loops=1)
                                             Merge Cond: (cc.movie_id = ml.movie_id)
                                             ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.041..1.964 rows=4705 loops=1)
                                             ->  Sort  (cost=55979.02..55979.02 rows=1 width=134) (actual time=459.712..459.778 rows=908 loops=1)
                                                   Sort Key: t.id
                                                   Sort Method: quicksort  Memory: 128kB
                                                   ->  Gather  (cost=50471.19..55979.01 rows=1 width=134) (actual time=397.392..459.643 rows=737 loops=1)
                                                         Workers Planned: 1
                                                         Workers Launched: 1
                                                         ->  Parallel Hash Join  (cost=49471.19..54978.91 rows=1 width=134) (actual time=397.576..453.904 rows=368 loops=2)
                                                               Hash Cond: (cn.id = mc.company_id)
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.040..60.437 rows=24151 loops=2)
                                                                     Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                     Rows Removed by Filter: 93348
                                                               ->  Parallel Hash  (cost=49471.16..49471.16 rows=3 width=119) (actual time=389.558..389.558 rows=718 loops=2)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                                                     ->  Hash Join  (cost=653.00..49471.16 rows=3 width=119) (actual time=245.455..358.009 rows=718 loops=2)
                                                                           Hash Cond: (mc.company_type_id = ct.id)
                                                                           ->  Merge Join  (cost=651.94..49470.03 rows=13 width=123) (actual time=245.359..357.690 rows=736 loops=2)
                                                                                 Merge Cond: (ml.movie_id = mc.movie_id)
                                                                                 ->  Merge Join  (cost=651.51..44246.14 rows=5 width=111) (actual time=227.159..332.760 rows=151 loops=2)
                                                                                       Merge Cond: (mi.movie_id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..972063.42 rows=55380 width=4) (actual time=1.394..137.130 rows=1440 loops=2)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                                                                                             Rows Removed by Filter: 187318
                                                                                       ->  Materialize  (cost=651.07..8854.49 rows=33 width=107) (actual time=25.264..195.364 rows=235 loops=2)
                                                                                             ->  Merge Join  (cost=651.07..8854.40 rows=33 width=107) (actual time=25.253..195.250 rows=141 loops=2)
                                                                                                   Merge Cond: (t.id = ml.movie_id)
                                                                                                   ->  Index Scan using title_pkey on title t  (cost=0.43..108402.95 rows=50313 width=21) (actual time=3.265..184.003 rows=4216 loops=2)
                                                                                                         Filter: (production_year = 1998)
                                                                                                         Rows Removed by Filter: 182255
                                                                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.338..10.515 rows=2315 loops=2)
                                                                                                         Sort Key: ml.movie_id
                                                                                                         Sort Method: quicksort  Memory: 205kB
                                                                                                         Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.126..9.091 rows=2315 loops=2)
                                                                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.023..4.821 rows=29997 loops=2)
                                                                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.040..0.040 rows=2 loops=2)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.018..0.023 rows=2 loops=2)
                                                                                                                           Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                                           Rows Removed by Filter: 16
                                                                                 ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.017..22.274 rows=34556 loops=2)
                                                                                       Filter: (note IS NULL)
                                                                                       Rows Removed by Filter: 35332
                                                                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.030..0.031 rows=1 loops=2)
                                                                                       Filter: ((kind)::text = 'production companies'::text)
                                                                                       Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.025..0.025 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.010..0.012 rows=2 loops=1)
                                                   Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                                                   Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.026..0.026 rows=1 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.014..0.015 rows=1 loops=1)
                                             Filter: ((kind)::text = 'complete'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.551..19.551 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.113..19.539 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 85.427 ms
 Execution Time: 512.032 ms
(82 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=64696.47..64696.48 rows=1 width=96) (actual time=554.899..554.900 rows=1 loops=1)
   ->  Hash Join  (cost=61522.37..64696.47 rows=1 width=118) (actual time=530.536..554.597 rows=743 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=58896.24..62065.93 rows=1677 width=122) (actual time=508.455..534.076 rows=11620 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.032..17.170 rows=69431 loops=1)
               ->  Sort  (cost=58895.80..58895.89 rows=36 width=138) (actual time=505.952..506.669 rows=11612 loops=1)
                     Sort Key: ml.movie_id
                     Sort Method: quicksort  Memory: 210kB
                     ->  Hash Join  (cost=58588.08..58894.87 rows=36 width=138) (actual time=500.713..504.980 rows=1150 loops=1)
                           Hash Cond: (cc.subject_id = cct1.id)
                           ->  Hash Join  (cost=58587.01..58893.03 rows=143 width=142) (actual time=500.641..504.581 rows=1436 loops=1)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Merge Join  (cost=58585.95..58888.88 rows=572 width=146) (actual time=500.565..504.110 rows=1436 loops=1)
                                       Merge Cond: (cc.movie_id = ml.movie_id)
                                       ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.035..2.244 rows=5142 loops=1)
                                       ->  Sort  (cost=58585.52..58586.43 rows=363 width=134) (actual time=500.154..500.485 rows=4252 loops=1)
                                             Sort Key: ml.movie_id
                                             Sort Method: quicksort  Memory: 654kB
                                             ->  Gather  (cost=7421.33..58570.09 rows=363 width=134) (actual time=91.497..499.508 rows=3966 loops=1)
                                                   Workers Planned: 2
                                                   Workers Launched: 2
                                                   ->  Hash Join  (cost=6421.33..57533.79 rows=151 width=134) (actual time=88.827..465.795 rows=1322 loops=3)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Parallel Hash Join  (cost=6420.26..57529.46 rows=605 width=138) (actual time=88.635..465.170 rows=1361 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Merge Join  (cost=694.11..51794.52 rows=3349 width=123) (actual time=13.685..413.541 rows=3944 loops=3)
                                                                     Merge Cond: (ml.movie_id = mc.movie_id)
                                                                     ->  Merge Join  (cost=693.68..46534.00 rows=1310 width=111) (actual time=13.505..373.723 rows=1247 loops=3)
                                                                           Merge Cond: (ml.movie_id = t.id)
                                                                           ->  Merge Join  (cost=651.07..37496.27 rows=1747 width=90) (actual time=10.878..165.033 rows=1288 loops=3)
                                                                                 Merge Cond: (mi.movie_id = ml.movie_id)
                                                                                 ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1010698.11 rows=372351 width=4) (actual time=0.150..153.103 rows=11321 loops=3)
                                                                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))
                                                                                       Rows Removed by Filter: 160210
                                                                                 ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=9.593..9.846 rows=2956 loops=3)
                                                                                       Sort Key: ml.movie_id
                                                                                       Sort Method: quicksort  Memory: 205kB
                                                                                       Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                       Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.124..8.371 rows=2315 loops=3)
                                                                                             Hash Cond: (ml.link_type_id = lt.id)
                                                                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.028..4.142 rows=29997 loops=3)
                                                                                             ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.037..0.037 rows=2 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.020..0.025 rows=2 loops=3)
                                                                                                         Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                         Rows Removed by Filter: 16
                                                                           ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=1895923 width=21) (actual time=0.033..197.544 rows=133937 loops=3)
                                                                                 Filter: ((production_year >= 1950) AND (production_year <= 2010))
                                                                                 Rows Removed by Filter: 37735
                                                                     ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.025..35.310 rows=47778 loops=3)
                                                                           Filter: (note IS NULL)
                                                                           Rows Removed by Filter: 47336
                                                               ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=49.462..49.462 rows=16101 loops=3)
                                                                     Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.022..39.001 rows=16101 loops=3)
                                                                           Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                           Rows Removed by Filter: 62232
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.060..0.061 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=3)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.023..0.023 rows=2 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.010..0.012 rows=2 loops=1)
                                             Filter: ((kind)::text ~~ 'complete%'::text)
                                             Rows Removed by Filter: 2
                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.025..0.025 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=1)
                                       Filter: ((kind)::text = 'cast'::text)
                                       Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.367..19.367 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.108..19.355 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 85.297 ms
 Execution Time: 557.640 ms
(81 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28a.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=468295.89..468295.90 rows=1 width=96) (actual time=3958.739..3958.739 rows=1 loops=1)
   ->  Hash Join  (cost=451069.27..468295.88 rows=1 width=41) (actual time=3780.815..3956.758 rows=4803 loops=1)
         Hash Cond: (mi_idx.info_type_id = it2.id)
         ->  Gather  (cost=451066.84..468293.45 rows=1 width=45) (actual time=3780.686..3960.240 rows=15325 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=450066.84..467293.35 rows=1 width=45) (actual time=3758.401..3944.748 rows=5108 loops=3)
                     Hash Cond: (mi_idx.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.083..155.849 rows=447629 loops=3)
                           Filter: ((info)::text < '8.5'::text)
                           Rows Removed by Filter: 12383
                     ->  Parallel Hash  (cost=450066.83..450066.83 rows=1 width=56) (actual time=3739.268..3739.268 rows=1704 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                           ->  Hash Join  (cost=147280.54..450066.83 rows=1 width=56) (actual time=3255.983..3733.925 rows=1704 loops=3)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Hash Join  (cost=147279.45..450065.74 rows=1 width=60) (actual time=3255.871..3733.305 rows=2155 loops=3)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Hash Join  (cost=147278.39..450064.67 rows=1 width=64) (actual time=3247.952..3731.463 rows=13930 loops=3)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Hash Join  (cost=142847.96..444972.22 rows=1 width=52) (actual time=3165.511..3630.563 rows=15212 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=142845.53..444969.79 rows=1 width=56) (actual time=1361.970..3626.237 rows=17574 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.001..2227.626 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Parallel Hash  (cost=142845.52..142845.52 rows=1 width=48) (actual time=1354.051..1354.051 rows=16473 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5176kB
                                                               ->  Parallel Hash Join  (cost=137845.48..142845.52 rows=1 width=48) (actual time=1292.297..1337.183 rows=16473 loops=3)
                                                                     Hash Cond: (cn.id = mc.company_id)
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.034..32.230 rows=42077 loops=3)
                                                                           Filter: ((country_code)::text <> '[us]'::text)
                                                                           Rows Removed by Filter: 36256
                                                                     ->  Parallel Hash  (cost=137845.47..137845.47 rows=1 width=33) (actual time=1292.156..1292.156 rows=17485 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4504kB
                                                                           ->  Hash Join  (cost=102542.40..137845.47 rows=1 width=33) (actual time=977.869..1267.061 rows=17485 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=102541.31..137844.38 rows=1 width=37) (actual time=977.768..1262.440 rows=17485 loops=3)
                                                                                       Hash Cond: (mc.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.012..267.903 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=102541.20..102541.20 rows=9 width=25) (actual time=976.205..976.206 rows=3895 loops=3)
                                                                                             Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 984kB
                                                                                             ->  Hash Join  (cost=51215.33..102541.20 rows=9 width=25) (actual time=594.287..929.479 rows=3895 loops=3)
                                                                                                   Hash Cond: (t.kind_id = kt.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..102539.96 rows=31 width=29) (actual time=593.205..927.485 rows=4924 loops=3)
                                                                                                         Hash Cond: (t.id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.011..269.095 rows=460484 loops=3)
                                                                                                               Filter: (production_year > 2000)
                                                                                                               Rows Removed by Filter: 382286
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=592.839..592.839 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=46.364..486.746 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..252.556 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=46.068..46.068 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.682..46.047 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.076..0.077 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.061..0.064 rows=2 loops=3)
                                                                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                                                                               Rows Removed by Filter: 5
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.047..0.047 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.030..0.031 rows=4 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.069..0.069 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.056 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=71.225..71.225 rows=135086 loops=3)
                                                   Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.022..30.125 rows=135086 loops=3)
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.029..0.029 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.015..0.017 rows=1 loops=3)
                                                   Filter: ((kind)::text = 'crew'::text)
                                                   Rows Removed by Filter: 3
                                 ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.062..0.062 rows=3 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=3 width=4) (actual time=0.037..0.039 rows=3 loops=3)
                                             Filter: ((kind)::text <> 'complete+verified'::text)
                                             Rows Removed by Filter: 1
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 109.551 ms
 Execution Time: 3965.907 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28b.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=418889.66..418889.67 rows=1 width=96) (actual time=3093.565..3093.565 rows=1 loops=1)
   ->  Hash Join  (cost=403298.67..418889.65 rows=1 width=41) (actual time=3058.692..3093.479 rows=148 loops=1)
         Hash Cond: (mi_idx.info_type_id = it2.id)
         ->  Gather  (cost=403296.25..418887.22 rows=1 width=45) (actual time=3058.571..3100.300 rows=224 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=402296.25..417887.12 rows=1 width=45) (actual time=2992.113..3085.138 rows=75 loops=3)
                     Hash Cond: (mi_idx.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=124848 width=13) (actual time=0.045..137.394 rows=99992 loops=3)
                           Filter: ((info)::text > '6.5'::text)
                           Rows Removed by Filter: 360020
                     ->  Parallel Hash  (cost=402296.24..402296.24 rows=1 width=56) (actual time=2935.845..2935.846 rows=70 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=350869.64..402296.24 rows=1 width=56) (actual time=2921.166..2935.529 rows=70 loops=3)
                                 Hash Cond: (cc.subject_id = cct1.id)
                                 ->  Hash Join  (cost=350868.57..402295.17 rows=1 width=60) (actual time=2842.632..2935.342 rows=544 loops=3)
                                       Hash Cond: (cc.status_id = cct2.id)
                                       ->  Hash Join  (cost=350867.49..402294.08 rows=1 width=64) (actual time=2831.190..2935.043 rows=1108 loops=3)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Hash Join  (cost=346437.05..397201.63 rows=1 width=52) (actual time=2557.573..2847.754 rows=1608 loops=3)
                                                   Hash Cond: (t.kind_id = kt.id)
                                                   ->  Parallel Hash Join  (cost=346435.94..397200.52 rows=1 width=56) (actual time=2554.435..2847.169 rows=1675 loops=3)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.008..258.450 rows=337640 loops=3)
                                                               Filter: (production_year > 2005)
                                                               Rows Removed by Filter: 505131
                                                         ->  Parallel Hash  (cost=346435.93..346435.93 rows=1 width=31) (actual time=2545.274..2545.274 rows=4086 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1080kB
                                                               ->  Parallel Hash Join  (cost=341435.89..346435.93 rows=1 width=31) (actual time=2517.538..2541.212 rows=4086 loops=3)
                                                                     Hash Cond: (cn.id = mc.company_id)
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.008..17.748 rows=42077 loops=3)
                                                                           Filter: ((country_code)::text <> '[us]'::text)
                                                                           Rows Removed by Filter: 36256
                                                                     ->  Parallel Hash  (cost=341435.88..341435.88 rows=1 width=16) (actual time=2517.401..2517.401 rows=4250 loops=3)
                                                                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                           ->  Hash Join  (cost=306132.81..341435.88 rows=1 width=16) (actual time=2205.105..2483.232 rows=4250 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=306131.72..341434.79 rows=1 width=20) (actual time=2205.001..2482.052 rows=4250 loops=3)
                                                                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.015..264.799 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=306131.71..306131.71 rows=1 width=8) (actual time=2201.995..2201.995 rows=653 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Hash Join  (cost=51216.64..306131.71 rows=1 width=8) (actual time=1906.734..2201.444 rows=653 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..306129.23 rows=21 width=12) (actual time=575.309..2200.885 rows=1510 loops=3)
                                                                                                         Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=55380 width=8) (actual time=0.798..1615.552 rows=44746 loops=3)
                                                                                                               Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                                                                                                               Rows Removed by Filter: 4900494
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=573.507..573.507 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=33.729..472.258 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..250.893 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=33.549..33.549 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.461..33.531 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.030..0.041 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'countries'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.048..0.048 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.030..0.032 rows=4 loops=3)
                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.081..0.081 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.064..0.067 rows=2 loops=3)
                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                               Rows Removed by Filter: 5
                                             ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=68.711..68.711 rows=135086 loops=3)
                                                   Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.022..27.210 rows=135086 loops=3)
                                       ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.024..0.024 rows=3 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=3 width=4) (actual time=0.008..0.010 rows=3 loops=3)
                                                   Filter: ((kind)::text <> 'complete+verified'::text)
                                                   Rows Removed by Filter: 1
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.065..0.066 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.042..0.043 rows=1 loops=3)
                                             Filter: ((kind)::text = 'crew'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.023..0.025 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 110.980 ms
 Execution Time: 3101.603 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28c.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=467734.71..467734.72 rows=1 width=96) (actual time=3881.760..3881.761 rows=1 loops=1)
   ->  Hash Join  (cost=449846.07..467734.70 rows=1 width=41) (actual time=3649.010..3878.140 rows=8373 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=449845.01..467733.64 rows=1 width=45) (actual time=3648.912..3875.248 rows=15126 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=449843.95..467732.57 rows=1 width=49) (actual time=3648.832..3871.162 rows=16719 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=445413.51..462640.12 rows=1 width=61) (actual time=3553.951..3767.405 rows=21489 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=445411.09..462637.70 rows=1 width=65) (actual time=3553.834..3756.295 rows=64628 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=444411.09..461637.60 rows=1 width=65) (actual time=3547.693..3747.209 rows=21543 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=1.248..156.811 rows=447629 loops=3)
                                             Filter: ((info)::text < '8.5'::text)
                                             Rows Removed by Filter: 12383
                                       ->  Parallel Hash  (cost=444411.07..444411.07 rows=1 width=52) (actual time=3534.152..3534.152 rows=7276 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2456kB
                                             ->  Hash Join  (cost=142286.81..444411.07 rows=1 width=52) (actual time=3060.081..3512.578 rows=7276 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=142284.38..444408.65 rows=1 width=56) (actual time=1285.511..3510.407 rows=8340 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=0.966..2207.426 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Parallel Hash  (cost=142284.37..142284.37 rows=1 width=48) (actual time=1266.126..1266.126 rows=7967 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2552kB
                                                               ->  Hash Join  (cost=137284.33..142284.37 rows=1 width=48) (actual time=1224.464..1257.311 rows=7967 loops=3)
                                                                     Hash Cond: (mc.company_type_id = ct.id)
                                                                     ->  Parallel Hash Join  (cost=137283.24..142283.28 rows=1 width=52) (actual time=1224.360..1255.218 rows=7967 loops=3)
                                                                           Hash Cond: (cn.id = mc.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.008..21.977 rows=42077 loops=3)
                                                                                 Filter: ((country_code)::text <> '[us]'::text)
                                                                                 Rows Removed by Filter: 36256
                                                                           ->  Parallel Hash  (cost=137283.23..137283.23 rows=1 width=37) (actual time=1224.247..1224.247 rows=8618 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2328kB
                                                                                 ->  Parallel Hash Join  (cost=101980.16..137283.23 rows=1 width=37) (actual time=922.688..1197.314 rows=8618 loops=3)
                                                                                       Hash Cond: (mc.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.031..264.498 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=101980.08..101980.08 rows=7 width=25) (actual time=916.579..916.579 rows=2691 loops=3)
                                                                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                                                                                             ->  Hash Join  (cost=51215.33..101980.08 rows=7 width=25) (actual time=557.290..874.488 rows=2691 loops=3)
                                                                                                   Hash Cond: (t.kind_id = kt.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..101978.87 rows=23 width=29) (actual time=557.112..873.125 rows=3246 loops=3)
                                                                                                         Hash Cond: (t.id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.033..267.079 rows=337640 loops=3)
                                                                                                               Filter: (production_year > 2005)
                                                                                                               Rows Removed by Filter: 505131
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=556.268..556.268 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=33.480..472.205 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..251.888 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=33.279..33.279 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.479..33.263 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.065..0.065 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.046..0.049 rows=2 loops=3)
                                                                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                                                                               Rows Removed by Filter: 5
                                                                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.044..0.044 rows=4 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.029..0.030 rows=4 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.049 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.030..0.033 rows=1 loops=1)
                                       Filter: ((info)::text = 'rating'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=68.912..68.912 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.022..27.642 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.027..0.027 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.025..0.025 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=1)
                     Filter: ((kind)::text = 'complete'::text)
                     Rows Removed by Filter: 3
 Planning Time: 109.613 ms
 Execution Time: 3885.095 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29a.sql_explained.sql
SET
SET
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1085189.97..1085189.98 rows=1 width=96) (actual time=8718.316..8718.316 rows=1 loops=1)
   ->  Hash Join  (cost=1002792.89..1085189.96 rows=1 width=48) (actual time=8674.264..8717.831 rows=1620 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=1002791.82..1085188.89 rows=1 width=52) (actual time=8674.145..8717.321 rows=1620 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=1002790.76..1085187.83 rows=1 width=56) (actual time=8674.063..8716.846 rows=1620 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=998360.33..1080095.38 rows=1 width=68) (actual time=8291.723..8596.457 rows=1620 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=997360.33..1079095.28 rows=1 width=68) (actual time=8484.998..8585.356 rows=540 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=218.568..520.042 rows=16670 loops=3)
                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1372493
                                 ->  Parallel Hash  (cost=997360.31..997360.31 rows=1 width=65) (actual time=8060.161..8060.161 rows=540 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                       ->  Hash Join  (cost=980800.35..997360.31 rows=1 width=65) (actual time=7964.520..8034.947 rows=540 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Hash Join  (cost=978174.21..994734.17 rows=1 width=69) (actual time=7942.168..8006.730 rows=58320 loops=3)
                                                   Hash Cond: (ci.role_id = rt.id)
                                                   ->  Parallel Hash Join  (cost=978173.05..994733.01 rows=1 width=73) (actual time=7942.033..7992.099 rows=58320 loops=3)
                                                         Hash Cond: (an.person_id = ci.person_id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.036..73.383 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=978173.04..978173.04 rows=1 width=69) (actual time=7857.985..7857.985 rows=19440 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6072kB
                                                               ->  Parallel Hash Join  (cost=911370.37..978173.04 rows=1 width=69) (actual time=6277.415..6798.659 rows=19440 loops=3)
                                                                     Hash Cond: (ci.person_role_id = chn.id)
                                                                     ->  Parallel Hash Join  (cost=858566.42..925369.09 rows=1 width=57) (actual time=6017.827..6524.858 rows=149955 loops=3)
                                                                           Hash Cond: (pi.person_id = ci.person_id)
                                                                           ->  Hash Join  (cost=2.43..66764.11 rows=10928 width=4) (actual time=0.102..450.987 rows=206842 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.043..287.932 rows=987888 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.027 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'trivia'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=858563.98..858563.98 rows=1 width=53) (actual time=6008.020..6008.020 rows=13941 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4344kB
                                                                                 ->  Parallel Hash Join  (cost=396900.01..858563.98 rows=1 width=53) (actual time=2794.956..5546.260 rows=13941 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..460336.89 rows=353886 width=16) (actual time=0.071..2730.685 rows=278900 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11802548
                                                                                       ->  Parallel Hash  (cost=396900.00..396900.00 rows=1 width=37) (actual time=2773.528..2773.528 rows=369 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                                             ->  Parallel Hash Join  (cost=391988.71..396900.00 rows=1 width=37) (actual time=2747.994..2773.288 rows=369 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.031..28.785 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=391988.70..391988.70 rows=1 width=41) (actual time=2740.937..2740.937 rows=1603 loops=3)
                                                                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                                         ->  Parallel Hash Join  (cost=358250.56..391988.70 rows=1 width=41) (actual time=2632.126..2632.512 rows=1603 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = t.id)
                                                                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.021..151.404 rows=869710 loops=3)
                                                                                                               ->  Parallel Hash  (cost=358250.54..358250.54 rows=1 width=33) (actual time=2373.434..2373.434 rows=81 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                     ->  Hash Join  (cost=102687.90..358250.54 rows=1 width=33) (actual time=2053.026..2373.317 rows=81 loops=3)
                                                                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                                                                           ->  Parallel Hash Join  (cost=102685.48..358248.12 rows=1 width=37) (actual time=2052.908..2373.180 rows=81 loops=3)
                                                                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=175.556..1659.767 rows=150368 loops=3)
                                                                                                                                       Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                                                                       Rows Removed by Filter: 4794872
                                                                                                                                 ->  Parallel Hash  (cost=102685.41..102685.41 rows=5 width=29) (actual time=696.705..696.705 rows=45 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                       ->  Parallel Hash Join  (cost=54433.65..102685.41 rows=5 width=29) (actual time=660.741..696.597 rows=45 loops=3)
                                                                                                                                             Hash Cond: (mk.movie_id = t.id)
                                                                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.011..247.178 rows=1507977 loops=3)
                                                                                                                                             ->  Parallel Hash  (cost=54433.61..54433.61 rows=3 width=21) (actual time=269.123..269.123 rows=1 loops=3)
                                                                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=3 width=21) (actual time=172.129..269.051 rows=1 loops=3)
                                                                                                                                                         Filter: ((production_year >= 2000) AND (production_year <= 2010) AND ((title)::text = 'Shrek 2'::text))
                                                                                                                                                         Rows Removed by Filter: 842770
                                                                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.051 rows=1 loops=3)
                                                                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=52803.93..52803.93 rows=1 width=20) (actual time=256.055..256.055 rows=0 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..52803.93 rows=1 width=20) (actual time=175.557..256.015 rows=0 loops=3)
                                                                                 Filter: ((name)::text = 'Queen'::text)
                                                                                 Rows Removed by Filter: 1046779
                                                   ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.077..0.077 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.060..0.062 rows=1 loops=3)
                                                               Filter: ((role)::text = 'actress'::text)
                                                               Rows Removed by Filter: 11
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.261..22.261 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.093..22.237 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'computer-animation'::text)
                                                         Rows Removed by Filter: 134169
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.658..69.658 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.023..27.604 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.026..0.026 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 147.583 ms
 Execution Time: 8722.096 ms
(111 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29b.sql_explained.sql
SET
SET
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1069734.87..1069734.88 rows=1 width=96) (actual time=7607.652..7607.652 rows=1 loops=1)
   ->  Hash Join  (cost=987337.79..1069734.86 rows=1 width=48) (actual time=7606.885..7607.636 rows=15 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=987336.72..1069733.79 rows=1 width=52) (actual time=7606.792..7607.539 rows=15 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=987335.66..1069732.73 rows=1 width=56) (actual time=7606.719..7607.462 rows=15 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=982905.23..1064640.28 rows=1 width=68) (actual time=7528.114..7529.681 rows=15 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=981905.23..1063640.18 rows=1 width=68) (actual time=7414.921..7519.427 rows=5 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=227.176..540.608 rows=16670 loops=3)
                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1372493
                                 ->  Parallel Hash  (cost=981905.21..981905.21 rows=1 width=65) (actual time=6974.666..6974.666 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Hash Join  (cost=965345.25..981905.21 rows=1 width=65) (actual time=6928.850..6974.574 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Hash Join  (cost=962719.11..979279.07 rows=1 width=69) (actual time=6905.914..6951.581 rows=540 loops=3)
                                                   Hash Cond: (ci.role_id = rt.id)
                                                   ->  Parallel Hash Join  (cost=962717.95..979277.91 rows=1 width=73) (actual time=6905.769..6951.299 rows=540 loops=3)
                                                         Hash Cond: (an.person_id = ci.person_id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.029..77.403 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=962717.94..962717.94 rows=1 width=69) (actual time=6835.291..6835.291 rows=180 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=895915.27..962717.94 rows=1 width=69) (actual time=6683.820..6835.074 rows=180 loops=3)
                                                                     Hash Cond: (ci.person_role_id = chn.id)
                                                                     ->  Parallel Hash Join  (cost=843111.32..909913.99 rows=1 width=57) (actual time=6153.957..6571.417 rows=2489 loops=3)
                                                                           Hash Cond: (pi.person_id = ci.person_id)
                                                                           ->  Hash Join  (cost=2.43..66764.11 rows=10928 width=4) (actual time=0.120..456.800 rows=47448 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.037..316.047 rows=987888 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.041..0.042 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.018..0.028 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'height'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=843108.88..843108.88 rows=1 width=53) (actual time=6104.884..6104.884 rows=7101 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2232kB
                                                                                 ->  Parallel Hash Join  (cost=381444.91..843108.88 rows=1 width=53) (actual time=2566.969..5350.057 rows=7101 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..460336.89 rows=353886 width=16) (actual time=0.098..2764.577 rows=278900 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11802548
                                                                                       ->  Parallel Hash  (cost=381444.90..381444.90 rows=1 width=37) (actual time=2545.994..2545.994 rows=189 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=376533.61..381444.90 rows=1 width=37) (actual time=2527.388..2545.823 rows=189 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.010..17.273 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=376533.60..376533.60 rows=1 width=41) (actual time=2525.472..2525.472 rows=811 loops=3)
                                                                                                         Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 248kB
                                                                                                         ->  Parallel Hash Join  (cost=342795.46..376533.60 rows=1 width=41) (actual time=2417.980..2418.185 rows=811 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = t.id)
                                                                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.330..155.404 rows=869710 loops=3)
                                                                                                               ->  Parallel Hash  (cost=342795.44..342795.44 rows=1 width=33) (actual time=2155.933..2155.933 rows=45 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                     ->  Hash Join  (cost=102687.84..342795.44 rows=1 width=33) (actual time=1874.209..2155.822 rows=45 loops=3)
                                                                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                                                                           ->  Parallel Hash Join  (cost=102685.41..342793.02 rows=1 width=37) (actual time=1874.086..2155.689 rows=45 loops=3)
                                                                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=227791 width=8) (actual time=147.200..1434.566 rows=129228 loops=3)
                                                                                                                                       Filter: ((info)::text ~~ 'USA:%200%'::text)
                                                                                                                                       Rows Removed by Filter: 4816012
                                                                                                                                 ->  Parallel Hash  (cost=102685.39..102685.39 rows=2 width=29) (actual time=706.389..706.389 rows=45 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                       ->  Parallel Hash Join  (cost=54433.62..102685.39 rows=2 width=29) (actual time=669.757..706.253 rows=45 loops=3)
                                                                                                                                             Hash Cond: (mk.movie_id = t.id)
                                                                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..255.761 rows=1507977 loops=3)
                                                                                                                                             ->  Parallel Hash  (cost=54433.61..54433.61 rows=1 width=21) (actual time=269.706..269.706 rows=1 loops=3)
                                                                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=1 width=21) (actual time=249.361..269.612 rows=1 loops=3)
                                                                                                                                                         Filter: ((production_year >= 2000) AND (production_year <= 2005) AND ((title)::text = 'Shrek 2'::text))
                                                                                                                                                         Rows Removed by Filter: 842770
                                                                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.055 rows=1 loops=3)
                                                                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=52803.93..52803.93 rows=1 width=20) (actual time=263.317..263.317 rows=0 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..52803.93 rows=1 width=20) (actual time=180.476..263.274 rows=0 loops=3)
                                                                                 Filter: ((name)::text = 'Queen'::text)
                                                                                 Rows Removed by Filter: 1046779
                                                   ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.081..0.081 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.063..0.065 rows=1 loops=3)
                                                               Filter: ((role)::text = 'actress'::text)
                                                               Rows Removed by Filter: 11
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.883..22.884 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.097..22.860 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'computer-animation'::text)
                                                         Rows Removed by Filter: 134169
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.101..69.101 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.013..27.968 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.032..0.032 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 145.807 ms
 Execution Time: 7610.020 ms
(111 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29c.sql_explained.sql
SET
SET
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1104796.41..1104796.42 rows=1 width=96) (actual time=8278.416..8278.417 rows=1 loops=1)
   ->  Hash Join  (cost=849233.65..1104796.40 rows=1 width=48) (actual time=7169.541..8272.809 rows=16308 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Hash Join  (cost=849231.22..1104793.97 rows=1 width=52) (actual time=7169.443..8268.763 rows=16308 loops=1)
               Hash Cond: (ci.role_id = rt.id)
               ->  Hash Join  (cost=849230.06..1104792.80 rows=1 width=56) (actual time=7169.348..8264.765 rows=16308 loops=1)
                     Hash Cond: (cc.status_id = cct2.id)
                     ->  Hash Join  (cost=849229.00..1104791.74 rows=1 width=60) (actual time=7118.018..8259.600 rows=28022 loops=1)
                           Hash Cond: (cc.subject_id = cct1.id)
                           ->  Gather  (cost=849227.94..1104790.67 rows=1 width=64) (actual time=7117.946..8259.354 rows=28022 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=848227.94..1103790.57 rows=1 width=64) (actual time=7122.555..8239.809 rows=9341 loops=3)
                                       Hash Cond: (mi.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=183.937..1775.400 rows=150368 loops=3)
                                             Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                             Rows Removed by Filter: 4794872
                                       ->  Parallel Hash  (cost=848227.92..848227.92 rows=1 width=80) (actual time=6442.660..6442.660 rows=3288 loops=3)
                                             Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1304kB
                                             ->  Parallel Hash Join  (cost=793788.39..848227.92 rows=1 width=80) (actual time=5773.923..6074.199 rows=3288 loops=3)
                                                   Hash Cond: (chn.id = ci.person_role_id)
                                                   ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.062..245.826 rows=1046780 loops=3)
                                                   ->  Parallel Hash  (cost=793788.37..793788.37 rows=1 width=68) (actual time=5690.632..5690.632 rows=3428 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1272kB
                                                         ->  Parallel Hash Join  (cost=777228.20..793788.37 rows=1 width=68) (actual time=5458.731..5553.220 rows=3428 loops=3)
                                                               Hash Cond: (n.id = ci.person_id)
                                                               ->  Parallel Hash Join  (cost=148593.14..165153.19 rows=28 width=27) (actual time=1196.734..1313.804 rows=5368 loops=3)
                                                                     Hash Cond: (an.person_id = n.id)
                                                                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.041..73.530 rows=300448 loops=3)
                                                                     ->  Parallel Hash  (cost=148591.56..148591.56 rows=126 width=23) (actual time=1195.622..1195.622 rows=3355 loops=3)
                                                                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                           ->  Hash Join  (cost=81912.66..148591.56 rows=126 width=23) (actual time=549.314..1012.734 rows=3355 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Hash Join  (cost=81910.23..148550.34 rows=14247 width=27) (actual time=547.427..1009.933 rows=15416 loops=3)
                                                                                       Hash Cond: (pi.person_id = n.id)
                                                                                       ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.024..311.007 rows=987888 loops=3)
                                                                                       ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=546.308..546.308 rows=16670 loops=3)
                                                                                             Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                             ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=222.599..531.314 rows=16670 loops=3)
                                                                                                   Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                                   Rows Removed by Filter: 1372493
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.053 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'trivia'::text)
                                                                                             Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=628635.05..628635.05 rows=1 width=57) (actual time=4237.491..4237.491 rows=3451 loops=3)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1208kB
                                                                     ->  Parallel Hash Join  (cost=148044.74..628635.05 rows=1 width=57) (actual time=1181.289..4115.416 rows=3451 loops=3)
                                                                           Hash Cond: (ci.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.438..2896.744 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Parallel Hash  (cost=148044.70..148044.70 rows=3 width=41) (actual time=1178.122..1178.122 rows=105 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=94621.37..148044.70 rows=3 width=41) (actual time=1079.964..1177.977 rows=105 loops=3)
                                                                                       Hash Cond: (t.id = mc.movie_id)
                                                                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=432897 width=21) (actual time=0.035..284.083 rows=347600 loops=3)
                                                                                             Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                                                             Rows Removed by Filter: 495171
                                                                                       ->  Parallel Hash  (cost=94621.24..94621.24 rows=10 width=20) (actual time=854.282..854.282 rows=144 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=89709.93..94621.24 rows=10 width=20) (actual time=828.919..854.108 rows=144 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.016..22.004 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=89709.68..89709.68 rows=20 width=24) (actual time=828.390..828.390 rows=589 loops=3)
                                                                                                         Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                                                                                         ->  Hash Join  (cost=55308.66..89709.68 rows=20 width=24) (actual time=601.334..827.658 rows=589 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = cc.movie_id)
                                                                                                               ->  Parallel Hash Join  (cost=50878.23..84616.67 rows=74 width=12) (actual time=466.307..741.147 rows=1073 loops=3)
                                                                                                                     Hash Cond: (mc.movie_id = mk.movie_id)
                                                                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.031..166.238 rows=869710 loops=3)
                                                                                                                     ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=461.971..461.971 rows=138 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                                           ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=28.453..461.725 rows=138 loops=3)
                                                                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..255.454 rows=1507977 loops=3)
                                                                                                                                 ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.917..22.918 rows=1 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.108..22.907 rows=1 loops=3)
                                                                                                                                             Filter: ((keyword)::text = 'computer-animation'::text)
                                                                                                                                             Rows Removed by Filter: 134169
                                                                                                               ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=68.805..68.805 rows=135086 loops=3)
                                                                                                                     Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                                                                                     ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.044..27.371 rows=135086 loops=3)
                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=1)
                                       Filter: ((kind)::text = 'cast'::text)
                                       Rows Removed by Filter: 3
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.028..0.028 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.018..0.018 rows=1 loops=1)
                                 Filter: ((kind)::text = 'complete+verified'::text)
                                 Rows Removed by Filter: 3
               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.031..0.034 rows=1 loops=1)
                           Filter: ((role)::text = 'actress'::text)
                           Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 145.422 ms
 Execution Time: 8287.790 ms
(109 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=139838.09..139838.10 rows=1 width=32) (actual time=1285.496..1285.496 rows=1 loops=1)
   ->  Gather  (cost=139837.88..139838.09 rows=2 width=32) (actual time=1284.833..1291.582 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=138837.88..138837.89 rows=1 width=32) (actual time=1278.349..1278.350 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=88354.74..138837.87 rows=3 width=17) (actual time=917.553..1276.921 rows=2611 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.024..233.096 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=88354.70..88354.70 rows=3 width=8) (actual time=913.876..913.876 rows=2611 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                           ->  Parallel Hash Join  (cost=55672.11..88354.70 rows=3 width=8) (actual time=540.476..839.125 rows=2611 loops=3)
                                 Hash Cond: (mc.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=4793.88..37309.04 rows=44647 width=4) (actual time=23.764..313.399 rows=49377 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.027..156.081 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=4722.92..4722.92 rows=5677 width=4) (actual time=23.564..23.564 rows=3258 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 544kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=5677 width=4) (actual time=0.013..21.568 rows=3258 loops=3)
                                                   Filter: ((country_code)::text = '[de]'::text)
                                                   Rows Removed by Filter: 75074
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=515.716..515.716 rows=13947 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=22.409..461.595 rows=13947 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..252.421 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.252..22.252 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.913..22.228 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.373 ms
 Execution Time: 1292.050 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2b.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=139653.63..139653.64 rows=1 width=32) (actual time=1225.254..1225.254 rows=1 loops=1)
   ->  Gather  (cost=89170.30..139653.63 rows=2 width=17) (actual time=865.725..1229.541 rows=5228 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=88170.30..138653.43 rows=1 width=17) (actual time=858.278..1216.269 rows=1743 loops=3)
               Hash Cond: (t.id = mc.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.035..229.345 rows=842771 loops=3)
               ->  Parallel Hash  (cost=88170.28..88170.28 rows=1 width=8) (actual time=855.703..855.703 rows=1743 loops=3)
                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                     ->  Parallel Hash Join  (cost=55617.21..88170.28 rows=1 width=8) (actual time=536.582..822.891 rows=1743 loops=3)
                           Hash Cond: (mc.movie_id = mk.movie_id)
                           ->  Parallel Hash Join  (cost=4738.98..37254.14 rows=10108 width=4) (actual time=21.946..305.012 rows=18803 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.040..158.238 rows=869710 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=1285 width=4) (actual time=21.785..21.785 rows=780 loops=3)
                                       Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=1285 width=4) (actual time=0.017..21.153 rows=780 loops=3)
                                             Filter: ((country_code)::text = '[nl]'::text)
                                             Rows Removed by Filter: 77552
                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=513.314..513.314 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=22.426..461.440 rows=13947 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..252.290 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.256..22.256 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.903..22.236 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
 Planning Time: 4.353 ms
 Execution Time: 1231.696 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2c.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=139600.06..139600.07 rows=1 width=32) (actual time=804.915..804.915 rows=1 loops=1)
   ->  Gather  (cost=89116.82..139600.05 rows=1 width=17) (actual time=804.908..810.800 rows=0 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=88116.82..138599.95 rows=1 width=17) (actual time=798.289..798.290 rows=0 loops=3)
               Hash Cond: (t.id = mc.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (never executed)
               ->  Parallel Hash  (cost=88116.81..88116.81 rows=1 width=8) (actual time=797.656..797.656 rows=0 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 0kB
                     ->  Parallel Hash Join  (cost=55601.29..88116.81 rows=1 width=8) (actual time=797.533..797.534 rows=0 loops=3)
                           Hash Cond: (mc.movie_id = mk.movie_id)
                           ->  Parallel Hash Join  (cost=4723.07..37238.23 rows=92 width=4) (actual time=189.074..287.521 rows=1 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.030..157.229 rows=869710 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=12 width=4) (actual time=20.991..20.992 rows=0 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=12 width=4) (actual time=15.236..20.948 rows=0 loops=3)
                                             Filter: ((country_code)::text = '[sm]'::text)
                                             Rows Removed by Filter: 78332
                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=509.943..509.943 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=22.364..460.358 rows=13947 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..252.153 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.195..22.195 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.905..22.174 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
 Planning Time: 4.415 ms
 Execution Time: 811.209 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2d.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=141451.03..141451.04 rows=1 width=32) (actual time=1375.948..1375.948 rows=1 loops=1)
   ->  Gather  (cost=141450.82..141451.03 rows=2 width=32) (actual time=1373.905..1382.760 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=140450.82..140450.83 rows=1 width=32) (actual time=1367.192..1367.193 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=17) (actual time=1032.477..1360.442 rows=22772 loops=3)
                     Hash Cond: (mc.company_id = cn.id)
                     ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=21) (actual time=987.617..1300.038 rows=49517 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.026..167.394 rows=869710 loops=3)
                           ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=25) (actual time=987.091..987.091 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                 ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=25) (actual time=531.924..912.668 rows=13947 loops=3)
                                       Hash Cond: (t.id = mk.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.038..239.865 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=531.686..531.686 rows=13947 loops=3)
                                             Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                             ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=23.274..473.334 rows=13947 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.060..263.317 rows=1507977 loops=3)
                                                   ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=23.101..23.101 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.970..23.079 rows=1 loops=3)
                                                               Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                               Rows Removed by Filter: 134169
                     ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=43.361..43.361 rows=28281 loops=3)
                           Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.032..26.615 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
 Planning Time: 4.478 ms
 Execution Time: 1383.284 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30a.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=944426.03..944426.04 rows=1 width=128) (actual time=6133.516..6133.517 rows=1 loops=1)
   ->  Hash Join  (cost=927922.43..944426.02 rows=1 width=80) (actual time=6017.890..6133.012 rows=757 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=927921.36..944424.94 rows=1 width=84) (actual time=6017.792..6132.705 rows=757 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=927920.30..944423.88 rows=1 width=88) (actual time=6017.715..6132.237 rows=2492 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=923489.86..939331.43 rows=1 width=100) (actual time=5924.925..6039.083 rows=6214 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=923487.44..939329.00 rows=1 width=104) (actual time=5924.816..6037.148 rows=18687 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=922487.44..938328.90 rows=1 width=104) (actual time=5902.020..6027.549 rows=6229 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.033..77.049 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=922487.42..922487.42 rows=1 width=91) (actual time=5885.045..5885.045 rows=2263 loops=3)
                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                             ->  Parallel Hash Join  (cost=842460.08..922487.42 rows=1 width=91) (actual time=5353.238..5861.331 rows=2263 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.043..440.182 rows=579860 loops=3)
                                                         Filter: ((gender)::text = 'm'::text)
                                                         Rows Removed by Filter: 809304
                                                   ->  Parallel Hash  (cost=842460.07..842460.07 rows=1 width=80) (actual time=5352.227..5352.227 rows=3573 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1176kB
                                                         ->  Parallel Hash Join  (cost=342439.39..842460.07 rows=1 width=80) (actual time=4184.590..5301.671 rows=3573 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=162.985..2863.005 rows=414905 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                     Rows Removed by Filter: 11666543
                                                               ->  Parallel Hash  (cost=342439.38..342439.38 rows=1 width=72) (actual time=2381.111..2381.111 rows=5468 loops=3)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                     ->  Parallel Hash Join  (cost=291113.75..342439.38 rows=1 width=72) (actual time=2031.161..2363.487 rows=5468 loops=3)
                                                                           Hash Cond: (t.id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.030..274.244 rows=460484 loops=3)
                                                                                 Filter: (production_year > 2000)
                                                                                 Rows Removed by Filter: 382286
                                                                           ->  Parallel Hash  (cost=291113.73..291113.73 rows=1 width=51) (actual time=2027.990..2027.990 rows=11309 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                                 ->  Hash Join  (cost=51720.34..291113.73 rows=1 width=51) (actual time=1836.001..1989.173 rows=11309 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..291111.24 rows=25 width=55) (actual time=1455.159..1985.670 rows=11907 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=884.878..1403.802 rows=24349 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                                   Rows Removed by Filter: 4920891
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=570.199..570.200 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.695..487.489 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..251.588 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.478..41.478 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.122..41.462 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.049 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.044 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.031..0.034 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.670..69.670 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.023..27.895 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.035..0.035 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.013..0.016 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                     Rows Removed by Filter: 2
 Planning Time: 92.238 ms
 Execution Time: 6136.943 ms
(80 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30b.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=950168.28..950168.29 rows=1 width=128) (actual time=6194.269..6194.269 rows=1 loops=1)
   ->  Hash Join  (cost=933664.68..950168.27 rows=1 width=80) (actual time=6125.502..6194.232 rows=28 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=933663.61..950167.19 rows=1 width=84) (actual time=6125.415..6194.138 rows=28 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=933662.55..950166.13 rows=1 width=88) (actual time=6125.333..6194.039 rows=108 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=929232.11..945073.68 rows=1 width=100) (actual time=6053.325..6110.223 rows=108 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=929229.69..945071.25 rows=1 width=104) (actual time=6053.181..6111.878 rows=324 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=928229.69..944071.15 rows=1 width=104) (actual time=6075.157..6101.652 rows=108 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..76.040 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=928229.67..928229.67 rows=1 width=91) (actual time=5968.692..5968.692 rows=36 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=871161.79..928229.67 rows=1 width=91) (actual time=5927.626..5968.458 rows=36 loops=3)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=161 width=21) (actual time=2.153..362.693 rows=178 loops=3)
                                                         Filter: ((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))
                                                         Rows Removed by Filter: 842593
                                                   ->  Parallel Hash  (cost=871161.78..871161.78 rows=1 width=70) (actual time=5605.435..5605.435 rows=4543 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1272kB
                                                         ->  Parallel Hash Join  (cost=791134.44..871161.78 rows=1 width=70) (actual time=5044.226..5557.052 rows=4543 loops=3)
                                                               Hash Cond: (n.id = ci.person_id)
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.283..442.926 rows=579860 loops=3)
                                                                     Filter: ((gender)::text = 'm'::text)
                                                                     Rows Removed by Filter: 809304
                                                               ->  Parallel Hash  (cost=791134.42..791134.42 rows=1 width=59) (actual time=5042.747..5042.747 rows=7458 loops=3)
                                                                     Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1848kB
                                                                     ->  Parallel Hash Join  (cost=291113.75..791134.42 rows=1 width=59) (actual time=3859.204..4986.483 rows=7458 loops=3)
                                                                           Hash Cond: (ci.movie_id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=195.444..2896.541 rows=414905 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                                 Rows Removed by Filter: 11666543
                                                                           ->  Parallel Hash  (cost=291113.73..291113.73 rows=1 width=51) (actual time=2034.417..2034.417 rows=11309 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                                 ->  Hash Join  (cost=51720.34..291113.73 rows=1 width=51) (actual time=1836.902..1990.071 rows=11309 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..291111.24 rows=25 width=55) (actual time=1452.660..1986.544 rows=11907 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=891.210..1413.939 rows=24349 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                                   Rows Removed by Filter: 4920891
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=561.368..561.368 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.453..482.066 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..250.407 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.297..41.298 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.129..41.283 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.063..0.063 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.046 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.029..0.032 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.653..69.653 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.014..27.508 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.026..0.026 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.013..0.015 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                     Rows Removed by Filter: 2
 Planning Time: 91.711 ms
 Execution Time: 6197.047 ms
(80 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=974687.78..974687.79 rows=1 width=128) (actual time=6960.039..6960.039 rows=1 loops=1)
   ->  Hash Join  (cost=958184.19..974687.77 rows=1 width=80) (actual time=6736.139..6955.443 rows=8024 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=958183.12..974686.71 rows=1 width=84) (actual time=6736.036..6952.700 rows=14123 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=958182.06..974685.64 rows=1 width=88) (actual time=6735.955..6948.454 rows=18841 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=953751.63..969593.19 rows=1 width=100) (actual time=6661.292..6837.818 rows=26153 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=953749.20..969590.76 rows=1 width=104) (actual time=6661.164..6824.913 rows=78897 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=952749.20..968590.66 rows=1 width=104) (actual time=6654.234..6804.476 rows=26299 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.034..78.340 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=952749.19..952749.19 rows=1 width=91) (actual time=6650.484..6650.484 rows=9085 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3064kB
                                             ->  Parallel Hash Join  (cost=872721.85..952749.19 rows=1 width=91) (actual time=6084.922..6617.291 rows=9085 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.054..453.349 rows=579860 loops=3)
                                                         Filter: ((gender)::text = 'm'::text)
                                                         Rows Removed by Filter: 809304
                                                   ->  Parallel Hash  (cost=872721.83..872721.83 rows=1 width=80) (actual time=6084.120..6084.120 rows=15008 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4664kB
                                                         ->  Parallel Hash Join  (cost=372701.16..872721.83 rows=1 width=80) (actual time=4880.163..6050.938 rows=15008 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=179.077..2976.042 rows=414905 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                     Rows Removed by Filter: 11666543
                                                               ->  Parallel Hash  (cost=372701.14..372701.14 rows=1 width=72) (actual time=3005.144..3005.144 rows=22680 loops=3)
                                                                     Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6968kB
                                                                     ->  Parallel Hash Join  (cost=322218.01..372701.14 rows=1 width=72) (actual time=2546.069..2914.687 rows=22680 loops=3)
                                                                           Hash Cond: (t.id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.037..229.861 rows=842771 loops=3)
                                                                           ->  Parallel Hash  (cost=322218.00..322218.00 rows=1 width=51) (actual time=2544.611..2544.611 rows=22680 loops=3)
                                                                                 Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                                                 ->  Hash Join  (cost=51720.34..322218.00 rows=1 width=51) (actual time=2266.114..2495.616 rows=22680 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..322215.41 rows=60 width=55) (actual time=1752.162..2489.463 rows=24129 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1071.610..1900.055 rows=62990 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                                   Rows Removed by Filter: 4882250
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=567.509..567.509 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=42.244..486.085 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..253.478 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=42.113..42.113 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.143..42.099 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.035..0.047 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.042 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.048..69.048 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.013..27.886 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.024..0.024 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.012..0.013 rows=1 loops=1)
                     Filter: ((kind)::text = 'complete+verified'::text)
                     Rows Removed by Filter: 3
 Planning Time: 92.355 ms
 Execution Time: 6966.444 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=975119.34..975119.35 rows=1 width=128) (actual time=6598.671..6598.671 rows=1 loops=1)
   ->  Gather  (cost=975119.11..975119.32 rows=2 width=128) (actual time=6597.285..6605.940 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=974119.11..974119.12 rows=1 width=128) (actual time=6589.432..6589.432 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=923635.97..974119.10 rows=1 width=80) (actual time=6475.483..6589.131 rows=424 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.042..235.687 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=923635.96..923635.96 rows=1 width=83) (actual time=6237.934..6237.934 rows=424 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 168kB
                           ->  Parallel Hash Join  (cost=843608.62..923635.96 rows=1 width=83) (actual time=5717.014..6237.648 rows=424 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.062..459.740 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=843608.60..843608.60 rows=1 width=72) (actual time=5711.150..5711.150 rows=519 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                       ->  Parallel Hash Join  (cost=343587.93..843608.60 rows=1 width=72) (actual time=4550.298..5710.869 rows=519 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=174.011..3015.864 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=343587.91..343587.91 rows=1 width=64) (actual time=2644.716..2644.716 rows=508 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                   ->  Parallel Hash Join  (cost=311072.34..343587.91 rows=1 width=64) (actual time=2416.428..2644.153 rows=508 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Hash Join  (cost=4723.09..37238.26 rows=106 width=4) (actual time=21.059..293.051 rows=605 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.051..167.179 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=16.009..16.009 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=5.618..15.937 rows=3 loops=3)
                                                                           Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                           Rows Removed by Filter: 78329
                                                         ->  Parallel Hash  (cost=306349.24..306349.24 rows=1 width=60) (actual time=2350.282..2350.282 rows=10505 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2456kB
                                                               ->  Parallel Hash Join  (cost=291078.97..306349.24 rows=1 width=60) (actual time=2137.518..2325.754 rows=10505 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.173..164.582 rows=153308 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.064..80.028 rows=460012 loops=3)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.041..0.041 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'votes'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=291076.53..291076.53 rows=1 width=51) (actual time=2137.027..2137.027 rows=11309 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2840kB
                                                                           ->  Parallel Hash Join  (cost=51720.34..291076.53 rows=1 width=51) (actual time=1909.226..2071.268 rows=11309 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..239357.37 rows=330 width=47) (actual time=1335.308..1486.998 rows=24086 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=932.279..1478.631 rows=24349 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                             Rows Removed by Filter: 4920891
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.094..0.095 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.053..0.066 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=573.839..573.839 rows=25571 loops=3)
                                                                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                       ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.763..488.655 rows=25571 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..252.833 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.608..41.608 rows=7 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.114..41.582 rows=7 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                         Rows Removed by Filter: 134163
 Planning Time: 119.220 ms
 Execution Time: 6607.246 ms
(72 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31b.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=980989.91..980989.92 rows=1 width=128) (actual time=6157.390..6157.390 rows=1 loops=1)
   ->  Gather  (cost=980989.68..980989.89 rows=2 width=128) (actual time=6157.109..6165.109 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=979989.68..979989.69 rows=1 width=128) (actual time=6149.383..6149.383 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=899962.33..979989.67 rows=1 width=80) (actual time=5797.258..6149.332 rows=28 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.044..447.674 rows=579860 loops=3)
                           Filter: ((gender)::text = 'm'::text)
                           Rows Removed by Filter: 809304
                     ->  Parallel Hash  (cost=899962.31..899962.31 rows=1 width=69) (actual time=5644.161..5644.161 rows=28 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=400520.12..899962.31 rows=1 width=69) (actual time=4666.525..5644.018 rows=28 loops=3)
                                 Hash Cond: (t.id = mi.movie_id)
                                 ->  Parallel Hash Join  (cost=57069.28..556511.17 rows=79 width=29) (actual time=2188.547..3303.823 rows=212 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=174.477..2890.110 rows=414905 loops=3)
                                             Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                             Rows Removed by Filter: 11666543
                                       ->  Parallel Hash  (cost=57067.27..57067.27 rows=161 width=21) (actual time=366.081..366.081 rows=178 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=161 width=21) (actual time=3.711..365.789 rows=178 loops=3)
                                                   Filter: ((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))
                                                   Rows Removed by Filter: 842593
                                 ->  Parallel Hash  (cost=343450.83..343450.83 rows=1 width=64) (actual time=2340.066..2340.066 rows=87 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=104094.63..343450.83 rows=1 width=64) (actual time=2212.933..2339.951 rows=87 loops=3)
                                             Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                             ->  Hash Join  (cost=2.43..239357.37 rows=330 width=47) (actual time=1269.773..1417.315 rows=24086 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=887.328..1409.240 rows=24349 loops=3)
                                                         Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                         Rows Removed by Filter: 4920891
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.030 rows=1 loops=3)
                                                               Filter: ((info)::text = 'genres'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=104092.19..104092.19 rows=1 width=17) (actual time=919.230..919.230 rows=105 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=88821.93..104092.19 rows=1 width=17) (actual time=813.579..919.103 rows=105 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.181..159.066 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.050..76.321 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.063..0.064 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=88819.49..88819.49 rows=1 width=8) (actual time=744.140..744.140 rows=105 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=40567.20..88819.49 rows=1 width=8) (actual time=370.953..743.997 rows=105 loops=3)
                                                                     Hash Cond: (mk.movie_id = mc.movie_id)
                                                                     ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.305..484.202 rows=25571 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.016..252.281 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.167..40.167 rows=7 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.108..40.152 rows=7 loops=3)
                                                                                       Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                       Rows Removed by Filter: 134163
                                                                     ->  Parallel Hash  (cost=37102.41..37102.41 rows=1 width=4) (actual time=255.450..255.450 rows=45 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=4723.09..37102.41 rows=1 width=4) (actual time=54.273..255.332 rows=45 loops=3)
                                                                                 Hash Cond: (mc.company_id = cn.id)
                                                                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=39 width=8) (actual time=1.122..232.637 rows=2654 loops=3)
                                                                                       Filter: ((note)::text ~~ '%(Blu-ray)%'::text)
                                                                                       Rows Removed by Filter: 867055
                                                                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=21.842..21.842 rows=3 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=1.766..21.781 rows=3 loops=3)
                                                                                             Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                                             Rows Removed by Filter: 78329
 Planning Time: 123.368 ms
 Execution Time: 6166.222 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31c.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=1005633.28..1005633.29 rows=1 width=128) (actual time=7905.797..7905.797 rows=1 loops=1)
   ->  Gather  (cost=1005633.05..1005633.26 rows=2 width=128) (actual time=7904.198..7911.979 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=1004633.05..1004633.06 rows=1 width=128) (actual time=7896.542..7896.542 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=954149.91..1004633.04 rows=1 width=80) (actual time=7743.452..7896.002 rows=942 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.028..225.907 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=954149.90..954149.90 rows=1 width=83) (actual time=7559.176..7559.176 rows=942 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 376kB
                           ->  Parallel Hash Join  (cost=874660.64..954149.90 rows=1 width=83) (actual time=6742.220..7271.999 rows=942 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.044..358.005 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=874660.62..874660.62 rows=1 width=72) (actual time=6733.001..6733.001 rows=942 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                       ->  Parallel Hash Join  (cost=374639.95..874660.62 rows=1 width=72) (actual time=5135.942..6236.996 rows=942 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=163.929..2870.159 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=374639.93..374639.93 rows=1 width=64) (actual time=3319.998..3319.998 rows=947 loops=3)
                                                   Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                   ->  Parallel Hash Join  (cost=342124.37..374639.93 rows=1 width=64) (actual time=2818.374..3043.175 rows=947 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Hash Join  (cost=4723.09..37238.26 rows=106 width=4) (actual time=20.421..280.096 rows=605 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.028..153.993 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=15.824..15.824 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=0.696..15.738 rows=3 loops=3)
                                                                           Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                           Rows Removed by Filter: 78329
                                                         ->  Parallel Hash  (cost=337401.26..337401.26 rows=1 width=60) (actual time=2762.073..2762.073 rows=21129 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4824kB
                                                               ->  Parallel Hash Join  (cost=322130.99..337401.26 rows=1 width=60) (actual time=2513.317..2702.794 rows=21129 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.135..161.707 rows=153308 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.032..77.318 rows=460012 loops=3)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'votes'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=322128.55..322128.55 rows=1 width=51) (actual time=2512.829..2512.829 rows=22680 loops=3)
                                                                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                                           ->  Parallel Hash Join  (cost=51720.34..322128.55 rows=1 width=51) (actual time=2235.965..2469.937 rows=22680 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1673.474..1890.241 rows=62198 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1056.860..1872.811 rows=62990 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                             Rows Removed by Filter: 4882250
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.082..0.083 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.056 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=562.406..562.406 rows=25571 loops=3)
                                                                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                       ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.789..482.000 rows=25571 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..250.239 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.634..41.634 rows=7 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.116..41.609 rows=7 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                         Rows Removed by Filter: 134163
 Planning Time: 122.001 ms
 Execution Time: 7913.014 ms
(70 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/32a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=75986.58..75986.59 rows=1 width=96) (actual time=340.491..340.491 rows=1 loops=1)
   ->  Gather  (cost=75986.36..75986.57 rows=2 width=96) (actual time=340.279..344.393 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=74986.36..74986.37 rows=1 width=96) (actual time=333.545..333.545 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=24503.19..74986.33 rows=4 width=116) (actual time=333.540..333.541 rows=0 loops=3)
                     Hash Cond: (t2.id = ml.linked_movie_id)
                     ->  Parallel Seq Scan on title t2  (cost=0.00..46532.63 rows=1053463 width=21) (never executed)
                     ->  Parallel Hash  (cost=24503.14..24503.14 rows=4 width=103) (actual time=333.012..333.012 rows=0 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 0kB
                           ->  Hash Join  (cost=2676.61..24503.14 rows=4 width=103) (actual time=331.524..331.524 rows=0 loops=3)
                                 Hash Cond: (ml.link_type_id = lt.id)
                                 ->  Hash Join  (cost=2675.20..24501.72 rows=4 width=25) (actual time=331.410..331.411 rows=0 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=49.07..20347.47 rows=582120 width=29) (actual time=12.189..300.525 rows=96064 loops=3)
                                             Merge Cond: (t1.id = ml.movie_id)
                                             ->  Merge Join  (cost=47.47..247535.04 rows=1884971 width=29) (actual time=11.897..247.143 rows=32619 loops=3)
                                                   Merge Cond: (mk.movie_id = t1.id)
                                                   ->  Parallel Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..115667.54 rows=1884971 width=8) (actual time=0.058..12.050 rows=32619 loops=3)
                                                   ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=21) (actual time=0.055..205.515 rows=187035 loops=3)
                                             ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=12) (actual time=0.049..27.436 rows=120323 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.950..21.950 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=21.408..21.931 rows=1 loops=3)
                                                   Filter: ((keyword)::text = '10,000-mile-club'::text)
                                                   Rows Removed by Filter: 134169
                                 ->  Hash  (cost=1.18..1.18 rows=18 width=86) (actual time=0.068..0.068 rows=18 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=86) (actual time=0.039..0.042 rows=18 loops=3)
 Planning Time: 5.405 ms
 Execution Time: 345.042 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/32b.sql_explained.sql
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=75986.58..75986.59 rows=1 width=96) (actual time=772.613..772.613 rows=1 loops=1)
   ->  Gather  (cost=75986.36..75986.57 rows=2 width=96) (actual time=772.237..777.840 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=74986.36..74986.37 rows=1 width=96) (actual time=765.261..765.261 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=24503.19..74986.33 rows=4 width=116) (actual time=400.212..763.673 rows=1463 loops=3)
                     Hash Cond: (t2.id = ml.linked_movie_id)
                     ->  Parallel Seq Scan on title t2  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.011..232.662 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=24503.14..24503.14 rows=4 width=103) (actual time=398.796..398.796 rows=1463 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 408kB
                           ->  Hash Join  (cost=2676.61..24503.14 rows=4 width=103) (actual time=62.306..336.726 rows=1463 loops=3)
                                 Hash Cond: (ml.link_type_id = lt.id)
                                 ->  Hash Join  (cost=2675.20..24501.72 rows=4 width=25) (actual time=62.180..336.128 rows=1463 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=49.07..20347.47 rows=582120 width=29) (actual time=3.268..305.134 rows=96064 loops=3)
                                             Merge Cond: (t1.id = ml.movie_id)
                                             ->  Merge Join  (cost=47.47..247535.04 rows=1884971 width=29) (actual time=3.065..254.250 rows=32619 loops=3)
                                                   Merge Cond: (mk.movie_id = t1.id)
                                                   ->  Parallel Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..115667.54 rows=1884971 width=8) (actual time=0.031..8.339 rows=32619 loops=3)
                                                   ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=21) (actual time=0.057..216.802 rows=187035 loops=3)
                                             ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=12) (actual time=0.049..25.035 rows=120414 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.854..21.854 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.924..21.840 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
                                 ->  Hash  (cost=1.18..1.18 rows=18 width=86) (actual time=0.073..0.073 rows=18 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=86) (actual time=0.038..0.042 rows=18 loops=3)
 Planning Time: 5.375 ms
 Execution Time: 778.513 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33a.sql_explained.sql
SET
SET
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=154593.22..154593.23 rows=1 width=192) (actual time=1431.850..1431.850 rows=1 loops=1)
   ->  Hash Join  (cost=144214.38..154593.20 rows=1 width=82) (actual time=1431.815..1431.830 rows=8 loops=1)
         Hash Cond: (t2.kind_id = kt2.id)
         ->  Hash Join  (cost=144213.28..154592.10 rows=1 width=86) (actual time=1431.710..1431.721 rows=8 loops=1)
               Hash Cond: (mi_idx1.info_type_id = it1.id)
               ->  Hash Join  (cost=144210.85..154589.67 rows=2 width=90) (actual time=1431.601..1431.629 rows=24 loops=1)
                     Hash Cond: (t1.kind_id = kt1.id)
                     ->  Merge Join  (cost=144209.75..154588.52 rows=12 width=94) (actual time=1431.521..1431.541 rows=24 loops=1)
                           Merge Cond: (ml.movie_id = t1.id)
                           ->  Merge Join  (cost=144209.32..146403.23 rows=12 width=85) (actual time=1412.859..1412.872 rows=24 loops=1)
                                 Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                 ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.033..2.572 rows=8479 loops=1)
                                 ->  Sort  (cost=144208.90..144208.91 rows=4 width=72) (actual time=1409.323..1409.326 rows=22 loops=1)
                                       Sort Key: ml.movie_id
                                       Sort Method: quicksort  Memory: 26kB
                                       ->  Hash Join  (cost=137529.19..144208.86 rows=4 width=72) (actual time=1370.225..1409.236 rows=8 loops=1)
                                             Hash Cond: (cn1.id = mc1.company_id)
                                             ->  Seq Scan on company_name cn1  (cost=0.00..5932.46 rows=85390 width=23) (actual time=0.023..46.956 rows=84843 loops=1)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 150154
                                             ->  Hash  (cost=137529.07..137529.07 rows=10 width=57) (actual time=1354.903..1354.903 rows=29 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                   ->  Merge Join  (cost=132176.15..137529.07 rows=10 width=57) (actual time=1329.168..1354.880 rows=29 loops=1)
                                                         Merge Cond: (mc1.movie_id = ml.movie_id)
                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..131550.35 rows=2609129 width=8) (actual time=0.023..25.703 rows=61895 loops=1)
                                                         ->  Sort  (cost=132175.72..132175.73 rows=2 width=49) (actual time=1321.871..1321.875 rows=29 loops=1)
                                                               Sort Key: ml.movie_id
                                                               Sort Method: quicksort  Memory: 26kB
                                                               ->  Gather  (cost=127279.79..132175.71 rows=2 width=49) (actual time=1282.766..1322.179 rows=11 loops=1)
                                                                     Workers Planned: 1
                                                                     Workers Launched: 1
                                                                     ->  Parallel Hash Join  (cost=126279.79..131175.51 rows=1 width=49) (actual time=1278.226..1313.854 rows=6 loops=2)
                                                                           Hash Cond: (cn2.id = mc2.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.005..22.879 rows=117498 loops=2)
                                                                           ->  Parallel Hash  (cost=126279.78..126279.78 rows=1 width=34) (actual time=1276.655..1276.655 rows=6 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                 ->  Parallel Hash Join  (cost=92541.63..126279.78 rows=1 width=34) (actual time=1010.331..1276.582 rows=6 loops=2)
                                                                                       Hash Cond: (mc2.movie_id = t2.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.031..233.864 rows=1304564 loops=2)
                                                                                       ->  Parallel Hash  (cost=92541.62..92541.62 rows=1 width=42) (actual time=882.795..882.795 rows=3 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Hash Join  (cost=76393.09..92541.62 rows=1 width=42) (actual time=666.171..882.724 rows=3 loops=2)
                                                                                                   Hash Cond: (mi_idx2.info_type_id = it2.id)
                                                                                                   ->  Parallel Hash Join  (cost=76390.66..92538.93 rows=96 width=46) (actual time=630.871..882.578 rows=153 loops=2)
                                                                                                         Hash Cond: (mi_idx2.movie_id = t2.id)
                                                                                                         ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=273383 width=13) (actual time=0.039..216.557 rows=327480 loops=2)
                                                                                                               Filter: ((info)::text < '3.0'::text)
                                                                                                               Rows Removed by Filter: 362537
                                                                                                         ->  Parallel Hash  (cost=76386.05..76386.05 rows=369 width=33) (actual time=630.553..630.553 rows=122 loops=2)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                               ->  Hash Join  (cost=75275.92..76386.05 rows=369 width=33) (actual time=565.514..629.960 rows=122 loops=2)
                                                                                                                     Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                     ->  Merge Join  (cost=75274.64..76377.59 rows=2212 width=37) (actual time=565.348..629.595 rows=2166 loops=2)
                                                                                                                           Merge Cond: (t2.id = ml.linked_movie_id)
                                                                                                                           ->  Sort  (cost=72580.89..73046.92 rows=186410 width=25) (actual time=544.367..578.573 rows=222854 loops=2)
                                                                                                                                 Sort Key: t2.id
                                                                                                                                 Sort Method: external merge  Disk: 8088kB
                                                                                                                                 Worker 0:  Sort Method: external merge  Disk: 7896kB
                                                                                                                                 ->  Parallel Seq Scan on title t2  (cost=0.00..51799.95 rows=186410 width=25) (actual time=0.030..395.585 rows=222930 loops=2)
                                                                                                                                       Filter: ((production_year >= 2005) AND (production_year <= 2008))
                                                                                                                                       Rows Removed by Filter: 1041226
                                                                                                                           ->  Sort  (cost=2693.63..2768.62 rows=29997 width=12) (actual time=20.959..23.290 rows=29997 loops=2)
                                                                                                                                 Sort Key: ml.linked_movie_id
                                                                                                                                 Sort Method: quicksort  Memory: 2175kB
                                                                                                                                 Worker 0:  Sort Method: quicksort  Memory: 2175kB
                                                                                                                                 ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.042..6.653 rows=29997 loops=2)
                                                                                                                     ->  Hash  (cost=1.25..1.25 rows=3 width=4) (actual time=0.061..0.061 rows=2 loops=2)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on link_type lt  (cost=0.00..1.25 rows=3 width=4) (actual time=0.046..0.051 rows=2 loops=2)
                                                                                                                                 Filter: ((link)::text = ANY ('{sequel,follows,"followed by"}'::text[]))
                                                                                                                                 Rows Removed by Filter: 16
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.060 rows=1 loops=2)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=2)
                                                                                                               Filter: ((info)::text = 'rating'::text)
                                                                                                               Rows Removed by Filter: 112
                           ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=25) (actual time=0.014..16.264 rows=22690 loops=1)
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                                 Filter: ((kind)::text = 'tv series'::text)
                                 Rows Removed by Filter: 6
               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.025 rows=1 loops=1)
                           Filter: ((info)::text = 'rating'::text)
                           Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=1)
                     Filter: ((kind)::text = 'tv series'::text)
                     Rows Removed by Filter: 6
 Planning Time: 112.516 ms
 Execution Time: 1435.432 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33b.sql_explained.sql
SET
SET
                                                                                                                                    QUERY PLAN                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=126526.42..126526.43 rows=1 width=192) (actual time=1282.437..1282.438 rows=1 loops=1)
   ->  Hash Join  (cost=121630.57..126526.40 rows=1 width=82) (actual time=1252.549..1282.416 rows=4 loops=1)
         Hash Cond: (mi_idx2.info_type_id = it2.id)
         ->  Hash Join  (cost=121628.15..126523.97 rows=1 width=86) (actual time=1252.444..1282.310 rows=8 loops=1)
               Hash Cond: (t2.kind_id = kt2.id)
               ->  Gather  (cost=121627.05..126522.87 rows=1 width=90) (actual time=1252.358..1287.214 rows=42 loops=1)
                     Workers Planned: 1
                     Workers Launched: 1
                     ->  Parallel Hash Join  (cost=120627.05..125522.77 rows=1 width=90) (actual time=1245.871..1275.638 rows=21 loops=2)
                           Hash Cond: (cn2.id = mc2.company_id)
                           ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.005..16.828 rows=117498 loops=2)
                           ->  Parallel Hash  (cost=120627.03..120627.03 rows=1 width=75) (actual time=1244.807..1244.807 rows=21 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=86888.89..120627.03 rows=1 width=75) (actual time=891.336..1244.749 rows=21 loops=2)
                                       Hash Cond: (mc2.movie_id = t2.id)
                                       ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.006..232.402 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=86888.88..86888.88 rows=1 width=83) (actual time=852.983..852.983 rows=6 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Hash Join  (cost=70741.00..86888.88 rows=1 width=83) (actual time=659.190..852.934 rows=6 loops=2)
                                                   Hash Cond: (mi_idx1.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=70738.57..86886.45 rows=1 width=87) (actual time=659.070..852.811 rows=18 loops=2)
                                                         Hash Cond: (mi_idx2.movie_id = t2.id)
                                                         ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=273383 width=13) (actual time=0.021..215.097 rows=327480 loops=2)
                                                               Filter: ((info)::text < '3.0'::text)
                                                               Rows Removed by Filter: 362537
                                                         ->  Parallel Hash  (cost=70738.56..70738.56 rows=1 width=74) (actual time=603.883..603.883 rows=9 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                               ->  Parallel Hash Join  (cost=21387.24..70738.56 rows=1 width=74) (actual time=421.690..603.827 rows=9 loops=2)
                                                                     Hash Cond: (t2.id = ml.linked_movie_id)
                                                                     ->  Parallel Seq Scan on title t2  (cost=0.00..49166.29 rows=49337 width=25) (actual time=0.020..353.995 rows=59782 loops=2)
                                                                           Filter: (production_year = 2007)
                                                                           Rows Removed by Filter: 1204374
                                                                     ->  Parallel Hash  (cost=21387.06..21387.06 rows=15 width=49) (actual time=235.681..235.681 rows=590 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                                           ->  Hash Join  (cost=14591.57..21387.06 rows=15 width=49) (actual time=149.132..235.247 rows=590 loops=2)
                                                                                 Hash Cond: (t1.kind_id = kt1.id)
                                                                                 ->  Merge Join  (cost=14590.47..21385.52 rows=102 width=53) (actual time=149.048..234.983 rows=716 loops=2)
                                                                                       Merge Cond: (t1.id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using title_pkey on title t1  (cost=0.43..87333.68 rows=1053463 width=25) (actual time=0.020..77.123 rows=81444 loops=2)
                                                                                       ->  Sort  (cost=14590.04..14590.65 rows=246 width=44) (actual time=148.009..148.108 rows=1431 loops=2)
                                                                                             Sort Key: ml.movie_id
                                                                                             Sort Method: quicksort  Memory: 213kB
                                                                                             Worker 0:  Sort Method: quicksort  Memory: 213kB
                                                                                             ->  Hash Join  (cost=6611.72..14580.27 rows=246 width=44) (actual time=62.326..146.933 rows=1431 loops=2)
                                                                                                   Hash Cond: (mc1.company_id = cn1.id)
                                                                                                   ->  Merge Join  (cost=651.94..8551.02 rows=26465 width=29) (actual time=10.527..91.678 rows=29022 loops=2)
                                                                                                         Merge Cond: (ml.movie_id = mc1.movie_id)
                                                                                                         ->  Merge Join  (cost=651.06..2920.55 rows=5051 width=21) (actual time=10.406..38.848 rows=6192 loops=2)
                                                                                                               Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                                                                                               ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.042..19.159 rows=63901 loops=2)
                                                                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=8) (actual time=10.332..10.857 rows=6443 loops=2)
                                                                                                                     Sort Key: ml.movie_id
                                                                                                                     Sort Method: quicksort  Memory: 205kB
                                                                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=8) (actual time=0.137..9.215 rows=2315 loops=2)
                                                                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.032..4.992 rows=29997 loops=2)
                                                                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.040..0.041 rows=2 loops=2)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.025..0.030 rows=2 loops=2)
                                                                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                                                       Rows Removed by Filter: 16
                                                                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..131550.35 rows=2609129 width=8) (actual time=0.031..36.458 rows=111067 loops=2)
                                                                                                   ->  Hash  (cost=5932.46..5932.46 rows=2185 width=23) (actual time=51.773..51.773 rows=2340 loops=2)
                                                                                                         Buckets: 4096  Batches: 1  Memory Usage: 160kB
                                                                                                         ->  Seq Scan on company_name cn1  (cost=0.00..5932.46 rows=2185 width=23) (actual time=0.038..50.280 rows=2340 loops=2)
                                                                                                               Filter: ((country_code)::text = '[nl]'::text)
                                                                                                               Rows Removed by Filter: 232657
                                                                                 ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.032..0.032 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=1 width=4) (actual time=0.020..0.022 rows=1 loops=2)
                                                                                             Filter: ((kind)::text = 'tv series'::text)
                                                                                             Rows Removed by Filter: 6
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.043 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.029..0.029 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=1 width=4) (actual time=0.018..0.020 rows=1 loops=1)
                           Filter: ((kind)::text = 'tv series'::text)
                           Rows Removed by Filter: 6
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 113.043 ms
 Execution Time: 1288.576 ms
(90 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33c.sql_explained.sql
SET
SET
                                                                                                                                       QUERY PLAN                                                                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=141754.28..141754.29 rows=1 width=192) (actual time=1578.996..1578.996 rows=1 loops=1)
   ->  Hash Join  (cost=133569.54..141754.26 rows=1 width=82) (actual time=1475.340..1578.862 rows=114 loops=1)
         Hash Cond: (t1.kind_id = kt1.id)
         ->  Merge Join  (cost=133568.42..141753.15 rows=1 width=86) (actual time=1475.246..1578.727 rows=114 loops=1)
               Merge Cond: (t1.id = ml.movie_id)
               ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=25) (actual time=0.024..105.134 rows=152917 loops=1)
               ->  Sort  (cost=133567.99..133568.00 rows=1 width=77) (actual time=1456.143..1456.153 rows=114 loops=1)
                     Sort Key: mc1.movie_id
                     Sort Method: quicksort  Memory: 42kB
                     ->  Hash Join  (cost=131373.01..133567.98 rows=1 width=77) (actual time=1443.656..1456.005 rows=114 loops=1)
                           Hash Cond: (mi_idx1.info_type_id = it1.id)
                           ->  Merge Join  (cost=131370.59..133565.36 rows=70 width=81) (actual time=1443.571..1455.872 rows=342 loops=1)
                                 Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                 ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.026..9.140 rows=50698 loops=1)
                                 ->  Sort  (cost=131370.16..131370.22 rows=23 width=68) (actual time=1441.103..1441.131 rows=347 loops=1)
                                       Sort Key: mc1.movie_id
                                       Sort Method: quicksort  Memory: 42kB
                                       ->  Gather  (cost=124052.14..131369.64 rows=23 width=68) (actual time=1411.445..1476.809 rows=121 loops=1)
                                             Workers Planned: 1
                                             Workers Launched: 1
                                             ->  Hash Join  (cost=123052.14..130367.34 rows=14 width=68) (actual time=1404.961..1433.838 rows=60 loops=2)
                                                   Hash Cond: (t2.kind_id = kt2.id)
                                                   ->  Parallel Hash Join  (cost=123051.03..130366.03 rows=47 width=72) (actual time=1403.967..1433.635 rows=70 loops=2)
                                                         Hash Cond: (cn2.id = mc2.company_id)
                                                         ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.005..16.191 rows=117498 loops=2)
                                                         ->  Parallel Hash  (cost=123050.62..123050.62 rows=33 width=57) (actual time=1403.336..1403.336 rows=70 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=89312.34..123050.62 rows=33 width=57) (actual time=1012.904..1403.231 rows=70 loops=2)
                                                                     Hash Cond: (mc2.movie_id = t2.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.008..230.961 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=89311.94..89311.94 rows=32 width=65) (actual time=1011.495..1011.495 rows=38 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=33182.88..89311.94 rows=32 width=65) (actual time=561.001..1011.350 rows=38 loops=2)
                                                                                 Hash Cond: (t2.id = ml.linked_movie_id)
                                                                                 ->  Parallel Seq Scan on title t2  (cost=0.00..51799.95 rows=432897 width=25) (actual time=0.016..405.049 rows=521400 loops=2)
                                                                                       Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                                                       Rows Removed by Filter: 742756
                                                                                 ->  Parallel Hash  (cost=33181.88..33181.88 rows=80 width=40) (actual time=550.310..550.310 rows=49 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Parallel Hash Join  (cost=26712.90..33181.88 rows=80 width=40) (actual time=477.307..550.073 rows=49 loops=2)
                                                                                             Hash Cond: (mc1.company_id = cn1.id)
                                                                                             ->  Hash Join  (cost=21066.29..27534.89 rows=149 width=25) (actual time=405.163..477.610 rows=63 loops=2)
                                                                                                   Hash Cond: (mi_idx2.info_type_id = it2.id)
                                                                                                   ->  Parallel Hash Join  (cost=21063.87..27486.73 rows=16791 width=29) (actual time=404.808..476.846 rows=6846 loops=2)
                                                                                                         Hash Cond: (ml.linked_movie_id = mi_idx2.movie_id)
                                                                                                         ->  Merge Join  (cost=869.16..5648.12 rows=10916 width=16) (actual time=8.955..37.901 rows=5049 loops=2)
                                                                                                               Merge Cond: (mc1.movie_id = ml.movie_id)
                                                                                                               ->  Parallel Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..116330.44 rows=1087137 width=8) (actual time=0.016..21.631 rows=49939 loops=2)
                                                                                                               ->  Sort  (cost=868.72..881.22 rows=5000 width=8) (actual time=8.821..9.231 rows=6226 loops=2)
                                                                                                                     Sort Key: ml.movie_id
                                                                                                                     Sort Method: quicksort  Memory: 205kB
                                                                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                                     ->  Hash Join  (cost=1.29..561.53 rows=5000 width=8) (actual time=0.087..7.869 rows=2315 loops=2)
                                                                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.034..3.786 rows=29997 loops=2)
                                                                                                                           ->  Hash  (cost=1.25..1.25 rows=3 width=4) (actual time=0.035..0.036 rows=2 loops=2)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.25 rows=3 width=4) (actual time=0.029..0.033 rows=2 loops=2)
                                                                                                                                       Filter: ((link)::text = ANY ('{sequel,follows,"followed by"}'::text[]))
                                                                                                                                       Rows Removed by Filter: 16
                                                                                                         ->  Parallel Hash  (cost=15122.68..15122.68 rows=291762 width=13) (actual time=353.989..353.989 rows=351960 loops=2)
                                                                                                               Buckets: 131072  Batches: 16  Memory Usage: 3360kB
                                                                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=291762 width=13) (actual time=0.024..228.154 rows=351960 loops=2)
                                                                                                                     Filter: ((info)::text < '3.5'::text)
                                                                                                                     Rows Removed by Filter: 338058
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=2)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.039 rows=1 loops=2)
                                                                                                               Filter: ((info)::text = 'rating'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=73895 width=23) (actual time=70.818..70.818 rows=63115 loops=2)
                                                                                                   Buckets: 131072  Batches: 1  Memory Usage: 8256kB
                                                                                                   ->  Parallel Seq Scan on company_name cn1  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.019..37.011 rows=63115 loops=2)
                                                                                                         Filter: ((country_code)::text <> '[us]'::text)
                                                                                                         Rows Removed by Filter: 54384
                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.061..0.061 rows=2 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=2 width=4) (actual time=0.039..0.042 rows=2 loops=2)
                                                               Filter: ((kind)::text = ANY ('{"tv series",episode}'::text[]))
                                                               Rows Removed by Filter: 5
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=1)
                                       Filter: ((info)::text = 'rating'::text)
                                       Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.036..0.036 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=2 width=4) (actual time=0.013..0.016 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{"tv series",episode}'::text[]))
                     Rows Removed by Filter: 5
 Planning Time: 109.977 ms
 Execution Time: 1615.943 ms
(92 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=389853.80..389853.81 rows=1 width=32) (actual time=2965.824..2965.824 rows=1 loops=1)
   ->  Gather  (cost=389853.58..389853.79 rows=2 width=32) (actual time=2965.524..2970.917 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=388853.58..388853.59 rows=1 width=32) (actual time=2959.249..2959.249 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=337023.30..388853.51 rows=30 width=17) (actual time=2812.196..2959.162 rows=69 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.016..265.655 rows=337640 loops=3)
                           Filter: (production_year > 2005)
                           Rows Removed by Filter: 505131
                     ->  Parallel Hash  (cost=337022.38..337022.38 rows=74 width=8) (actual time=2644.625..2644.625 rows=589 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=50880.48..337022.38 rows=74 width=8) (actual time=601.938..2644.082 rows=589 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..285615.00 rows=60182 width=4) (actual time=0.938..2035.950 rows=51299 loops=3)
                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                                       Rows Removed by Filter: 4893941
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=597.299..597.299 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=35.835..473.346 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..253.205 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=34.156..34.156 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.736..34.102 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.864 ms
 Execution Time: 2971.311 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3b.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=340923.67..340923.68 rows=1 width=32) (actual time=2193.381..2193.381 rows=1 loops=1)
   ->  Gather  (cost=340923.45..340923.66 rows=2 width=32) (actual time=2193.019..2199.371 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=339923.45..339923.46 rows=1 width=32) (actual time=2186.213..2186.214 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=290135.26..339923.45 rows=1 width=17) (actual time=2149.326..2186.186 rows=2 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.014..256.362 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=290135.24..290135.24 rows=1 width=8) (actual time=1911.989..1911.989 rows=7 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=50880.48..290135.24 rows=1 width=8) (actual time=694.903..1911.880 rows=7 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=158 width=4) (actual time=75.613..1314.844 rows=762 loops=3)
                                       Filter: ((info)::text = 'Bulgaria'::text)
                                       Rows Removed by Filter: 4944478
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=596.388..596.388 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=36.911..478.152 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..255.398 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=36.004..36.005 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.783..35.952 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.727 ms
 Execution Time: 2199.816 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=409155.23..409155.24 rows=1 width=32) (actual time=3537.257..3537.257 rows=1 loops=1)
   ->  Gather  (cost=409155.02..409155.23 rows=2 width=32) (actual time=3536.876..3542.333 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=408155.02..408155.03 rows=1 width=32) (actual time=3530.598..3530.598 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=354417.68..408154.42 rows=241 width=17) (actual time=3180.231..3529.277 rows=2417 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.016..279.355 rows=583011 loops=3)
                           Filter: (production_year > 1990)
                           Rows Removed by Filter: 259760
                     ->  Parallel Hash  (cost=354413.34..354413.34 rows=347 width=8) (actual time=3174.288..3174.288 rows=4054 loops=3)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                           ->  Parallel Hash Join  (cost=50880.48..354413.34 rows=347 width=8) (actual time=608.386..2856.253 rows=4054 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=4) (actual time=1.027..2218.072 rows=235558 loops=3)
                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                       Rows Removed by Filter: 4709682
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=603.381..603.382 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=35.317..473.483 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..254.028 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=34.089..34.089 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.722..34.035 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.986 ms
 Execution Time: 3542.722 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4a.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=118372.74..118372.75 rows=1 width=64) (actual time=1203.880..1203.880 rows=1 loops=1)
   ->  Gather  (cost=67607.95..118372.73 rows=2 width=22) (actual time=944.047..1208.424 rows=740 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=66607.95..117372.53 rows=1 width=22) (actual time=942.800..1196.665 rows=247 loops=3)
               Hash Cond: (t.id = mi_idx.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.012..264.107 rows=337640 loops=3)
                     Filter: (production_year > 2005)
                     Rows Removed by Filter: 505131
               ->  Parallel Hash  (cost=66607.92..66607.92 rows=2 width=13) (actual time=886.170..886.170 rows=1940 loops=3)
                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                     ->  Parallel Hash Join  (cost=50882.90..66607.92 rows=2 width=13) (actual time=611.206..806.549 rows=1940 loops=3)
                           Hash Cond: (mi_idx.movie_id = mk.movie_id)
                           ->  Hash Join  (cost=2.43..15720.19 rows=1934 width=9) (actual time=0.167..179.231 rows=117663 loops=3)
                                 Hash Cond: (mi_idx.info_type_id = it.id)
                                 ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=218500 width=13) (actual time=0.029..145.050 rows=174440 loops=3)
                                       Filter: ((info)::text > '5.0'::text)
                                       Rows Removed by Filter: 285572
                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.063..0.064 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.048 rows=1 loops=3)
                                             Filter: ((info)::text = 'rating'::text)
                                             Rows Removed by Filter: 112
                           ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=610.447..610.447 rows=4317 loops=3)
                                 Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                 ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=35.708..475.436 rows=4317 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..254.287 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=34.848..34.848 rows=30 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.738..34.795 rows=30 loops=3)
                                                   Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                   Rows Removed by Filter: 134140
 Planning Time: 4.184 ms
 Execution Time: 1209.368 ms
(35 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4b.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=116799.72..116799.73 rows=1 width=64) (actual time=874.544..874.545 rows=1 loops=1)
   ->  Gather  (cost=67011.42..116799.71 rows=1 width=22) (actual time=844.339..879.795 rows=6 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=66011.42..115799.61 rows=1 width=22) (actual time=821.905..868.095 rows=2 loops=3)
               Hash Cond: (t.id = mi_idx.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.012..245.928 rows=130555 loops=3)
                     Filter: (production_year > 2010)
                     Rows Removed by Filter: 712215
               ->  Parallel Hash  (cost=66011.41..66011.41 rows=1 width=13) (actual time=604.514..604.514 rows=7 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=17758.80..66011.41 rows=1 width=13) (actual time=286.265..604.382 rows=7 loops=3)
                           Hash Cond: (mk.movie_id = mi_idx.movie_id)
                           ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=35.542..474.318 rows=4317 loops=3)
                                 Hash Cond: (mk.keyword_id = k.id)
                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.023..254.029 rows=1507977 loops=3)
                                 ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=34.909..34.909 rows=30 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.720..34.861 rows=30 loops=3)
                                             Filter: ((keyword)::text ~~ '%sequel%'::text)
                                             Rows Removed by Filter: 134140
                           ->  Parallel Hash  (cost=15132.23..15132.23 rows=23 width=9) (actual time=129.028..129.028 rows=102 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Hash Join  (cost=2.43..15132.23 rows=23 width=9) (actual time=2.449..128.893 rows=102 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=2615 width=13) (actual time=0.177..127.844 rows=2794 loops=3)
                                             Filter: ((info)::text > '9.0'::text)
                                             Rows Removed by Filter: 457218
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.047 rows=1 loops=3)
                                                   Filter: ((info)::text = 'rating'::text)
                                                   Rows Removed by Filter: 112
 Planning Time: 4.183 ms
 Execution Time: 880.274 ms
(35 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=119900.33..119900.34 rows=1 width=64) (actual time=1276.008..1276.009 rows=1 loops=1)
   ->  Gather  (cost=119900.11..119900.32 rows=2 width=64) (actual time=1275.526..1282.118 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=118900.11..118900.12 rows=1 width=64) (actual time=1268.841..1268.842 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=66992.13..118900.10 rows=2 width=22) (actual time=901.765..1267.459 rows=1567 loops=3)
                     Hash Cond: (t.id = mi_idx.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.012..289.945 rows=583011 loops=3)
                           Filter: (production_year > 1990)
                           Rows Removed by Filter: 259760
                     ->  Parallel Hash  (cost=66992.09..66992.09 rows=3 width=13) (actual time=898.331..898.331 rows=2697 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 568kB
                           ->  Parallel Hash Join  (cost=50882.90..66992.09 rows=3 width=13) (actual time=607.720..833.610 rows=2697 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                 ->  Hash Join  (cost=2.43..16099.73 rows=3167 width=9) (actual time=0.193..205.694 rows=149656 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=357862 width=13) (actual time=0.034..156.381 rows=287152 loops=3)
                                             Filter: ((info)::text > '2.0'::text)
                                             Rows Removed by Filter: 172860
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.077..0.078 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.058..0.061 rows=1 loops=3)
                                                   Filter: ((info)::text = 'rating'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=606.863..606.863 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.822..479.677 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..258.975 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=34.543..34.543 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.756..34.491 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 4.107 ms
 Execution Time: 1282.596 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5a.sql_explained.sql
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=372724.06..372724.07 rows=1 width=32) (actual time=262.257..262.257 rows=1 loops=1)
   ->  Gather  (cost=372723.84..372724.05 rows=2 width=32) (actual time=262.163..264.231 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=371723.84..371723.85 rows=1 width=32) (actual time=255.755..255.755 rows=1 loops=3)
               ->  Hash Join  (cost=85882.87..371723.72 rows=48 width=17) (actual time=255.753..255.753 rows=0 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=85879.33..371720.05 rows=48 width=21) (actual time=255.443..255.444 rows=0 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..285615.00 rows=60182 width=8) (never executed)
                                 Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                           ->  Parallel Hash  (cost=85877.27..85877.27 rows=165 width=25) (actual time=254.927..254.927 rows=0 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                 ->  Parallel Hash Join  (cost=35112.01..85877.27 rows=165 width=25) (actual time=254.866..254.866 rows=0 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (never executed)
                                             Filter: (production_year > 2005)
                                       ->  Parallel Hash  (cost=35106.92..35106.92 rows=407 width=4) (actual time=254.825..254.825 rows=0 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                             ->  Hash Join  (cost=1.06..35106.92 rows=407 width=4) (actual time=254.801..254.801 rows=0 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=1629 width=8) (actual time=9.812..253.089 rows=8008 loops=3)
                                                         Filter: (((note)::text ~~ '%(theatrical)%'::text) AND ((note)::text ~~ '%(France)%'::text))
                                                         Rows Removed by Filter: 861701
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.093..0.093 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.033..0.047 rows=113 loops=3)
 Planning Time: 4.454 ms
 Execution Time: 264.652 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5b.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=328691.22..328691.23 rows=1 width=32) (actual time=248.588..248.588 rows=1 loops=1)
   ->  Gather  (cost=328691.00..328691.21 rows=2 width=32) (actual time=248.490..250.547 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=327691.00..327691.01 rows=1 width=32) (actual time=241.947..241.947 rows=1 loops=3)
               ->  Hash Join  (cost=87607.92..327691.00 rows=1 width=17) (actual time=241.944..241.944 rows=0 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=87604.38..327687.46 rows=1 width=21) (actual time=241.628..241.628 rows=0 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=221252 width=8) (never executed)
                                 Filter: ((info)::text = ANY ('{USA,America}'::text[]))
                           ->  Parallel Hash  (cost=87604.36..87604.36 rows=1 width=25) (actual time=241.257..241.257 rows=0 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                 ->  Parallel Hash Join  (cost=37816.17..87604.36 rows=1 width=25) (actual time=241.187..241.188 rows=0 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (never executed)
                                             Filter: (production_year > 2010)
                                       ->  Parallel Hash  (cost=37816.09..37816.09 rows=6 width=4) (actual time=241.148..241.148 rows=0 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                             ->  Hash Join  (cost=1.06..37816.09 rows=6 width=4) (actual time=241.118..241.118 rows=0 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=25 width=8) (actual time=9.852..240.795 rows=473 loops=3)
                                                         Filter: (((note)::text ~~ '%(VHS)%'::text) AND ((note)::text ~~ '%(USA)%'::text) AND ((note)::text ~~ '%(1994)%'::text))
                                                         Rows Removed by Filter: 869237
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.028..0.030 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.092..0.092 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.029..0.043 rows=113 loops=3)
 Planning Time: 4.750 ms
 Execution Time: 250.985 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5c.sql_explained.sql
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=391106.63..391106.64 rows=1 width=32) (actual time=2933.852..2933.852 rows=1 loops=1)
   ->  Gather  (cost=391106.42..391106.63 rows=2 width=32) (actual time=2933.464..2938.855 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=390106.42..390106.43 rows=1 width=32) (actual time=2927.080..2927.080 rows=1 loops=3)
               ->  Hash Join  (cost=87874.47..390061.87 rows=17818 width=17) (actual time=712.570..2926.840 rows=223 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=87870.93..390009.80 rows=17818 width=21) (actual time=712.261..2926.395 rows=223 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.036..2256.868 rows=235558 loops=3)
                                 Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                 Rows Removed by Filter: 4709682
                           ->  Parallel Hash  (cost=87706.73..87706.73 rows=13136 width=25) (actual time=641.943..641.943 rows=256 loops=3)
                                 Buckets: 32768  Batches: 1  Memory Usage: 352kB
                                 ->  Parallel Hash Join  (cost=35744.04..87706.73 rows=13136 width=25) (actual time=304.664..641.288 rows=256 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.022..285.306 rows=583011 loops=3)
                                             Filter: (production_year > 1990)
                                             Rows Removed by Filter: 259760
                                       ->  Parallel Hash  (cost=35507.44..35507.44 rows=18928 width=4) (actual time=292.255..292.255 rows=266 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 608kB
                                             ->  Hash Join  (cost=1.06..35507.44 rows=18928 width=4) (actual time=208.298..291.922 rows=266 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=75712 width=8) (actual time=0.028..281.527 rows=98543 loops=3)
                                                         Filter: (((note)::text !~~ '%(TV)%'::text) AND ((note)::text ~~ '%(USA)%'::text))
                                                         Rows Removed by Filter: 771167
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.093..0.093 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.032..0.046 rows=113 loops=3)
 Planning Time: 4.446 ms
 Execution Time: 2939.293 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=622340.59..622340.60 rows=1 width=96) (actual time=4837.529..4837.529 rows=1 loops=1)
   ->  Gather  (cost=622340.37..622340.58 rows=2 width=96) (actual time=4837.303..4842.507 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=621340.37..621340.38 rows=1 width=96) (actual time=4830.740..4830.741 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=571552.17..621340.36 rows=1 width=48) (actual time=4801.405..4830.704 rows=2 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.019..249.587 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=39) (actual time=4563.465..4563.465 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=39) (actual time=3461.501..4563.340 rows=2 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=794.969..4100.456 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.029..2145.759 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=488.660..488.661 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=196.502..488.571 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=462.790..462.790 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=101.080..462.704 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.017..257.522 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=22.162..22.162 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.531..22.142 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.670 ms
 Execution Time: 4843.063 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6b.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=622719.90..622719.91 rows=1 width=96) (actual time=5093.613..5093.613 rows=1 loops=1)
   ->  Gather  (cost=622719.67..622719.88 rows=2 width=96) (actual time=5093.034..5098.810 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=621719.67..621719.68 rows=1 width=96) (actual time=5086.515..5086.515 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=544400.32..621719.67 rows=1 width=48) (actual time=4935.779..5086.499 rows=4 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=202.265..503.705 rows=1 loops=3)
                           Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                           Rows Removed by Filter: 1389163
                     ->  Parallel Hash  (cost=544400.31..544400.31 rows=1 width=37) (actual time=4582.137..4582.137 rows=128 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=101052.25..544400.31 rows=1 width=37) (actual time=936.325..4581.871 rows=128 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=49166.44..492513.86 rows=167 width=29) (actual time=260.983..4029.464 rows=1033 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.026..2189.218 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=49166.29..49166.29 rows=12 width=21) (actual time=235.059..235.059 rows=146 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=12 width=21) (actual time=77.599..234.772 rows=146 loops=3)
                                                   Filter: (production_year > 2014)
                                                   Rows Removed by Filter: 842625
                                 ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=551.808..551.808 rows=11849 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                       ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.956..487.850 rows=11849 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..254.891 rows=1507977 loops=3)
                                             ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=44.557..44.557 rows=8 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.182..44.532 rows=8 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                         Rows Removed by Filter: 134162
 Planning Time: 4.798 ms
 Execution Time: 5099.289 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=621712.31..621712.32 rows=1 width=96) (actual time=5154.274..5154.275 rows=1 loops=1)
   ->  Gather  (cost=621712.09..621712.30 rows=2 width=96) (actual time=5154.020..5160.538 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=620712.09..620712.10 rows=1 width=96) (actual time=5147.290..5147.290 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=543392.73..620712.08 rows=1 width=48) (actual time=4992.013..5147.277 rows=1 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=208.081..518.616 rows=1 loops=3)
                           Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                           Rows Removed by Filter: 1389163
                     ->  Parallel Hash  (cost=543392.72..543392.72 rows=1 width=37) (actual time=4627.918..4627.918 rows=11 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=100044.67..543392.72 rows=1 width=37) (actual time=1295.535..4627.763 rows=11 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=49166.44..492513.86 rows=167 width=29) (actual time=253.671..4155.942 rows=1033 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.037..2307.986 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=49166.29..49166.29 rows=12 width=21) (actual time=239.212..239.212 rows=146 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=12 width=21) (actual time=84.903..238.906 rows=146 loops=3)
                                                   Filter: (production_year > 2014)
                                                   Rows Removed by Filter: 842625
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=471.547..471.547 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=101.947..471.470 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..265.905 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=22.854..22.854 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.543..22.832 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.492 ms
 Execution Time: 5161.095 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6d.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=624885.62..624885.63 rows=1 width=96) (actual time=4937.746..4937.746 rows=1 loops=1)
   ->  Gather  (cost=624885.39..624885.60 rows=2 width=96) (actual time=4937.151..4942.485 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=623885.39..623885.40 rows=1 width=96) (actual time=4930.503..4930.503 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=572559.75..623885.39 rows=1 width=48) (actual time=4769.934..4930.433 rows=29 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.015..267.870 rows=460484 loops=3)
                           Filter: (production_year > 2000)
                           Rows Removed by Filter: 382286
                     ->  Parallel Hash  (cost=572559.74..572559.74 rows=1 width=39) (actual time=4614.172..4614.172 rows=37 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=129206.67..572559.74 rows=1 width=39) (actual time=1363.040..4614.012 rows=37 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=804.511..4055.384 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.030..2089.107 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=503.256..503.257 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=202.139..503.198 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=558.421..558.421 rows=11849 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                       ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.772..485.200 rows=11849 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..252.489 rows=1507977 loops=3)
                                             ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=44.439..44.439 rows=8 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.181..44.414 rows=8 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                         Rows Removed by Filter: 134162
 Planning Time: 4.844 ms
 Execution Time: 4942.961 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6e.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=623878.03..623878.04 rows=1 width=96) (actual time=4990.214..4990.214 rows=1 loops=1)
   ->  Gather  (cost=623877.81..623878.02 rows=2 width=96) (actual time=4989.943..4996.964 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=622877.81..622877.82 rows=1 width=96) (actual time=4983.120..4983.120 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=571552.17..622877.80 rows=1 width=48) (actual time=4946.027..4983.098 rows=2 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.015..276.166 rows=460484 loops=3)
                           Filter: (production_year > 2000)
                           Rows Removed by Filter: 382286
                     ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=39) (actual time=4659.925..4659.925 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=39) (actual time=3536.540..4659.774 rows=2 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=826.514..4196.250 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.400..2217.517 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=514.152..514.152 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=206.414..514.048 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=463.415..463.415 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=144.331..463.345 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..257.707 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=22.916..22.916 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.537..22.894 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.479 ms
 Execution Time: 4997.547 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6f.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=652048.60..652048.61 rows=1 width=96) (actual time=6948.048..6948.049 rows=1 loops=1)
   ->  Gather  (cost=652048.38..652048.59 rows=2 width=96) (actual time=6944.010..7073.957 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=651048.38..651048.39 rows=1 width=96) (actual time=6937.343..6937.343 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=565020.96..651031.37 rows=2268 width=48) (actual time=6317.234..6829.172 rows=261826 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.045..383.262 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=564992.61..564992.61 rows=2268 width=37) (actual time=5395.199..5395.199 rows=261826 loops=3)
                           Buckets: 65536 (originally 8192)  Batches: 16 (originally 1)  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=104652.02..564992.61 rows=2268 width=37) (actual time=950.050..5125.893 rows=261826 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.035..2171.206 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=104651.25..104651.25 rows=62 width=41) (actual time=949.884..949.884 rows=4722 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1304kB
                                       ->  Parallel Hash Join  (cost=51885.81..104651.25 rows=62 width=41) (actual time=556.453..894.520 rows=4722 loops=3)
                                             Hash Cond: (t.id = mk.movie_id)
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.012..272.989 rows=460484 loops=3)
                                                   Filter: (production_year > 2000)
                                                   Rows Removed by Filter: 382286
                                             ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=556.211..556.211 rows=11849 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                                   ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.344..488.298 rows=11849 loops=3)
                                                         Hash Cond: (mk.keyword_id = k.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..255.677 rows=1507977 loops=3)
                                                         ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=44.167..44.167 rows=8 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.179..44.138 rows=8 loops=3)
                                                                     Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                                     Rows Removed by Filter: 134162
 Planning Time: 4.810 ms
 Execution Time: 7075.634 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7a.sql_explained.sql
SET
SET
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=693399.56..693399.57 rows=1 width=64) (actual time=6747.595..6747.595 rows=1 loops=1)
   ->  Gather  (cost=693399.34..693399.55 rows=2 width=64) (actual time=6747.365..6752.432 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=692399.34..692399.35 rows=1 width=64) (actual time=6739.928..6739.928 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=675186.31..692399.33 rows=1 width=32) (actual time=6613.618..6739.902 rows=11 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..16090.49 rows=299338 width=4) (actual time=0.035..115.139 rows=224897 loops=3)
                           Filter: ((name)::text ~~ '%a%'::text)
                           Rows Removed by Filter: 75550
                     ->  Parallel Hash  (cost=675186.30..675186.30 rows=1 width=44) (actual time=6602.370..6602.370 rows=5 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=622849.52..675186.30 rows=1 width=44) (actual time=6558.737..6602.242 rows=5 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=622267.21..674603.97 rows=1 width=52) (actual time=6314.554..6590.699 rows=130 loops=3)
                                       Hash Cond: (t.id = ci.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=143147 width=21) (actual time=0.021..257.689 rows=113395 loops=3)
                                             Filter: ((production_year >= 1980) AND (production_year <= 1995))
                                             Rows Removed by Filter: 729375
                                       ->  Parallel Hash  (cost=622267.19..622267.19 rows=1 width=31) (actual time=6313.836..6313.836 rows=890 loops=3)
                                             Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                             ->  Parallel Hash Join  (cost=161930.27..622267.19 rows=1 width=31) (actual time=1088.030..4653.809 rows=890 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.034..2120.222 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=161930.25..161930.25 rows=1 width=23) (actual time=1054.002..1054.002 rows=6 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=66488.22..161930.25 rows=1 width=23) (actual time=351.526..1053.908 rows=6 loops=3)
                                                               Hash Cond: (n.id = pi.person_id)
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..94683.23 rows=202346 width=19) (actual time=0.051..713.445 rows=181097 loops=3)
                                                                     Filter: (((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'B%'::text))))
                                                                     Rows Removed by Filter: 1208067
                                                               ->  Parallel Hash  (cost=66488.21..66488.21 rows=1 width=4) (actual time=320.873..320.873 rows=21 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Hash Join  (cost=2.43..66488.21 rows=1 width=4) (actual time=27.532..320.801 rows=21 loops=3)
                                                                           Hash Cond: (pi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on person_info pi  (cost=0.00..66485.75 rows=12 width=8) (actual time=27.413..320.657 rows=21 loops=3)
                                                                                 Filter: ((note)::text = 'Volker Boehm'::text)
                                                                                 Rows Removed by Filter: 987867
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.047 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'mini biography'::text)
                                                                                       Rows Removed by Filter: 112
                                 ->  Hash  (cost=561.48..561.48 rows=1666 width=4) (actual time=11.426..11.426 rows=5186 loops=3)
                                       Buckets: 8192 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 247kB
                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=4) (actual time=0.190..9.701 rows=5186 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.043..5.061 rows=29997 loops=3)
                                             ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.030..0.032 rows=1 loops=3)
                                                         Filter: ((link)::text = 'features'::text)
                                                         Rows Removed by Filter: 17
 Planning Time: 14.701 ms
 Execution Time: 6753.239 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7b.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=663974.41..663974.42 rows=1 width=64) (actual time=5194.353..5194.353 rows=1 loops=1)
   ->  Gather  (cost=663974.19..663974.40 rows=2 width=64) (actual time=5192.793..5199.178 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=662974.19..662974.20 rows=1 width=64) (actual time=5185.780..5185.781 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=645761.16..662974.18 rows=1 width=32) (actual time=5147.746..5185.756 rows=5 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..16090.49 rows=299338 width=4) (actual time=0.051..115.398 rows=224897 loops=3)
                           Filter: ((name)::text ~~ '%a%'::text)
                           Rows Removed by Filter: 75550
                     ->  Parallel Hash  (cost=645761.15..645761.15 rows=1 width=44) (actual time=5047.965..5047.965 rows=3 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Hash Join  (cost=201453.00..645761.15 rows=1 width=44) (actual time=4626.276..5047.740 rows=3 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=200870.69..645178.82 rows=1 width=52) (actual time=3006.966..5036.345 rows=7 loops=3)
                                       Hash Cond: (n.id = pi.person_id)
                                       ->  Parallel Hash Join  (cost=134382.47..578648.77 rows=11153 width=48) (actual time=1025.835..4721.201 rows=11015 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Hash Join  (cost=82162.96..525510.35 rows=350058 width=27) (actual time=477.859..4386.373 rows=304108 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.027..2188.002 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=40251 width=19) (actual time=476.963..476.963 rows=30659 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 6048kB
                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40251 width=19) (actual time=0.089..455.810 rows=30659 loops=3)
                                                               Filter: (((name_pcode_cf)::text ~~ 'D%'::text) AND ((gender)::text = 'm'::text))
                                                               Rows Removed by Filter: 1358505
                                             ->  Parallel Hash  (cost=51799.95..51799.95 rows=33565 width=21) (actual time=274.740..274.740 rows=25355 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 5376kB
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=33565 width=21) (actual time=0.020..251.070 rows=25355 loops=3)
                                                         Filter: ((production_year >= 1980) AND (production_year <= 1984))
                                                         Rows Removed by Filter: 817416
                                       ->  Parallel Hash  (cost=66488.21..66488.21 rows=1 width=4) (actual time=313.823..313.823 rows=21 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=2.43..66488.21 rows=1 width=4) (actual time=6.773..313.749 rows=21 loops=3)
                                                   Hash Cond: (pi.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on person_info pi  (cost=0.00..66485.75 rows=12 width=8) (actual time=6.653..313.604 rows=21 loops=3)
                                                         Filter: ((note)::text = 'Volker Boehm'::text)
                                                         Rows Removed by Filter: 987867
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.050 rows=1 loops=3)
                                                               Filter: ((info)::text = 'mini biography'::text)
                                                               Rows Removed by Filter: 112
                                 ->  Hash  (cost=561.48..561.48 rows=1666 width=4) (actual time=11.339..11.340 rows=5186 loops=3)
                                       Buckets: 8192 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 247kB
                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=4) (actual time=0.172..9.663 rows=5186 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.043..5.047 rows=29997 loops=3)
                                             ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.029..0.032 rows=1 loops=3)
                                                         Filter: ((link)::text = 'features'::text)
                                                         Rows Removed by Filter: 17
 Planning Time: 14.323 ms
 Execution Time: 5199.909 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7c.sql_explained.sql
SET
SET
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=697422.31..697422.32 rows=1 width=64) (actual time=8763.341..8763.341 rows=1 loops=1)
   ->  Gather  (cost=697422.09..697422.30 rows=2 width=64) (actual time=8757.477..9424.361 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=696422.09..696422.10 rows=1 width=64) (actual time=8750.236..8750.237 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=678258.59..696422.08 rows=2 width=109) (actual time=8551.685..8622.470 rows=22728 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..17029.39 rows=302423 width=4) (actual time=0.039..119.704 rows=228698 loops=3)
                           Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%a%'::text) OR ((name)::text ~~ 'A%'::text)))
                           Rows Removed by Filter: 71749
                     ->  Parallel Hash  (cost=678258.58..678258.58 rows=1 width=121) (actual time=8347.462..8347.462 rows=13386 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 2592kB
                           ->  Hash Join  (cost=624016.03..678258.58 rows=1 width=121) (actual time=7621.003..8258.239 rows=13386 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=623371.14..677606.36 rows=189 width=129) (actual time=7601.501..8209.264 rows=176455 loops=3)
                                       Hash Cond: (t.id = ci.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=649194 width=4) (actual time=0.036..294.168 rows=518532 loops=3)
                                             Filter: ((production_year >= 1980) AND (production_year <= 2010))
                                             Rows Removed by Filter: 324238
                                       ->  Parallel Hash  (cost=623367.30..623367.30 rows=307 width=125) (actual time=7046.906..7046.906 rows=305764 loops=3)
                                             Buckets: 8192 (originally 1024)  Batches: 256 (originally 1)  Memory Usage: 3232kB
                                             ->  Parallel Hash Join  (cost=163029.14..623367.30 rows=307 width=125) (actual time=1309.341..5202.702 rows=305764 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.042..2167.703 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=163028.71..163028.71 rows=35 width=117) (actual time=1308.876..1308.877 rows=4354 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 11416kB
                                                         ->  Parallel Hash Join  (cost=98354.03..163028.71 rows=35 width=117) (actual time=1205.855..1272.712 rows=4354 loops=3)
                                                               Hash Cond: (pi.person_id = n.id)
                                                               ->  Hash Join  (cost=2.43..63495.30 rows=306 width=98) (actual time=0.101..342.241 rows=28061 loops=3)
                                                                     Hash Cond: (pi.info_type_id = it.id)
                                                                     ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=34617 width=102) (actual time=0.039..324.347 rows=28061 loops=3)
                                                                           Filter: (note IS NOT NULL)
                                                                           Rows Removed by Filter: 959827
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.046 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'mini biography'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=94683.23..94683.23 rows=199790 width=19) (actual time=775.850..775.850 rows=169207 loops=3)
                                                                     Buckets: 65536  Batches: 8  Memory Usage: 4032kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..94683.23 rows=199790 width=19) (actual time=0.084..714.292 rows=169207 loops=3)
                                                                           Filter: (((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'A%'::text))))
                                                                           Rows Removed by Filter: 1219957
                                 ->  Hash  (cost=561.57..561.57 rows=6666 width=4) (actual time=18.692..18.692 rows=21505 loops=3)
                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 1013kB
                                       ->  Hash Join  (cost=1.32..561.57 rows=6666 width=4) (actual time=0.156..12.013 rows=21505 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.043..5.134 rows=29997 loops=3)
                                             ->  Hash  (cost=1.27..1.27 rows=4 width=4) (actual time=0.061..0.061 rows=4 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.27 rows=4 width=4) (actual time=0.030..0.035 rows=4 loops=3)
                                                         Filter: ((link)::text = ANY ('{references,"referenced in",features,"featured in"}'::text[]))
                                                         Rows Removed by Filter: 14
 Planning Time: 14.679 ms
 Execution Time: 9425.304 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8a.sql_explained.sql
SET
SET
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=631023.55..631023.56 rows=1 width=64) (actual time=3688.304..3688.304 rows=1 loops=1)
   ->  Gather  (cost=631023.33..631023.54 rows=2 width=64) (actual time=3687.441..3694.722 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=630023.33..630023.34 rows=1 width=64) (actual time=3680.216..3680.216 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=579540.20..630023.33 rows=1 width=33) (actual time=3422.708..3680.161 rows=21 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.018..224.873 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=579540.18..579540.18 rows=1 width=24) (actual time=3352.072..3352.072 rows=21 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=563388.51..579540.18 rows=1 width=24) (actual time=3322.565..3351.969 rows=21 loops=3)
                                 Hash Cond: (an1.person_id = ci.person_id)
                                 ->  Parallel Hash Join  (cost=81879.04..98016.48 rows=3793 width=24) (actual time=505.246..622.480 rows=1344 loops=3)
                                       Hash Cond: (an1.person_id = n1.id)
                                       ->  Parallel Seq Scan on aka_name an1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.025..73.541 rows=300448 loops=3)
                                       ->  Parallel Hash  (cost=81659.82..81659.82 rows=17538 width=4) (actual time=504.513..504.514 rows=6970 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 1376kB
                                             ->  Parallel Seq Scan on name n1  (cost=0.00..81659.82 rows=17538 width=4) (actual time=0.199..498.553 rows=6970 loops=3)
                                                   Filter: (((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))
                                                   Rows Removed by Filter: 1382193
                                 ->  Parallel Hash  (cost=481509.44..481509.44 rows=2 width=12) (actual time=2729.098..2729.098 rows=2479 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 504kB
                                       ->  Hash Join  (cost=39896.72..481509.44 rows=2 width=12) (actual time=1084.864..2629.047 rows=2479 loops=3)
                                             Hash Cond: (ci.role_id = rt.id)
                                             ->  Parallel Hash Join  (cost=39895.56..481508.19 rows=25 width=16) (actual time=296.745..2627.479 rows=6533 loops=3)
                                                   Hash Cond: (ci.movie_id = mc.movie_id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=40775 width=12) (actual time=0.883..2322.564 rows=31032 loops=3)
                                                         Filter: ((note)::text = '(voice: English version)'::text)
                                                         Rows Removed by Filter: 12050416
                                                   ->  Parallel Hash  (cost=39892.48..39892.48 rows=246 width=4) (actual time=295.402..295.402 rows=16109 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2968kB
                                                         ->  Parallel Hash Join  (cost=4773.19..39892.48 rows=246 width=4) (actual time=23.975..266.165 rows=16109 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=8470 width=8) (actual time=0.053..235.907 rows=16299 loops=3)
                                                                     Filter: (((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text))
                                                                     Rows Removed by Filter: 853411
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=4022 width=4) (actual time=23.816..23.816 rows=2251 loops=3)
                                                                     Buckets: 8192  Batches: 1  Memory Usage: 384kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=4022 width=4) (actual time=0.030..22.392 rows=2251 loops=3)
                                                                           Filter: ((country_code)::text = '[jp]'::text)
                                                                           Rows Removed by Filter: 76082
                                             ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.048..0.051 rows=1 loops=3)
                                                         Filter: ((role)::text = 'actress'::text)
                                                         Rows Removed by Filter: 11
 Planning Time: 9.435 ms
 Execution Time: 3695.373 ms
(48 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8b.sql_explained.sql
SET
SET
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=642938.22..642938.23 rows=1 width=64) (actual time=5103.426..5103.426 rows=1 loops=1)
   ->  Gather  (cost=642938.11..642938.22 rows=1 width=64) (actual time=5103.131..5108.821 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=641938.11..641938.12 rows=1 width=64) (actual time=5097.772..5097.772 rows=1 loops=2)
               ->  Hash Join  (cost=637200.09..641938.10 rows=1 width=33) (actual time=5087.126..5097.753 rows=3 loops=2)
                     Hash Cond: (ci.role_id = rt.id)
                     ->  Parallel Hash Join  (cost=637198.93..641936.94 rows=1 width=37) (actual time=5086.877..5097.503 rows=3 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=4022 width=4) (actual time=0.010..23.380 rows=3376 loops=2)
                                 Filter: ((country_code)::text = '[jp]'::text)
                                 Rows Removed by Filter: 114122
                           ->  Parallel Hash  (cost=637198.91..637198.91 rows=1 width=41) (actual time=5073.224..5073.224 rows=3 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=596664.89..637198.91 rows=1 width=41) (actual time=4861.233..5073.159 rows=3 loops=2)
                                       Hash Cond: (mc.movie_id = ci.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..40532.74 rows=338 width=8) (actual time=0.094..354.766 rows=4284 loops=2)
                                             Filter: (((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text) AND (((note)::text ~~ '%(2006)%'::text) OR ((note)::text ~~ '%(2007)%'::text)))
                                             Rows Removed by Filter: 1300280
                                       ->  Parallel Hash  (cost=596664.88..596664.88 rows=1 width=45) (actual time=4717.349..4717.349 rows=4 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                             ->  Parallel Hash Join  (cost=580513.21..596664.88 rows=1 width=45) (actual time=4698.262..4717.289 rows=4 loops=2)
                                                   Hash Cond: (an.person_id = ci.person_id)
                                                   ->  Parallel Hash Join  (cost=81879.04..98016.48 rows=3793 width=24) (actual time=740.116..912.593 rows=2016 loops=2)
                                                         Hash Cond: (an.person_id = n.id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.012..106.398 rows=450672 loops=2)
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=17538 width=4) (actual time=739.208..739.208 rows=10456 loops=2)
                                                               Buckets: 65536  Batches: 1  Memory Usage: 1376kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=17538 width=4) (actual time=0.138..731.008 rows=10456 loops=2)
                                                                     Filter: (((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))
                                                                     Rows Removed by Filter: 2073290
                                                   ->  Parallel Hash  (cost=498634.15..498634.15 rows=1 width=33) (actual time=3804.343..3804.343 rows=113 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                         ->  Parallel Hash Join  (cost=57067.49..498634.15 rows=1 width=33) (actual time=453.205..3804.141 rows=113 loops=2)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=40775 width=12) (actual time=0.826..3419.104 rows=46548 loops=2)
                                                                     Filter: ((note)::text = '(voice: English version)'::text)
                                                                     Rows Removed by Filter: 18075624
                                                               ->  Parallel Hash  (cost=57067.27..57067.27 rows=18 width=21) (actual time=378.156..378.156 rows=4 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=18 width=21) (actual time=282.447..378.092 rows=4 loops=2)
                                                                           Filter: ((production_year >= 2006) AND (production_year <= 2007) AND (((title)::text ~~ 'One Piece%'::text) OR ((title)::text ~~ 'Dragon Ball Z%'::text)))
                                                                           Rows Removed by Filter: 1264152
                     ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.059..0.060 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.041..0.043 rows=1 loops=2)
                                 Filter: ((role)::text = 'actress'::text)
                                 Rows Removed by Filter: 11
 Planning Time: 9.538 ms
 Execution Time: 5109.500 ms
(50 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8c.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=767932.80..767932.81 rows=1 width=64) (actual time=8097.137..8097.137 rows=1 loops=1)
   ->  Gather  (cost=767932.58..767932.79 rows=2 width=64) (actual time=8093.501..8256.232 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=766932.58..766932.59 rows=1 width=64) (actual time=8086.881..8086.881 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=243772.58..752972.57 rows=2792002 width=33) (actual time=7570.196..7853.893 rows=829204 loops=3)
                     Hash Cond: (ci.person_id = a1.person_id)
                     ->  Parallel Hash Join  (cost=118006.90..594573.48 rows=1215217 width=21) (actual time=5653.828..5956.819 rows=656886 loops=3)
                           Hash Cond: (ci.movie_id = t.id)
                           ->  Hash Join  (cost=1.16..457349.15 rows=1258484 width=8) (actual time=2557.236..3963.173 rows=909648 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.031..2165.869 rows=12081448 loops=3)
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.030..0.031 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=3)
                                             Filter: ((role)::text = 'writer'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=110366.87..110366.87 rows=395029 width=25) (actual time=1439.639..1439.639 rows=384599 loops=3)
                                 Buckets: 65536  Batches: 32  Memory Usage: 2784kB
                                 ->  Parallel Hash Join  (cost=44347.81..110366.87 rows=395029 width=25) (actual time=1035.706..1307.331 rows=384599 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.017..263.731 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=37865.94..37865.94 rows=395029 width=4) (actual time=503.064..503.064 rows=384599 loops=3)
                                             Buckets: 131072  Batches: 16  Memory Usage: 3872kB
                                             ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=4) (actual time=37.027..395.546 rows=384599 loops=3)
                                                   Hash Cond: (mc.company_id = cn.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.007..159.144 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=36.754..36.754 rows=28281 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.034..24.315 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                     ->  Parallel Hash  (cost=118870.18..118870.18 rows=375560 width=24) (actual time=1406.240..1406.240 rows=300448 loops=3)
                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=22047.10..118870.18 rows=375560 width=24) (actual time=954.613..1304.675 rows=300448 loops=3)
                                 Hash Cond: (n1.id = a1.person_id)
                                 ->  Parallel Seq Scan on name n1  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.049..418.850 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=15151.60..15151.60 rows=375560 width=20) (actual time=186.831..186.831 rows=300448 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 3712kB
                                       ->  Parallel Seq Scan on aka_name a1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.043..87.994 rows=300448 loops=3)
 Planning Time: 8.866 ms
 Execution Time: 8256.921 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8d.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=767932.80..767932.81 rows=1 width=64) (actual time=7295.192..7295.193 rows=1 loops=1)
   ->  Gather  (cost=767932.58..767932.79 rows=2 width=64) (actual time=7291.177..7430.050 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=766932.58..766932.59 rows=1 width=64) (actual time=7284.001..7284.001 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=243772.58..752972.57 rows=2792002 width=33) (actual time=7176.686..7253.429 rows=107668 loops=3)
                     Hash Cond: (ci.person_id = an1.person_id)
                     ->  Parallel Hash Join  (cost=118006.90..594573.48 rows=1215217 width=21) (actual time=5527.334..5670.378 rows=95179 loops=3)
                           Hash Cond: (ci.movie_id = t.id)
                           ->  Hash Join  (cost=1.16..457349.15 rows=1258484 width=8) (actual time=3121.918..3981.368 rows=92134 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.045..2288.133 rows=12081448 loops=3)
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.031..0.031 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.027..0.029 rows=1 loops=3)
                                             Filter: ((role)::text = 'costume designer'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=110366.87..110366.87 rows=395029 width=25) (actual time=1507.809..1507.809 rows=384599 loops=3)
                                 Buckets: 65536  Batches: 32  Memory Usage: 2784kB
                                 ->  Parallel Hash Join  (cost=44347.81..110366.87 rows=395029 width=25) (actual time=1083.981..1374.484 rows=384599 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.020..271.243 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=37865.94..37865.94 rows=395029 width=4) (actual time=530.521..530.521 rows=384599 loops=3)
                                             Buckets: 131072  Batches: 16  Memory Usage: 3872kB
                                             ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=4) (actual time=41.368..417.819 rows=384599 loops=3)
                                                   Hash Cond: (mc.company_id = cn.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.013..170.619 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=41.046..41.046 rows=28281 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.036..25.075 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                     ->  Parallel Hash  (cost=118870.18..118870.18 rows=375560 width=24) (actual time=1463.302..1463.303 rows=300448 loops=3)
                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=22047.10..118870.18 rows=375560 width=24) (actual time=982.456..1359.731 rows=300448 loops=3)
                                 Hash Cond: (n1.id = an1.person_id)
                                 ->  Parallel Seq Scan on name n1  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.057..438.163 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=15151.60..15151.60 rows=375560 width=20) (actual time=193.073..193.073 rows=300448 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 3680kB
                                       ->  Parallel Seq Scan on aka_name an1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.059..92.549 rows=300448 loops=3)
 Planning Time: 8.894 ms
 Execution Time: 7430.743 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9a.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=727877.31..727877.32 rows=1 width=96) (actual time=4616.168..4616.168 rows=1 loops=1)
   ->  Gather  (cost=674329.47..727877.30 rows=1 width=49) (actual time=4409.910..4622.754 rows=121 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=673329.47..726877.20 rows=1 width=49) (actual time=4373.915..4608.741 rows=40 loops=3)
               Hash Cond: (t.id = ci.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=466073 width=21) (actual time=0.013..268.773 rows=369296 loops=3)
                     Filter: ((production_year >= 2005) AND (production_year <= 2015))
                     Rows Removed by Filter: 473475
               ->  Parallel Hash  (cost=673329.45..673329.45 rows=1 width=40) (actual time=4298.557..4298.557 rows=114 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=668418.17..673329.45 rows=1 width=40) (actual time=4274.548..4298.394 rows=114 loops=3)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.018..20.930 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
                           ->  Parallel Hash  (cost=668418.15..668418.15 rows=1 width=44) (actual time=4274.364..4274.364 rows=116 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=613978.62..668418.15 rows=1 width=44) (actual time=3903.618..4274.245 rows=116 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.031..241.683 rows=1046780 loops=3)
                                       ->  Parallel Hash  (cost=613978.60..613978.60 rows=1 width=32) (actual time=3900.948..3900.948 rows=124 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=578389.44..613978.60 rows=1 width=32) (actual time=3603.009..3900.832 rows=124 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=131225 width=8) (actual time=0.020..286.423 rows=196998 loops=3)
                                                         Filter: ((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                                         Rows Removed by Filter: 672712
                                                   ->  Parallel Hash  (cost=578389.42..578389.42 rows=2 width=24) (actual time=3592.973..3592.973 rows=142 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Hash Join  (cost=97799.03..578389.42 rows=2 width=24) (actual time=1628.991..3592.822 rows=142 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Hash Join  (cost=97797.87..578388.18 rows=19 width=28) (actual time=1628.867..3592.650 rows=142 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.085..2851.606 rows=289159 loops=3)
                                                                           Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                           Rows Removed by Filter: 11792289
                                                                     ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=24) (actual time=699.167..699.167 rows=519 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=24) (actual time=580.802..698.683 rows=519 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.036..73.913 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=4) (actual time=579.166..579.166 rows=2256 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=4) (actual time=215.926..510.866 rows=2256 loops=3)
                                                                                             Filter: (((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1386908
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.068..0.069 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.046..0.048 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actress'::text)
                                                                           Rows Removed by Filter: 11
 Planning Time: 16.348 ms
 Execution Time: 4623.546 ms
(54 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9b.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=691306.83..691306.84 rows=1 width=128) (actual time=4091.872..4091.873 rows=1 loops=1)
   ->  Gather  (cost=638698.30..691306.82 rows=1 width=64) (actual time=3909.365..4098.373 rows=40 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=637698.30..690306.72 rows=1 width=64) (actual time=3942.316..4084.612 rows=13 loops=3)
               Hash Cond: (t.id = ci.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=215591 width=21) (actual time=0.016..254.113 rows=170942 loops=3)
                     Filter: ((production_year >= 2007) AND (production_year <= 2010))
                     Rows Removed by Filter: 671829
               ->  Parallel Hash  (cost=637698.28..637698.28 rows=1 width=55) (actual time=3809.227..3809.227 rows=31 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=632787.00..637698.28 rows=1 width=55) (actual time=3786.392..3809.109 rows=31 loops=3)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.024..20.447 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
                           ->  Parallel Hash  (cost=632786.98..632786.98 rows=1 width=59) (actual time=3785.695..3785.695 rows=31 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=594815.82..632786.98 rows=1 width=59) (actual time=3535.242..3785.627 rows=31 loops=3)
                                       Hash Cond: (mc.movie_id = ci.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=41669 width=8) (actual time=0.019..264.722 rows=66173 loops=3)
                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                             Rows Removed by Filter: 803537
                                       ->  Parallel Hash  (cost=594815.80..594815.80 rows=1 width=51) (actual time=3512.700..3512.700 rows=79 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=540376.27..594815.80 rows=1 width=51) (actual time=3143.318..3512.579 rows=79 loops=3)
                                                   Hash Cond: (chn.id = ci.person_role_id)
                                                   ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.054..240.017 rows=1046780 loops=3)
                                                   ->  Parallel Hash  (cost=540376.25..540376.25 rows=1 width=39) (actual time=3142.118..3142.118 rows=88 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Hash Join  (cost=97799.03..540376.25 rows=1 width=39) (actual time=1602.252..3142.002 rows=88 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Hash Join  (cost=97797.87..540375.04 rows=15 width=43) (actual time=1602.135..3141.851 rows=88 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=298009 width=16) (actual time=0.057..2328.070 rows=237943 loops=3)
                                                                           Filter: ((note)::text = '(voice)'::text)
                                                                           Rows Removed by Filter: 11843505
                                                                     ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=39) (actual time=778.889..778.889 rows=432 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                                           ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=39) (actual time=662.177..778.423 rows=432 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.033..73.129 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=660.732..660.732 rows=1803 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=216.368..505.985 rows=1803 loops=3)
                                                                                             Filter: (((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1387361
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actress'::text)
                                                                           Rows Removed by Filter: 11
 Planning Time: 15.784 ms
 Execution Time: 4099.128 ms
(54 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9c.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=750479.65..750479.66 rows=1 width=128) (actual time=5145.813..5145.813 rows=1 loops=1)
   ->  Gather  (cost=750479.42..750479.63 rows=2 width=128) (actual time=5141.605..5235.385 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=749479.42..749479.43 rows=1 width=128) (actual time=5134.398..5134.398 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=732915.55..749475.64 rows=378 width=64) (actual time=5019.458..5132.895 rows=2715 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.025..71.203 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=732913.48..732913.48 rows=165 width=56) (actual time=5017.200..5017.200 rows=1501 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=682429.67..732913.48 rows=165 width=56) (actual time=4668.051..5008.170 rows=1501 loops=3)
                                 Hash Cond: (t.id = ci.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.014..224.480 rows=842771 loops=3)
                                 ->  Parallel Hash  (cost=682427.61..682427.61 rows=165 width=47) (actual time=4666.737..4666.737 rows=1501 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 568kB
                                       ->  Parallel Hash Join  (cost=648686.41..682427.61 rows=165 width=47) (actual time=4335.598..4615.765 rows=1501 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=643335.63..677075.64 rows=453 width=51) (actual time=4294.878..4573.791 rows=4128 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.014..154.522 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=643333.50..643333.50 rows=170 width=43) (actual time=4293.779..4293.779 rows=1895 loops=3)
                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 600kB
                                                         ->  Parallel Hash Join  (cost=155467.08..643333.50 rows=170 width=43) (actual time=4036.718..4244.414 rows=1895 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Hash Join  (cost=81911.39..562103.89 rows=353 width=31) (actual time=1436.036..3373.573 rows=2184 loops=3)
                                                                     Hash Cond: (ci.role_id = rt.id)
                                                                     ->  Parallel Hash Join  (cost=81910.23..562087.69 rows=4234 width=35) (actual time=1435.973..3372.696 rows=2185 loops=3)
                                                                           Hash Cond: (ci.person_id = n.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.075..2791.444 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=535.463..535.464 rows=16670 loops=3)
                                                                                 Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=221.422..522.525 rows=16670 loops=3)
                                                                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                       Rows Removed by Filter: 1372493
                                                                     ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.047..0.048 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=3)
                                                                                 Filter: ((role)::text = 'actress'::text)
                                                                                 Rows Removed by Filter: 11
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=638.730..638.730 rows=1046780 loops=3)
                                                                     Buckets: 65536  Batches: 64  Memory Usage: 3232kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.064..295.381 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.138..39.138 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.028..25.102 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 16.053 ms
 Execution Time: 5236.595 ms
(51 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9d.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=756571.53..756571.54 rows=1 width=128) (actual time=6855.195..6855.196 rows=1 loops=1)
   ->  Gather  (cost=756571.30..756571.51 rows=2 width=128) (actual time=6842.604..7111.314 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=755571.30..755571.31 rows=1 width=128) (actual time=6836.598..6836.598 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=738933.47..755496.36 rows=7494 width=64) (actual time=6645.479..6763.302 rows=161027 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.033..80.816 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=738892.70..738892.70 rows=3262 width=56) (actual time=6446.218..6446.218 rows=57856 loops=3)
                           Buckets: 32768 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2848kB
                           ->  Parallel Hash Join  (cost=688395.99..738892.70 rows=3262 width=56) (actual time=6136.949..6386.984 rows=57856 loops=3)
                                 Hash Cond: (t.id = ci.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.020..236.497 rows=842771 loops=3)
                                 ->  Parallel Hash  (cost=688355.22..688355.22 rows=3262 width=47) (actual time=5569.074..5569.074 rows=57856 loops=3)
                                       Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2432kB
                                       ->  Parallel Hash Join  (cost=654556.12..688355.22 rows=3262 width=47) (actual time=5267.875..5506.774 rows=57856 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=649205.34..682980.87 rows=8976 width=51) (actual time=5224.509..5432.331 rows=142133 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.038..169.331 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=649163.11..649163.11 rows=3378 width=43) (actual time=4805.895..4805.895 rows=85164 loops=3)
                                                         Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2976kB
                                                         ->  Parallel Hash Join  (cost=158158.83..649163.11 rows=3378 width=43) (actual time=4488.060..4710.911 rows=85164 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Hash Join  (cost=84603.14..567826.09 rows=6986 width=31) (actual time=3652.843..3772.331 rows=92002 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Hash Join  (cost=1.16..480518.83 rows=30581 width=12) (actual time=954.420..3033.075 rows=92055 loops=3)
                                                                           Hash Cond: (ci.role_id = rt.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.101..2969.829 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=3)
                                                                                       Filter: ((role)::text = 'actress'::text)
                                                                                       Rows Removed by Filter: 11
                                                                     ->  Parallel Hash  (cost=77318.68..77318.68 rows=396664 width=19) (actual time=571.513..571.514 rows=320518 loops=3)
                                                                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                                                                           ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=396664 width=19) (actual time=190.374..458.670 rows=320518 loops=3)
                                                                                 Filter: ((gender)::text = 'f'::text)
                                                                                 Rows Removed by Filter: 1068645
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=663.947..663.947 rows=1046780 loops=3)
                                                                     Buckets: 65536  Batches: 64  Memory Usage: 3232kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.114..314.453 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=42.444..42.444 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.035..26.224 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 15.783 ms
 Execution Time: 7112.448 ms
(51 rows)

