execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10a.sql_explained.sql
SET
SET
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=629274.70..629274.71 rows=1 width=64) (actual time=3817.494..3817.494 rows=1 loops=1)
   ->  Gather  (cost=629274.48..629274.69 rows=2 width=64) (actual time=3817.098..3824.137 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=628274.48..628274.49 rows=1 width=64) (actual time=3810.126..3810.126 rows=1 loops=3)
               ->  Hash Join  (cost=567292.56..628274.47 rows=2 width=33) (actual time=3443.909..3810.052 rows=35 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=567291.47..628273.38 rows=2 width=37) (actual time=3443.626..3809.750 rows=35 loops=3)
                           Hash Cond: (chn.id = ci.person_role_id)
                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.044..239.547 rows=1046780 loops=3)
                           ->  Parallel Hash  (cost=567291.40..567291.40 rows=5 width=25) (actual time=3441.847..3441.847 rows=37 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=516526.82..567291.40 rows=5 width=25) (actual time=3315.818..3441.716 rows=37 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.015..257.297 rows=337640 loops=3)
                                             Filter: (production_year > 2005)
                                             Rows Removed by Filter: 505131
                                       ->  Parallel Hash  (cost=516526.68..516526.68 rows=11 width=16) (actual time=3146.422..3146.422 rows=92 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=483987.14..516526.68 rows=11 width=16) (actual time=2912.721..3146.253 rows=92 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Hash Join  (cost=4733.23..37248.39 rows=6486 width=8) (actual time=23.425..295.746 rows=2930 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.031..152.698 rows=869710 loops=3)
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=825 width=4) (actual time=22.456..22.457 rows=454 loops=3)
                                                               Buckets: 2048  Batches: 1  Memory Usage: 112kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=825 width=4) (actual time=0.061..21.998 rows=454 loops=3)
                                                                     Filter: ((country_code)::text = '[ru]'::text)
                                                                     Rows Removed by Filter: 77879
                                                   ->  Parallel Hash  (cost=479245.16..479245.16 rows=700 width=8) (actual time=2849.387..2849.387 rows=8625 loops=3)
                                                         Buckets: 32768 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 1552kB
                                                         ->  Hash Join  (cost=1.16..479245.16 rows=700 width=8) (actual time=0.419..2711.022 rows=8625 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=8405 width=12) (actual time=0.313..2706.041 rows=10763 loops=3)
                                                                     Filter: (((note)::text ~~ '%(voice)%'::text) AND ((note)::text ~~ '%(uncredited)%'::text))
                                                                     Rows Removed by Filter: 12070685
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.032..0.035 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actor'::text)
                                                                           Rows Removed by Filter: 11
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.060..0.060 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.040..0.041 rows=4 loops=3)
 Planning Time: 8.244 ms
 Execution Time: 3824.802 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10b.sql_explained.sql
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=612898.77..612898.78 rows=1 width=64) (actual time=4625.805..4625.805 rows=1 loops=1)
   ->  Gather  (cost=612898.55..612898.76 rows=2 width=64) (actual time=4622.422..4681.517 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=611898.55..611898.56 rows=1 width=64) (actual time=4615.669..4615.670 rows=1 loops=3)
               ->  Hash Join  (cost=160692.60..611898.28 rows=55 width=33) (actual time=4615.663..4615.663 rows=0 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=160691.51..611896.89 rows=55 width=37) (actual time=4615.365..4615.454 rows=0 loops=3)
                           Hash Cond: (ci.person_role_id = chn.id)
                           ->  Hash Join  (cost=87135.83..530671.90 rows=115 width=25) (actual time=3572.309..3572.309 rows=0 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Hash Join  (cost=87134.66..530665.85 rows=1377 width=29) (actual time=1988.089..3572.081 rows=871 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=551821 width=12) (actual time=321.911..2927.922 rows=478480 loops=3)
                                             Filter: ((note)::text ~~ '%(producer)%'::text)
                                             Rows Removed by Filter: 11602968
                                       ->  Parallel Hash  (cost=87121.90..87121.90 rows=1021 width=29) (actual time=590.809..590.809 rows=420 loops=3)
                                             Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                             ->  Parallel Hash Join  (cost=37329.47..87121.90 rows=1021 width=29) (actual time=318.414..590.191 rows=420 loops=3)
                                                   Hash Cond: (t.id = mc.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.016..253.986 rows=130555 loops=3)
                                                         Filter: (production_year > 2010)
                                                         Rows Removed by Filter: 712215
                                                   ->  Parallel Hash  (cost=37248.39..37248.39 rows=6486 width=8) (actual time=314.779..314.779 rows=2930 loops=3)
                                                         Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                         ->  Parallel Hash Join  (cost=4733.23..37248.39 rows=6486 width=8) (actual time=24.948..312.706 rows=2930 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.037..166.326 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=825 width=4) (actual time=24.395..24.395 rows=454 loops=3)
                                                                     Buckets: 2048  Batches: 1  Memory Usage: 112kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=825 width=4) (actual time=0.063..23.796 rows=454 loops=3)
                                                                           Filter: ((country_code)::text = '[ru]'::text)
                                                                           Rows Removed by Filter: 77879
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.049..0.051 rows=1 loops=3)
                                             Filter: ((role)::text = 'actor'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=651.553..651.553 rows=1046780 loops=3)
                                 Buckets: 65536  Batches: 64  Memory Usage: 3232kB
                                 ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.057..307.280 rows=1046780 loops=3)
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.065..0.065 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.038..0.040 rows=4 loops=3)
 Planning Time: 8.029 ms
 Execution Time: 4683.883 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10c.sql_explained.sql
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=652016.30..652016.31 rows=1 width=64) (actual time=4965.063..4965.064 rows=1 loops=1)
   ->  Gather  (cost=652016.08..652016.29 rows=2 width=64) (actual time=4961.830..5054.768 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=651016.08..651016.09 rows=1 width=64) (actual time=4954.851..4954.851 rows=1 loops=3)
               ->  Hash Join  (cost=609518.31..650122.02 rows=178812 width=33) (actual time=4917.225..4954.814 rows=3 loops=3)
                     Hash Cond: (ci.role_id = rt.id)
                     ->  Hash Join  (cost=609517.04..649485.59 rows=178812 width=37) (actual time=4916.937..4954.524 rows=3 loops=3)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=609515.95..648517.80 rows=178812 width=41) (actual time=4916.826..4954.411 rows=3 loops=3)
                                 Hash Cond: (mc.movie_id = t.id)
                                 ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=8) (actual time=30.324..395.979 rows=384599 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.030..159.245 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=30.119..30.119 rows=28281 loops=3)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.017..19.164 rows=28281 loops=3)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=600222.44..600222.44 rows=185178 width=45) (actual time=4404.664..4404.664 rows=4 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 544kB
                                       ->  Parallel Hash Join  (cost=136144.88..600222.44 rows=185178 width=45) (actual time=4304.738..4403.840 rows=4 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Hash Join  (cost=73555.68..529520.84 rows=266824 width=24) (actual time=3606.920..3775.041 rows=5 loops=3)
                                                   Hash Cond: (ci.person_role_id = chn.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=551821 width=12) (actual time=296.994..2758.705 rows=478480 loops=3)
                                                         Filter: ((note)::text ~~ '%(producer)%'::text)
                                                         Rows Removed by Filter: 11602968
                                                   ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=626.098..626.098 rows=1046780 loops=3)
                                                         Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.055..288.464 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=49166.29..49166.29 rows=731112 width=21) (actual time=509.565..509.565 rows=583011 loops=3)
                                                   Buckets: 65536  Batches: 32  Memory Usage: 3648kB
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.028..291.051 rows=583011 loops=3)
                                                         Filter: (production_year > 1990)
                                                         Rows Removed by Filter: 259760
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.046..0.046 rows=4 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.034..0.035 rows=4 loops=3)
                     ->  Hash  (cost=1.12..1.12 rows=12 width=4) (actual time=0.058..0.058 rows=12 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on role_type rt  (cost=0.00..1.12 rows=12 width=4) (actual time=0.035..0.037 rows=12 loops=3)
 Planning Time: 7.945 ms
 Execution Time: 5055.457 ms
(44 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11a.sql_explained.sql
SET
SET
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=25460.06..25460.07 rows=1 width=96) (actual time=312.709..312.710 rows=1 loops=1)
   ->  Gather  (cost=19952.24..25460.06 rows=1 width=118) (actual time=271.795..317.422 rows=310 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Parallel Hash Join  (cost=18952.24..24459.96 rows=1 width=118) (actual time=263.411..306.779 rows=155 loops=2)
               Hash Cond: (cn.id = mc.company_id)
               ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.025..45.105 rows=24151 loops=2)
                     Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                     Rows Removed by Filter: 93348
               ->  Parallel Hash  (cost=18952.23..18952.23 rows=1 width=103) (actual time=258.442..258.442 rows=332 loops=2)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Hash Join  (cost=8687.12..18952.23 rows=1 width=103) (actual time=135.141..258.148 rows=332 loops=2)
                           Hash Cond: (mk.keyword_id = k.id)
                           ->  Merge Join  (cost=6060.98..16306.51 rows=7458 width=107) (actual time=90.341..226.512 rows=16065 loops=2)
                                 Merge Cond: (ml.movie_id = mk.movie_id)
                                 ->  Merge Join  (cost=6016.36..13086.62 rows=160 width=115) (actual time=90.251..187.601 rows=1397 loops=2)
                                       Merge Cond: (t.id = ml.movie_id)
                                       ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=379985 width=21) (actual time=0.037..94.727 rows=26100 loops=2)
                                             Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                             Rows Removed by Filter: 56295
                                       ->  Sort  (cost=6015.92..6018.59 rows=1065 width=94) (actual time=89.447..89.778 rows=4393 loops=2)
                                             Sort Key: mc.movie_id
                                             Sort Method: quicksort  Memory: 536kB
                                             Worker 0:  Sort Method: quicksort  Memory: 536kB
                                             ->  Hash Join  (cost=652.13..5962.37 rows=1065 width=94) (actual time=12.855..87.312 rows=4393 loops=2)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Merge Join  (cost=651.06..5938.28 rows=4260 width=98) (actual time=12.759..85.889 rows=5069 loops=2)
                                                         Merge Cond: (mc.movie_id = ml.movie_id)
                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.052..67.487 rows=49142 loops=2)
                                                               Filter: (note IS NULL)
                                                               Rows Removed by Filter: 50735
                                                         ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.532..12.919 rows=5369 loops=2)
                                                               Sort Key: ml.movie_id
                                                               Sort Method: quicksort  Memory: 205kB
                                                               Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                               ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.144..11.306 rows=2315 loops=2)
                                                                     Hash Cond: (ml.link_type_id = lt.id)
                                                                     ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.023..6.944 rows=29997 loops=2)
                                                                     ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.051..0.051 rows=2 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.034..0.040 rows=2 loops=2)
                                                                                 Filter: ((link)::text ~~ '%follow%'::text)
                                                                                 Rows Removed by Filter: 16
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=2)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                                 ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.021..27.129 rows=96539 loops=2)
                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=30.019..30.020 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.514..29.999 rows=1 loops=2)
                                       Filter: ((keyword)::text = 'sequel'::text)
                                       Rows Removed by Filter: 134169
 Planning Time: 14.180 ms
 Execution Time: 318.508 ms
(56 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=37292.30..37292.31 rows=1 width=96) (actual time=673.758..673.758 rows=1 loops=1)
   ->  Hash Join  (cost=15626.08..37292.29 rows=1 width=118) (actual time=472.154..673.733 rows=14 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=12999.94..34666.15 rows=1 width=122) (actual time=450.376..651.947 rows=56 loops=1)
               Merge Cond: (ml.movie_id = mk.movie_id)
               ->  Merge Join  (cost=12999.51..31520.71 rows=1 width=130) (actual time=421.621..623.164 rows=14 loops=1)
                     Merge Cond: (t.id = ml.movie_id)
                     ->  Gather Merge  (cost=1000.45..93601.60 rows=5 width=21) (actual time=330.712..556.616 rows=3 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=2 width=21) (actual time=151.058..527.652 rows=6 loops=3)
                                 Filter: (((title)::text ~~ '%Money%'::text) AND (production_year = 1998))
                                 Rows Removed by Filter: 400214
                     ->  Sort  (cost=11999.06..11999.54 rows=192 width=109) (actual time=90.855..90.886 rows=450 loops=1)
                           Sort Key: mc.movie_id
                           Sort Method: quicksort  Memory: 61kB
                           ->  Gather  (cost=7378.27..11991.77 rows=192 width=109) (actual time=68.207..92.014 rows=450 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Hash Join  (cost=6378.27..10972.57 rows=80 width=109) (actual time=62.789..83.251 rows=150 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=6377.21..10969.78 rows=321 width=113) (actual time=62.571..82.988 rows=153 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Merge Join  (cost=651.06..5238.97 rows=1775 width=98) (actual time=12.738..33.883 rows=692 loops=3)
                                                   Merge Cond: (mc.movie_id = ml.movie_id)
                                                   ->  Parallel Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..116330.44 rows=530595 width=12) (actual time=0.147..19.693 rows=16381 loops=3)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 16912
                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.439..12.551 rows=1516 loops=3)
                                                         Sort Key: ml.movie_id
                                                         Sort Method: quicksort  Memory: 103kB
                                                         Worker 0:  Sort Method: quicksort  Memory: 103kB
                                                         Worker 1:  Sort Method: quicksort  Memory: 103kB
                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.160..11.687 rows=1158 loops=3)
                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.029..7.502 rows=29997 loops=3)
                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.044..0.045 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.026..0.031 rows=1 loops=3)
                                                                           Filter: ((link)::text ~~ '%follows%'::text)
                                                                           Rows Removed by Filter: 17
                                             ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=47.760..47.760 rows=16101 loops=3)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.027..36.321 rows=16101 loops=3)
                                                         Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                         Rows Removed by Filter: 62232
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.070..0.070 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.046..0.048 rows=1 loops=3)
                                                   Filter: ((kind)::text = 'production companies'::text)
                                                   Rows Removed by Filter: 3
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.032..21.698 rows=69469 loops=1)
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.718..21.718 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.124..21.706 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 13.841 ms
 Execution Time: 700.296 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11c.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=26126.74..26126.75 rows=1 width=96) (actual time=632.375..632.375 rows=1 loops=1)
   ->  Hash Join  (cost=22974.01..26126.73 rows=1 width=60) (actual time=487.256..628.465 rows=6946 loops=1)
         Hash Cond: (ml.link_type_id = lt.id)
         ->  Hash Join  (cost=22972.60..26125.32 rows=1 width=64) (actual time=487.133..626.788 rows=6946 loops=1)
               Hash Cond: (mk.keyword_id = k.id)
               ->  Merge Join  (cost=20178.73..23330.26 rows=454 width=68) (actual time=268.112..520.241 rows=780776 loops=1)
                     Merge Cond: (mk.movie_id = ml.movie_id)
                     ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.032..23.470 rows=77819 loops=1)
                     ->  Sort  (cost=20178.30..20178.32 rows=10 width=76) (actual time=266.816..314.806 rows=780794 loops=1)
                           Sort Key: mc.movie_id
                           Sort Method: quicksort  Memory: 1609kB
                           ->  Gather  (cost=6420.11..20178.13 rows=10 width=76) (actual time=75.517..260.724 rows=8393 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Hash Join  (cost=5420.11..19177.13 rows=4 width=76) (actual time=68.013..252.091 rows=2798 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=5419.02..19176.02 rows=5 width=80) (actual time=67.843..251.068 rows=2801 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Merge Join  (cost=4.62..13682.01 rows=30328 width=65) (actual time=1.434..209.032 rows=34978 loops=3)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=2.03..8120.68 rows=11307 width=29) (actual time=0.868..130.136 rows=9909 loops=3)
                                                         Merge Cond: (t.id = ml.movie_id)
                                                         ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..89967.34 rows=952979 width=21) (actual time=0.091..110.550 rows=59309 loops=3)
                                                               Filter: (production_year > 1950)
                                                               Rows Removed by Filter: 2750
                                                         ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=8) (actual time=0.043..9.398 rows=29997 loops=3)
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1335700 width=36) (actual time=0.063..67.850 rows=77636 loops=3)
                                                         Filter: (note IS NOT NULL)
                                                         Rows Removed by Filter: 66588
                                             ->  Parallel Hash  (cost=5414.09..5414.09 rows=25 width=23) (actual time=37.019..37.019 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=25 width=23) (actual time=0.275..36.908 rows=30 loops=3)
                                                         Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '20th Century Fox%'::text) OR ((name)::text ~~ 'Twentieth Century Fox%'::text)))
                                                         Rows Removed by Filter: 78303
                                       ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.053..0.053 rows=3 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=3 width=4) (actual time=0.031..0.034 rows=3 loops=3)
                                                   Filter: ((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))
                                                   Rows Removed by Filter: 1
               ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=40.349..40.349 rows=3 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=1.505..40.335 rows=3 loops=1)
                           Filter: ((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))
                           Rows Removed by Filter: 134167
         ->  Hash  (cost=1.18..1.18 rows=18 width=4) (actual time=0.054..0.054 rows=18 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=4) (actual time=0.037..0.040 rows=18 loops=1)
 Planning Time: 15.076 ms
 Execution Time: 633.620 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11d.sql_explained.sql
SET
SET
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=34220.63..34220.64 rows=1 width=96) (actual time=375.843..375.843 rows=1 loops=1)
   ->  Hash Join  (cost=26974.32..34220.25 rows=51 width=60) (actual time=256.912..370.229 rows=14899 loops=1)
         Hash Cond: (cn.id = mc.company_id)
         ->  Seq Scan on company_name cn  (cost=0.00..5932.46 rows=210072 width=23) (actual time=0.053..89.420 rows=210031 loops=1)
               Filter: ((country_code)::text <> '[pl]'::text)
               Rows Removed by Filter: 24966
         ->  Hash  (cost=26973.61..26973.61 rows=57 width=45) (actual time=256.763..256.763 rows=14916 loops=1)
               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1231kB
               ->  Hash Join  (cost=21742.73..26973.61 rows=57 width=45) (actual time=211.477..250.487 rows=14916 loops=1)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Merge Join  (cost=21741.65..26972.11 rows=76 width=49) (actual time=211.381..246.740 rows=15510 loops=1)
                           Merge Cond: (mc.movie_id = ml.movie_id)
                           ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1335700 width=36) (actual time=0.025..27.838 rows=42219 loops=1)
                                 Filter: (note IS NOT NULL)
                                 Rows Removed by Filter: 41437
                           ->  Sort  (cost=21741.22..21741.29 rows=28 width=29) (actual time=211.083..212.144 rows=15913 loops=1)
                                 Sort Key: mk.movie_id
                                 Sort Method: quicksort  Memory: 159kB
                                 ->  Gather  (cost=3836.65..21740.54 rows=28 width=29) (actual time=46.046..210.437 rows=1460 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 2
                                       ->  Hash Join  (cost=2836.65..20737.74 rows=12 width=29) (actual time=40.505..199.870 rows=487 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Hash Join  (cost=2835.24..20736.30 rows=12 width=33) (actual time=40.331..199.541 rows=487 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Merge Join  (cost=41.37..16560.07 rows=526594 width=37) (actual time=0.520..163.902 rows=95464 loops=3)
                                                         Merge Cond: (ml.movie_id = mk.movie_id)
                                                         ->  Merge Join  (cost=2.03..8120.68 rows=11307 width=29) (actual time=0.288..97.332 rows=9909 loops=3)
                                                               Merge Cond: (t.id = ml.movie_id)
                                                               ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..89967.34 rows=952979 width=21) (actual time=0.024..80.089 rows=59309 loops=3)
                                                                     Filter: (production_year > 1950)
                                                                     Rows Removed by Filter: 2750
                                                               ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=8) (actual time=0.048..7.433 rows=29997 loops=3)
                                                         ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.065..37.521 rows=175267 loops=3)
                                                   ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=26.726..26.726 rows=3 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=1.068..26.711 rows=3 loops=3)
                                                               Filter: ((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))
                                                               Rows Removed by Filter: 134167
                                             ->  Hash  (cost=1.18..1.18 rows=18 width=4) (actual time=0.060..0.060 rows=18 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=4) (actual time=0.037..0.040 rows=18 loops=3)
                     ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.043..0.043 rows=3 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=3 width=4) (actual time=0.022..0.024 rows=3 loops=1)
                                 Filter: ((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))
                                 Rows Removed by Filter: 1
 Planning Time: 12.914 ms
 Execution Time: 376.812 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12a.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=346907.90..346907.91 rows=1 width=96) (actual time=3468.210..3468.210 rows=1 loops=1)
   ->  Gather  (cost=346907.78..346907.89 rows=1 width=96) (actual time=3467.886..3473.369 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=345907.78..345907.79 rows=1 width=96) (actual time=3462.604..3462.604 rows=1 loops=2)
               ->  Hash Join  (cost=340996.48..345907.77 rows=1 width=41) (actual time=3421.010..3462.342 rows=198 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=340995.42..345906.71 rows=1 width=45) (actual time=3420.800..3462.007 rows=354 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.034..35.463 rows=42422 loops=2)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 75077
                           ->  Parallel Hash  (cost=340995.41..340995.41 rows=1 width=30) (actual time=3420.309..3420.309 rows=967 loops=2)
                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                 ->  Parallel Hash Join  (cost=307257.26..340995.41 rows=1 width=30) (actual time=2890.495..3288.735 rows=967 loops=2)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.011..230.015 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=307257.25..307257.25 rows=1 width=34) (actual time=2885.149..2885.149 rows=278 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=254758.25..307257.25 rows=1 width=34) (actual time=2496.954..2884.713 rows=278 loops=2)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=186410 width=21) (actual time=0.041..366.881 rows=222930 loops=2)
                                                         Filter: ((production_year >= 2005) AND (production_year <= 2008))
                                                         Rows Removed by Filter: 1041226
                                                   ->  Parallel Hash  (cost=254758.24..254758.24 rows=1 width=13) (actual time=2483.410..2483.410 rows=972 loops=2)
                                                         Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                         ->  Parallel Hash Join  (cost=15184.50..254758.24 rows=1 width=13) (actual time=2112.609..2391.288 rows=972 loops=2)
                                                               Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                               ->  Hash Join  (cost=2.43..239572.30 rows=1028 width=4) (actual time=1887.738..2146.469 rows=136360 loops=2)
                                                                     Hash Cond: (mi.info_type_id = it1.id)
                                                                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=116213 width=8) (actual time=1310.037..2112.069 rows=137322 loops=2)
                                                                           Filter: ((info)::text = ANY ('{Drama,Horror}'::text[]))
                                                                           Rows Removed by Filter: 7280538
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.052 rows=1 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.028 rows=1 loops=2)
                                                                                 Filter: ((info)::text = 'genres'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=15179.85..15179.85 rows=178 width=9) (actual time=224.626..224.626 rows=7924 loops=2)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                     ->  Hash Join  (cost=2.43..15179.85 rows=178 width=9) (actual time=0.221..198.045 rows=7924 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.053..191.767 rows=26824 loops=2)
                                                                                 Filter: ((info)::text > '8.0'::text)
                                                                                 Rows Removed by Filter: 663193
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.040 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.026..0.027 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 14.597 ms
 Execution Time: 3474.085 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12b.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348978.79..348978.80 rows=1 width=64) (actual time=3698.015..3698.016 rows=1 loops=1)
   ->  Gather  (cost=348978.68..348978.79 rows=1 width=64) (actual time=3697.736..3703.114 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347978.68..347978.69 rows=1 width=64) (actual time=3692.571..3692.571 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343067.38..347978.67 rows=1 width=60) (actual time=3673.892..3692.540 rows=5 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.019..24.526 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343067.37..343067.37 rows=1 width=64) (actual time=3663.403..3663.403 rows=16 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=102227.57..343067.37 rows=1 width=64) (actual time=3172.199..3663.315 rows=16 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=1486.522..2572.617 rows=60932 loops=2)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.031..1635.716 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'budget'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102225.13..102225.13 rows=1 width=33) (actual time=1084.438..1084.438 rows=16 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=86954.86..102225.13 rows=1 width=33) (actual time=1084.366..1084.379 rows=16 loops=2)
                                             Hash Cond: (mi_idx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=197.489..197.491 rows=5 loops=2)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.017..113.824 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=2)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86951.75..86951.75 rows=55 width=29) (actual time=886.804..886.804 rows=1984 loops=2)
                                                   Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 376kB
                                                   ->  Hash Join  (cost=54436.04..86951.75 rows=55 width=29) (actual time=454.327..875.269 rows=1984 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Parallel Hash Join  (cost=54434.96..86950.06 rows=111 width=33) (actual time=454.214..874.255 rows=1984 loops=2)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.012..230.860 rows=1304564 loops=2)
                                                               ->  Parallel Hash  (cost=54433.61..54433.61 rows=108 width=21) (actual time=453.290..453.291 rows=1268 loops=2)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=108 width=21) (actual time=0.783..450.481 rows=1268 loops=2)
                                                                           Filter: ((production_year > 2000) AND (((title)::text ~~ 'Birdemic%'::text) OR ((title)::text ~~ '%Movie%'::text)))
                                                                           Rows Removed by Filter: 1262888
                                                         ->  Hash  (cost=1.06..1.06 rows=2 width=4) (actual time=0.048..0.048 rows=2 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.06 rows=2 width=4) (actual time=0.026..0.028 rows=2 loops=2)
                                                                     Filter: ((kind IS NOT NULL) AND (((kind)::text = 'production companies'::text) OR ((kind)::text = 'distributors'::text)))
                                                                     Rows Removed by Filter: 2
 Planning Time: 13.790 ms
 Execution Time: 3703.865 ms
(53 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12c.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=363505.12..363505.13 rows=1 width=96) (actual time=3866.991..3866.992 rows=1 loops=1)
   ->  Gather  (cost=363505.00..363505.11 rows=1 width=96) (actual time=3866.262..3872.210 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=362505.00..362505.01 rows=1 width=96) (actual time=3861.093..3861.093 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=357593.71..362504.99 rows=1 width=41) (actual time=3827.642..3859.807 rows=2356 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.018..25.265 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=357593.68..357593.68 rows=2 width=26) (actual time=3827.006..3827.006 rows=7768 loops=2)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1208kB
                           ->  Hash Join  (cost=323855.49..357593.68 rows=2 width=26) (actual time=3589.897..3802.919 rows=7768 loops=2)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=323854.42..357592.57 rows=10 width=30) (actual time=3363.904..3798.487 rows=22503 loops=2)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.011..234.312 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=323854.40..323854.40 rows=2 width=34) (actual time=3363.663..3363.663 rows=3982 loops=2)
                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                             ->  Parallel Hash Join  (cost=270431.08..323854.40 rows=2 width=34) (actual time=2882.912..3354.076 rows=3982 loops=2)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=432897 width=21) (actual time=0.036..395.274 rows=521400 loops=2)
                                                         Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                         Rows Removed by Filter: 742756
                                                   ->  Parallel Hash  (cost=270431.01..270431.01 rows=5 width=13) (actual time=2882.160..2882.160 rows=11094 loops=2)
                                                         Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1592kB
                                                         ->  Parallel Hash Join  (cost=15354.10..270431.01 rows=5 width=13) (actual time=2501.852..2851.980 rows=11094 loops=2)
                                                               Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                               ->  Hash Join  (cost=2.43..255074.87 rows=1187 width=4) (actual time=2238.200..2551.854 rows=162628 loops=2)
                                                                     Hash Cond: (mi.info_type_id = it1.id)
                                                                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=134092 width=8) (actual time=1559.605..2511.333 rows=163656 loops=2)
                                                                           Filter: ((info)::text = ANY ('{Drama,Horror,Western,Family}'::text[]))
                                                                           Rows Removed by Filter: 7254204
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.050 rows=1 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.028 rows=1 loops=2)
                                                                                 Filter: ((info)::text = 'genres'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=15342.82..15342.82 rows=708 width=9) (actual time=263.553..263.553 rows=60786 loops=2)
                                                                     Buckets: 131072 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 6832kB
                                                                     ->  Hash Join  (cost=2.43..15342.82 rows=708 width=9) (actual time=0.168..224.679 rows=60786 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=79942 width=13) (actual time=0.060..203.057 rows=96948 loops=2)
                                                                                 Filter: ((info)::text > '7.0'::text)
                                                                                 Rows Removed by Filter: 593070
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.027..0.028 rows=1 loops=2)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
 Planning Time: 13.862 ms
 Execution Time: 3873.041 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13a.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=345137.34..345137.35 rows=1 width=96) (actual time=3254.978..3254.978 rows=1 loops=1)
   ->  Gather  (cost=345137.12..345137.33 rows=2 width=96) (actual time=3250.948..3270.513 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=344137.12..344137.13 rows=1 width=96) (actual time=3244.287..3244.287 rows=1 loops=3)
               ->  Hash Join  (cost=293653.26..344137.03 rows=11 width=65) (actual time=3064.572..3228.245 rows=37034 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=293652.16..344135.60 rows=79 width=69) (actual time=2852.430..3217.407 rows=44730 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.015..216.770 rows=842771 loops=3)
                           ->  Parallel Hash  (cost=293651.17..293651.17 rows=79 width=60) (actual time=2851.879..2851.879 rows=44730 loops=3)
                                 Buckets: 262144 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 13880kB
                                 ->  Parallel Hash Join  (cost=52811.08..293651.17 rows=79 width=60) (actual time=1141.517..2719.236 rows=44730 loops=3)
                                       Hash Cond: (mi.movie_id = mc.movie_id)
                                       ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=450.056..1892.889 rows=1012240 loops=3)
                                             Hash Cond: (mi.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.050..1120.458 rows=4945240 loops=3)
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.032..0.032 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.019..0.029 rows=1 loops=3)
                                                         Filter: ((info)::text = 'release dates'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=52805.23..52805.23 rows=274 width=13) (actual time=690.009..690.009 rows=10503 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2040kB
                                             ->  Hash Join  (cost=20112.16..52805.23 rows=274 width=13) (actual time=616.693..662.785 rows=10503 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Hash Join  (cost=20111.09..52798.24 rows=1095 width=17) (actual time=615.291..658.671 rows=27966 loops=3)
                                                         Hash Cond: (mc.movie_id = miidx.movie_id)
                                                         ->  Parallel Hash Join  (cost=4793.88..37309.04 rows=44647 width=8) (actual time=24.538..318.765 rows=49377 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.010..157.506 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=5677 width=4) (actual time=24.334..24.334 rows=3258 loops=3)
                                                                     Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=5677 width=4) (actual time=0.021..22.142 rows=3258 loops=3)
                                                                           Filter: ((country_code)::text = '[de]'::text)
                                                                           Rows Removed by Filter: 75074
                                                         ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=271.024..271.024 rows=153308 loops=3)
                                                               Buckets: 131072 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 3328kB
                                                               ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.163..163.126 rows=153308 loops=3)
                                                                     Hash Cond: (miidx.info_type_id = it.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.040..77.045 rows=460012 loops=3)
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.049 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'rating'::text)
                                                                                 Rows Removed by Filter: 112
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.023..0.024 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 20.218 ms
 Execution Time: 3272.887 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13b.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348980.78..348980.79 rows=1 width=96) (actual time=4257.607..4257.607 rows=1 loops=1)
   ->  Gather  (cost=348980.66..348980.77 rows=1 width=96) (actual time=4257.377..4262.739 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347980.66..347980.67 rows=1 width=96) (actual time=4251.982..4251.982 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343069.37..347980.65 rows=1 width=41) (actual time=4223.692..4251.847 rows=186 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.026..24.660 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343069.35..343069.35 rows=1 width=26) (actual time=4222.185..4222.185 rows=313 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102229.55..343069.35 rows=1 width=26) (actual time=2436.365..4221.981 rows=313 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=673.427..2778.669 rows=1518360 loops=2)
                                       Hash Cond: (mi.info_type_id = it2.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.027..1662.240 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102227.11..102227.11 rows=1 width=38) (actual time=1296.928..1296.928 rows=58 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=86956.85..102227.11 rows=1 width=38) (actual time=1139.386..1296.842 rows=58 loops=2)
                                             Hash Cond: (miidx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.151..238.021 rows=229962 loops=2)
                                                   Hash Cond: (miidx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.030..114.738 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.047 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86954.33..86954.33 rows=7 width=29) (actual time=1034.730..1034.730 rows=178 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=54438.22..86954.33 rows=7 width=29) (actual time=907.069..1034.508 rows=178 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Hash Join  (cost=54437.16..86953.12 rows=29 width=33) (actual time=683.959..1034.312 rows=384 loops=2)
                                                               Hash Cond: (t.kind_id = kt.id)
                                                               ->  Parallel Hash Join  (cost=54436.06..86951.16 rows=202 width=37) (actual time=610.531..1033.888 rows=1330 loops=2)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.012..236.490 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=54433.61..54433.61 rows=196 width=25) (actual time=610.286..610.286 rows=1109 loops=2)
                                                                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=196 width=25) (actual time=0.180..606.387 rows=1109 loops=2)
                                                                                 Filter: (((title)::text <> ''::text) AND (((title)::text ~~ '%Champion%'::text) OR ((title)::text ~~ '%Loser%'::text)))
                                                                                 Rows Removed by Filter: 1263047
                                                               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=2)
                                                                           Filter: ((kind)::text = 'movie'::text)
                                                                           Rows Removed by Filter: 6
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.028..0.030 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
 Planning Time: 20.726 ms
 Execution Time: 4263.714 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13c.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348980.78..348980.79 rows=1 width=96) (actual time=4004.704..4004.705 rows=1 loops=1)
   ->  Gather  (cost=348980.66..348980.77 rows=1 width=96) (actual time=4004.470..4009.814 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347980.66..347980.67 rows=1 width=96) (actual time=3999.102..3999.102 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343069.37..347980.65 rows=1 width=41) (actual time=3974.931..3999.040 rows=26 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.019..24.378 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343069.35..343069.35 rows=1 width=26) (actual time=3969.954..3969.954 rows=81 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102229.55..343069.35 rows=1 width=26) (actual time=2281.003..3969.832 rows=81 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=659.554..2707.634 rows=1518360 loops=2)
                                       Hash Cond: (mi.info_type_id = it2.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.037..1592.528 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102227.11..102227.11 rows=1 width=38) (actual time=1118.803..1118.803 rows=16 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=86956.85..102227.11 rows=1 width=38) (actual time=1052.279..1118.752 rows=16 loops=2)
                                             Hash Cond: (miidx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.150..235.172 rows=229962 loops=2)
                                                   Hash Cond: (miidx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.029..111.855 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86954.33..86954.33 rows=7 width=29) (actual time=860.808..860.808 rows=40 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=54438.22..86954.33 rows=7 width=29) (actual time=759.308..860.710 rows=40 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Hash Join  (cost=54437.16..86953.12 rows=29 width=33) (actual time=553.262..860.587 rows=90 loops=2)
                                                               Hash Cond: (t.kind_id = kt.id)
                                                               ->  Parallel Hash Join  (cost=54436.06..86951.16 rows=202 width=37) (actual time=467.551..860.448 rows=184 loops=2)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.011..226.144 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=54433.61..54433.61 rows=196 width=25) (actual time=467.164..467.165 rows=147 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=196 width=25) (actual time=7.460..466.904 rows=147 loops=2)
                                                                                 Filter: (((title)::text <> ''::text) AND (((title)::text ~~ 'Champion%'::text) OR ((title)::text ~~ 'Loser%'::text)))
                                                                                 Rows Removed by Filter: 1264009
                                                               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=2)
                                                                           Filter: ((kind)::text = 'movie'::text)
                                                                           Rows Removed by Filter: 6
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.027..0.028 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
 Planning Time: 20.655 ms
 Execution Time: 4010.731 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13d.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=346725.46..346725.47 rows=1 width=96) (actual time=8983.339..8983.339 rows=1 loops=1)
   ->  Gather  (cost=346725.34..346725.45 rows=1 width=96) (actual time=8974.328..9199.930 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=345725.34..345725.35 rows=1 width=96) (actual time=8972.422..8972.422 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=340435.70..345724.28 rows=141 width=41) (actual time=8638.770..8848.617 rows=335195 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.031..24.779 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=340432.26..340432.26 rows=275 width=26) (actual time=8589.900..8589.900 rows=959748 loops=2)
                           Buckets: 65536 (originally 1024)  Batches: 64 (originally 1)  Memory Usage: 4352kB
                           ->  Hash Join  (cost=306684.12..340432.26 rows=275 width=26) (actual time=6537.322..8002.438 rows=959748 loops=2)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=306683.05..340425.77 rows=1004 width=30) (actual time=6478.811..7521.954 rows=4061793 loops=2)
                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.020..236.518 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=306680.43..306680.43 rows=210 width=34) (actual time=5856.993..5856.993 rows=362366 loops=2)
                                             Buckets: 65536 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 3680kB
                                             ->  Hash Join  (cost=256185.00..306680.43 rows=210 width=34) (actual time=4968.219..5626.925 rows=362366 loops=2)
                                                   Hash Cond: (t.kind_id = kt.id)
                                                   ->  Parallel Hash Join  (cost=256183.90..306673.14 rows=1468 width=38) (actual time=4950.845..5519.850 rows=559492 loops=2)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.036..320.025 rows=1264156 loops=2)
                                                         ->  Parallel Hash  (cost=256165.55..256165.55 rows=1468 width=13) (actual time=4135.432..4135.432 rows=559492 loops=2)
                                                               Buckets: 131072 (originally 4096)  Batches: 16 (originally 1)  Memory Usage: 4384kB
                                                               ->  Parallel Hash Join  (cost=15319.64..256165.55 rows=1468 width=13) (actual time=3564.056..3911.971 rows=559492 loops=2)
                                                                     Hash Cond: (mi.movie_id = miidx.movie_id)
                                                                     ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=670.827..2788.668 rows=1518360 loops=2)
                                                                           Hash Cond: (mi.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.042..1653.131 rows=7417860 loops=2)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.032 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=385.413..385.413 rows=229962 loops=2)
                                                                           Buckets: 131072 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 3328kB
                                                                           ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.151..241.525 rows=229962 loops=2)
                                                                                 Hash Cond: (miidx.info_type_id = it.id)
                                                                                 ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.042..114.323 rows=690018 loops=2)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.051 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.041 rows=1 loops=2)
                                                                                             Filter: ((info)::text = 'rating'::text)
                                                                                             Rows Removed by Filter: 112
                                                   ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.041..0.041 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=2)
                                                               Filter: ((kind)::text = 'movie'::text)
                                                               Rows Removed by Filter: 6
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.027..0.029 rows=1 loops=2)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
 Planning Time: 20.288 ms
 Execution Time: 9202.792 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14a.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=420522.53..420522.54 rows=1 width=64) (actual time=3505.835..3505.835 rows=1 loops=1)
   ->  Gather  (cost=420522.31..420522.52 rows=2 width=64) (actual time=3505.045..3512.477 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=419522.31..419522.32 rows=1 width=64) (actual time=3498.287..3498.287 rows=1 loops=3)
               ->  Hash Join  (cost=369734.11..419522.30 rows=1 width=22) (actual time=3398.967..3498.017 rows=254 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=369733.01..419521.20 rows=1 width=26) (actual time=3238.651..3497.611 rows=328 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=25) (actual time=0.022..240.235 rows=130555 loops=3)
                                 Filter: (production_year > 2010)
                                 Rows Removed by Filter: 712215
                           ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3233.970..3233.970 rows=6989 loops=3)
                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                 ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2960.798..3205.376 rows=6989 loops=3)
                                       Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                       ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.172..222.593 rows=151410 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.050..158.379 rows=447629 loops=3)
                                                   Filter: ((info)::text < '8.5'::text)
                                                   Rows Removed by Filter: 12383
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2959.812..2959.812 rows=7972 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                             ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2400.454..2911.149 rows=7972 loops=3)
                                                   Hash Cond: (mi.movie_id = mk.movie_id)
                                                   ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1824.188..2305.391 rows=204750 loops=3)
                                                         Hash Cond: (mi.info_type_id = it1.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=0.996..2253.766 rows=235558 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4709682
                                                         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.052 rows=1 loops=3)
                                                                     Filter: ((info)::text = 'countries'::text)
                                                                     Rows Removed by Filter: 112
                                                   ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=575.925..575.925 rows=12364 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=43.762..486.822 rows=12364 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.041..255.494 rows=1507977 loops=3)
                                                               ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=43.460..43.460 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.604..43.447 rows=3 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                           Rows Removed by Filter: 134167
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.036..0.038 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 12.489 ms
 Execution Time: 3513.183 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14b.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=426312.24..426312.25 rows=1 width=64) (actual time=3221.263..3221.263 rows=1 loops=1)
   ->  Gather  (cost=426312.02..426312.23 rows=2 width=64) (actual time=3221.034..3227.531 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=425312.02..425312.03 rows=1 width=64) (actual time=3214.156..3214.157 rows=1 loops=3)
               ->  Hash Join  (cost=409759.67..425312.01 rows=1 width=22) (actual time=3200.587..3214.146 rows=0 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=409758.57..425310.91 rows=1 width=26) (actual time=3156.537..3213.900 rows=1 loops=3)
                           Hash Cond: (mi_idx.movie_id = t.id)
                           ->  Hash Join  (cost=2.43..15549.59 rows=1379 width=9) (actual time=0.158..167.298 rows=86616 loops=3)
                                 Hash Cond: (mi_idx.info_type_id = it2.id)
                                 ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=155862 width=13) (actual time=0.046..141.827 rows=125612 loops=3)
                                       Filter: ((info)::text > '6.0'::text)
                                       Rows Removed by Filter: 334399
                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.040 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=3)
                                             Filter: ((info)::text = 'rating'::text)
                                             Rows Removed by Filter: 112
                           ->  Parallel Hash  (cost=409756.13..409756.13 rows=1 width=33) (actual time=3036.999..3036.999 rows=3 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=361504.10..409756.13 rows=1 width=33) (actual time=2710.678..3036.889 rows=3 loops=3)
                                       Hash Cond: (mk.movie_id = t.id)
                                       ->  Hash Join  (cost=2626.15..50878.06 rows=28 width=4) (actual time=23.695..468.196 rows=6509 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..258.296 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=2 width=4) (actual time=23.464..23.464 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=2 width=4) (actual time=1.348..23.446 rows=1 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title}'::text[]))
                                                         Rows Removed by Filter: 134169
                                       ->  Parallel Hash  (cost=358877.94..358877.94 rows=1 width=29) (actual time=2566.907..2566.907 rows=41 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=57070.27..358877.94 rows=1 width=29) (actual time=2114.969..2566.767 rows=41 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=57067.84..358875.48 rows=12 width=33) (actual time=298.669..2566.623 rows=49 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=0.958..2265.350 rows=235558 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4709682
                                                         ->  Parallel Hash  (cost=57067.27..57067.27 rows=46 width=25) (actual time=274.528..274.528 rows=152 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=46 width=25) (actual time=0.461..274.243 rows=152 loops=3)
                                                                     Filter: ((production_year > 2010) AND (((title)::text ~~ '%murder%'::text) OR ((title)::text ~~ '%Murder%'::text) OR ((title)::text ~~ '%Mord%'::text)))
                                                                     Rows Removed by Filter: 842619
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.044 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.060..0.061 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 12.612 ms
 Execution Time: 3228.239 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14c.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=421498.92..421498.93 rows=1 width=64) (actual time=3521.571..3521.571 rows=1 loops=1)
   ->  Gather  (cost=421498.70..421498.91 rows=2 width=64) (actual time=3520.681..3528.129 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=420498.70..420498.71 rows=1 width=64) (actual time=3513.904..3513.904 rows=1 loops=3)
               ->  Hash Join  (cost=369734.12..420498.70 rows=1 width=22) (actual time=3211.430..3512.782 rows=1372 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=369733.01..420497.58 rows=1 width=26) (actual time=3209.874..3511.865 rows=1710 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.021..256.709 rows=337640 loops=3)
                                 Filter: (production_year > 2005)
                                 Rows Removed by Filter: 505131
                           ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3207.158..3207.158 rows=6989 loops=3)
                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                 ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2936.341..3180.402 rows=6989 loops=3)
                                       Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                       ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.160..222.634 rows=151410 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.047..158.678 rows=447629 loops=3)
                                                   Filter: ((info)::text < '8.5'::text)
                                                   Rows Removed by Filter: 12383
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2934.895..2934.895 rows=7972 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                             ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2374.326..2882.928 rows=7972 loops=3)
                                                   Hash Cond: (mi.movie_id = mk.movie_id)
                                                   ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1812.554..2291.907 rows=204750 loops=3)
                                                         Hash Cond: (mi.info_type_id = it1.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.067..2240.132 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.051 rows=1 loops=3)
                                                                     Filter: ((info)::text = 'countries'::text)
                                                                     Rows Removed by Filter: 112
                                                   ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=561.203..561.203 rows=12364 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=33.656..472.928 rows=12364 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.040..251.188 rows=1507977 loops=3)
                                                               ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=33.459..33.459 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.446..33.446 rows=3 loops=3)
                                                                           Filter: ((keyword IS NOT NULL) AND ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[])))
                                                                           Rows Removed by Filter: 134167
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.062..0.062 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.036..0.039 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 12.081 ms
 Execution Time: 3528.947 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=409625.94..409625.95 rows=1 width=64) (actual time=3566.527..3566.527 rows=1 loops=1)
   ->  Gather  (cost=409625.72..409625.93 rows=2 width=64) (actual time=3566.283..3573.358 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=408625.72..408625.73 rows=1 width=64) (actual time=3559.049..3559.050 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=400362.74..408625.68 rows=8 width=60) (actual time=3515.258..3558.973 rows=109 loops=3)
                     Hash Cond: (at.movie_id = t.id)
                     ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.035..36.886 rows=120491 loops=3)
                     ->  Parallel Hash  (cost=400362.70..400362.70 rows=3 width=76) (actual time=3504.235..3504.235 rows=466 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                           ->  Parallel Hash Join  (cost=396456.49..400362.70 rows=3 width=76) (actual time=3444.599..3488.190 rows=466 loops=3)
                                 Hash Cond: (k.id = mk.keyword_id)
                                 ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.157..37.941 rows=44723 loops=3)
                                       Heap Fetches: 134170
                                 ->  Parallel Hash  (cost=396456.03..396456.03 rows=3 width=80) (actual time=3444.346..3444.346 rows=466 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=346083.67..396456.03 rows=3 width=80) (actual time=3000.090..3442.717 rows=466 loops=3)
                                             Hash Cond: (mk.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.060..253.488 rows=1507977 loops=3)
                                             ->  Parallel Hash  (cost=346083.66..346083.66 rows=1 width=72) (actual time=2999.633..2999.633 rows=220 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=294758.03..346083.66 rows=1 width=72) (actual time=2688.959..2999.264 rows=220 loops=3)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.020..260.627 rows=460484 loops=3)
                                                               Filter: (production_year > 2000)
                                                               Rows Removed by Filter: 382286
                                                         ->  Parallel Hash  (cost=294758.02..294758.02 rows=1 width=51) (actual time=2684.392..2684.392 rows=223 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Hash Join  (cost=289846.73..294758.02 rows=1 width=51) (actual time=2657.707..2684.205 rows=223 loops=3)
                                                                     Hash Cond: (mc.company_type_id = ct.id)
                                                                     ->  Parallel Hash Join  (cost=289845.64..294756.93 rows=1 width=55) (actual time=2657.605..2684.027 rows=223 loops=3)
                                                                           Hash Cond: (cn.id = mc.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.018..23.156 rows=28281 loops=3)
                                                                                 Filter: ((country_code)::text = '[us]'::text)
                                                                                 Rows Removed by Filter: 50051
                                                                           ->  Parallel Hash  (cost=289845.63..289845.63 rows=1 width=59) (actual time=2657.361..2657.361 rows=233 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=254710.18..289845.63 rows=1 width=59) (actual time=2403.929..2657.021 rows=233 loops=3)
                                                                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=7675 width=12) (actual time=0.049..250.827 rows=20555 loops=3)
                                                                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))
                                                                                             Rows Removed by Filter: 849155
                                                                                       ->  Parallel Hash  (cost=254710.16..254710.16 rows=2 width=47) (actual time=2401.858..2401.858 rows=590 loops=3)
                                                                                             Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                                             ->  Hash Join  (cost=2.43..254710.16 rows=2 width=47) (actual time=293.551..1148.216 rows=590 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=51) (actual time=293.419..1147.524 rows=590 loops=3)
                                                                                                         Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                                                                                         Rows Removed by Filter: 4944650
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.052 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'release dates'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.050..0.050 rows=4 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.025..0.026 rows=4 loops=3)
 Planning Time: 32.179 ms
 Execution Time: 3574.146 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=411365.11..411365.12 rows=1 width=64) (actual time=2274.865..2274.865 rows=1 loops=1)
   ->  Gather  (cost=411364.89..411365.10 rows=2 width=64) (actual time=2274.630..2282.046 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=410364.89..410364.90 rows=1 width=64) (actual time=2267.427..2267.427 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=402101.92..410364.87 rows=4 width=60) (actual time=2262.462..2267.415 rows=12 loops=3)
                     Hash Cond: (at.movie_id = t.id)
                     ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.030..34.531 rows=120491 loops=3)
                     ->  Parallel Hash  (cost=402101.90..402101.90 rows=2 width=76) (actual time=2216.590..2216.590 rows=50 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=147394.15..402101.90 rows=2 width=76) (actual time=1334.342..2216.465 rows=50 loops=3)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..254710.16 rows=2 width=47) (actual time=289.171..1175.348 rows=590 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=51) (actual time=289.030..1174.634 rows=590 loops=3)
                                             Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                             Rows Removed by Filter: 4944650
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.049 rows=1 loops=3)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=147391.71..147391.71 rows=1 width=29) (actual time=1040.779..1040.779 rows=144 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=143485.50..147391.71 rows=1 width=29) (actual time=996.523..1040.632 rows=144 loops=3)
                                             Hash Cond: (k.id = mk.keyword_id)
                                             ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.065..39.105 rows=44723 loops=3)
                                                   Heap Fetches: 134170
                                             ->  Parallel Hash  (cost=143485.07..143485.07 rows=1 width=33) (actual time=996.277..996.277 rows=144 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=93112.71..143485.07 rows=1 width=33) (actual time=563.052..996.114 rows=144 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.033..251.467 rows=1507977 loops=3)
                                                         ->  Parallel Hash  (cost=93112.69..93112.69 rows=1 width=25) (actual time=558.811..558.811 rows=85 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=40186.82..93112.69 rows=1 width=25) (actual time=276.696..558.621 rows=85 loops=3)
                                                                     Hash Cond: (t.id = mc.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=300243 width=21) (actual time=0.017..255.802 rows=238753 loops=3)
                                                                           Filter: ((production_year >= 2005) AND (production_year <= 2010))
                                                                           Rows Removed by Filter: 604018
                                                                     ->  Parallel Hash  (cost=40186.81..40186.81 rows=1 width=4) (actual time=274.822..274.822 rows=93 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Hash Join  (cost=5069.61..40186.81 rows=1 width=4) (actual time=23.166..274.644 rows=93 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=5068.52..40185.72 rows=1 width=8) (actual time=23.061..274.491 rows=93 loops=3)
                                                                                       Hash Cond: (mc.company_id = cn.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=7675 width=12) (actual time=0.064..249.258 rows=20555 loops=3)
                                                                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))
                                                                                             Rows Removed by Filter: 849155
                                                                                       ->  Parallel Hash  (cost=5068.50..5068.50 rows=1 width=4) (actual time=21.849..21.849 rows=0 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..5068.50 rows=1 width=4) (actual time=15.232..21.817 rows=0 loops=3)
                                                                                                   Filter: (((country_code)::text = '[us]'::text) AND ((name)::text = 'YouTube'::text))
                                                                                                   Rows Removed by Filter: 78332
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.050..0.050 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.024..0.026 rows=4 loops=3)
 Planning Time: 31.950 ms
 Execution Time: 2282.834 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15c.sql_explained.sql
SET
SET
                                                                                                                            QUERY PLAN                                                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=424524.77..424524.78 rows=1 width=64) (actual time=3717.811..3717.812 rows=1 loops=1)
   ->  Gather  (cost=424524.55..424524.76 rows=2 width=64) (actual time=3717.615..3725.968 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=423524.55..423524.56 rows=1 width=64) (actual time=3709.929..3709.930 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=419547.77..423524.17 rows=76 width=60) (actual time=3657.416..3709.516 rows=757 loops=3)
                     Hash Cond: (k.id = mk.keyword_id)
                     ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.125..46.307 rows=44723 loops=3)
                           Heap Fetches: 134170
                     ->  Parallel Hash  (cost=419546.40..419546.40 rows=76 width=64) (actual time=3656.559..3656.559 rows=757 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 248kB
                           ->  Parallel Hash Join  (cost=369174.02..419546.40 rows=76 width=64) (actual time=3178.439..3606.443 rows=757 loops=3)
                                 Hash Cond: (mk.movie_id = t.id)
                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.061..255.880 rows=1507977 loops=3)
                                 ->  Parallel Hash  (cost=369173.97..369173.97 rows=4 width=76) (actual time=3166.135..3166.135 rows=95 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=364262.66..369173.97 rows=4 width=76) (actual time=3144.426..3165.999 rows=95 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Hash Join  (cost=364261.57..369172.86 rows=4 width=80) (actual time=3144.317..3165.855 rows=95 loops=3)
                                                   Hash Cond: (cn.id = mc.company_id)
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.019..18.634 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
                                                   ->  Parallel Hash  (cost=364261.48..364261.48 rows=7 width=84) (actual time=3144.058..3144.058 rows=133 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=330523.34..364261.48 rows=7 width=84) (actual time=2876.601..3143.832 rows=133 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=1.217..163.823 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=330523.33..330523.33 rows=1 width=72) (actual time=2871.592..2871.592 rows=40 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=278615.36..330523.33 rows=1 width=72) (actual time=2540.202..2871.502 rows=40 loops=3)
                                                                           Hash Cond: (t.id = at.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.030..280.562 rows=583011 loops=3)
                                                                                 Filter: (production_year > 1990)
                                                                                 Rows Removed by Filter: 259760
                                                                           ->  Parallel Hash  (cost=278615.33..278615.33 rows=2 width=51) (actual time=2530.232..2530.232 rows=40 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=270164.12..278615.33 rows=2 width=51) (actual time=2473.468..2530.097 rows=40 loops=3)
                                                                                       Hash Cond: (at.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.046..38.860 rows=120491 loops=3)
                                                                                       ->  Parallel Hash  (cost=270164.10..270164.10 rows=2 width=47) (actual time=2472.217..2472.217 rows=594 loops=3)
                                                                                             Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                                             ->  Hash Join  (cost=2.43..270164.10 rows=2 width=47) (actual time=308.604..1189.343 rows=594 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=51) (actual time=308.475..1188.651 rows=594 loops=3)
                                                                                                         Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                                         Rows Removed by Filter: 4944646
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.049 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'release dates'::text)
                                                                                                               Rows Removed by Filter: 112
                                             ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.051..0.051 rows=4 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.025..0.026 rows=4 loops=3)
 Planning Time: 31.176 ms
 Execution Time: 3726.794 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=397267.91..397267.92 rows=1 width=64) (actual time=2512.928..2512.928 rows=1 loops=1)
   ->  Gather  (cost=397267.69..397267.90 rows=2 width=64) (actual time=2511.519..2519.067 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=396267.69..396267.70 rows=1 width=64) (actual time=2504.350..2504.350 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=345880.45..396258.32 rows=1873 width=38) (actual time=2064.061..2503.125 rows=3782 loops=3)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Parallel Hash Join  (cost=341484.68..391857.62 rows=1873 width=42) (actual time=1993.793..2430.788 rows=3782 loops=3)
                           Hash Cond: (mk.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.033..252.373 rows=1507977 loops=3)
                           ->  Parallel Hash  (cost=341483.66..341483.66 rows=81 width=54) (actual time=1985.500..1985.500 rows=292 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                 ->  Hash Join  (cost=336383.26..341483.66 rows=81 width=54) (actual time=1964.374..1985.204 rows=292 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=336382.17..341482.14 rows=81 width=58) (actual time=1964.265..1984.995 rows=292 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.017..17.139 rows=28281 loops=3)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 50051
                                             ->  Parallel Hash  (cost=336380.22..336380.22 rows=156 width=62) (actual time=1964.140..1964.140 rows=700 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                   ->  Parallel Hash Join  (cost=302641.96..336380.22 rows=156 width=62) (actual time=1686.309..1957.953 rows=700 loops=3)
                                                         Hash Cond: (mc.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=1.201..158.793 rows=869710 loops=3)
                                                         ->  Parallel Hash  (cost=302641.58..302641.58 rows=30 width=50) (actual time=1682.903..1682.903 rows=195 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=250733.50..302641.58 rows=30 width=50) (actual time=1349.280..1682.639 rows=195 loops=3)
                                                                     Hash Cond: (t.id = at.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.019..271.221 rows=583011 loops=3)
                                                                           Filter: (production_year > 1990)
                                                                           Rows Removed by Filter: 259760
                                                                     ->  Parallel Hash  (cost=250732.96..250732.96 rows=43 width=29) (actual time=1346.069..1346.069 rows=197 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=239269.32..250732.96 rows=43 width=29) (actual time=1290.811..1345.730 rows=197 loops=3)
                                                                                 Hash Cond: (at.movie_id = mi.movie_id)
                                                                                 ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=25) (actual time=0.040..35.628 rows=120491 loops=3)
                                                                                 ->  Parallel Hash  (cost=239268.80..239268.80 rows=42 width=4) (actual time=1290.328..1290.328 rows=3560 loops=3)
                                                                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                                                                       ->  Hash Join  (cost=2.43..239268.80 rows=42 width=4) (actual time=295.514..1206.863 rows=3560 loops=3)
                                                                                             Hash Cond: (mi.info_type_id = it1.id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=4774 width=8) (actual time=50.656..1204.211 rows=3603 loops=3)
                                                                                                   Filter: ((note)::text ~~ '%internet%'::text)
                                                                                                   Rows Removed by Filter: 4941637
                                                                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.049 rows=1 loops=3)
                                                                                                         Filter: ((info)::text = 'release dates'::text)
                                                                                                         Rows Removed by Filter: 112
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.050..0.050 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.030..0.032 rows=4 loops=3)
                     ->  Parallel Hash  (cost=3696.98..3696.98 rows=55904 width=4) (actual time=67.672..67.673 rows=44723 loops=3)
                           Buckets: 262144  Batches: 1  Memory Usage: 7360kB
                           ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.054..44.361 rows=44723 loops=3)
                                 Heap Fetches: 134170
 Planning Time: 31.154 ms
 Execution Time: 2519.876 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=683598.14..683598.15 rows=1 width=64) (actual time=6238.887..6238.888 rows=1 loops=1)
   ->  Gather  (cost=683597.92..683598.13 rows=2 width=64) (actual time=6237.554..6245.765 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=682597.92..682597.93 rows=1 width=64) (actual time=6230.415..6230.415 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=666037.80..682597.77 rows=31 width=33) (actual time=6113.934..6230.283 rows=128 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.026..79.543 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=666037.56..666037.56 rows=19 width=25) (actual time=6110.235..6110.235 rows=108 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=661126.21..666037.56 rows=19 width=25) (actual time=6090.932..6110.084 rows=108 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.019..18.260 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=661125.74..661125.74 rows=37 width=29) (actual time=6088.763..6088.763 rows=363 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                       ->  Parallel Hash Join  (cost=627387.45..661125.74 rows=37 width=29) (actual time=5811.656..6088.481 rows=363 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.036..163.071 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=627387.27..627387.27 rows=14 width=37) (actual time=5806.579..5806.579 rows=391 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                   ->  Parallel Hash Join  (cost=547897.96..627387.27 rows=14 width=37) (actual time=5219.762..5806.019 rows=391 loops=3)
                                                         Hash Cond: (n.id = ci.person_id)
                                                         ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.050..386.589 rows=1389164 loops=3)
                                                         ->  Parallel Hash  (cost=547897.79..547897.79 rows=14 width=33) (actual time=5218.285..5218.285 rows=391 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                               ->  Parallel Hash Join  (cost=103031.36..547897.79 rows=14 width=33) (actual time=802.127..5217.460 rows=391 loops=3)
                                                                     Hash Cond: (ci.movie_id = mk.movie_id)
                                                                     ->  Parallel Hash Join  (cost=52153.14..495500.56 rows=405052 width=29) (actual time=273.975..4617.244 rows=388676 loops=3)
                                                                           Hash Cond: (ci.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.042..2251.547 rows=12081448 loops=3)
                                                                           ->  Parallel Hash  (cost=51799.95..51799.95 rows=28255 width=21) (actual time=272.519..272.520 rows=22748 loops=3)
                                                                                 Buckets: 131072  Batches: 1  Memory Usage: 4736kB
                                                                                 ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=28255 width=21) (actual time=0.026..251.472 rows=22748 loops=3)
                                                                                       Filter: ((episode_nr >= 50) AND (episode_nr < 100))
                                                                                       Rows Removed by Filter: 820022
                                                                     ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=515.054..515.054 rows=13947 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                           ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.482..460.796 rows=13947 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.046..252.828 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.306..21.306 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.803..21.287 rows=1 loops=3)
                                                                                             Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                             Rows Removed by Filter: 134169
 Planning Time: 15.194 ms
 Execution Time: 6246.480 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16b.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=697874.98..697874.99 rows=1 width=64) (actual time=10077.672..10077.672 rows=1 loops=1)
   ->  Gather  (cost=697874.76..697874.97 rows=2 width=64) (actual time=10069.864..10403.370 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=696874.76..696874.77 rows=1 width=64) (actual time=10062.809..10062.809 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=617374.97..696869.01 rows=1150 width=33) (actual time=8783.456..9717.541 rows=1236864 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.048..393.485 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=617360.59..617360.59 rows=1150 width=41) (actual time=7831.259..7831.259 rows=1236864 loops=3)
                           Buckets: 65536 (originally 4096)  Batches: 64 (originally 1)  Memory Usage: 6368kB
                           ->  Parallel Hash Join  (cost=600795.85..617360.59 rows=1150 width=41) (actual time=6825.822..7295.969 rows=1236864 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.044..80.121 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=21) (actual time=6610.150..6610.150 rows=944185 loops=3)
                                       Buckets: 65536 (originally 2048)  Batches: 64 (originally 1)  Memory Usage: 3456kB
                                       ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=21) (actual time=1371.928..5962.788 rows=944185 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.033..2338.850 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=29) (actual time=1371.783..1371.783 rows=22772 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6776kB
                                                   ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=29) (actual time=989.627..1327.196 rows=22772 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=33) (actual time=947.795..1268.344 rows=49517 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.026..169.040 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=25) (actual time=947.382..947.382 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=25) (actual time=525.788..882.969 rows=13947 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.016..217.082 rows=842771 loops=3)
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=525.498..525.498 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.439..464.839 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.069..258.833 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.261..19.262 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.815..19.249 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=40.783..40.783 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.025..25.136 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.385 ms
 Execution Time: 10404.136 ms
(47 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16c.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=698025.50..698025.51 rows=1 width=64) (actual time=7459.611..7459.611 rows=1 loops=1)
   ->  Gather  (cost=698025.28..698025.49 rows=2 width=64) (actual time=7453.484..7605.972 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=697025.28..697025.29 rows=1 width=64) (actual time=7446.193..7446.194 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=617532.05..697023.11 rows=434 width=33) (actual time=7015.497..7413.422 rows=106644 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.047..407.457 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=617526.63..617526.63 rows=434 width=41) (actual time=6081.440..6081.440 rows=106644 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 8 (originally 1)  Memory Usage: 4256kB
                           ->  Parallel Hash Join  (cost=600964.87..617526.63 rows=434 width=41) (actual time=5885.570..6001.026 rows=106644 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.034..84.867 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=600962.51..600962.51 rows=189 width=21) (actual time=5683.400..5683.400 rows=73870 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2368kB
                                       ->  Parallel Hash Join  (cost=140625.02..600962.51 rows=189 width=21) (actual time=1280.660..5497.610 rows=73870 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.026..2310.182 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=140624.89..140624.89 rows=10 width=29) (actual time=1280.368..1280.369 rows=2846 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                                   ->  Parallel Hash Join  (cost=106886.67..140624.89 rows=10 width=29) (actual time=957.852..1254.925 rows=2846 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=101535.88..135274.04 rows=28 width=33) (actual time=914.902..1210.204 rows=3802 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.029..167.751 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=101535.82..101535.82 rows=5 width=25) (actual time=914.100..914.100 rows=2309 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 600kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..101535.82 rows=5 width=25) (actual time=524.464..845.940 rows=2309 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=397676 width=21) (actual time=0.018..273.325 rows=315635 loops=3)
                                                                                 Filter: (episode_nr < 100)
                                                                                 Rows Removed by Filter: 527135
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=524.219..524.219 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.442..468.296 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=2.250..261.609 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.078..19.078 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.828..19.066 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=42.074..42.074 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.030..25.057 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.404 ms
 Execution Time: 7606.692 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=700256.85..700256.86 rows=1 width=64) (actual time=7289.770..7289.770 rows=1 loops=1)
   ->  Gather  (cost=700256.63..700256.84 rows=2 width=64) (actual time=7286.393..7419.024 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=699256.63..699256.64 rows=1 width=64) (actual time=7279.563..7279.564 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=619764.46..699255.04 rows=318 width=33) (actual time=6871.855..7253.823 rows=83152 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.115..386.222 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=619760.48..619760.48 rows=318 width=41) (actual time=5965.895..5965.895 rows=83152 loops=3)
                           Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 3424kB
                           ->  Parallel Hash Join  (cost=603199.22..619760.48 rows=318 width=41) (actual time=5794.188..5898.841 rows=83152 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.044..76.943 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=603197.49..603197.49 rows=138 width=21) (actual time=5601.323..5601.323 rows=56424 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 1920kB
                                       ->  Parallel Hash Join  (cost=142860.13..603197.49 rows=138 width=21) (actual time=1414.057..5401.567 rows=56424 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.131..2177.820 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=142860.03..142860.03 rows=8 width=29) (actual time=1413.446..1413.446 rows=2255 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 664kB
                                                   ->  Parallel Hash Join  (cost=109121.82..142860.03 rows=8 width=29) (actual time=1089.497..1370.616 rows=2255 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=103771.04..137509.19 rows=20 width=33) (actual time=1051.097..1330.844 rows=2887 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.068..157.217 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=103770.99..103770.99 rows=4 width=25) (actual time=1050.431..1050.431 rows=1795 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..103770.99 rows=4 width=25) (actual time=519.897..811.721 rows=1795 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=291411 width=21) (actual time=0.018..255.767 rows=230852 loops=3)
                                                                                 Filter: ((episode_nr >= 5) AND (episode_nr < 100))
                                                                                 Rows Removed by Filter: 611919
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=519.719..519.719 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.447..461.357 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.075..256.017 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.249..19.250 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.845..19.238 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=37.552..37.553 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.024..23.837 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.595 ms
 Execution Time: 7421.168 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17a.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=680693.62..680693.63 rows=1 width=64) (actual time=6723.617..6723.618 rows=1 loops=1)
   ->  Gather  (cost=680693.40..680693.61 rows=2 width=32) (actual time=6718.376..6786.932 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=679693.40..679693.41 rows=1 width=32) (actual time=6711.542..6711.542 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=600795.85..679693.30 rows=40 width=15) (actual time=6444.868..6693.241 rows=86096 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=140320 width=19) (actual time=8.350..431.187 rows=114466 loops=3)
                           Filter: ((name)::text ~~ 'B%'::text)
                           Rows Removed by Filter: 1274697
                     ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=4) (actual time=5953.927..5953.927 rows=944185 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4192kB
                           ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=4) (actual time=1377.068..5518.639 rows=944185 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.049..2127.546 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=12) (actual time=1376.928..1376.928 rows=22772 loops=3)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5304kB
                                       ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=12) (actual time=1021.354..1339.314 rows=22772 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=16) (actual time=982.128..1285.190 rows=49517 loops=3)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.033..158.585 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=981.810..981.810 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=532.055..885.167 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.014..216.127 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=531.895..531.895 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.267..461.515 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.038..254.679 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.123..19.123 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.790..19.098 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.252..38.252 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.023..24.231 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 9.007 ms
 Execution Time: 6787.586 ms
(44 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17b.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=64) (actual time=8307.093..8307.093 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=8304.779..8314.683 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=8297.498..8297.499 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=7926.574..8292.749 rows=17435 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.017..222.886 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=7924.719..7924.719 rows=17435 loops=3)
                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4312kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=7867.491..7905.914 rows=17435 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.021..16.562 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=7867.377..7867.377 rows=17435 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4440kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=7530.615..7830.855 rows=17435 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.053..168.392 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=7529.723..7529.724 rows=2214 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=2315.837..4851.196 rows=2214 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=1793.673..4309.790 rows=89570 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.036..2263.100 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=453.437..453.437 rows=12058 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3032kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=181.994..439.008 rows=12058 loops=3)
                                                                           Filter: ((name)::text ~~ 'Z%'::text)
                                                                           Rows Removed by Filter: 1377106
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=522.016..522.016 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.631..463.175 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.052..253.641 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.477..21.477 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.809..21.456 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.413 ms
 Execution Time: 8315.417 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17c.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=64) (actual time=5528.389..5528.389 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=5527.768..5534.653 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=5521.133..5521.133 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=5203.502..5520.895 rows=639 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.014..216.430 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=5189.299..5189.299 rows=639 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=5132.769..5158.162 rows=639 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.016..14.266 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=5132.633..5132.633 rows=639 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=4866.196..5125.977 rows=639 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.057..156.226 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=4858.794..4858.794 rows=83 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=2389.644..4858.601 rows=83 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=1875.487..4343.115 rows=4167 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.030..2174.497 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=606.513..606.513 rows=888 loops=3)
                                                                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=174.566..417.671 rows=888 loops=3)
                                                                           Filter: ((name)::text ~~ 'X%'::text)
                                                                           Rows Removed by Filter: 1388276
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=513.987..513.988 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.079..461.890 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.050..253.229 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.929..20.933 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.778..20.911 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.033 ms
 Execution Time: 5535.306 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17d.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=32) (actual time=6816.017..6816.017 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=6815.160..6823.887 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=6808.110..6808.111 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=6469.066..6806.982 rows=3846 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.017..221.730 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=6463.319..6463.319 rows=3846 loops=3)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=6427.272..6456.580 rows=3846 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.017..16.127 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=6427.168..6427.168 rows=3846 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1048kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=6088.655..6378.974 rows=3846 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.047..167.902 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=6086.206..6086.206 rows=657 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=1288.759..5089.045 rows=657 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=749.688..4570.585 rows=16097 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.050..2262.868 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=746.027..746.028 rows=1739 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=1.548..498.644 rows=1739 loops=3)
                                                                           Filter: ((name)::text ~~ '%Bert%'::text)
                                                                           Rows Removed by Filter: 1387425
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=513.012..513.012 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.751..461.881 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.143..252.833 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.476..21.476 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.806..21.455 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.013 ms
 Execution Time: 6824.511 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17e.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=694312.07..694312.08 rows=1 width=32) (actual time=7793.561..7793.561 rows=1 loops=1)
   ->  Gather  (cost=694311.86..694312.07 rows=2 width=32) (actual time=7788.602..7947.480 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=693311.86..693311.87 rows=1 width=32) (actual time=7782.040..7782.041 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=600795.85..693310.60 rows=501 width=15) (actual time=6972.314..7619.827 rows=944185 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.040..376.803 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=4) (actual time=6048.349..6048.349 rows=944185 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4192kB
                           ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=4) (actual time=1377.422..5600.050 rows=944185 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.026..2148.310 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=12) (actual time=1377.310..1377.310 rows=22772 loops=3)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5304kB
                                       ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=12) (actual time=1005.791..1321.957 rows=22772 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=16) (actual time=966.408..1267.387 rows=49517 loops=3)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.035..157.018 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=966.039..966.040 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=515.929..866.664 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.015..214.070 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=515.650..515.650 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=20.522..461.670 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=1.480..253.417 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.922..18.922 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.776..18.900 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.524..38.524 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.022..24.111 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 9.002 ms
 Execution Time: 7948.113 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17f.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=682238.58..682238.59 rows=1 width=32) (actual time=7054.317..7054.318 rows=1 loops=1)
   ->  Gather  (cost=682238.36..682238.57 rows=2 width=32) (actual time=7046.116..7129.462 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=681238.36..681238.37 rows=1 width=32) (actual time=7038.656..7038.657 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=647498.67..681237.95 rows=167 width=15) (actual time=6435.364..6972.893 rows=371040 loops=3)
                     Hash Cond: (mc.company_id = cn.id)
                     ->  Parallel Hash Join  (cost=641393.41..675132.25 rows=167 width=19) (actual time=6363.498..6801.199 rows=371040 loops=3)
                           Hash Cond: (mc.movie_id = ci.movie_id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.036..167.621 rows=869710 loops=3)
                           ->  Parallel Hash  (cost=641392.63..641392.63 rows=63 width=27) (actual time=6362.966..6362.966 rows=49831 loops=3)
                                 Buckets: 262144 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 13400kB
                                 ->  Parallel Hash Join  (cost=561705.80..641392.63 rows=63 width=27) (actual time=6146.558..6300.944 rows=49831 loops=3)
                                       Hash Cond: (n.id = ci.person_id)
                                       ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=210479 width=19) (actual time=0.057..513.038 rows=178905 loops=3)
                                             Filter: ((name)::text ~~ '%B%'::text)
                                             Rows Removed by Filter: 1210258
                                       ->  Parallel Hash  (cost=561699.31..561699.31 rows=519 width=16) (actual time=5541.927..5541.927 rows=346131 loops=3)
                                             Buckets: 65536 (originally 2048)  Batches: 16 (originally 1)  Memory Usage: 3680kB
                                             ->  Parallel Hash Join  (cost=101361.58..561699.31 rows=519 width=16) (actual time=996.339..5262.404 rows=346131 loops=3)
                                                   Hash Cond: (ci.movie_id = t.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=1.326..2279.844 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=994.904..994.904 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=531.289..894.685 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.016..223.833 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=531.066..531.066 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.728..466.356 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.428..257.616 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.184..19.185 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.820..19.161 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                     ->  Parallel Hash  (cost=4377.34..4377.34 rows=138234 width=4) (actual time=69.167..69.167 rows=78332 loops=3)
                           Buckets: 262144  Batches: 1  Memory Usage: 11296kB
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.024..22.950 rows=78332 loops=3)
 Planning Time: 9.157 ms
 Execution Time: 7130.073 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18a.sql_explained.sql
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=833190.17..833190.18 rows=1 width=96) (actual time=5796.082..5796.082 rows=1 loops=1)
   ->  Gather  (cost=833189.95..833190.16 rows=2 width=96) (actual time=5795.670..5802.527 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=832189.95..832189.96 rows=1 width=96) (actual time=5788.919..5788.919 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=781706.81..832189.94 rows=1 width=65) (actual time=5497.829..5788.639 rows=137 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.038..217.901 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=781706.80..781706.80 rows=1 width=60) (actual time=5460.754..5460.754 rows=137 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=540867.00..781706.80 rows=1 width=60) (actual time=4748.987..5460.483 rows=137 loops=3)
                                 Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=1007.198..1742.468 rows=40621 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.034..1117.421 rows=4945240 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.035 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=3)
                                                   Filter: ((info)::text = 'budget'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=540864.56..540864.56 rows=1 width=13) (actual time=3712.357..3712.357 rows=1145 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                       ->  Parallel Hash Join  (cost=525594.29..540864.56 rows=1 width=13) (actual time=3416.931..3595.543 rows=1145 loops=3)
                                             Hash Cond: (mi_idx.movie_id = ci.movie_id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.168..158.928 rows=153308 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.038..76.579 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.044 rows=1 loops=3)
                                                               Filter: ((info)::text = 'votes'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=525591.38..525591.38 rows=39 width=4) (actual time=3416.505..3416.505 rows=2240 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                   ->  Parallel Hash Join  (cost=81660.72..525591.38 rows=39 width=4) (actual time=1899.912..3289.689 rows=2240 loops=3)
                                                         Hash Cond: (ci.person_id = n.id)
                                                         ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=941346 width=8) (actual time=305.231..2615.408 rows=793090 loops=3)
                                                               Filter: ((note)::text = ANY ('{(producer),"(executive producer)"}'::text[]))
                                                               Rows Removed by Filter: 11288358
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=72 width=4) (actual time=585.187..585.187 rows=3021 loops=3)
                                                               Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=72 width=4) (actual time=0.144..506.813 rows=3021 loops=3)
                                                                     Filter: (((name)::text ~~ '%Tim%'::text) AND ((gender)::text = 'm'::text))
                                                                     Rows Removed by Filter: 1386143
 Planning Time: 9.516 ms
 Execution Time: 5803.240 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18b.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=886874.06..886874.07 rows=1 width=96) (actual time=5319.527..5319.528 rows=1 loops=1)
   ->  Gather  (cost=886873.83..886874.04 rows=2 width=96) (actual time=5319.161..5325.822 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=885873.83..885873.84 rows=1 width=96) (actual time=5312.313..5312.313 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=832828.60..885873.82 rows=1 width=65) (actual time=5220.083..5312.282 rows=4 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=332069 width=21) (actual time=0.025..254.806 rows=261496 loops=3)
                           Filter: ((production_year >= 2008) AND (production_year <= 2014))
                           Rows Removed by Filter: 581275
                     ->  Parallel Hash  (cost=832828.59..832828.59 rows=1 width=60) (actual time=5028.777..5028.777 rows=5 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=754551.36..832828.59 rows=1 width=60) (actual time=4752.655..5028.671 rows=5 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=255610 width=4) (actual time=186.507..440.891 rows=320518 loops=3)
                                       Filter: ((gender IS NOT NULL) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1068645
                                 ->  Parallel Hash  (cost=754551.35..754551.35 rows=1 width=64) (actual time=4553.367..4553.368 rows=137 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=254530.67..754551.35 rows=1 width=64) (actual time=3444.169..4553.099 rows=137 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=198.044..2880.110 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=254530.66..254530.66 rows=1 width=56) (actual time=1623.361..1623.361 rows=244 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=15184.50..254530.66 rows=1 width=56) (actual time=1460.286..1622.724 rows=244 loops=3)
                                                         Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                         ->  Hash Join  (cost=2.43..239347.45 rows=298 width=47) (actual time=1303.297..1460.672 rows=24086 loops=3)
                                                               Hash Cond: (mi.info_type_id = it1.id)
                                                               ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=33653 width=51) (actual time=914.440..1452.294 rows=24349 loops=3)
                                                                     Filter: ((note IS NULL) AND ((info)::text = ANY ('{Horror,Thriller}'::text[])))
                                                                     Rows Removed by Filter: 4920891
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.015..0.027 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'genres'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=15179.85..15179.85 rows=178 width=9) (actual time=156.558..156.558 rows=5283 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 952kB
                                                               ->  Hash Join  (cost=2.43..15179.85 rows=178 width=9) (actual time=0.310..133.438 rows=5283 loops=3)
                                                                     Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.076..129.222 rows=17883 loops=3)
                                                                           Filter: ((info)::text > '8.0'::text)
                                                                           Rows Removed by Filter: 442129
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.071..0.071 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.046 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'rating'::text)
                                                                                 Rows Removed by Filter: 112
 Planning Time: 9.000 ms
 Execution Time: 5326.500 ms
(52 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18c.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=917260.31..917260.32 rows=1 width=96) (actual time=6243.396..6243.396 rows=1 loops=1)
   ->  Gather  (cost=917260.08..917260.29 rows=2 width=96) (actual time=6239.531..6259.284 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=916260.08..916260.09 rows=1 width=96) (actual time=6232.780..6232.780 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=865776.83..916260.00 rows=11 width=65) (actual time=5868.618..6225.892 rows=9358 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.029..220.492 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=865776.69..865776.69 rows=11 width=60) (actual time=5866.443..5866.443 rows=9358 loops=3)
                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2168kB
                           ->  Parallel Hash Join  (cost=785749.31..865776.69 rows=11 width=60) (actual time=5284.781..5820.912 rows=9358 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=4) (actual time=0.048..449.464 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=785748.97..785748.97 rows=27 width=64) (actual time=5284.189..5284.190 rows=18052 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4472kB
                                       ->  Parallel Hash Join  (cost=285728.20..785748.97 rows=27 width=64) (actual time=3359.466..5240.742 rows=18052 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=219.029..2898.961 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=285727.93..285727.93 rows=21 width=56) (actual time=2253.543..2253.543 rows=34172 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 7704kB
                                                   ->  Parallel Hash Join  (cost=15319.64..285727.93 rows=21 width=56) (actual time=2168.789..2220.663 rows=34172 loops=3)
                                                         Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                         ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1660.346..1878.621 rows=62198 loops=3)
                                                               Hash Cond: (mi.info_type_id = it1.id)
                                                               ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1047.228..1861.283 rows=62990 loops=3)
                                                                     Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                     Rows Removed by Filter: 4882250
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.030..0.031 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.015..0.027 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'genres'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=258.613..258.613 rows=153308 loops=3)
                                                               Buckets: 65536 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 2848kB
                                                               ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.168..163.512 rows=153308 loops=3)
                                                                     Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.043..77.714 rows=460012 loops=3)
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.069..0.069 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.048..0.051 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'votes'::text)
                                                                                 Rows Removed by Filter: 112
 Planning Time: 8.753 ms
 Execution Time: 6260.058 ms
(48 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19a.sql_explained.sql
SET
SET
                                                                                                            QUERY PLAN                                                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=982370.28..982370.29 rows=1 width=64) (actual time=6290.560..6290.560 rows=1 loops=1)
   ->  Gather  (cost=982370.06..982370.27 rows=2 width=64) (actual time=6290.230..6297.739 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=981370.06..981370.07 rows=1 width=64) (actual time=6282.789..6282.789 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=928667.96..981370.06 rows=1 width=32) (actual time=6086.502..6282.717 rows=61 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=240570 width=21) (actual time=0.029..252.499 rows=191519 loops=3)
                           Filter: ((production_year >= 2005) AND (production_year <= 2009))
                           Rows Removed by Filter: 651252
                     ->  Parallel Hash  (cost=928667.95..928667.95 rows=1 width=27) (actual time=6006.843..6006.843 rows=104 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=923756.66..928667.95 rows=1 width=27) (actual time=5982.189..6006.704 rows=104 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.020..21.746 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=923756.65..923756.65 rows=1 width=31) (actual time=5981.882..5981.882 rows=107 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=888167.49..923756.65 rows=1 width=31) (actual time=5715.000..5981.772 rows=107 loops=3)
                                             Hash Cond: (mc.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=131225 width=8) (actual time=0.036..290.247 rows=196998 loops=3)
                                                   Filter: ((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                                   Rows Removed by Filter: 672712
                                             ->  Parallel Hash  (cost=888167.48..888167.48 rows=1 width=23) (actual time=5671.195..5671.195 rows=68 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=833727.94..888167.48 rows=1 width=23) (actual time=5301.812..5671.099 rows=68 loops=3)
                                                         Hash Cond: (chn.id = ci.person_role_id)
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.034..244.304 rows=1046780 loops=3)
                                                         ->  Parallel Hash  (cost=833727.93..833727.93 rows=1 width=27) (actual time=5297.488..5297.488 rows=75 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=578391.87..833727.93 rows=1 width=27) (actual time=4014.205..5297.377 rows=75 loops=3)
                                                                     Hash Cond: (mi.movie_id = ci.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255330.90 rows=2019 width=4) (actual time=414.745..1732.054 rows=150346 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=178.587..1694.639 rows=150368 loops=3)
                                                                                 Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                 Rows Removed by Filter: 4794872
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.028..0.039 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=578389.42..578389.42 rows=2 width=23) (actual time=3547.683..3547.683 rows=142 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Hash Join  (cost=97799.03..578389.42 rows=2 width=23) (actual time=1609.597..3547.541 rows=142 loops=3)
                                                                                 Hash Cond: (ci.role_id = rt.id)
                                                                                 ->  Parallel Hash Join  (cost=97797.87..578388.18 rows=19 width=27) (actual time=1609.467..3547.365 rows=142 loops=3)
                                                                                       Hash Cond: (ci.person_id = n.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.071..2820.004 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=23) (actual time=685.393..685.393 rows=519 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                                             ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=23) (actual time=565.495..684.901 rows=519 loops=3)
                                                                                                   Hash Cond: (an.person_id = n.id)
                                                                                                   ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.040..73.952 rows=300448 loops=3)
                                                                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=564.163..564.163 rows=2256 loops=3)
                                                                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=216.740..511.663 rows=2256 loops=3)
                                                                                                               Filter: (((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))
                                                                                                               Rows Removed by Filter: 1386908
                                                                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.075..0.075 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.045..0.048 rows=1 loops=3)
                                                                                             Filter: ((role)::text = 'actress'::text)
                                                                                             Rows Removed by Filter: 11
 Planning Time: 53.269 ms
 Execution Time: 6298.667 ms
(69 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=947597.06..947597.07 rows=1 width=64) (actual time=8392.693..8392.693 rows=1 loops=1)
   ->  Gather  (cost=947596.94..947597.05 rows=1 width=64) (actual time=8392.390..8398.149 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=946596.94..946596.95 rows=1 width=64) (actual time=8386.563..8386.563 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=941685.65..946596.94 rows=1 width=32) (actual time=8363.563..8386.537 rows=8 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.020..24.354 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=941685.64..941685.64 rows=1 width=36) (actual time=8357.613..8357.613 rows=8 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=903714.47..941685.64 rows=1 width=36) (actual time=8238.943..8357.568 rows=8 loops=2)
                                 Hash Cond: (mc.movie_id = t.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=41669 width=8) (actual time=0.029..408.155 rows=99260 loops=2)
                                       Filter: (((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                       Rows Removed by Filter: 1205305
                                 ->  Parallel Hash  (cost=903714.46..903714.46 rows=1 width=44) (actual time=7937.908..7937.908 rows=2 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=849274.92..903714.46 rows=1 width=44) (actual time=7846.630..7937.869 rows=2 loops=2)
                                             Hash Cond: (chn.id = ci.person_role_id)
                                             ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.033..375.458 rows=1570170 loops=2)
                                             ->  Parallel Hash  (cost=849274.91..849274.91 rows=1 width=48) (actual time=7374.106..7374.106 rows=2 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                   ->  Parallel Hash Join  (cost=833137.42..849274.91 rows=1 width=48) (actual time=7315.196..7374.062 rows=2 loops=2)
                                                         Hash Cond: (n.id = ci.person_id)
                                                         ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=23) (actual time=803.485..981.336 rows=648 loops=2)
                                                               Hash Cond: (an.person_id = n.id)
                                                               ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.299..113.621 rows=450672 loops=2)
                                                               ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=801.308..801.309 rows=2704 loops=2)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=328.479..779.051 rows=2704 loops=2)
                                                                           Filter: (((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))
                                                                           Rows Removed by Filter: 2081041
                                                         ->  Parallel Hash  (cost=751477.09..751477.09 rows=1 width=37) (actual time=6392.558..6392.558 rows=8 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=496679.24..751477.09 rows=1 width=37) (actual time=4865.327..6392.515 rows=8 loops=2)
                                                                     Hash Cond: (mi.movie_id = t.id)
                                                                     ->  Hash Join  (cost=2.43..254799.18 rows=291 width=4) (actual time=621.607..2526.954 rows=34739 loops=2)
                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=32862 width=8) (actual time=621.484..2514.697 rows=34739 loops=2)
                                                                                 Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%2007%'::text) OR ((info)::text ~~ 'USA:%2008%'::text)))
                                                                                 Rows Removed by Filter: 7383121
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.045 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=496676.80..496676.80 rows=1 width=33) (actual time=3860.674..3860.674 rows=8 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Hash Join  (cost=54434.90..496676.80 rows=1 width=33) (actual time=1650.312..3860.577 rows=8 loops=2)
                                                                                 Hash Cond: (ci.role_id = rt.id)
                                                                                 ->  Parallel Hash Join  (cost=54433.73..496675.63 rows=3 width=37) (actual time=493.038..3860.444 rows=36 loops=2)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=298009 width=16) (actual time=0.100..3450.653 rows=356914 loops=2)
                                                                                             Filter: ((note)::text = '(voice)'::text)
                                                                                             Rows Removed by Filter: 17765258
                                                                                       ->  Parallel Hash  (cost=54433.61..54433.61 rows=10 width=21) (actual time=361.211..361.211 rows=4 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=10 width=21) (actual time=75.887..361.151 rows=4 loops=2)
                                                                                                   Filter: ((production_year >= 2007) AND (production_year <= 2008) AND ((title)::text ~~ '%Kung%Fu%Panda%'::text))
                                                                                                   Rows Removed by Filter: 1264152
                                                                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=2)
                                                                                             Filter: ((role)::text = 'actress'::text)
                                                                                             Rows Removed by Filter: 11
 Planning Time: 51.508 ms
 Execution Time: 8399.104 ms
(69 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19c.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=979421.66..979421.67 rows=1 width=64) (actual time=7075.977..7075.977 rows=1 loops=1)
   ->  Gather  (cost=979421.44..979421.65 rows=2 width=64) (actual time=7075.144..7082.396 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=978421.44..978421.45 rows=1 width=64) (actual time=7067.528..7067.529 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=961861.47..978421.43 rows=2 width=32) (actual time=6953.867..7067.099 rows=1192 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.036..72.125 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=961861.46..961861.46 rows=1 width=40) (actual time=6950.930..6950.930 rows=877 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                           ->  Parallel Hash Join  (cost=956950.17..961861.46 rows=1 width=40) (actual time=6926.166..6947.949 rows=877 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.019..17.804 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=956950.15..956950.15 rows=2 width=44) (actual time=6925.996..6925.996 rows=2862 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                       ->  Parallel Hash Join  (cost=923212.00..956950.15 rows=2 width=44) (actual time=6633.493..6915.058 rows=2862 loops=3)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.036..157.133 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=923211.99..923211.99 rows=1 width=52) (actual time=6631.388..6631.388 rows=710 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                   ->  Parallel Hash Join  (cost=868772.46..923211.99 rows=1 width=52) (actual time=6200.516..6594.171 rows=710 loops=3)
                                                         Hash Cond: (chn.id = ci.person_role_id)
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.220..243.034 rows=1046780 loops=3)
                                                         ->  Parallel Hash  (cost=868772.44..868772.44 rows=1 width=56) (actual time=6198.928..6198.928 rows=755 loops=3)
                                                               Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                               ->  Parallel Hash Join  (cost=817446.81..868772.44 rows=1 width=56) (actual time=5858.421..6186.485 rows=755 loops=3)
                                                                     Hash Cond: (t.id = mi.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.037..272.318 rows=460484 loops=3)
                                                                           Filter: (production_year > 2000)
                                                                           Rows Removed by Filter: 382286
                                                                     ->  Parallel Hash  (cost=817446.79..817446.79 rows=2 width=35) (actual time=5857.188..5857.188 rows=840 loops=3)
                                                                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                                           ->  Parallel Hash Join  (cost=562110.73..817446.79 rows=2 width=35) (actual time=3999.051..5313.564 rows=840 loops=3)
                                                                                 Hash Cond: (mi.movie_id = ci.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..255330.90 rows=2019 width=4) (actual time=419.047..1715.302 rows=150346 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=176.847..1678.558 rows=150368 loops=3)
                                                                                             Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                             Rows Removed by Filter: 4794872
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.080..0.081 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.058..0.069 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'release dates'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=562103.89..562103.89 rows=353 width=31) (actual time=3576.601..3576.601 rows=2184 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 568kB
                                                                                       ->  Hash Join  (cost=81911.39..562103.89 rows=353 width=31) (actual time=1435.981..3377.652 rows=2184 loops=3)
                                                                                             Hash Cond: (ci.role_id = rt.id)
                                                                                             ->  Parallel Hash Join  (cost=81910.23..562087.69 rows=4234 width=35) (actual time=1435.862..3376.734 rows=2185 loops=3)
                                                                                                   Hash Cond: (ci.person_id = n.id)
                                                                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.086..2798.620 rows=289159 loops=3)
                                                                                                         Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                                         Rows Removed by Filter: 11792289
                                                                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=532.240..532.240 rows=16670 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 3264kB
                                                                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=217.848..519.561 rows=16670 loops=3)
                                                                                                               Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                                               Rows Removed by Filter: 1372493
                                                                                             ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.038..0.040 rows=1 loops=3)
                                                                                                         Filter: ((role)::text = 'actress'::text)
                                                                                                         Rows Removed by Filter: 11
 Planning Time: 51.814 ms
 Execution Time: 7083.376 ms
(67 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=992869.82..992869.83 rows=1 width=64) (actual time=9986.448..9986.448 rows=1 loops=1)
   ->  Gather  (cost=992869.60..992869.81 rows=2 width=64) (actual time=9922.977..10284.302 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=991869.60..991869.61 rows=1 width=64) (actual time=9937.047..9937.047 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=975303.84..991864.20 rows=1080 width=32) (actual time=9552.633..9783.139 rows=586882 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.049..77.965 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=975297.96..975297.96 rows=470 width=40) (actual time=9351.449..9351.450 rows=262348 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4384kB
                           ->  Parallel Hash Join  (cost=941555.37..975297.96 rows=470 width=40) (actual time=8590.829..9122.130 rows=262348 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Hash Join  (cost=936204.59..969943.78 rows=1294 width=44) (actual time=8549.039..8935.003 rows=1076352 loops=3)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.043..168.720 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=936201.50..936201.50 rows=247 width=52) (actual time=8139.260..8139.260 rows=113945 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 2624kB
                                             ->  Parallel Hash Join  (cost=884874.85..936201.50 rows=247 width=52) (actual time=7834.727..8024.100 rows=113945 loops=3)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.055..283.149 rows=460484 loops=3)
                                                         Filter: (production_year > 2000)
                                                         Rows Removed by Filter: 382286
                                                   ->  Parallel Hash  (cost=884869.20..884869.20 rows=452 width=31) (actual time=7369.980..7369.980 rows=166016 loops=3)
                                                         Buckets: 65536 (originally 2048)  Batches: 16 (originally 1)  Memory Usage: 2944kB
                                                         ->  Parallel Hash Join  (cost=636506.19..884869.20 rows=452 width=31) (actual time=7008.449..7218.997 rows=166016 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Hash Join  (cost=565505.50..808738.07 rows=934 width=35) (actual time=6199.312..6338.826 rows=182242 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Hash Join  (cost=480903.52..721760.35 rows=4089 width=16) (actual time=5364.449..5555.300 rows=182372 loops=3)
                                                                           Hash Cond: (mi.movie_id = ci.movie_id)
                                                                           ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=474.382..1992.433 rows=1012240 loops=3)
                                                                                 Hash Cond: (mi.info_type_id = it.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.054..1226.875 rows=4945240 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.049 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'release dates'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=480518.83..480518.83 rows=30581 width=12) (actual time=3091.002..3091.002 rows=92055 loops=3)
                                                                                 Buckets: 65536 (originally 131072)  Batches: 8 (originally 1)  Memory Usage: 2176kB
                                                                                 ->  Hash Join  (cost=1.16..480518.83 rows=30581 width=12) (actual time=949.652..3007.993 rows=92055 loops=3)
                                                                                       Hash Cond: (ci.role_id = rt.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.088..2944.648 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.033..0.035 rows=1 loops=3)
                                                                                                   Filter: ((role)::text = 'actress'::text)
                                                                                                   Rows Removed by Filter: 11
                                                                     ->  Parallel Hash  (cost=77318.68..77318.68 rows=396664 width=19) (actual time=571.814..571.815 rows=320518 loops=3)
                                                                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                                                                           ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=396664 width=19) (actual time=188.571..458.805 rows=320518 loops=3)
                                                                                 Filter: ((gender)::text = 'f'::text)
                                                                                 Rows Removed by Filter: 1068645
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=4) (actual time=585.070..585.070 rows=1046780 loops=3)
                                                                     Buckets: 131072  Batches: 64  Memory Usage: 3008kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.072..297.820 rows=1046780 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=40.892..40.892 rows=28281 loops=3)
                                       Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.028..24.997 rows=28281 loops=3)
                                             Filter: ((country_code)::text = '[us]'::text)
                                             Rows Removed by Filter: 50051
 Planning Time: 50.880 ms
 Execution Time: 10285.312 ms
(65 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=104638.31..104638.32 rows=1 width=68) (actual time=852.439..852.439 rows=1 loops=1)
   ->  Gather  (cost=104638.09..104638.30 rows=2 width=68) (actual time=851.922..857.956 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=103638.09..103638.10 rows=1 width=68) (actual time=845.408..845.408 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=53154.41..103637.73 rows=47 width=45) (actual time=734.763..845.303 rows=47 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.039..223.953 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=53153.83..53153.83 rows=47 width=32) (actual time=515.123..515.123 rows=47 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=37883.38..53153.83 rows=47 width=32) (actual time=514.618..514.825 rows=47 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mc.movie_id)
                                 ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=133.596..133.636 rows=83 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.029..77.884 rows=460012 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.044..0.046 rows=1 loops=3)
                                                   Filter: ((info)::text = 'top 250 rank'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=37857.14..37857.14 rows=1905 width=28) (actual time=380.921..380.921 rows=9552 loops=3)
                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2112kB
                                       ->  Hash Join  (cost=1.06..37857.14 rows=1905 width=28) (actual time=275.494..369.958 rows=9552 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=7618 width=32) (actual time=40.334..366.180 rows=9630 loops=3)
                                                   Filter: (((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND (((note)::text ~~ '%(co-production)%'::text) OR ((note)::text ~~ '%(presents)%'::text)))
                                                   Rows Removed by Filter: 860080
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'production companies'::text)
                                                         Rows Removed by Filter: 3
 Planning Time: 4.011 ms
 Execution Time: 858.474 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1b.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=103766.13..103766.14 rows=1 width=68) (actual time=742.819..742.819 rows=1 loops=1)
   ->  Gather  (cost=103765.91..103766.12 rows=2 width=68) (actual time=742.584..748.193 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=102765.91..102765.92 rows=1 width=68) (actual time=736.312..736.312 rows=1 loops=3)
               ->  Hash Join  (cost=68268.30..102758.62 rows=972 width=45) (actual time=721.820..736.295 rows=1 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=68267.24..102736.53 rows=3890 width=49) (actual time=555.399..736.006 rows=22 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=556503 width=32) (actual time=0.048..264.869 rows=445696 loops=3)
                                 Filter: ((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)
                                 Rows Removed by Filter: 424014
                           ->  Parallel Hash  (cost=68249.11..68249.11 rows=1450 width=29) (actual time=426.577..426.577 rows=1 loops=3)
                                 Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                 ->  Parallel Hash Join  (cost=15317.21..68249.11 rows=1450 width=29) (actual time=367.452..426.446 rows=1 loops=3)
                                       Hash Cond: (t.id = mi_idx.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=300243 width=25) (actual time=0.048..264.835 rows=238753 loops=3)
                                             Filter: ((production_year >= 2005) AND (production_year <= 2010))
                                             Rows Removed by Filter: 604018
                                       ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=4) (actual time=133.426..133.426 rows=3 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 160kB
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=133.347..133.350 rows=3 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.044..77.087 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.067 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.047 rows=1 loops=3)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.041..0.042 rows=1 loops=3)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 3.720 ms
 Execution Time: 748.684 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=101209.01..101209.02 rows=1 width=68) (actual time=711.709..711.709 rows=1 loops=1)
   ->  Gather  (cost=101208.79..101209.00 rows=2 width=68) (actual time=711.258..717.454 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=100208.79..100208.80 rows=1 width=68) (actual time=704.857..704.858 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=50420.55..100208.75 rows=5 width=45) (actual time=685.871..704.850 rows=1 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=25) (actual time=0.037..242.990 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=50420.11..50420.11 rows=35 width=32) (actual time=444.580..444.580 rows=8 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=35149.70..50420.11 rows=35 width=32) (actual time=444.250..444.338 rows=8 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mc.movie_id)
                                 ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=131.565..131.599 rows=83 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.031..75.864 rows=460012 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.043 rows=1 loops=3)
                                                   Filter: ((info)::text = 'top 250 rank'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=35129.26..35129.26 rows=1441 width=28) (actual time=312.579..312.579 rows=5937 loops=3)
                                       Buckets: 32768 (originally 4096)  Batches: 1 (originally 1)  Memory Usage: 1536kB
                                       ->  Hash Join  (cost=1.06..35129.26 rows=1441 width=28) (actual time=213.249..300.657 rows=5937 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=5762 width=32) (actual time=139.670..298.117 rows=5939 loops=3)
                                                   Filter: (((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND ((note)::text ~~ '%(co-production)%'::text))
                                                   Rows Removed by Filter: 863771
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'production companies'::text)
                                                         Rows Removed by Filter: 3
 Planning Time: 3.815 ms
 Execution Time: 717.992 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1d.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=102217.02..102217.03 rows=1 width=68) (actual time=766.802..766.802 rows=1 loops=1)
   ->  Gather  (cost=102216.80..102217.01 rows=2 width=68) (actual time=766.533..772.561 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=101216.80..101216.81 rows=1 width=68) (actual time=760.259..760.260 rows=1 loops=3)
               ->  Hash Join  (cost=66690.26..101202.81 rows=1865 width=45) (actual time=741.796..760.240 rows=1 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=66689.20..101161.42 rows=7460 width=49) (actual time=540.456..759.961 rows=26 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=556503 width=32) (actual time=0.046..266.167 rows=445696 loops=3)
                                 Filter: ((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)
                                 Rows Removed by Filter: 424014
                           ->  Parallel Hash  (cost=66654.42..66654.42 rows=2782 width=29) (actual time=448.658..448.658 rows=2 loops=3)
                                 Buckets: 8192  Batches: 1  Memory Usage: 160kB
                                 ->  Parallel Hash Join  (cost=15317.21..66654.42 rows=2782 width=29) (actual time=378.645..448.528 rows=2 loops=3)
                                       Hash Cond: (t.id = mi_idx.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.037..267.099 rows=460484 loops=3)
                                             Filter: (production_year > 2000)
                                             Rows Removed by Filter: 382286
                                       ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=4) (actual time=132.641..132.641 rows=3 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 160kB
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=132.571..132.573 rows=3 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.047..76.229 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.068..0.069 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.046 rows=1 loops=3)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=3)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 3.663 ms
 Execution Time: 773.056 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20a.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=690921.15..690921.16 rows=1 width=32) (actual time=5651.233..5651.233 rows=1 loops=1)
   ->  Hash Join  (cost=611431.78..690921.14 rows=1 width=17) (actual time=5650.594..5651.209 rows=33 loops=1)
         Hash Cond: (t.kind_id = kt.id)
         ->  Gather  (cost=611430.68..690920.04 rows=1 width=21) (actual time=5650.459..5657.216 rows=33 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=610430.68..689919.94 rows=1 width=21) (actual time=5354.013..5643.665 rows=11 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.052..376.111 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=610430.67..610430.67 rows=1 width=25) (actual time=5096.973..5096.973 rows=11 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Hash Join  (cost=557690.68..610430.67 rows=1 width=25) (actual time=5058.696..5096.878 rows=11 loops=3)
                                 Hash Cond: (t.id = cc.movie_id)
                                 ->  Parallel Hash Join  (cost=554588.26..607328.24 rows=1 width=37) (actual time=4769.599..4998.327 rows=59 loops=3)
                                       Hash Cond: (t.id = mk.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=952979 width=25) (actual time=0.040..282.564 rows=762424 loops=3)
                                             Filter: (production_year > 1950)
                                             Rows Removed by Filter: 80347
                                       ->  Parallel Hash  (cost=554588.25..554588.25 rows=1 width=12) (actual time=4640.528..4640.528 rows=59 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=111235.39..554588.25 rows=1 width=12) (actual time=1327.516..4640.399 rows=59 loops=3)
                                                   Hash Cond: (ci.movie_id = mk.movie_id)
                                                   ->  Parallel Hash Join  (cost=59349.58..502696.95 rows=1460 width=8) (actual time=612.619..4035.489 rows=185 loops=3)
                                                         Hash Cond: (ci.person_role_id = chn.id)
                                                         ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.026..2155.347 rows=12081448 loops=3)
                                                         ->  Parallel Hash  (cost=59346.31..59346.31 rows=262 width=4) (actual time=538.348..538.349 rows=10 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Seq Scan on char_name chn  (cost=0.00..59346.31 rows=262 width=4) (actual time=29.851..538.257 rows=10 loops=3)
                                                                     Filter: (((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))
                                                                     Rows Removed by Filter: 1046770
                                                   ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=4) (actual time=604.705..604.706 rows=11849 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=4) (actual time=59.099..500.728 rows=11849 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.039..253.664 rows=1507977 loops=3)
                                                               ->  Hash  (cost=3632.40..3632.40 rows=8 width=4) (actual time=58.736..58.742 rows=8 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=4) (actual time=0.199..58.719 rows=8 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                                           Rows Removed by Filter: 134162
                                 ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=98.201..98.201 rows=85941 loops=3)
                                       Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                       ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.241..71.517 rows=85941 loops=3)
                                             Hash Cond: (cc.status_id = cct2.id)
                                             ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.117..53.376 rows=85941 loops=3)
                                                   Hash Cond: (cc.subject_id = cct1.id)
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.031..22.562 rows=135086 loops=3)
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.021..0.021 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'cast'::text)
                                                               Rows Removed by Filter: 3
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.064..0.064 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.044..0.046 rows=2 loops=3)
                                                         Filter: ((kind)::text ~~ '%complete%'::text)
                                                         Rows Removed by Filter: 2
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=1)
                     Filter: ((kind)::text = 'movie'::text)
                     Rows Removed by Filter: 6
 Planning Time: 35.129 ms
 Execution Time: 5658.327 ms
(64 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20b.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=687335.89..687335.90 rows=1 width=32) (actual time=5390.858..5390.858 rows=1 loops=1)
   ->  Gather  (cost=687335.68..687335.89 rows=2 width=32) (actual time=5390.452..5397.895 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=686335.68..686335.69 rows=1 width=32) (actual time=5383.426..5383.427 rows=1 loops=3)
               ->  Hash Join  (cost=635010.03..686335.67 rows=1 width=17) (actual time=5353.888..5383.405 rows=6 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=635008.93..686334.57 rows=1 width=21) (actual time=5353.615..5383.130 rows=6 loops=3)
                           Hash Cond: (t.id = cc.movie_id)
                           ->  Parallel Hash Join  (cost=631906.51..683232.14 rows=1 width=33) (actual time=5231.736..5290.566 rows=17 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.045..270.389 rows=460484 loops=3)
                                       Filter: (production_year > 2000)
                                       Rows Removed by Filter: 382286
                                 ->  Parallel Hash  (cost=631906.50..631906.50 rows=1 width=8) (actual time=4973.575..4973.576 rows=17 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=583654.16..631906.50 rows=1 width=8) (actual time=4747.969..4973.419 rows=17 loops=3)
                                             Hash Cond: (mk.movie_id = ci.movie_id)
                                             ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=4) (actual time=41.662..487.311 rows=11849 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.041..258.944 rows=1507977 loops=3)
                                                   ->  Hash  (cost=3632.40..3632.40 rows=8 width=4) (actual time=41.393..41.393 rows=8 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=4) (actual time=0.154..41.374 rows=8 loops=3)
                                                               Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                               Rows Removed by Filter: 134162
                                             ->  Parallel Hash  (cost=580021.64..580021.64 rows=1 width=4) (actual time=4483.715..4483.715 rows=5 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=136670.44..580021.64 rows=1 width=4) (actual time=1331.323..4483.594 rows=5 loops=3)
                                                         Hash Cond: (ci.person_id = n.id)
                                                         ->  Parallel Hash Join  (cost=59349.58..502696.95 rows=1460 width=8) (actual time=591.687..3994.084 rows=185 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.031..2123.002 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=59346.31..59346.31 rows=262 width=4) (actual time=532.111..532.111 rows=10 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..59346.31 rows=262 width=4) (actual time=50.207..531.973 rows=10 loops=3)
                                                                           Filter: (((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))
                                                                           Rows Removed by Filter: 1046770
                                                         ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=4) (actual time=489.411..489.411 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=4) (actual time=196.414..489.348 rows=1 loops=3)
                                                                     Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                                     Rows Removed by Filter: 1389163
                           ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=92.251..92.251 rows=85941 loops=3)
                                 Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                 ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.192..65.595 rows=85941 loops=3)
                                       Hash Cond: (cc.status_id = cct2.id)
                                       ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.108..47.535 rows=85941 loops=3)
                                             Hash Cond: (cc.subject_id = cct1.id)
                                             ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.027..17.032 rows=135086 loops=3)
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.027..0.027 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'cast'::text)
                                                         Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.033..0.033 rows=2 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.020..0.022 rows=2 loops=3)
                                                   Filter: ((kind)::text ~~ '%complete%'::text)
                                                   Rows Removed by Filter: 2
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.068..0.069 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.039..0.041 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 35.138 ms
 Execution Time: 5398.835 ms
(67 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20c.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=689631.09..689631.10 rows=1 width=64) (actual time=6529.406..6529.407 rows=1 loops=1)
   ->  Gather  (cost=610141.72..689631.08 rows=1 width=32) (actual time=5932.183..6534.121 rows=5406 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Hash Join  (cost=609141.72..688630.98 rows=1 width=32) (actual time=5924.728..6515.103 rows=1802 loops=3)
               Hash Cond: (t.kind_id = kt.id)
               ->  Parallel Hash Join  (cost=609140.62..688629.88 rows=1 width=36) (actual time=5924.175..6513.857 rows=1906 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.053..386.653 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=609140.61..609140.61 rows=1 width=25) (actual time=5922.642..5922.642 rows=1906 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=557788.53..609140.61 rows=1 width=25) (actual time=5531.574..5866.610 rows=1906 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Hash Join  (cost=3102.42..54447.27 rows=1923 width=29) (actual time=93.561..439.236 rows=7852 loops=3)
                                       Hash Cond: (t.id = cc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.061..274.827 rows=460484 loops=3)
                                             Filter: (production_year > 2000)
                                             Rows Removed by Filter: 382286
                                       ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=93.105..93.105 rows=85941 loops=3)
                                             Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                             ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.207..66.533 rows=85941 loops=3)
                                                   Hash Cond: (cc.status_id = cct2.id)
                                                   ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.099..48.213 rows=85941 loops=3)
                                                         Hash Cond: (cc.subject_id = cct1.id)
                                                         ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.020..17.537 rows=135086 loops=3)
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.022..0.022 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.010..0.011 rows=1 loops=3)
                                                                     Filter: ((kind)::text = 'cast'::text)
                                                                     Rows Removed by Filter: 3
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.046..0.046 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.031..0.033 rows=2 loops=3)
                                                               Filter: ((kind)::text ~~ '%complete%'::text)
                                                               Rows Removed by Filter: 2
                                 ->  Parallel Hash  (cost=554683.94..554683.94 rows=174 width=12) (actual time=5422.601..5422.601 rows=12272 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2776kB
                                       ->  Parallel Hash Join  (cost=109433.18..554683.94 rows=174 width=12) (actual time=1139.367..5126.353 rows=12272 loops=3)
                                             Hash Cond: (ci.movie_id = mk.movie_id)
                                             ->  Parallel Hash Join  (cost=57211.57..500558.94 rows=507378 width=8) (actual time=532.501..4467.847 rows=207862 loops=3)
                                                   Hash Cond: (ci.person_role_id = chn.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.030..2281.687 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=56075.12..56075.12 rows=90916 width=4) (actual time=530.360..530.360 rows=60051 loops=3)
                                                         Buckets: 262144  Batches: 1  Memory Usage: 9120kB
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=4) (actual time=0.050..482.133 rows=60051 loops=3)
                                                               Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                                               Rows Removed by Filter: 986729
                                             ->  Parallel Hash  (cost=52219.86..52219.86 rows=140 width=4) (actual time=606.043..606.043 rows=8030 loops=3)
                                                   Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                   ->  Hash Join  (cost=3967.95..52219.86 rows=140 width=4) (actual time=46.819..493.780 rows=8030 loops=3)
                                                         Hash Cond: (mk.keyword_id = k.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.045..259.003 rows=1507977 loops=3)
                                                         ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=46.592..46.592 rows=10 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.200..46.574 rows=10 loops=3)
                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                     Rows Removed by Filter: 134160
               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=3)
                           Filter: ((kind)::text = 'movie'::text)
                           Rows Removed by Filter: 6
 Planning Time: 33.769 ms
 Execution Time: 6537.944 ms
(64 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21a.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=63661.87..63661.88 rows=1 width=96) (actual time=731.457..731.457 rows=1 loops=1)
   ->  Gather  (cost=63661.76..63661.87 rows=1 width=96) (actual time=731.191..736.502 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=62661.76..62661.77 rows=1 width=96) (actual time=725.663..725.663 rows=1 loops=2)
               ->  Hash Join  (cost=57154.03..62661.75 rows=1 width=118) (actual time=668.662..725.340 rows=705 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=57152.97..62660.68 rows=1 width=122) (actual time=668.493..725.008 rows=752 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.042..60.414 rows=24151 loops=2)
                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                 Rows Removed by Filter: 93348
                           ->  Parallel Hash  (cost=57152.95..57152.95 rows=1 width=107) (actual time=660.651..660.651 rows=1562 loops=2)
                                 Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                 ->  Hash Join  (cost=3473.02..57152.95 rows=1 width=107) (actual time=307.872..569.319 rows=1562 loops=2)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=846.89..54494.99 rows=12124 width=111) (actual time=69.080..548.692 rows=27148 loops=2)
                                             Merge Cond: (ml.movie_id = mk.movie_id)
                                             ->  Merge Join  (cost=651.93..51228.28 rows=260 width=123) (actual time=67.337..508.368 rows=3220 loops=2)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=651.50..46001.67 rows=102 width=111) (actual time=64.211..464.770 rows=656 loops=2)
                                                         Merge Cond: (ml.movie_id = t.id)
                                                         ->  Merge Join  (cost=651.07..37165.42 rows=282 width=90) (actual time=15.137..264.142 rows=1391 loops=2)
                                                               Merge Cond: (mi.movie_id = ml.movie_id)
                                                               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1002971.17 rows=60182 width=4) (actual time=1.306..252.498 rows=2058 loops=2)
                                                                     Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                                                                     Rows Removed by Filter: 255305
                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.450..10.705 rows=3172 loops=2)
                                                                     Sort Key: ml.movie_id
                                                                     Sort Method: quicksort  Memory: 205kB
                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.136..9.152 rows=2315 loops=2)
                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.029..4.859 rows=29997 loops=2)
                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.053..0.054 rows=2 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.032..0.037 rows=2 loops=2)
                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                       Rows Removed by Filter: 16
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=911963 width=21) (actual time=0.022..196.092 rows=51993 loops=2)
                                                               Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                                               Rows Removed by Filter: 110576
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.059..39.947 rows=40588 loops=2)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 39291
                                             ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.030..26.533 rows=102619 loops=2)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=17.752..17.752 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.084..17.739 rows=1 loops=2)
                                                   Filter: ((keyword)::text = 'sequel'::text)
                                                   Rows Removed by Filter: 134169
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.041..0.043 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 31.452 ms
 Execution Time: 737.319 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=61990.17..61990.18 rows=1 width=96) (actual time=515.177..515.177 rows=1 loops=1)
   ->  Gather  (cost=61990.05..61990.16 rows=1 width=96) (actual time=514.960..520.369 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=60990.05..60990.06 rows=1 width=96) (actual time=509.478..509.479 rows=1 loops=2)
               ->  Hash Join  (cost=55482.32..60990.04 rows=1 width=118) (actual time=478.554..509.451 rows=19 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=55481.26..60988.98 rows=1 width=122) (actual time=478.398..509.290 rows=19 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.034..60.720 rows=24151 loops=2)
                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                 Rows Removed by Filter: 93348
                           ->  Parallel Hash  (cost=55481.25..55481.25 rows=1 width=107) (actual time=445.075..445.075 rows=66 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                 ->  Hash Join  (cost=3474.93..55481.25 rows=1 width=107) (actual time=399.695..444.923 rows=66 loops=2)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=848.79..52824.70 rows=11587 width=111) (actual time=31.816..427.372 rows=2784 loops=2)
                                             Merge Cond: (ml.movie_id = mk.movie_id)
                                             ->  Merge Join  (cost=651.93..49563.13 rows=249 width=123) (actual time=26.240..400.013 rows=770 loops=2)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=651.50..44336.66 rows=97 width=111) (actual time=25.228..369.270 rows=338 loops=2)
                                                         Merge Cond: (ml.movie_id = t.id)
                                                         ->  Merge Join  (cost=651.07..35476.61 rows=237 width=90) (actual time=15.601..186.755 rows=544 loops=2)
                                                               Merge Cond: (mi.movie_id = ml.movie_id)
                                                               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..956609.55 rows=50482 width=4) (actual time=1.352..175.188 rows=1524 loops=2)
                                                                     Filter: ((info)::text = ANY ('{Germany,German}'::text[]))
                                                                     Rows Removed by Filter: 255930
                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.744..10.943 rows=2527 loops=2)
                                                                     Sort Key: ml.movie_id
                                                                     Sort Method: quicksort  Memory: 205kB
                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.120..9.489 rows=2315 loops=2)
                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.022..5.191 rows=29997 loops=2)
                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.045..0.046 rows=2 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.029..0.034 rows=2 loops=2)
                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                       Rows Removed by Filter: 16
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=1038952 width=21) (actual time=0.033..175.887 rows=80454 loops=2)
                                                               Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                               Rows Removed by Filter: 83612
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.053..27.689 rows=38685 loops=2)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 39236
                                             ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.024..18.825 rows=80312 loops=2)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=17.243..17.243 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.046..17.232 rows=1 loops=2)
                                                   Filter: ((keyword)::text = 'sequel'::text)
                                                   Rows Removed by Filter: 134169
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.038..0.040 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 31.647 ms
 Execution Time: 521.175 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21c.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=54436.16..54436.17 rows=1 width=96) (actual time=645.370..645.370 rows=1 loops=1)
   ->  Hash Join  (cost=22630.14..54436.15 rows=1 width=118) (actual time=322.693..644.519 rows=1874 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=20004.00..51778.36 rows=12060 width=122) (actual time=221.386..607.598 rows=33031 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Merge Join  (cost=208.46..1509126.58 rows=11385503 width=12) (actual time=0.122..378.357 rows=55032 loops=1)
                     Merge Cond: (mi.movie_id = mk.movie_id)
                     ->  Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1194599.22 rows=893642 width=4) (actual time=0.081..315.707 rows=28657 loops=1)
                           Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))
                           Rows Removed by Filter: 414007
                     ->  Materialize  (cost=0.43..153366.95 rows=4523930 width=8) (actual time=0.036..38.707 rows=85569 loops=1)
                           ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.026..22.791 rows=82171 loops=1)
               ->  Sort  (cost=19795.25..19795.61 rows=144 width=130) (actual time=215.456..217.549 rows=33234 loops=1)
                     Sort Key: mc.movie_id
                     Sort Method: quicksort  Memory: 203kB
                     ->  Gather  (cost=7378.71..19790.09 rows=144 width=130) (actual time=73.989..215.996 rows=1130 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Hash Join  (cost=6378.71..18775.69 rows=60 width=130) (actual time=82.250..201.765 rows=377 loops=3)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=6377.65..18773.33 rows=240 width=134) (actual time=82.049..201.436 rows=393 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Merge Join  (cost=651.50..13043.69 rows=1331 width=119) (actual time=14.126..150.171 rows=1672 loops=3)
                                             Merge Cond: (ml.movie_id = mc.movie_id)
                                             ->  Merge Join  (cost=651.07..7805.34 rows=520 width=107) (actual time=13.920..106.832 rows=749 loops=3)
                                                   Merge Cond: (t.id = ml.movie_id)
                                                   ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=789968 width=21) (actual time=0.082..89.102 rows=48445 loops=3)
                                                         Filter: ((production_year >= 1950) AND (production_year <= 2010))
                                                         Rows Removed by Filter: 13625
                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.930..13.112 rows=2315 loops=3)
                                                         Sort Key: ml.movie_id
                                                         Sort Method: quicksort  Memory: 205kB
                                                         Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                         Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.139..11.645 rows=2315 loops=3)
                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.031..7.283 rows=29997 loops=3)
                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.046..0.046 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.029..0.035 rows=2 loops=3)
                                                                           Filter: ((link)::text ~~ '%follow%'::text)
                                                                           Rows Removed by Filter: 16
                                             ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.039..39.454 rows=45268 loops=3)
                                                   Filter: (note IS NULL)
                                                   Rows Removed by Filter: 45979
                                       ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=49.850..49.850 rows=16101 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.029..38.531 rows=16101 loops=3)
                                                   Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                   Rows Removed by Filter: 62232
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=3)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=33.770..33.770 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.726..33.759 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 32.166 ms
 Execution Time: 647.398 ms
(62 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=414666.61..414666.62 rows=1 width=96) (actual time=3424.102..3424.102 rows=1 loops=1)
   ->  Gather  (cost=414666.39..414666.60 rows=2 width=96) (actual time=3422.082..3431.507 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=413666.39..413666.40 rows=1 width=96) (actual time=3414.179..3414.180 rows=1 loops=3)
               ->  Hash Join  (cost=363451.32..413666.38 rows=1 width=41) (actual time=3247.334..3413.707 rows=950 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=363450.20..413665.27 rows=1 width=45) (actual time=3226.063..3413.139 rows=1009 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=279670 width=25) (actual time=0.014..270.980 rows=220688 loops=3)
                                 Filter: (production_year > 2008)
                                 Rows Removed by Filter: 622082
                           ->  Parallel Hash  (cost=363450.19..363450.19 rows=1 width=40) (actual time=3104.779..3104.779 rows=13395 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4088kB
                                 ->  Hash Join  (cost=358450.15..363450.19 rows=1 width=40) (actual time=3038.330..3088.033 rows=13395 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=358449.06..363449.10 rows=1 width=44) (actual time=3038.222..3084.406 rows=13395 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.038..32.713 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=358449.05..358449.05 rows=1 width=29) (actual time=3038.059..3038.060 rows=14738 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3832kB
                                                   ->  Parallel Hash Join  (cost=323145.98..358449.05 rows=1 width=29) (actual time=2711.633..3006.444 rows=14738 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.014..278.203 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=323145.97..323145.97 rows=1 width=17) (actual time=2709.009..2709.009 rows=5361 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                                                               ->  Parallel Hash Join  (cost=67689.63..323145.97 rows=1 width=17) (actual time=2280.095..2666.922 rows=5361 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255449.73 rows=2405 width=4) (actual time=1425.782..1784.441 rows=196255 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=271735 width=8) (actual time=0.719..1734.711 rows=223112 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Germany,German,USA,American}'::text[]))
                                                                                 Rows Removed by Filter: 4722128
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.014..0.026 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'countries'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=67687.20..67687.20 rows=1 width=13) (actual time=853.643..853.643 rows=8267 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1720kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..67687.20 rows=1 width=13) (actual time=594.076..826.555 rows=8267 loops=3)
                                                                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..16456.75 rows=4327 width=9) (actual time=0.203..213.461 rows=108039 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=488953 width=13) (actual time=0.044..160.433 rows=390635 loops=3)
                                                                                             Filter: ((info)::text < '7.0'::text)
                                                                                             Rows Removed by Filter: 69377
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.047..0.050 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=593.038..593.038 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=39.230..486.823 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..259.628 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=39.040..39.040 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.748..39.026 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.049..0.049 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.036..0.037 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.066..0.066 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.043..0.046 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 81.216 ms
 Execution Time: 3432.881 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22b.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=414463.52..414463.53 rows=1 width=96) (actual time=3352.745..3352.745 rows=1 loops=1)
   ->  Gather  (cost=414463.29..414463.50 rows=2 width=96) (actual time=3350.788..3360.122 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=413463.29..413463.30 rows=1 width=96) (actual time=3343.091..3343.091 rows=1 loops=3)
               ->  Hash Join  (cost=363451.32..413463.29 rows=1 width=41) (actual time=3263.310..3343.055 rows=10 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=363450.20..413462.17 rows=1 width=45) (actual time=3262.998..3342.738 rows=11 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=225511 width=25) (actual time=0.013..256.548 rows=177790 loops=3)
                                 Filter: (production_year > 2009)
                                 Rows Removed by Filter: 664981
                           ->  Parallel Hash  (cost=363450.19..363450.19 rows=1 width=40) (actual time=3055.943..3055.943 rows=13395 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4056kB
                                 ->  Hash Join  (cost=358450.15..363450.19 rows=1 width=40) (actual time=3006.074..3041.214 rows=13395 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=358449.06..363449.10 rows=1 width=44) (actual time=3005.964..3037.638 rows=13395 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.017..19.612 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=358449.05..358449.05 rows=1 width=29) (actual time=3005.828..3005.828 rows=14738 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3832kB
                                                   ->  Parallel Hash Join  (cost=323145.98..358449.05 rows=1 width=29) (actual time=2685.450..2976.080 rows=14738 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.013..273.168 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=323145.97..323145.97 rows=1 width=17) (actual time=2683.753..2683.753 rows=5361 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1048kB
                                                               ->  Parallel Hash Join  (cost=67689.63..323145.97 rows=1 width=17) (actual time=2268.936..2656.042 rows=5361 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255449.73 rows=2405 width=4) (actual time=1421.251..1780.157 rows=196255 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=271735 width=8) (actual time=0.684..1729.906 rows=223112 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Germany,German,USA,American}'::text[]))
                                                                                 Rows Removed by Filter: 4722128
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.028 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'countries'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=67687.20..67687.20 rows=1 width=13) (actual time=846.975..846.975 rows=8267 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1752kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..67687.20 rows=1 width=13) (actual time=578.320..811.189 rows=8267 loops=3)
                                                                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..16456.75 rows=4327 width=9) (actual time=0.200..214.157 rows=108039 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=488953 width=13) (actual time=0.050..161.050 rows=390635 loops=3)
                                                                                             Filter: ((info)::text < '7.0'::text)
                                                                                             Rows Removed by Filter: 69377
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.058 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.047 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=577.538..577.538 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.795..475.020 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.043..254.070 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.520..32.520 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.555..32.505 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.055..0.055 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.040..0.042 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.060..0.060 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.034..0.037 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 80.744 ms
 Execution Time: 3361.413 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22c.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=461803.15..461803.16 rows=1 width=96) (actual time=4029.575..4029.575 rows=1 loops=1)
   ->  Gather  (cost=461802.92..461803.13 rows=2 width=96) (actual time=4027.201..4036.318 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=460802.92..460802.93 rows=1 width=96) (actual time=4019.630..4019.630 rows=1 loops=3)
               ->  Hash Join  (cost=410038.34..460802.92 rows=1 width=41) (actual time=3708.147..4016.439 rows=7163 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=410037.22..460801.80 rows=1 width=45) (actual time=3688.417..4014.238 rows=7732 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.017..272.558 rows=337640 loops=3)
                                 Filter: (production_year > 2005)
                                 Rows Removed by Filter: 505131
                           ->  Parallel Hash  (cost=410037.21..410037.21 rows=1 width=40) (actual time=3684.289..3684.289 rows=21916 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5976kB
                                 ->  Hash Join  (cost=405037.17..410037.21 rows=1 width=40) (actual time=3620.191..3662.435 rows=21916 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=405036.08..410036.12 rows=1 width=44) (actual time=3620.085..3656.750 rows=21916 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.014..19.779 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=405036.07..405036.07 rows=1 width=29) (actual time=3619.969..3619.969 rows=23616 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6552kB
                                                   ->  Parallel Hash Join  (cost=369733.01..405036.07 rows=1 width=29) (actual time=3273.315..3574.471 rows=23616 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.013..279.823 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3272.628..3272.628 rows=6989 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                                               ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2996.161..3245.265 rows=6989 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.186..226.129 rows=151410 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.058..162.024 rows=447629 loops=3)
                                                                                 Filter: ((info)::text < '8.5'::text)
                                                                                 Rows Removed by Filter: 12383
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2995.248..2995.249 rows=7972 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2431.868..2948.248 rows=7972 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1869.449..2355.733 rows=204750 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=5.168..2303.538 rows=238737 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                                                             Rows Removed by Filter: 4706503
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.061..0.062 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.050 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'countries'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=561.666..561.666 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.960..473.358 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.040..253.495 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.677..32.677 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.564..32.663 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.047..0.047 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.034..0.036 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.057..0.057 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.035..0.037 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 82.104 ms
 Execution Time: 4038.194 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22d.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=460238.12..460238.13 rows=1 width=96) (actual time=5700.347..5700.347 rows=1 loops=1)
   ->  Gather  (cost=460238.00..460238.11 rows=1 width=96) (actual time=5699.448..5705.358 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=459238.00..459238.01 rows=1 width=96) (actual time=5693.351..5693.351 rows=1 loops=2)
               ->  Hash Join  (cost=454237.96..459238.00 rows=1 width=41) (actual time=5629.871..5684.080 rows=23140 loops=2)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=454236.84..459236.88 rows=1 width=45) (actual time=5629.621..5678.309 rows=24954 loops=2)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=454235.75..459235.79 rows=1 width=49) (actual time=5629.505..5672.208 rows=24954 loops=2)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.008..25.579 rows=63115 loops=2)
                                       Filter: ((country_code)::text <> '[us]'::text)
                                       Rows Removed by Filter: 54384
                                 ->  Parallel Hash  (cost=454235.74..454235.74 rows=1 width=34) (actual time=5629.069..5629.069 rows=35884 loops=2)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6808kB
                                       ->  Parallel Hash Join  (cost=420497.60..454235.74 rows=1 width=34) (actual time=5169.646..5597.456 rows=35884 loops=2)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..236.219 rows=1304564 loops=2)
                                             ->  Parallel Hash  (cost=420497.58..420497.58 rows=1 width=42) (actual time=5169.455..5169.455 rows=2566 loops=2)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                   ->  Parallel Hash Join  (cost=369733.01..420497.58 rows=1 width=42) (actual time=4684.266..5151.117 rows=2566 loops=2)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.016..396.062 rows=506460 loops=2)
                                                               Filter: (production_year > 2005)
                                                               Rows Removed by Filter: 757696
                                                         ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=4683.334..4683.334 rows=10484 loops=2)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                               ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=4297.092..4661.227 rows=10484 loops=2)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.197..331.588 rows=227115 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.080..236.087 rows=671443 loops=2)
                                                                                 Filter: ((info)::text < '8.5'::text)
                                                                                 Rows Removed by Filter: 18574
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=4295.884..4295.884 rows=11958 loops=2)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=3503.506..4265.770 rows=11958 loops=2)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=2717.168..3436.882 rows=307126 loops=2)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.495..3358.537 rows=358105 loops=2)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                                                             Rows Removed by Filter: 7059755
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.044 rows=1 loops=2)
                                                                                                   Filter: ((info)::text = 'countries'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=786.133..786.133 rows=18546 loops=2)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.444..691.384 rows=18546 loops=2)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.040..375.303 rows=2261965 loops=2)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.283..32.283 rows=3 loops=2)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.591..32.259 rows=3 loops=2)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.048..0.048 rows=4 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.035..0.036 rows=4 loops=2)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.049..0.049 rows=2 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.028..0.031 rows=2 loops=2)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 82.178 ms
 Execution Time: 5706.894 ms
(74 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23a.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=418779.45..418779.46 rows=1 width=64) (actual time=2520.674..2520.674 rows=1 loops=1)
   ->  Gather  (cost=418779.23..418779.44 rows=2 width=64) (actual time=2520.104..2528.852 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=417779.23..417779.24 rows=1 width=64) (actual time=2512.289..2512.289 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=413873.01..417779.22 rows=1 width=65) (actual time=2458.030..2512.160 rows=206 loops=3)
                     Hash Cond: (k.id = mk.keyword_id)
                     ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.107..49.168 rows=44723 loops=3)
                           Heap Fetches: 134170
                     ->  Parallel Hash  (cost=413872.58..413872.58 rows=1 width=69) (actual time=2457.102..2457.102 rows=206 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Hash Join  (cost=363500.14..413872.58 rows=1 width=69) (actual time=2402.529..2456.924 rows=206 loops=3)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Hash Join  (cost=363499.05..413871.49 rows=1 width=73) (actual time=2402.408..2456.756 rows=206 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Hash Join  (cost=363496.62..413868.99 rows=26 width=77) (actual time=2402.294..2456.594 rows=206 loops=3)
                                             Hash Cond: (mk.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.029..256.117 rows=1507977 loops=3)
                                             ->  Parallel Hash  (cost=363496.59..363496.59 rows=3 width=89) (actual time=2019.963..2019.963 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Parallel Hash Join  (cost=358585.30..363496.59 rows=3 width=89) (actual time=2013.559..2019.898 rows=2 loops=3)
                                                         Hash Cond: (cn.id = mc.company_id)
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.014..17.237 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                                                         ->  Parallel Hash  (cost=358585.24..358585.24 rows=5 width=93) (actual time=1999.894..1999.894 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=324847.09..358585.24 rows=5 width=93) (actual time=1939.078..1999.804 rows=2 loops=3)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.008..161.444 rows=869710 loops=3)
                                                                     ->  Parallel Hash  (cost=324847.07..324847.07 rows=2 width=81) (actual time=1731.679..1731.679 rows=2 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=54685.18..324847.07 rows=2 width=81) (actual time=1211.506..1731.599 rows=2 loops=3)
                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=8) (actual time=322.833..1329.969 rows=594 loops=3)
                                                                                       Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                       Rows Removed by Filter: 4944646
                                                                                 ->  Parallel Hash  (cost=54671.45..54671.45 rows=1099 width=73) (actual time=401.114..401.114 rows=344 loops=3)
                                                                                       Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                                                                       ->  Hash Join  (cost=3236.49..54671.45 rows=1099 width=73) (actual time=279.236..400.597 rows=344 loops=3)
                                                                                             Hash Cond: (t.kind_id = kt.id)
                                                                                             ->  Hash Join  (cost=3235.39..54637.93 rows=7692 width=29) (actual time=53.326..400.230 rows=694 loops=3)
                                                                                                   Hash Cond: (t.id = cc.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.041..291.002 rows=460484 loops=3)
                                                                                                         Filter: (production_year > 2000)
                                                                                                         Rows Removed by Filter: 382286
                                                                                                   ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=51.857..51.857 rows=24592 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.161..44.431 rows=24592 loops=3)
                                                                                                               Hash Cond: (cc.status_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.050..23.583 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.027..0.028 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'complete+verified'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                             ->  Hash  (cost=1.09..1.09 rows=1 width=52) (actual time=0.052..0.052 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=52) (actual time=0.037..0.039 rows=1 loops=3)
                                                                                                         Filter: ((kind)::text = 'movie'::text)
                                                                                                         Rows Removed by Filter: 6
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.044 rows=1 loops=3)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.062..0.062 rows=4 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.037..0.038 rows=4 loops=3)
 Planning Time: 82.568 ms
 Execution Time: 2530.018 ms
(71 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23b.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=400136.80..400136.81 rows=1 width=64) (actual time=4263.335..4263.335 rows=1 loops=1)
   ->  Gather  (cost=400136.69..400136.80 rows=1 width=64) (actual time=4263.030..4268.911 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=399136.69..399136.70 rows=1 width=64) (actual time=4257.352..4257.352 rows=1 loops=2)
               ->  Hash Join  (cost=394225.39..399136.68 rows=1 width=65) (actual time=4253.799..4257.331 rows=8 loops=2)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=394224.29..399135.58 rows=1 width=21) (actual time=4253.548..4257.077 rows=8 loops=2)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=394223.20..399134.49 rows=1 width=25) (actual time=4253.435..4256.963 rows=8 loops=2)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.008..23.798 rows=42422 loops=2)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 75077
                                 ->  Parallel Hash  (cost=394223.19..394223.19 rows=1 width=29) (actual time=4228.587..4228.587 rows=8 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Hash Join  (cost=360485.03..394223.19 rows=1 width=29) (actual time=4217.021..4228.513 rows=8 loops=2)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Parallel Hash Join  (cost=357249.64..390987.79 rows=1 width=45) (actual time=3891.144..4181.471 rows=6 loops=2)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..232.700 rows=1304564 loops=2)
                                                   ->  Parallel Hash  (cost=357249.63..357249.63 rows=1 width=33) (actual time=3789.173..3789.173 rows=5 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                         ->  Parallel Hash Join  (cost=305924.00..357249.63 rows=1 width=33) (actual time=3508.597..3789.137 rows=5 loops=2)
                                                               Hash Cond: (t.id = mi.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.015..410.375 rows=690726 loops=2)
                                                                     Filter: (production_year > 2000)
                                                                     Rows Removed by Filter: 573430
                                                               ->  Parallel Hash  (cost=305923.99..305923.99 rows=1 width=8) (actual time=3308.954..3308.954 rows=5 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Hash Join  (cost=257671.78..305923.99 rows=1 width=8) (actual time=2812.515..3308.882 rows=5 loops=2)
                                                                           Hash Cond: (mk.movie_id = mi.movie_id)
                                                                           ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=30.735..679.548 rows=566 loops=2)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..375.589 rows=2261965 loops=2)
                                                                                 ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=28.876..28.877 rows=4 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.830..28.849 rows=4 loops=2)
                                                                                             Filter: ((keyword)::text = ANY ('{nerd,loner,alienation,dignity}'::text[]))
                                                                                             Rows Removed by Filter: 134166
                                                                           ->  Parallel Hash  (cost=254710.16..254710.16 rows=2 width=4) (actual time=2628.961..2628.961 rows=886 loops=2)
                                                                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                                                 ->  Hash Join  (cost=2.43..254710.16 rows=2 width=4) (actual time=429.859..1694.032 rows=886 loops=2)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=8) (actual time=429.738..1693.114 rows=886 loops=2)
                                                                                             Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                                                                             Rows Removed by Filter: 7416974
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.043 rows=1 loops=2)
                                                                                                   Filter: ((info)::text = 'release dates'::text)
                                                                                                   Rows Removed by Filter: 112
                                             ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=45.839..45.839 rows=24592 loops=2)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                   ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.139..38.390 rows=24592 loops=2)
                                                         Hash Cond: (cc.status_id = cct1.id)
                                                         ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.038..17.692 rows=135086 loops=2)
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.022..0.023 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'complete+verified'::text)
                                                                     Rows Removed by Filter: 3
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.050..0.050 rows=4 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.033..0.034 rows=4 loops=2)
                     ->  Hash  (cost=1.09..1.09 rows=1 width=52) (actual time=0.056..0.056 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=52) (actual time=0.034..0.036 rows=1 loops=2)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 81.989 ms
 Execution Time: 4269.926 ms
(72 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=419448.86..419448.87 rows=1 width=64) (actual time=2409.135..2409.135 rows=1 loops=1)
   ->  Gather  (cost=419448.64..419448.85 rows=2 width=64) (actual time=2408.753..2415.813 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=418448.64..418448.65 rows=1 width=64) (actual time=2401.171..2401.172 rows=1 loops=3)
               ->  Hash Join  (cost=414542.42..418448.63 rows=2 width=65) (actual time=2356.902..2401.056 rows=209 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=414541.33..418447.54 rows=2 width=69) (actual time=2356.624..2400.716 rows=209 loops=3)
                           Hash Cond: (k.id = mk.keyword_id)
                           ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.096..39.156 rows=44723 loops=3)
                                 Heap Fetches: 134170
                           ->  Parallel Hash  (cost=414540.87..414540.87 rows=3 width=73) (actual time=2356.011..2356.011 rows=209 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=409629.58..414540.87 rows=3 width=73) (actual time=2349.490..2355.855 rows=209 loops=3)
                                       Hash Cond: (cn.id = mc.company_id)
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.033..18.812 rows=28281 loops=3)
                                             Filter: ((country_code)::text = '[us]'::text)
                                             Rows Removed by Filter: 50051
                                       ->  Parallel Hash  (cost=409629.53..409629.53 rows=4 width=77) (actual time=2334.045..2334.045 rows=209 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=359255.99..409629.53 rows=4 width=77) (actual time=2187.965..2333.879 rows=209 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=359253.57..409626.13 rows=360 width=81) (actual time=2187.855..2333.721 rows=209 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..252.915 rows=1507977 loops=3)
                                                         ->  Parallel Hash  (cost=359253.22..359253.22 rows=28 width=93) (actual time=1900.986..1900.987 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=325515.05..359253.22 rows=28 width=93) (actual time=1781.389..1900.906 rows=2 loops=3)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.010..154.345 rows=869710 loops=3)
                                                                     ->  Parallel Hash  (cost=325514.95..325514.95 rows=8 width=81) (actual time=1640.150..1640.151 rows=2 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=55353.07..325514.95 rows=8 width=81) (actual time=1138.056..1640.070 rows=2 loops=3)
                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=8) (actual time=304.031..1234.612 rows=594 loops=3)
                                                                                       Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                       Rows Removed by Filter: 4944646
                                                                                 ->  Parallel Hash  (cost=55283.32..55283.32 rows=5580 width=73) (actual time=404.830..404.830 rows=1684 loops=3)
                                                                                       Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                                                       ->  Hash Join  (cost=3236.54..55283.32 rows=5580 width=73) (actual time=269.834..402.990 rows=1684 loops=3)
                                                                                             Hash Cond: (t.kind_id = kt.id)
                                                                                             ->  Hash Join  (cost=3235.39..55241.01 rows=9766 width=29) (actual time=46.827..402.019 rows=2141 loops=3)
                                                                                                   Hash Cond: (t.id = cc.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=25) (actual time=0.034..288.097 rows=583011 loops=3)
                                                                                                         Filter: (production_year > 1990)
                                                                                                         Rows Removed by Filter: 259760
                                                                                                   ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=45.463..45.463 rows=24592 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.140..38.255 rows=24592 loops=3)
                                                                                                               Hash Cond: (cc.status_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.040..17.540 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.019..0.020 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'complete+verified'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                             ->  Hash  (cost=1.10..1.10 rows=4 width=52) (actual time=0.047..0.047 rows=4 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.10 rows=4 width=52) (actual time=0.032..0.035 rows=4 loops=3)
                                                                                                         Filter: ((kind)::text = ANY ('{movie,"tv movie","video movie","video game"}'::text[]))
                                                                                                         Rows Removed by Filter: 3
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.043 rows=1 loops=3)
                                                               Filter: ((info)::text = 'release dates'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.072..0.072 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.043..0.045 rows=4 loops=3)
 Planning Time: 81.266 ms
 Execution Time: 2416.829 ms
(71 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/24a.sql_explained.sql
SET
SET
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1028775.06..1028775.07 rows=1 width=96) (actual time=7081.541..7081.541 rows=1 loops=1)
   ->  Hash Join  (cost=773581.49..1028775.05 rows=1 width=48) (actual time=6035.973..7081.406 rows=275 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Gather  (cost=773579.07..1028772.62 rows=1 width=52) (actual time=6035.859..7087.474 rows=275 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=772579.07..1027772.52 rows=1 width=52) (actual time=6010.145..7073.092 rows=92 loops=3)
                     Hash Cond: (mi.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=129652 width=8) (actual time=272.404..1718.784 rows=100416 loops=3)
                           Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))
                           Rows Removed by Filter: 4844824
                     ->  Parallel Hash  (cost=772579.06..772579.06 rows=1 width=64) (actual time=5341.521..5341.521 rows=42 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=767667.77..772579.06 rows=1 width=64) (actual time=5326.063..5341.429 rows=42 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.018..19.636 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=767667.75..767667.75 rows=1 width=68) (actual time=5318.813..5318.813 rows=115 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=733929.61..767667.75 rows=1 width=68) (actual time=5126.747..5318.696 rows=115 loops=3)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.016..159.289 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=733929.60..733929.60 rows=1 width=60) (actual time=5052.410..5052.410 rows=13 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Hash Join  (cost=679490.06..733929.60 rows=1 width=60) (actual time=4878.715..5052.317 rows=13 loops=3)
                                                         Hash Cond: (ci.role_id = rt.id)
                                                         ->  Parallel Hash Join  (cost=679488.90..733928.43 rows=1 width=64) (actual time=4878.597..5052.195 rows=13 loops=3)
                                                               Hash Cond: (chn.id = ci.person_role_id)
                                                               ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.036..248.310 rows=1046780 loops=3)
                                                               ->  Parallel Hash  (cost=679488.88..679488.88 rows=1 width=52) (actual time=4678.091..4678.091 rows=13 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=663335.18..679488.88 rows=1 width=52) (actual time=4574.355..4677.964 rows=13 loops=3)
                                                                           Hash Cond: (n.id = ci.person_id)
                                                                           ->  Parallel Hash Join  (cost=81910.23..98047.67 rows=4333 width=23) (actual time=542.123..669.944 rows=3508 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.034..76.184 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=541.142..541.142 rows=16670 loops=3)
                                                                                       Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=221.172..527.690 rows=16670 loops=3)
                                                                                             Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1372493
                                                                           ->  Parallel Hash  (cost=581424.93..581424.93 rows=2 width=41) (actual time=4007.234..4007.235 rows=875 loops=3)
                                                                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                                                 ->  Parallel Hash Join  (cost=100834.61..581424.93 rows=2 width=41) (actual time=893.692..3751.426 rows=875 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.786..2818.373 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Parallel Hash  (cost=100834.53..100834.53 rows=7 width=25) (actual time=890.717..890.717 rows=165 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=51046.31..100834.53 rows=7 width=25) (actual time=621.611..890.496 rows=165 loops=3)
                                                                                                   Hash Cond: (t.id = mk.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.041..250.707 rows=130555 loops=3)
                                                                                                         Filter: (production_year > 2010)
                                                                                                         Rows Removed by Filter: 712215
                                                                                                   ->  Parallel Hash  (cost=51045.79..51045.79 rows=42 width=4) (actual time=618.281..618.281 rows=3232 loops=3)
                                                                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                                                                         ->  Hash Join  (cost=2793.88..51045.79 rows=42 width=4) (actual time=29.989..465.945 rows=3232 loops=3)
                                                                                                               Hash Cond: (mk.keyword_id = k.id)
                                                                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.043..252.538 rows=1507977 loops=3)
                                                                                                               ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=29.217..29.217 rows=3 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=0.066..29.203 rows=3 loops=3)
                                                                                                                           Filter: ((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat}'::text[]))
                                                                                                                           Rows Removed by Filter: 134167
                                                         ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.062..0.063 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=3)
                                                                     Filter: ((role)::text = 'actress'::text)
                                                                     Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.028 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 99.264 ms
 Execution Time: 7088.734 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/24b.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1031111.24..1031111.25 rows=1 width=96) (actual time=6614.615..6614.615 rows=1 loops=1)
   ->  Hash Join  (cost=775917.68..1031111.23 rows=1 width=48) (actual time=6613.939..6614.566 rows=45 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Gather  (cost=775915.25..1031108.81 rows=1 width=52) (actual time=6613.827..6621.082 rows=45 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=774915.25..1030108.71 rows=1 width=52) (actual time=5926.146..6606.369 rows=15 loops=3)
                     Hash Cond: (mi.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=129652 width=8) (actual time=208.395..1684.621 rows=100416 loops=3)
                           Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))
                           Rows Removed by Filter: 4844824
                     ->  Parallel Hash  (cost=774915.24..774915.24 rows=1 width=64) (actual time=4909.109..4909.109 rows=8 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Hash Join  (cost=720475.70..774915.24 rows=1 width=64) (actual time=4869.039..4909.019 rows=8 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Hash Join  (cost=720474.54..774914.07 rows=1 width=68) (actual time=4868.935..4908.912 rows=8 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.039..243.953 rows=1046780 loops=3)
                                       ->  Parallel Hash  (cost=720474.52..720474.52 rows=1 width=56) (actual time=4539.584..4539.584 rows=8 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=704320.82..720474.52 rows=1 width=56) (actual time=4506.937..4539.469 rows=8 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Hash Join  (cost=81910.23..98047.67 rows=4333 width=23) (actual time=539.770..667.444 rows=3508 loops=3)
                                                         Hash Cond: (an.person_id = n.id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.023..74.450 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=538.977..538.977 rows=16670 loops=3)
                                                               Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=219.444..525.508 rows=16670 loops=3)
                                                                     Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                     Rows Removed by Filter: 1372493
                                                   ->  Parallel Hash  (cost=622410.58..622410.58 rows=1 width=45) (actual time=3871.482..3871.482 rows=36 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=141820.27..622410.58 rows=1 width=45) (actual time=1160.023..3871.367 rows=36 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.065..2836.217 rows=289159 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                     Rows Removed by Filter: 11792289
                                                               ->  Parallel Hash  (cost=141820.25..141820.25 rows=1 width=29) (actual time=997.125..997.125 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                     ->  Parallel Hash Join  (cost=108082.11..141820.25 rows=1 width=29) (actual time=961.676..997.049 rows=2 loops=3)
                                                                           Hash Cond: (mc.company_id = cn.id)
                                                                           ->  Parallel Hash Join  (cost=103013.59..136751.74 rows=1 width=33) (actual time=774.159..974.671 rows=21 loops=3)
                                                                                 Hash Cond: (mc.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.015..154.471 rows=869710 loops=3)
                                                                                 ->  Parallel Hash  (cost=103013.58..103013.58 rows=1 width=25) (actual time=712.064..712.064 rows=2 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Hash Join  (cost=54761.74..103013.58 rows=1 width=25) (actual time=511.431..711.966 rows=2 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Hash Join  (cost=51800.14..100051.91 rows=28 width=29) (actual time=478.655..679.190 rows=29 loops=3)
                                                                                                   Hash Cond: (mk.movie_id = t.id)
                                                                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.035..252.532 rows=1507977 loops=3)
                                                                                                   ->  Parallel Hash  (cost=51799.95..51799.95 rows=15 width=21) (actual time=246.212..246.212 rows=3 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=15 width=21) (actual time=130.497..246.121 rows=3 loops=3)
                                                                                                               Filter: ((production_year > 2010) AND ((title)::text ~~ 'Kung Fu Panda%'::text))
                                                                                                               Rows Removed by Filter: 842768
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.714..32.714 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.075..32.696 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat,computer-animated-movie}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                                                           ->  Parallel Hash  (cost=5068.50..5068.50 rows=1 width=4) (actual time=22.312..22.312 rows=0 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..5068.50 rows=1 width=4) (actual time=16.690..22.279 rows=0 loops=3)
                                                                                       Filter: (((country_code)::text = '[us]'::text) AND ((name)::text = 'DreamWorks Animation'::text))
                                                                                       Rows Removed by Filter: 78332
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=3)
                                             Filter: ((role)::text = 'actress'::text)
                                             Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.026 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 99.278 ms
 Execution Time: 6622.195 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=937486.93..937486.94 rows=1 width=128) (actual time=5991.700..5991.700 rows=1 loops=1)
   ->  Gather  (cost=937486.70..937486.91 rows=2 width=128) (actual time=5990.838..5998.023 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=936486.70..936486.71 rows=1 width=128) (actual time=5983.732..5983.732 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=886003.56..936486.69 rows=1 width=80) (actual time=5755.539..5982.390 rows=1469 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.027..225.524 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=886003.55..886003.55 rows=1 width=79) (actual time=5631.381..5631.381 rows=1469 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 440kB
                           ->  Parallel Hash Join  (cost=805976.20..886003.55 rows=1 width=79) (actual time=5072.967..5591.628 rows=1469 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.053..449.213 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=805976.19..805976.19 rows=1 width=68) (actual time=5071.533..5071.533 rows=2371 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 664kB
                                       ->  Parallel Hash Join  (cost=305955.51..805976.19 rows=1 width=68) (actual time=3848.346..4974.469 rows=2371 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=175.516..2903.212 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=305955.50..305955.50 rows=1 width=60) (actual time=2017.565..2017.565 rows=3796 loops=3)
                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 984kB
                                                   ->  Parallel Hash Join  (cost=290685.23..305955.50 rows=1 width=60) (actual time=1802.928..1983.918 rows=3796 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.139..161.098 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.036..77.657 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=290682.79..290682.79 rows=1 width=51) (actual time=1802.064..1802.064 rows=4146 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 920kB
                                                               ->  Parallel Hash Join  (cost=51384.54..290682.79 rows=1 width=51) (actual time=1640.421..1766.498 rows=4146 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..239300.13 rows=144 width=47) (actual time=1105.540..1226.518 rows=10138 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=16278 width=51) (actual time=771.055..1221.984 rows=10267 loops=3)
                                                                                 Filter: ((info)::text = 'Horror'::text)
                                                                                 Rows Removed by Filter: 4934973
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.084..0.084 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.048..0.061 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'genres'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=51381.24..51381.24 rows=70 width=4) (actual time=534.769..534.769 rows=20699 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3480kB
                                                                           ->  Hash Join  (cost=3129.33..51381.24 rows=70 width=4) (actual time=34.893..476.221 rows=20699 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.043..251.822 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=3129.26..3129.26 rows=5 width=4) (actual time=34.746..34.746 rows=5 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..3129.26 rows=5 width=4) (actual time=0.993..34.722 rows=5 loops=3)
                                                                                             Filter: ((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))
                                                                                             Rows Removed by Filter: 134165
 Planning Time: 28.773 ms
 Execution Time: 5998.910 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25b.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=938224.64..938224.65 rows=1 width=128) (actual time=5597.071..5597.072 rows=1 loops=1)
   ->  Gather  (cost=938224.41..938224.62 rows=2 width=128) (actual time=5596.814..5603.484 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=937224.41..937224.42 rows=1 width=128) (actual time=5589.569..5589.569 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=857197.05..937224.40 rows=1 width=80) (actual time=5352.466..5589.535 rows=2 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.042..445.701 rows=579860 loops=3)
                           Filter: ((gender)::text = 'm'::text)
                           Rows Removed by Filter: 809304
                     ->  Parallel Hash  (cost=857197.04..857197.04 rows=1 width=69) (actual time=5086.607..5086.607 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=617898.78..857197.04 rows=1 width=69) (actual time=5073.640..5086.495 rows=2 loops=3)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..239300.13 rows=144 width=47) (actual time=1092.737..1212.990 rows=10138 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=16278 width=51) (actual time=762.409..1208.607 rows=10267 loops=3)
                                             Filter: ((info)::text = 'Horror'::text)
                                             Rows Removed by Filter: 4934973
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.044 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.018..0.030 rows=1 loops=3)
                                                   Filter: ((info)::text = 'genres'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=617896.35..617896.35 rows=1 width=42) (actual time=3871.800..3871.800 rows=2 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=602626.08..617896.35 rows=1 width=42) (actual time=3867.492..3871.725 rows=2 loops=3)
                                             Hash Cond: (mi_idx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.168..159.645 rows=153308 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..77.222 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.075..0.075 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.047..0.050 rows=1 loops=3)
                                                               Filter: ((info)::text = 'votes'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=602623.64..602623.64 rows=1 width=33) (actual time=3697.299..3697.300 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                   ->  Parallel Hash Join  (cost=554371.45..602623.64 rows=1 width=33) (actual time=3690.731..3697.239 rows=2 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Hash Join  (cost=3129.33..51381.24 rows=70 width=4) (actual time=34.741..479.314 rows=20699 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.036..255.726 rows=1507977 loops=3)
                                                               ->  Hash  (cost=3129.26..3129.26 rows=5 width=4) (actual time=34.561..34.561 rows=5 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..3129.26 rows=5 width=4) (actual time=0.977..34.539 rows=5 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))
                                                                           Rows Removed by Filter: 134165
                                                         ->  Parallel Hash  (cost=551242.03..551242.03 rows=8 width=29) (actual time=3214.273..3214.273 rows=8 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=51800.14..551242.03 rows=8 width=29) (actual time=2098.867..3214.168 rows=8 loops=3)
                                                                     Hash Cond: (ci.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=257.315..2924.272 rows=414905 loops=3)
                                                                           Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                           Rows Removed by Filter: 11666543
                                                                     ->  Parallel Hash  (cost=51799.95..51799.95 rows=15 width=21) (actual time=247.024..247.024 rows=24 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=15 width=21) (actual time=8.161..246.931 rows=24 loops=3)
                                                                                 Filter: ((production_year > 2010) AND ((title)::text ~~ 'Vampire%'::text))
                                                                                 Rows Removed by Filter: 842746
 Planning Time: 29.499 ms
 Execution Time: 5604.297 ms
(62 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25c.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=968932.69..968932.70 rows=1 width=128) (actual time=6646.844..6646.844 rows=1 loops=1)
   ->  Gather  (cost=968932.46..968932.67 rows=2 width=128) (actual time=6644.468..6652.081 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=967932.46..967932.47 rows=1 width=128) (actual time=6637.402..6637.402 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=917449.32..967932.45 rows=1 width=80) (actual time=6281.200..6631.714 rows=8718 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.028..229.393 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=917449.31..917449.31 rows=1 width=79) (actual time=6275.746..6275.746 rows=8718 loops=3)
                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                           ->  Parallel Hash Join  (cost=837421.96..917449.31 rows=1 width=79) (actual time=5719.656..6243.242 rows=8718 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.051..450.635 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=837421.95..837421.95 rows=1 width=68) (actual time=5718.754..5718.755 rows=14300 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3992kB
                                       ->  Parallel Hash Join  (cost=337401.27..837421.95 rows=1 width=68) (actual time=4539.711..5672.042 rows=14300 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=194.212..2878.673 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=337401.26..337401.26 rows=1 width=60) (actual time=2726.903..2726.903 rows=21129 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4792kB
                                                   ->  Parallel Hash Join  (cost=322130.99..337401.26 rows=1 width=60) (actual time=2480.327..2669.465 rows=21129 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.138..160.765 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.033..76.947 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=322128.55..322128.55 rows=1 width=51) (actual time=2479.918..2479.918 rows=22680 loops=3)
                                                               Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                               ->  Parallel Hash Join  (cost=51720.34..322128.55 rows=1 width=51) (actual time=2209.619..2441.642 rows=22680 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1643.094..1857.392 rows=62198 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1037.615..1839.949 rows=62990 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                 Rows Removed by Filter: 4882250
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.086..0.086 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.050..0.063 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'genres'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=566.435..566.436 rows=25571 loops=3)
                                                                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                           ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=39.904..483.194 rows=25571 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.049..252.521 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=39.739..39.739 rows=7 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.167..39.714 rows=7 loops=3)
                                                                                             Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                             Rows Removed by Filter: 134163
 Planning Time: 28.140 ms
 Execution Time: 6653.563 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26a.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=722071.79..722071.80 rows=1 width=128) (actual time=7244.638..7244.638 rows=1 loops=1)
   ->  Hash Join  (cost=706649.20..722071.78 rows=1 width=53) (actual time=7155.393..7243.635 rows=1728 loops=1)
         Hash Cond: (t.kind_id = kt.id)
         ->  Hash Join  (cost=706648.10..722070.67 rows=1 width=57) (actual time=7114.163..7243.092 rows=1844 loops=1)
               Hash Cond: (mi_idx.info_type_id = it2.id)
               ->  Gather  (cost=706645.67..722068.24 rows=1 width=61) (actual time=7114.076..7348.043 rows=2580 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Parallel Hash Join  (cost=705645.67..721068.14 rows=1 width=61) (actual time=7097.301..7230.108 rows=860 loops=3)
                           Hash Cond: (mi_idx.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=79942 width=13) (actual time=0.050..133.556 rows=64632 loops=3)
                                 Filter: ((info)::text > '7.0'::text)
                                 Rows Removed by Filter: 395380
                           ->  Parallel Hash  (cost=705645.66..705645.66 rows=1 width=68) (actual time=7086.252..7086.252 rows=1906 loops=3)
                                 Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 728kB
                                 ->  Parallel Hash Join  (cost=648661.37..705645.66 rows=1 width=68) (actual time=6553.470..7032.551 rows=1906 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.048..458.671 rows=60051 loops=3)
                                             Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                             Rows Removed by Filter: 986729
                                       ->  Parallel Hash  (cost=648661.29..648661.29 rows=6 width=56) (actual time=6553.212..6553.212 rows=69092 loops=3)
                                             Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 9560kB
                                             ->  Parallel Hash Join  (cost=569172.01..648661.29 rows=6 width=56) (actual time=6085.799..6481.799 rows=69092 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.039..383.494 rows=1389164 loops=3)
                                                   ->  Parallel Hash  (cost=569171.94..569171.94 rows=6 width=45) (actual time=5183.885..5183.885 rows=69092 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2528kB
                                                         ->  Parallel Hash Join  (cost=108834.99..569171.94 rows=6 width=45) (actual time=1019.497..4989.370 rows=69092 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.031..2190.490 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=108834.98..108834.98 rows=1 width=33) (actual time=1018.896..1018.896 rows=532 loops=3)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                     ->  Hash Join  (cost=58439.25..108834.98 rows=1 width=33) (actual time=521.350..999.688 rows=532 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Hash Join  (cost=54471.30..104857.99 rows=3441 width=37) (actual time=466.190..939.972 rows=121797 loops=3)
                                                                                 Hash Cond: (mk.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.029..253.505 rows=1507977 loops=3)
                                                                                 ->  Parallel Hash  (cost=54447.27..54447.27 rows=1923 width=29) (actual time=465.650..465.650 rows=7852 loops=3)
                                                                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2016kB
                                                                                       ->  Hash Join  (cost=3102.42..54447.27 rows=1923 width=29) (actual time=94.842..439.181 rows=7852 loops=3)
                                                                                             Hash Cond: (t.id = cc.movie_id)
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.064..275.494 rows=460484 loops=3)
                                                                                                   Filter: (production_year > 2000)
                                                                                                   Rows Removed by Filter: 382286
                                                                                             ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=94.368..94.368 rows=85941 loops=3)
                                                                                                   Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                                                                                   ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.241..67.215 rows=85941 loops=3)
                                                                                                         Hash Cond: (cc.status_id = cct2.id)
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.126..49.083 rows=85941 loops=3)
                                                                                                               Hash Cond: (cc.subject_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.021..18.499 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.021..0.023 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'cast'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.057..0.057 rows=2 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.043..0.045 rows=2 loops=3)
                                                                                                                     Filter: ((kind)::text ~~ '%complete%'::text)
                                                                                                                     Rows Removed by Filter: 2
                                                                           ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=48.144..48.144 rows=10 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.240..48.106 rows=10 loops=3)
                                                                                       Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                                       Rows Removed by Filter: 134160
               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.033..0.033 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.020..0.023 rows=1 loops=1)
                           Filter: ((info)::text = 'rating'::text)
                           Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.022..0.022 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.010..0.012 rows=1 loops=1)
                     Filter: ((kind)::text = 'movie'::text)
                     Rows Removed by Filter: 6
 Planning Time: 85.746 ms
 Execution Time: 7351.449 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26b.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=719517.69..719517.70 rows=1 width=96) (actual time=6638.739..6638.740 rows=1 loops=1)
   ->  Hash Join  (cost=662439.50..719517.69 rows=1 width=38) (actual time=6140.291..6638.664 rows=93 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=662438.44..719516.62 rows=1 width=42) (actual time=6140.172..6638.521 rows=93 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=662437.38..719515.56 rows=1 width=46) (actual time=6140.087..6638.399 rows=180 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=658006.94..714423.11 rows=1 width=54) (actual time=6064.916..6553.461 rows=191 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=657006.94..713423.01 rows=1 width=54) (actual time=6056.298..6544.330 rows=64 loops=3)
                                 Hash Cond: (chn.id = ci.person_role_id)
                                 ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.058..477.550 rows=60051 loops=3)
                                       Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                       Rows Removed by Filter: 986729
                                 ->  Parallel Hash  (cost=657006.93..657006.93 rows=1 width=42) (actual time=6052.973..6052.973 rows=2660 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 344kB
                                       ->  Hash Join  (cost=577517.63..657006.93 rows=1 width=42) (actual time=5206.376..5789.123 rows=2660 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Hash Join  (cost=577515.21..657004.49 rows=6 width=46) (actual time=5206.254..5787.009 rows=5809 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.047..375.781 rows=1389164 loops=3)
                                                   ->  Parallel Hash  (cost=577515.13..577515.13 rows=6 width=50) (actual time=5205.630..5205.630 rows=5809 loops=3)
                                                         Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2136kB
                                                         ->  Parallel Hash Join  (cost=117178.19..577515.13 rows=6 width=50) (actual time=1098.065..4916.336 rows=5809 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.030..2287.998 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=117178.17..117178.17 rows=1 width=38) (actual time=1096.572..1096.572 rows=39 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=101980.10..117178.17 rows=1 width=38) (actual time=1014.342..1096.442 rows=39 loops=3)
                                                                           Hash Cond: (mi_idx.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.060..133.435 rows=17883 loops=3)
                                                                                 Filter: ((info)::text > '8.0'::text)
                                                                                 Rows Removed by Filter: 442129
                                                                           ->  Parallel Hash  (cost=101980.06..101980.06 rows=3 width=25) (actual time=959.067..959.067 rows=480 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Hash Join  (cost=51215.31..101980.06 rows=3 width=25) (actual time=846.534..958.425 rows=480 loops=3)
                                                                                       Hash Cond: (t.kind_id = kt.id)
                                                                                       ->  Parallel Hash Join  (cost=51214.21..101978.87 rows=23 width=29) (actual time=639.808..957.917 rows=1008 loops=3)
                                                                                             Hash Cond: (t.id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.042..275.824 rows=337640 loops=3)
                                                                                                   Filter: (production_year > 2005)
                                                                                                   Rows Removed by Filter: 505131
                                                                                             ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=635.713..635.713 rows=3328 loops=3)
                                                                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                                                                   ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.979..470.274 rows=3328 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.052..252.275 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.658..32.659 rows=4 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.148..32.638 rows=4 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,fight}'::text[]))
                                                                                                                     Rows Removed by Filter: 134166
                                                                                       ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.027..0.029 rows=1 loops=3)
                                                                                                   Filter: ((kind)::text = 'movie'::text)
                                                                                                   Rows Removed by Filter: 6
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.073..0.073 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.052..0.054 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=67.968..67.969 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.015..26.246 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.021..0.021 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.040..0.040 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.026..0.028 rows=2 loops=1)
                     Filter: ((kind)::text ~~ '%complete%'::text)
                     Rows Removed by Filter: 2
 Planning Time: 85.899 ms
 Execution Time: 6640.734 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26c.sql_explained.sql
SET
SET
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=722078.21..722078.22 rows=1 width=96) (actual time=8288.223..8288.223 rows=1 loops=1)
   ->  Hash Join  (cost=665321.10..722078.20 rows=1 width=38) (actual time=7804.026..8285.066 rows=5400 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Gather  (cost=665320.04..722077.14 rows=1 width=42) (actual time=7803.922..8437.340 rows=6359 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=664320.04..721077.04 rows=1 width=42) (actual time=7796.577..8272.328 rows=2120 loops=3)
                     Hash Cond: (chn.id = ci.person_role_id)
                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.056..456.659 rows=60051 loops=3)
                           Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                           Rows Removed by Filter: 986729
                     ->  Parallel Hash  (cost=664319.99..664319.99 rows=4 width=30) (actual time=7795.680..7795.680 rows=73556 loops=3)
                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 7384kB
                           ->  Parallel Hash Join  (cost=584830.72..664319.99 rows=4 width=30) (actual time=7369.254..7752.240 rows=73556 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.045..381.547 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=584830.67..584830.67 rows=4 width=34) (actual time=6473.769..6473.769 rows=73556 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2336kB
                                       ->  Hash Join  (cost=533504.83..584830.67 rows=4 width=34) (actual time=6162.970..6380.011 rows=73556 loops=3)
                                             Hash Cond: (t.kind_id = kt.id)
                                             ->  Parallel Hash Join  (cost=533503.73..584829.46 rows=26 width=38) (actual time=6157.762..6362.107 rows=81357 loops=3)
                                                   Hash Cond: (t.id = mk.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.054..284.273 rows=460484 loops=3)
                                                         Filter: (production_year > 2000)
                                                         Rows Removed by Filter: 382286
                                                   ->  Parallel Hash  (cost=533503.13..533503.13 rows=48 width=33) (actual time=5684.862..5684.862 rows=232511 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 3616kB
                                                         ->  Hash Join  (cost=72499.97..533503.13 rows=48 width=33) (actual time=855.499..5395.692 rows=232511 loops=3)
                                                               Hash Cond: (cc.status_id = cct2.id)
                                                               ->  Hash Join  (cost=72498.91..533501.03 rows=192 width=37) (actual time=855.394..5327.772 rows=232511 loops=3)
                                                                     Hash Cond: (mk.movie_id = cc.movie_id)
                                                                     ->  Parallel Hash Join  (cost=68068.47..528405.98 rows=138 width=25) (actual time=785.963..4918.098 rows=360905 loops=3)
                                                                           Hash Cond: (ci.movie_id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.029..2164.287 rows=12081448 loops=3)
                                                                           ->  Parallel Hash  (cost=68068.42..68068.42 rows=4 width=13) (actual time=785.780..785.780 rows=6392 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                                 ->  Hash Join  (cost=52224.04..68068.42 rows=4 width=13) (actual time=603.711..752.477 rows=6392 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Hash Join  (cost=52221.61..68064.84 rows=426 width=17) (actual time=603.578..749.427 rows=19234 loops=3)
                                                                                             Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..75.825 rows=460012 loops=3)
                                                                                             ->  Parallel Hash  (cost=52219.86..52219.86 rows=140 width=4) (actual time=603.015..603.015 rows=8030 loops=3)
                                                                                                   Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                                                                   ->  Hash Join  (cost=3967.95..52219.86 rows=140 width=4) (actual time=48.057..490.358 rows=8030 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.038..252.440 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=47.834..47.835 rows=10 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.219..47.804 rows=10 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                                                                     Rows Removed by Filter: 134160
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.070..0.070 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.057..0.059 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=66.776..66.776 rows=135086 loops=3)
                                                                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.023..26.030 rows=135086 loops=3)
                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.046..0.046 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.034..0.035 rows=2 loops=3)
                                                                           Filter: ((kind)::text ~~ '%complete%'::text)
                                                                           Rows Removed by Filter: 2
                                             ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.030..0.032 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'movie'::text)
                                                         Rows Removed by Filter: 6
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 85.494 ms
 Execution Time: 8445.209 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27a.sql_explained.sql
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=62724.94..62724.95 rows=1 width=96) (actual time=313.378..313.379 rows=1 loops=1)
   ->  Merge Join  (cost=26778.72..62724.94 rows=1 width=118) (actual time=312.513..313.182 rows=477 loops=1)
         Merge Cond: (mi.movie_id = ml.movie_id)
         ->  Gather Merge  (cost=1000.46..988404.79 rows=132912 width=4) (actual time=9.501..22.850 rows=2822 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..972063.42 rows=55380 width=4) (actual time=1.095..167.439 rows=1126 loops=3)
                     Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                     Rows Removed by Filter: 148910
         ->  Sort  (cost=25778.26..25778.26 rows=1 width=138) (actual time=302.612..302.642 rows=475 loops=1)
               Sort Key: t.id
               Sort Method: quicksort  Memory: 49kB
               ->  Hash Join  (cost=22622.22..25778.25 rows=1 width=138) (actual time=279.711..302.420 rows=172 loops=1)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Merge Join  (cost=19996.08..23150.40 rows=652 width=142) (actual time=255.599..280.930 rows=3278 loops=1)
                           Merge Cond: (mk.movie_id = ml.movie_id)
                           ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.029..19.184 rows=69431 loops=1)
                           ->  Sort  (cost=19995.65..19995.68 rows=14 width=134) (actual time=252.863..253.069 rows=3270 loops=1)
                                 Sort Key: t.id
                                 Sort Method: quicksort  Memory: 62kB
                                 ->  Hash Join  (cost=19698.66..19995.38 rows=14 width=134) (actual time=249.868..252.628 rows=269 loops=1)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Hash Join  (cost=19697.58..19994.16 rows=27 width=138) (actual time=249.772..252.460 rows=269 loops=1)
                                             Hash Cond: (cc.status_id = cct2.id)
                                             ->  Merge Join  (cost=19696.52..19992.51 rows=109 width=142) (actual time=249.689..252.290 rows=333 loops=1)
                                                   Merge Cond: (cc.movie_id = ml.movie_id)
                                                   ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.035..2.184 rows=5140 loops=1)
                                                   ->  Sort  (cost=19696.10..19696.27 rows=69 width=130) (actual time=249.272..249.324 rows=756 loops=1)
                                                         Sort Key: t.id
                                                         Sort Method: quicksort  Memory: 120kB
                                                         ->  Gather  (cost=7378.71..19693.99 rows=69 width=130) (actual time=137.452..250.293 rows=698 loops=1)
                                                               Workers Planned: 2
                                                               Workers Launched: 2
                                                               ->  Parallel Hash Join  (cost=6378.71..18687.09 rows=29 width=130) (actual time=124.031..241.270 rows=233 loops=3)
                                                                     Hash Cond: (mc.company_id = cn.id)
                                                                     ->  Hash Join  (cost=652.57..12960.52 rows=160 width=115) (actual time=23.380..178.292 rows=931 loops=3)
                                                                           Hash Cond: (mc.company_type_id = ct.id)
                                                                           ->  Merge Join  (cost=651.50..12956.00 rows=640 width=119) (actual time=23.227..177.773 rows=1104 loops=3)
                                                                                 Merge Cond: (ml.movie_id = mc.movie_id)
                                                                                 ->  Merge Join  (cost=651.07..7725.24 rows=250 width=107) (actual time=19.397..128.955 rows=444 loops=3)
                                                                                       Merge Cond: (t.id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=379985 width=21) (actual time=0.677..114.105 rows=19945 loops=3)
                                                                                             Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                                                                             Rows Removed by Filter: 42153
                                                                                       ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.337..12.522 rows=2315 loops=3)
                                                                                             Sort Key: ml.movie_id
                                                                                             Sort Method: quicksort  Memory: 205kB
                                                                                             Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                             Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                                                             ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.145..11.040 rows=2315 loops=3)
                                                                                                   Hash Cond: (ml.link_type_id = lt.id)
                                                                                                   ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.029..6.686 rows=29997 loops=3)
                                                                                                   ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.049..0.049 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.033..0.038 rows=2 loops=3)
                                                                                                               Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                               Rows Removed by Filter: 16
                                                                                 ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.078..45.152 rows=42275 loops=3)
                                                                                       Filter: (note IS NULL)
                                                                                       Rows Removed by Filter: 42817
                                                                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.086..0.086 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.073..0.075 rows=1 loops=3)
                                                                                       Filter: ((kind)::text = 'production companies'::text)
                                                                                       Rows Removed by Filter: 3
                                                                     ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=61.521..61.521 rows=16101 loops=3)
                                                                           Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.066..50.004 rows=16101 loops=3)
                                                                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                                 Rows Removed by Filter: 62232
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                                                         Filter: ((kind)::text = 'complete'::text)
                                                         Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.040..0.040 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.027..0.029 rows=2 loops=1)
                                                   Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                                                   Rows Removed by Filter: 2
                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.093..21.093 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.220..21.081 rows=1 loops=1)
                                 Filter: ((keyword)::text = 'sequel'::text)
                                 Rows Removed by Filter: 134169
 Planning Time: 84.159 ms
 Execution Time: 328.416 ms
(87 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27b.sql_explained.sql
SET
SET
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=62047.93..62047.94 rows=1 width=96) (actual time=537.564..537.564 rows=1 loops=1)
   ->  Hash Join  (cost=58902.55..62047.92 rows=1 width=118) (actual time=536.723..537.439 rows=247 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=56276.42..59421.66 rows=47 width=122) (actual time=515.284..515.926 rows=1919 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.031..17.400 rows=69431 loops=1)
               ->  Materialize  (cost=56275.98..56275.99 rows=1 width=138) (actual time=490.117..490.338 rows=1911 loops=1)
                     ->  Sort  (cost=56275.98..56275.99 rows=1 width=138) (actual time=490.107..490.123 rows=247 loops=1)
                           Sort Key: t.id
                           Sort Method: quicksort  Memory: 59kB
                           ->  Hash Join  (cost=55981.58..56275.97 rows=1 width=138) (actual time=489.465..489.849 rows=247 loops=1)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Hash Join  (cost=55980.51..56274.91 rows=1 width=142) (actual time=489.381..489.684 rows=418 loops=1)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Merge Join  (cost=55979.44..56273.83 rows=2 width=146) (actual time=489.302..489.493 rows=418 loops=1)
                                             Merge Cond: (cc.movie_id = ml.movie_id)
                                             ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.042..1.937 rows=4705 loops=1)
                                             ->  Sort  (cost=55979.02..55979.02 rows=1 width=134) (actual time=486.756..486.822 rows=908 loops=1)
                                                   Sort Key: t.id
                                                   Sort Method: quicksort  Memory: 128kB
                                                   ->  Gather  (cost=50471.19..55979.01 rows=1 width=134) (actual time=421.560..486.674 rows=737 loops=1)
                                                         Workers Planned: 1
                                                         Workers Launched: 1
                                                         ->  Parallel Hash Join  (cost=49471.19..54978.91 rows=1 width=134) (actual time=448.796..480.979 rows=368 loops=2)
                                                               Hash Cond: (cn.id = mc.company_id)
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.039..63.509 rows=24151 loops=2)
                                                                     Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                     Rows Removed by Filter: 93348
                                                               ->  Parallel Hash  (cost=49471.16..49471.16 rows=3 width=119) (actual time=413.556..413.556 rows=718 loops=2)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                                                     ->  Hash Join  (cost=653.00..49471.16 rows=3 width=119) (actual time=258.224..379.336 rows=718 loops=2)
                                                                           Hash Cond: (mc.company_type_id = ct.id)
                                                                           ->  Merge Join  (cost=651.94..49470.03 rows=13 width=123) (actual time=258.120..379.007 rows=736 loops=2)
                                                                                 Merge Cond: (ml.movie_id = mc.movie_id)
                                                                                 ->  Merge Join  (cost=651.51..44246.14 rows=5 width=111) (actual time=239.843..353.834 rows=151 loops=2)
                                                                                       Merge Cond: (mi.movie_id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..972063.42 rows=55380 width=4) (actual time=1.407..141.731 rows=1440 loops=2)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                                                                                             Rows Removed by Filter: 187318
                                                                                       ->  Materialize  (cost=651.07..8854.49 rows=33 width=107) (actual time=26.067..211.838 rows=235 loops=2)
                                                                                             ->  Merge Join  (cost=651.07..8854.40 rows=33 width=107) (actual time=26.056..211.722 rows=141 loops=2)
                                                                                                   Merge Cond: (t.id = ml.movie_id)
                                                                                                   ->  Index Scan using title_pkey on title t  (cost=0.43..108402.95 rows=50313 width=21) (actual time=3.149..201.017 rows=4216 loops=2)
                                                                                                         Filter: (production_year = 1998)
                                                                                                         Rows Removed by Filter: 182255
                                                                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=9.793..9.970 rows=2315 loops=2)
                                                                                                         Sort Key: ml.movie_id
                                                                                                         Sort Method: quicksort  Memory: 205kB
                                                                                                         Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.127..8.581 rows=2315 loops=2)
                                                                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.023..4.357 rows=29997 loops=2)
                                                                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.043..0.043 rows=2 loops=2)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.027..0.032 rows=2 loops=2)
                                                                                                                           Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                                           Rows Removed by Filter: 16
                                                                                 ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.025..22.496 rows=34556 loops=2)
                                                                                       Filter: (note IS NULL)
                                                                                       Rows Removed by Filter: 35332
                                                                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.036..0.038 rows=1 loops=2)
                                                                                       Filter: ((kind)::text = 'production companies'::text)
                                                                                       Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.024..0.025 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.010..0.012 rows=2 loops=1)
                                                   Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                                                   Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.026..0.027 rows=1 loops=1)
                                             Filter: ((kind)::text = 'complete'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.242..21.242 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.190..21.231 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 85.129 ms
 Execution Time: 538.874 ms
(82 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=64696.47..64696.48 rows=1 width=96) (actual time=560.060..560.060 rows=1 loops=1)
   ->  Hash Join  (cost=61522.37..64696.47 rows=1 width=118) (actual time=535.100..559.755 rows=743 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=58896.24..62065.93 rows=1677 width=122) (actual time=511.030..537.320 rows=11620 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.029..17.863 rows=69431 loops=1)
               ->  Sort  (cost=58895.80..58895.89 rows=36 width=138) (actual time=508.492..509.210 rows=11612 loops=1)
                     Sort Key: ml.movie_id
                     Sort Method: quicksort  Memory: 210kB
                     ->  Hash Join  (cost=58588.08..58894.87 rows=36 width=138) (actual time=503.434..507.576 rows=1150 loops=1)
                           Hash Cond: (cc.subject_id = cct1.id)
                           ->  Hash Join  (cost=58587.01..58893.03 rows=143 width=142) (actual time=503.347..507.165 rows=1436 loops=1)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Merge Join  (cost=58585.95..58888.88 rows=572 width=146) (actual time=503.271..506.694 rows=1436 loops=1)
                                       Merge Cond: (cc.movie_id = ml.movie_id)
                                       ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.036..2.090 rows=5142 loops=1)
                                       ->  Sort  (cost=58585.52..58586.43 rows=363 width=134) (actual time=502.893..503.231 rows=4252 loops=1)
                                             Sort Key: ml.movie_id
                                             Sort Method: quicksort  Memory: 654kB
                                             ->  Gather  (cost=7421.33..58570.09 rows=363 width=134) (actual time=72.775..501.426 rows=3966 loops=1)
                                                   Workers Planned: 2
                                                   Workers Launched: 2
                                                   ->  Hash Join  (cost=6421.33..57533.79 rows=151 width=134) (actual time=80.508..473.956 rows=1322 loops=3)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Parallel Hash Join  (cost=6420.26..57529.46 rows=605 width=138) (actual time=80.305..473.315 rows=1361 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Merge Join  (cost=694.11..51794.52 rows=3349 width=123) (actual time=13.499..423.864 rows=3944 loops=3)
                                                                     Merge Cond: (ml.movie_id = mc.movie_id)
                                                                     ->  Merge Join  (cost=693.68..46534.00 rows=1310 width=111) (actual time=13.302..384.193 rows=1247 loops=3)
                                                                           Merge Cond: (ml.movie_id = t.id)
                                                                           ->  Merge Join  (cost=651.07..37496.27 rows=1747 width=90) (actual time=10.533..162.999 rows=1288 loops=3)
                                                                                 Merge Cond: (mi.movie_id = ml.movie_id)
                                                                                 ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1010698.11 rows=372351 width=4) (actual time=0.157..151.383 rows=11321 loops=3)
                                                                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))
                                                                                       Rows Removed by Filter: 160210
                                                                                 ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=9.292..9.546 rows=2954 loops=3)
                                                                                       Sort Key: ml.movie_id
                                                                                       Sort Method: quicksort  Memory: 205kB
                                                                                       Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                       Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.127..8.062 rows=2315 loops=3)
                                                                                             Hash Cond: (ml.link_type_id = lt.id)
                                                                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.025..3.813 rows=29997 loops=3)
                                                                                             ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.043..0.043 rows=2 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.026..0.031 rows=2 loops=3)
                                                                                                         Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                         Rows Removed by Filter: 16
                                                                           ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=1895923 width=21) (actual time=0.033..210.111 rows=133937 loops=3)
                                                                                 Filter: ((production_year >= 1950) AND (production_year <= 2010))
                                                                                 Rows Removed by Filter: 37735
                                                                     ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.036..35.155 rows=47778 loops=3)
                                                                           Filter: (note IS NULL)
                                                                           Rows Removed by Filter: 47336
                                                               ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=47.388..47.388 rows=16101 loops=3)
                                                                     Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.032..37.129 rows=16101 loops=3)
                                                                           Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                           Rows Removed by Filter: 62232
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.039..0.041 rows=1 loops=3)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.023..0.023 rows=2 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.010..0.012 rows=2 loops=1)
                                             Filter: ((kind)::text ~~ 'complete%'::text)
                                             Rows Removed by Filter: 2
                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=1)
                                       Filter: ((kind)::text = 'cast'::text)
                                       Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.280..21.280 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.194..21.268 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 85.056 ms
 Execution Time: 562.337 ms
(81 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28a.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=468295.89..468295.90 rows=1 width=96) (actual time=3948.650..3948.650 rows=1 loops=1)
   ->  Hash Join  (cost=451069.27..468295.88 rows=1 width=41) (actual time=3749.335..3946.677 rows=4803 loops=1)
         Hash Cond: (mi_idx.info_type_id = it2.id)
         ->  Gather  (cost=451066.84..468293.45 rows=1 width=45) (actual time=3749.204..3950.057 rows=15325 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=450066.84..467293.35 rows=1 width=45) (actual time=3743.201..3934.505 rows=5108 loops=3)
                     Hash Cond: (mi_idx.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.062..155.498 rows=447629 loops=3)
                           Filter: ((info)::text < '8.5'::text)
                           Rows Removed by Filter: 12383
                     ->  Parallel Hash  (cost=450066.83..450066.83 rows=1 width=56) (actual time=3729.680..3729.680 rows=1704 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                           ->  Hash Join  (cost=147280.54..450066.83 rows=1 width=56) (actual time=3240.141..3714.807 rows=1704 loops=3)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Hash Join  (cost=147279.45..450065.74 rows=1 width=60) (actual time=3240.026..3714.186 rows=2155 loops=3)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Hash Join  (cost=147278.39..450064.67 rows=1 width=64) (actual time=3225.740..3712.344 rows=13930 loops=3)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Hash Join  (cost=142847.96..444972.22 rows=1 width=52) (actual time=3149.984..3611.543 rows=15212 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=142845.53..444969.79 rows=1 width=56) (actual time=1353.590..3607.213 rows=17574 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.030..2218.648 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Parallel Hash  (cost=142845.52..142845.52 rows=1 width=48) (actual time=1346.617..1346.617 rows=16473 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5176kB
                                                               ->  Parallel Hash Join  (cost=137845.48..142845.52 rows=1 width=48) (actual time=1282.674..1326.944 rows=16473 loops=3)
                                                                     Hash Cond: (cn.id = mc.company_id)
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.035..31.597 rows=42077 loops=3)
                                                                           Filter: ((country_code)::text <> '[us]'::text)
                                                                           Rows Removed by Filter: 36256
                                                                     ->  Parallel Hash  (cost=137845.47..137845.47 rows=1 width=33) (actual time=1282.527..1282.527 rows=17485 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4504kB
                                                                           ->  Hash Join  (cost=102542.40..137845.47 rows=1 width=33) (actual time=966.079..1254.444 rows=17485 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=102541.31..137844.38 rows=1 width=37) (actual time=965.979..1249.836 rows=17485 loops=3)
                                                                                       Hash Cond: (mc.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.020..267.113 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=102541.20..102541.20 rows=9 width=25) (actual time=964.226..964.226 rows=3895 loops=3)
                                                                                             Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 984kB
                                                                                             ->  Hash Join  (cost=51215.33..102541.20 rows=9 width=25) (actual time=578.487..915.527 rows=3895 loops=3)
                                                                                                   Hash Cond: (t.kind_id = kt.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..102539.96 rows=31 width=29) (actual time=576.780..913.548 rows=4924 loops=3)
                                                                                                         Hash Cond: (t.id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.012..273.142 rows=460484 loops=3)
                                                                                                               Filter: (production_year > 2000)
                                                                                                               Rows Removed by Filter: 382286
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=576.348..576.348 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=46.925..486.387 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..251.784 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=46.684..46.684 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.580..46.663 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.080..0.080 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.065..0.068 rows=2 loops=3)
                                                                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                                                                               Rows Removed by Filter: 5
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.046..0.046 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.029..0.030 rows=4 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.069..0.069 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.057 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=71.134..71.134 rows=135086 loops=3)
                                                   Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.022..30.137 rows=135086 loops=3)
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.029..0.029 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.015..0.017 rows=1 loops=3)
                                                   Filter: ((kind)::text = 'crew'::text)
                                                   Rows Removed by Filter: 3
                                 ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.067..0.067 rows=3 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=3 width=4) (actual time=0.042..0.044 rows=3 loops=3)
                                             Filter: ((kind)::text <> 'complete+verified'::text)
                                             Rows Removed by Filter: 1
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.026 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 109.822 ms
 Execution Time: 3955.862 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28b.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=418889.66..418889.67 rows=1 width=96) (actual time=3185.507..3185.508 rows=1 loops=1)
   ->  Hash Join  (cost=403298.67..418889.65 rows=1 width=41) (actual time=3156.794..3185.417 rows=148 loops=1)
         Hash Cond: (mi_idx.info_type_id = it2.id)
         ->  Gather  (cost=403296.25..418887.22 rows=1 width=45) (actual time=3156.675..3193.454 rows=224 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=402296.25..417887.12 rows=1 width=45) (actual time=3083.887..3176.753 rows=75 loops=3)
                     Hash Cond: (mi_idx.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=124848 width=13) (actual time=0.054..140.809 rows=99992 loops=3)
                           Filter: ((info)::text > '6.5'::text)
                           Rows Removed by Filter: 360020
                     ->  Parallel Hash  (cost=402296.24..402296.24 rows=1 width=56) (actual time=3024.134..3024.134 rows=70 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=350869.64..402296.24 rows=1 width=56) (actual time=3008.981..3023.631 rows=70 loops=3)
                                 Hash Cond: (cc.subject_id = cct1.id)
                                 ->  Hash Join  (cost=350868.57..402295.17 rows=1 width=60) (actual time=2920.497..3023.438 rows=544 loops=3)
                                       Hash Cond: (cc.status_id = cct2.id)
                                       ->  Hash Join  (cost=350867.49..402294.08 rows=1 width=64) (actual time=2918.939..3023.151 rows=1108 loops=3)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Hash Join  (cost=346437.05..397201.63 rows=1 width=52) (actual time=2666.738..2935.577 rows=1608 loops=3)
                                                   Hash Cond: (t.kind_id = kt.id)
                                                   ->  Parallel Hash Join  (cost=346435.94..397200.52 rows=1 width=56) (actual time=2633.068..2934.977 rows=1675 loops=3)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.010..267.896 rows=337640 loops=3)
                                                               Filter: (production_year > 2005)
                                                               Rows Removed by Filter: 505131
                                                         ->  Parallel Hash  (cost=346435.93..346435.93 rows=1 width=31) (actual time=2623.511..2623.511 rows=4086 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1112kB
                                                               ->  Parallel Hash Join  (cost=341435.89..346435.93 rows=1 width=31) (actual time=2594.369..2618.491 rows=4086 loops=3)
                                                                     Hash Cond: (cn.id = mc.company_id)
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.010..17.977 rows=42077 loops=3)
                                                                           Filter: ((country_code)::text <> '[us]'::text)
                                                                           Rows Removed by Filter: 36256
                                                                     ->  Parallel Hash  (cost=341435.88..341435.88 rows=1 width=16) (actual time=2594.241..2594.241 rows=4250 loops=3)
                                                                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 920kB
                                                                           ->  Hash Join  (cost=306132.81..341435.88 rows=1 width=16) (actual time=2258.846..2544.870 rows=4250 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=306131.72..341434.79 rows=1 width=20) (actual time=2258.744..2543.714 rows=4250 loops=3)
                                                                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.042..272.778 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=306131.71..306131.71 rows=1 width=8) (actual time=2255.579..2255.579 rows=653 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Hash Join  (cost=51216.64..306131.71 rows=1 width=8) (actual time=1953.551..2254.983 rows=653 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..306129.23 rows=21 width=12) (actual time=578.877..2254.422 rows=1510 loops=3)
                                                                                                         Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=55380 width=8) (actual time=0.943..1665.412 rows=44746 loops=3)
                                                                                                               Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                                                                                                               Rows Removed by Filter: 4900494
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=576.380..576.380 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=33.692..475.093 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..253.970 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=33.492..33.493 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.406..33.475 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.030..0.042 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'countries'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.048..0.048 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.031..0.032 rows=4 loops=3)
                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.095..0.095 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.079..0.082 rows=2 loops=3)
                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                               Rows Removed by Filter: 5
                                             ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.348..69.348 rows=135086 loops=3)
                                                   Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.023..27.611 rows=135086 loops=3)
                                       ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.023..0.023 rows=3 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=3 width=4) (actual time=0.008..0.010 rows=3 loops=3)
                                                   Filter: ((kind)::text <> 'complete+verified'::text)
                                                   Rows Removed by Filter: 1
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.074..0.074 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.050..0.051 rows=1 loops=3)
                                             Filter: ((kind)::text = 'crew'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.046 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 110.290 ms
 Execution Time: 3194.769 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28c.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=467734.71..467734.72 rows=1 width=96) (actual time=3969.070..3969.071 rows=1 loops=1)
   ->  Hash Join  (cost=449846.07..467734.70 rows=1 width=41) (actual time=3717.276..3965.481 rows=8373 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=449845.01..467733.64 rows=1 width=45) (actual time=3717.143..3962.551 rows=15126 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=449843.95..467732.57 rows=1 width=49) (actual time=3717.044..3958.460 rows=16719 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=445413.51..462640.12 rows=1 width=61) (actual time=3621.022..3835.228 rows=21489 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=445411.09..462637.70 rows=1 width=65) (actual time=3620.905..3823.792 rows=64628 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=444411.09..461637.60 rows=1 width=65) (actual time=3615.327..3814.906 rows=21543 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.747..156.811 rows=447629 loops=3)
                                             Filter: ((info)::text < '8.5'::text)
                                             Rows Removed by Filter: 12383
                                       ->  Parallel Hash  (cost=444411.07..444411.07 rows=1 width=52) (actual time=3602.181..3602.181 rows=7276 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                             ->  Hash Join  (cost=142286.81..444411.07 rows=1 width=52) (actual time=3114.856..3574.760 rows=7276 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=142284.38..444408.65 rows=1 width=56) (actual time=1319.242..3572.585 rows=8340 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.020..2228.867 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Parallel Hash  (cost=142284.37..142284.37 rows=1 width=48) (actual time=1301.703..1301.703 rows=7967 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2520kB
                                                               ->  Hash Join  (cost=137284.33..142284.37 rows=1 width=48) (actual time=1261.063..1292.401 rows=7967 loops=3)
                                                                     Hash Cond: (mc.company_type_id = ct.id)
                                                                     ->  Parallel Hash Join  (cost=137283.24..142283.28 rows=1 width=52) (actual time=1260.956..1290.310 rows=7967 loops=3)
                                                                           Hash Cond: (cn.id = mc.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.009..20.892 rows=42077 loops=3)
                                                                                 Filter: ((country_code)::text <> '[us]'::text)
                                                                                 Rows Removed by Filter: 36256
                                                                           ->  Parallel Hash  (cost=137283.23..137283.23 rows=1 width=37) (actual time=1260.845..1260.845 rows=8618 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2360kB
                                                                                 ->  Parallel Hash Join  (cost=101980.16..137283.23 rows=1 width=37) (actual time=947.137..1227.362 rows=8618 loops=3)
                                                                                       Hash Cond: (mc.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.035..270.288 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=101980.08..101980.08 rows=7 width=25) (actual time=940.816..940.816 rows=2691 loops=3)
                                                                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                                                                                             ->  Hash Join  (cost=51215.33..101980.08 rows=7 width=25) (actual time=576.640..898.015 rows=2691 loops=3)
                                                                                                   Hash Cond: (t.kind_id = kt.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..101978.87 rows=23 width=29) (actual time=575.619..896.638 rows=3246 loops=3)
                                                                                                         Hash Cond: (t.id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.013..271.572 rows=337640 loops=3)
                                                                                                               Filter: (production_year > 2005)
                                                                                                               Rows Removed by Filter: 505131
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=575.214..575.214 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=33.268..472.051 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..251.759 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=33.080..33.081 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.430..33.065 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.072..0.072 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.054..0.057 rows=2 loops=3)
                                                                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                                                                               Rows Removed by Filter: 5
                                                                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.049..0.049 rows=4 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.035..0.036 rows=4 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.049 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.035 rows=1 loops=1)
                                       Filter: ((info)::text = 'rating'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.622..69.622 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.022..28.650 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.030..0.030 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.042..0.042 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=1)
                     Filter: ((kind)::text = 'complete'::text)
                     Rows Removed by Filter: 3
 Planning Time: 109.520 ms
 Execution Time: 3972.261 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29a.sql_explained.sql
SET
SET
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1085189.97..1085189.98 rows=1 width=96) (actual time=8698.703..8698.703 rows=1 loops=1)
   ->  Hash Join  (cost=1002792.89..1085189.96 rows=1 width=48) (actual time=8695.856..8698.221 rows=1620 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=1002791.82..1085188.89 rows=1 width=52) (actual time=8695.734..8697.718 rows=1620 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=1002790.76..1085187.83 rows=1 width=56) (actual time=8695.664..8697.243 rows=1620 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=998360.33..1080095.38 rows=1 width=68) (actual time=8279.821..8518.837 rows=1620 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=997360.33..1079095.28 rows=1 width=68) (actual time=8495.389..8573.885 rows=540 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=219.873..521.654 rows=16670 loops=3)
                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1372493
                                 ->  Parallel Hash  (cost=997360.31..997360.31 rows=1 width=65) (actual time=8047.001..8047.001 rows=540 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                       ->  Hash Join  (cost=980800.35..997360.31 rows=1 width=65) (actual time=7951.851..8021.721 rows=540 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Hash Join  (cost=978174.21..994734.17 rows=1 width=69) (actual time=7929.913..7993.934 rows=58320 loops=3)
                                                   Hash Cond: (ci.role_id = rt.id)
                                                   ->  Parallel Hash Join  (cost=978173.05..994733.01 rows=1 width=73) (actual time=7929.789..7979.341 rows=58320 loops=3)
                                                         Hash Cond: (an.person_id = ci.person_id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.028..72.409 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=978173.04..978173.04 rows=1 width=69) (actual time=7846.700..7846.700 rows=19440 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6072kB
                                                               ->  Parallel Hash Join  (cost=911370.37..978173.04 rows=1 width=69) (actual time=6275.292..6793.505 rows=19440 loops=3)
                                                                     Hash Cond: (ci.person_role_id = chn.id)
                                                                     ->  Parallel Hash Join  (cost=858566.42..925369.09 rows=1 width=57) (actual time=6016.098..6520.071 rows=149955 loops=3)
                                                                           Hash Cond: (pi.person_id = ci.person_id)
                                                                           ->  Hash Join  (cost=2.43..66764.11 rows=10928 width=4) (actual time=0.098..447.925 rows=206842 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.033..286.105 rows=987888 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.019..0.030 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'trivia'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=858563.98..858563.98 rows=1 width=53) (actual time=6006.352..6006.352 rows=13941 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4344kB
                                                                                 ->  Parallel Hash Join  (cost=396900.01..858563.98 rows=1 width=53) (actual time=2821.500..5550.983 rows=13941 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..460336.89 rows=353886 width=16) (actual time=0.082..2708.577 rows=278900 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11802548
                                                                                       ->  Parallel Hash  (cost=396900.00..396900.00 rows=1 width=37) (actual time=2800.325..2800.325 rows=369 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=391988.71..396900.00 rows=1 width=37) (actual time=2772.167..2800.095 rows=369 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.034..27.458 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=391988.70..391988.70 rows=1 width=41) (actual time=2769.060..2769.060 rows=1603 loops=3)
                                                                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                                         ->  Parallel Hash Join  (cost=358250.56..391988.70 rows=1 width=41) (actual time=2660.335..2660.718 rows=1603 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = t.id)
                                                                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.034..152.477 rows=869710 loops=3)
                                                                                                               ->  Parallel Hash  (cost=358250.54..358250.54 rows=1 width=33) (actual time=2400.752..2400.752 rows=81 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                     ->  Hash Join  (cost=102687.90..358250.54 rows=1 width=33) (actual time=2073.765..2400.681 rows=81 loops=3)
                                                                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                                                                           ->  Parallel Hash Join  (cost=102685.48..358248.12 rows=1 width=37) (actual time=2073.645..2400.541 rows=81 loops=3)
                                                                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=174.517..1687.970 rows=150368 loops=3)
                                                                                                                                       Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                                                                       Rows Removed by Filter: 4794872
                                                                                                                                 ->  Parallel Hash  (cost=102685.41..102685.41 rows=5 width=29) (actual time=695.898..695.899 rows=45 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                       ->  Parallel Hash Join  (cost=54433.65..102685.41 rows=5 width=29) (actual time=659.809..695.805 rows=45 loops=3)
                                                                                                                                             Hash Cond: (mk.movie_id = t.id)
                                                                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.015..249.846 rows=1507977 loops=3)
                                                                                                                                             ->  Parallel Hash  (cost=54433.61..54433.61 rows=3 width=21) (actual time=265.880..265.880 rows=1 loops=3)
                                                                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=3 width=21) (actual time=170.188..265.790 rows=1 loops=3)
                                                                                                                                                         Filter: ((production_year >= 2000) AND (production_year <= 2010) AND ((title)::text = 'Shrek 2'::text))
                                                                                                                                                         Rows Removed by Filter: 842770
                                                                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.052 rows=1 loops=3)
                                                                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=52803.93..52803.93 rows=1 width=20) (actual time=255.701..255.702 rows=0 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..52803.93 rows=1 width=20) (actual time=175.295..255.664 rows=0 loops=3)
                                                                                 Filter: ((name)::text = 'Queen'::text)
                                                                                 Rows Removed by Filter: 1046779
                                                   ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.046..0.049 rows=1 loops=3)
                                                               Filter: ((role)::text = 'actress'::text)
                                                               Rows Removed by Filter: 11
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.836..21.836 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.086..21.812 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'computer-animation'::text)
                                                         Rows Removed by Filter: 134169
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.679..69.680 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.024..28.241 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.027..0.028 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 146.401 ms
 Execution Time: 8702.083 ms
(111 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29b.sql_explained.sql
SET
SET
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1069734.87..1069734.88 rows=1 width=96) (actual time=7130.993..7130.993 rows=1 loops=1)
   ->  Hash Join  (cost=987337.79..1069734.86 rows=1 width=48) (actual time=7130.306..7130.979 rows=15 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=987336.72..1069733.79 rows=1 width=52) (actual time=7130.201..7130.870 rows=15 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=987335.66..1069732.73 rows=1 width=56) (actual time=7130.127..7130.792 rows=15 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=982905.23..1064640.28 rows=1 width=68) (actual time=7050.730..7052.137 rows=15 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=981905.23..1063640.18 rows=1 width=68) (actual time=6939.785..7042.467 rows=5 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=223.362..531.250 rows=16670 loops=3)
                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1372493
                                 ->  Parallel Hash  (cost=981905.21..981905.21 rows=1 width=65) (actual time=6507.092..6507.092 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Hash Join  (cost=965345.25..981905.21 rows=1 width=65) (actual time=6470.064..6507.012 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Hash Join  (cost=962719.11..979279.07 rows=1 width=69) (actual time=6448.135..6485.025 rows=540 loops=3)
                                                   Hash Cond: (ci.role_id = rt.id)
                                                   ->  Parallel Hash Join  (cost=962717.95..979277.91 rows=1 width=73) (actual time=6448.016..6484.770 rows=540 loops=3)
                                                         Hash Cond: (an.person_id = ci.person_id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.025..74.598 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=962717.94..962717.94 rows=1 width=69) (actual time=6371.607..6371.607 rows=180 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=895915.27..962717.94 rows=1 width=69) (actual time=6222.386..6371.417 rows=180 loops=3)
                                                                     Hash Cond: (ci.person_role_id = chn.id)
                                                                     ->  Parallel Hash Join  (cost=843111.32..909913.99 rows=1 width=57) (actual time=5685.572..6114.029 rows=2489 loops=3)
                                                                           Hash Cond: (pi.person_id = ci.person_id)
                                                                           ->  Hash Join  (cost=2.43..66764.11 rows=10928 width=4) (actual time=0.105..450.308 rows=47448 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.026..309.543 rows=987888 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.019..0.031 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'height'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=843108.88..843108.88 rows=1 width=53) (actual time=5654.158..5654.158 rows=7101 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2232kB
                                                                                 ->  Parallel Hash Join  (cost=381444.91..843108.88 rows=1 width=53) (actual time=2563.062..5215.606 rows=7101 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..460336.89 rows=353886 width=16) (actual time=0.070..2709.454 rows=278900 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11802548
                                                                                       ->  Parallel Hash  (cost=381444.90..381444.90 rows=1 width=37) (actual time=2466.844..2466.844 rows=189 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=376533.61..381444.90 rows=1 width=37) (actual time=2450.546..2466.692 rows=189 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.014..16.391 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=376533.60..376533.60 rows=1 width=41) (actual time=2447.307..2447.307 rows=811 loops=3)
                                                                                                         Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 248kB
                                                                                                         ->  Parallel Hash Join  (cost=342795.46..376533.60 rows=1 width=41) (actual time=2340.354..2340.666 rows=811 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = t.id)
                                                                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.289..152.204 rows=869710 loops=3)
                                                                                                               ->  Parallel Hash  (cost=342795.44..342795.44 rows=1 width=33) (actual time=2081.242..2081.242 rows=45 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                     ->  Hash Join  (cost=102687.84..342795.44 rows=1 width=33) (actual time=1813.437..2081.134 rows=45 loops=3)
                                                                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                                                                           ->  Parallel Hash Join  (cost=102685.41..342793.02 rows=1 width=37) (actual time=1813.310..2080.996 rows=45 loops=3)
                                                                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=227791 width=8) (actual time=140.923..1372.150 rows=129228 loops=3)
                                                                                                                                       Filter: ((info)::text ~~ 'USA:%200%'::text)
                                                                                                                                       Rows Removed by Filter: 4816012
                                                                                                                                 ->  Parallel Hash  (cost=102685.39..102685.39 rows=2 width=29) (actual time=694.183..694.183 rows=45 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                       ->  Parallel Hash Join  (cost=54433.62..102685.39 rows=2 width=29) (actual time=657.899..694.084 rows=45 loops=3)
                                                                                                                                             Hash Cond: (mk.movie_id = t.id)
                                                                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.268..251.745 rows=1507977 loops=3)
                                                                                                                                             ->  Parallel Hash  (cost=54433.61..54433.61 rows=1 width=21) (actual time=261.358..261.358 rows=1 loops=3)
                                                                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=1 width=21) (actual time=241.586..261.260 rows=1 loops=3)
                                                                                                                                                         Filter: ((production_year >= 2000) AND (production_year <= 2005) AND ((title)::text = 'Shrek 2'::text))
                                                                                                                                                         Rows Removed by Filter: 842770
                                                                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.052 rows=1 loops=3)
                                                                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=52803.93..52803.93 rows=1 width=20) (actual time=257.050..257.050 rows=0 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..52803.93 rows=1 width=20) (actual time=176.270..257.013 rows=0 loops=3)
                                                                                 Filter: ((name)::text = 'Queen'::text)
                                                                                 Rows Removed by Filter: 1046779
                                                   ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.037..0.040 rows=1 loops=3)
                                                               Filter: ((role)::text = 'actress'::text)
                                                               Rows Removed by Filter: 11
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.876..21.876 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.084..21.853 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'computer-animation'::text)
                                                         Rows Removed by Filter: 134169
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.002..70.002 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.015..27.909 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.025..0.026 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 146.422 ms
 Execution Time: 7133.294 ms
(111 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29c.sql_explained.sql
SET
SET
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1104796.41..1104796.42 rows=1 width=96) (actual time=8323.658..8323.659 rows=1 loops=1)
   ->  Hash Join  (cost=849233.65..1104796.40 rows=1 width=48) (actual time=7219.472..8318.247 rows=16308 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Hash Join  (cost=849231.22..1104793.97 rows=1 width=52) (actual time=7219.373..8314.214 rows=16308 loops=1)
               Hash Cond: (ci.role_id = rt.id)
               ->  Hash Join  (cost=849230.06..1104792.80 rows=1 width=56) (actual time=7219.298..8310.248 rows=16308 loops=1)
                     Hash Cond: (cc.status_id = cct2.id)
                     ->  Hash Join  (cost=849229.00..1104791.74 rows=1 width=60) (actual time=7167.967..8305.027 rows=28022 loops=1)
                           Hash Cond: (cc.subject_id = cct1.id)
                           ->  Gather  (cost=849227.94..1104790.67 rows=1 width=64) (actual time=7167.894..8304.804 rows=28022 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=848227.94..1103790.57 rows=1 width=64) (actual time=7172.559..8278.505 rows=9341 loops=3)
                                       Hash Cond: (mi.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=181.358..1758.637 rows=150368 loops=3)
                                             Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                             Rows Removed by Filter: 4794872
                                       ->  Parallel Hash  (cost=848227.92..848227.92 rows=1 width=80) (actual time=6498.142..6498.142 rows=3288 loops=3)
                                             Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1304kB
                                             ->  Parallel Hash Join  (cost=793788.39..848227.92 rows=1 width=80) (actual time=5841.068..6137.477 rows=3288 loops=3)
                                                   Hash Cond: (chn.id = ci.person_role_id)
                                                   ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.057..240.778 rows=1046780 loops=3)
                                                   ->  Parallel Hash  (cost=793788.37..793788.37 rows=1 width=68) (actual time=5759.535..5759.535 rows=3428 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1240kB
                                                         ->  Parallel Hash Join  (cost=777228.20..793788.37 rows=1 width=68) (actual time=5547.478..5643.634 rows=3428 loops=3)
                                                               Hash Cond: (n.id = ci.person_id)
                                                               ->  Parallel Hash Join  (cost=148593.14..165153.19 rows=28 width=27) (actual time=1211.030..1326.873 rows=5368 loops=3)
                                                                     Hash Cond: (an.person_id = n.id)
                                                                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.028..72.433 rows=300448 loops=3)
                                                                     ->  Parallel Hash  (cost=148591.56..148591.56 rows=126 width=23) (actual time=1209.850..1209.850 rows=3355 loops=3)
                                                                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                           ->  Hash Join  (cost=81912.66..148591.56 rows=126 width=23) (actual time=554.950..1015.162 rows=3355 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Hash Join  (cost=81910.23..148550.34 rows=14247 width=27) (actual time=554.207..1012.349 rows=15416 loops=3)
                                                                                       Hash Cond: (pi.person_id = n.id)
                                                                                       ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.031..307.181 rows=987888 loops=3)
                                                                                       ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=553.458..553.459 rows=16670 loops=3)
                                                                                             Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                             ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=225.638..537.863 rows=16670 loops=3)
                                                                                                   Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                                   Rows Removed by Filter: 1372493
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.074..0.074 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.052..0.063 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'trivia'::text)
                                                                                             Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=628635.05..628635.05 rows=1 width=57) (actual time=4314.853..4314.853 rows=3451 loops=3)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1208kB
                                                                     ->  Parallel Hash Join  (cost=148044.74..628635.05 rows=1 width=57) (actual time=1182.887..4098.545 rows=3451 loops=3)
                                                                           Hash Cond: (ci.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.799..2878.396 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Parallel Hash  (cost=148044.70..148044.70 rows=3 width=41) (actual time=1179.141..1179.142 rows=105 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=94621.37..148044.70 rows=3 width=41) (actual time=1078.449..1179.000 rows=105 loops=3)
                                                                                       Hash Cond: (t.id = mc.movie_id)
                                                                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=432897 width=21) (actual time=0.042..287.907 rows=347600 loops=3)
                                                                                             Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                                                             Rows Removed by Filter: 495171
                                                                                       ->  Parallel Hash  (cost=94621.24..94621.24 rows=10 width=20) (actual time=851.554..851.554 rows=144 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=89709.93..94621.24 rows=10 width=20) (actual time=826.184..851.373 rows=144 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.020..22.037 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=89709.68..89709.68 rows=20 width=24) (actual time=825.668..825.669 rows=589 loops=3)
                                                                                                         Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                                                                                         ->  Hash Join  (cost=55308.66..89709.68 rows=20 width=24) (actual time=588.945..824.900 rows=589 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = cc.movie_id)
                                                                                                               ->  Parallel Hash Join  (cost=50878.23..84616.67 rows=74 width=12) (actual time=465.571..738.555 rows=1073 loops=3)
                                                                                                                     Hash Cond: (mc.movie_id = mk.movie_id)
                                                                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.031..166.256 rows=869710 loops=3)
                                                                                                                     ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=459.229..459.229 rows=138 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                                           ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=26.767..458.985 rows=138 loops=3)
                                                                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.036..254.102 rows=1507977 loops=3)
                                                                                                                                 ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.195..22.196 rows=1 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.083..22.185 rows=1 loops=3)
                                                                                                                                             Filter: ((keyword)::text = 'computer-animation'::text)
                                                                                                                                             Rows Removed by Filter: 134169
                                                                                                               ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=68.611..68.611 rows=135086 loops=3)
                                                                                                                     Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                                                                                     ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.048..27.629 rows=135086 loops=3)
                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                                       Filter: ((kind)::text = 'cast'::text)
                                       Rows Removed by Filter: 3
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.041..0.041 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.030..0.031 rows=1 loops=1)
                                 Filter: ((kind)::text = 'complete+verified'::text)
                                 Rows Removed by Filter: 3
               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.022..0.022 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.011..0.013 rows=1 loops=1)
                           Filter: ((role)::text = 'actress'::text)
                           Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 144.745 ms
 Execution Time: 8333.603 ms
(109 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=139838.09..139838.10 rows=1 width=32) (actual time=1291.127..1291.127 rows=1 loops=1)
   ->  Gather  (cost=139837.88..139838.09 rows=2 width=32) (actual time=1290.478..1297.246 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=138837.88..138837.89 rows=1 width=32) (actual time=1283.881..1283.882 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=88354.74..138837.87 rows=3 width=17) (actual time=919.534..1282.457 rows=2611 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.019..236.189 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=88354.70..88354.70 rows=3 width=8) (actual time=916.322..916.322 rows=2611 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                           ->  Parallel Hash Join  (cost=55672.11..88354.70 rows=3 width=8) (actual time=535.273..834.950 rows=2611 loops=3)
                                 Hash Cond: (mc.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=4793.88..37309.04 rows=44647 width=4) (actual time=23.107..313.957 rows=49377 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.046..157.133 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=4722.92..4722.92 rows=5677 width=4) (actual time=22.522..22.523 rows=3258 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 576kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=5677 width=4) (actual time=0.022..20.553 rows=3258 loops=3)
                                                   Filter: ((country_code)::text = '[de]'::text)
                                                   Rows Removed by Filter: 75074
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=511.015..511.015 rows=13947 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=22.193..463.901 rows=13947 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.033..255.057 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.939..21.939 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.862..21.916 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.121 ms
 Execution Time: 1297.686 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2b.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=139653.63..139653.64 rows=1 width=32) (actual time=1274.677..1274.677 rows=1 loops=1)
   ->  Gather  (cost=89170.30..139653.63 rows=2 width=17) (actual time=905.721..1279.819 rows=5228 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=88170.30..138653.43 rows=1 width=17) (actual time=898.889..1265.072 rows=1743 loops=3)
               Hash Cond: (t.id = mc.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.025..238.353 rows=842771 loops=3)
               ->  Parallel Hash  (cost=88170.28..88170.28 rows=1 width=8) (actual time=896.456..896.456 rows=1743 loops=3)
                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                     ->  Parallel Hash Join  (cost=55617.21..88170.28 rows=1 width=8) (actual time=531.135..823.776 rows=1743 loops=3)
                           Hash Cond: (mc.movie_id = mk.movie_id)
                           ->  Parallel Hash Join  (cost=4738.98..37254.14 rows=10108 width=4) (actual time=22.383..311.013 rows=18803 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.047..163.683 rows=869710 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=1285 width=4) (actual time=22.211..22.211 rows=780 loops=3)
                                       Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=1285 width=4) (actual time=0.027..21.500 rows=780 loops=3)
                                             Filter: ((country_code)::text = '[nl]'::text)
                                             Rows Removed by Filter: 77552
                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=507.327..507.327 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=22.396..462.361 rows=13947 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.086..253.706 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.195..22.195 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.835..22.174 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
 Planning Time: 4.103 ms
 Execution Time: 1281.945 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2c.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=139600.06..139600.07 rows=1 width=32) (actual time=816.328..816.328 rows=1 loops=1)
   ->  Gather  (cost=89116.82..139600.05 rows=1 width=17) (actual time=816.322..823.460 rows=0 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=88116.82..138599.95 rows=1 width=17) (actual time=809.393..809.393 rows=0 loops=3)
               Hash Cond: (t.id = mc.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (never executed)
               ->  Parallel Hash  (cost=88116.81..88116.81 rows=1 width=8) (actual time=808.732..808.732 rows=0 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 0kB
                     ->  Parallel Hash Join  (cost=55601.29..88116.81 rows=1 width=8) (actual time=808.592..808.592 rows=0 loops=3)
                           Hash Cond: (mc.movie_id = mk.movie_id)
                           ->  Parallel Hash Join  (cost=4723.07..37238.23 rows=92 width=4) (actual time=195.571..297.341 rows=1 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.028..166.205 rows=869710 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=12 width=4) (actual time=21.372..21.372 rows=0 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=12 width=4) (actual time=15.549..21.334 rows=0 loops=3)
                                             Filter: ((country_code)::text = '[sm]'::text)
                                             Rows Removed by Filter: 78332
                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=511.155..511.155 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=22.251..462.309 rows=13947 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.036..253.644 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.102..22.103 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.847..22.081 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
 Planning Time: 4.062 ms
 Execution Time: 823.874 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2d.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=141451.03..141451.04 rows=1 width=32) (actual time=1382.498..1382.498 rows=1 loops=1)
   ->  Gather  (cost=141450.82..141451.03 rows=2 width=32) (actual time=1380.495..1389.494 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=140450.82..140450.83 rows=1 width=32) (actual time=1374.001..1374.002 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=17) (actual time=1037.757..1367.277 rows=22772 loops=3)
                     Hash Cond: (mc.company_id = cn.id)
                     ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=21) (actual time=993.382..1306.958 rows=49517 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.032..168.104 rows=869710 loops=3)
                           ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=25) (actual time=993.025..993.025 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                 ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=25) (actual time=533.949..914.391 rows=13947 loops=3)
                                       Hash Cond: (t.id = mk.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.024..238.192 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=533.729..533.730 rows=13947 loops=3)
                                             Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                             ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.801..469.244 rows=13947 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.061..261.347 rows=1507977 loops=3)
                                                   ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.618..21.618 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.890..21.599 rows=1 loops=3)
                                                               Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                               Rows Removed by Filter: 134169
                     ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=42.808..42.808 rows=28281 loops=3)
                           Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.028..26.292 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
 Planning Time: 4.131 ms
 Execution Time: 1389.956 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30a.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=944426.03..944426.04 rows=1 width=128) (actual time=6487.500..6487.501 rows=1 loops=1)
   ->  Hash Join  (cost=927922.43..944426.02 rows=1 width=80) (actual time=6368.914..6486.988 rows=757 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=927921.36..944424.94 rows=1 width=84) (actual time=6368.809..6486.678 rows=757 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=927920.30..944423.88 rows=1 width=88) (actual time=6368.731..6486.203 rows=2492 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=923489.86..939331.43 rows=1 width=100) (actual time=6248.184..6370.868 rows=6214 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=923487.44..939329.00 rows=1 width=104) (actual time=6248.061..6369.044 rows=18687 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=922487.44..938328.90 rows=1 width=104) (actual time=6227.709..6358.105 rows=6229 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.034..80.804 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=922487.42..922487.42 rows=1 width=91) (actual time=6211.804..6211.804 rows=2263 loops=3)
                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                             ->  Parallel Hash Join  (cost=842460.08..922487.42 rows=1 width=91) (actual time=5643.716..6173.528 rows=2263 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.056..460.597 rows=579860 loops=3)
                                                         Filter: ((gender)::text = 'm'::text)
                                                         Rows Removed by Filter: 809304
                                                   ->  Parallel Hash  (cost=842460.07..842460.07 rows=1 width=80) (actual time=5642.262..5642.262 rows=3573 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1176kB
                                                         ->  Parallel Hash Join  (cost=342439.39..842460.07 rows=1 width=80) (actual time=4409.242..5582.198 rows=3573 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=204.450..3023.713 rows=414905 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                     Rows Removed by Filter: 11666543
                                                               ->  Parallel Hash  (cost=342439.38..342439.38 rows=1 width=72) (actual time=2500.890..2500.890 rows=5468 loops=3)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1496kB
                                                                     ->  Parallel Hash Join  (cost=291113.75..342439.38 rows=1 width=72) (actual time=2144.180..2483.776 rows=5468 loops=3)
                                                                           Hash Cond: (t.id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.015..279.416 rows=460484 loops=3)
                                                                                 Filter: (production_year > 2000)
                                                                                 Rows Removed by Filter: 382286
                                                                           ->  Parallel Hash  (cost=291113.73..291113.73 rows=1 width=51) (actual time=2140.507..2140.507 rows=11309 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                                 ->  Hash Join  (cost=51720.34..291113.73 rows=1 width=51) (actual time=1940.985..2101.970 rows=11309 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..291111.24 rows=25 width=55) (actual time=1527.779..2098.479 rows=11907 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=953.989..1512.538 rows=24349 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                                   Rows Removed by Filter: 4920891
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=573.696..573.696 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.429..487.392 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.032..252.331 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.277..41.277 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.121..41.263 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.071..0.071 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.050 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.031..0.034 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=92.515..92.515 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.022..28.627 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.042..0.042 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.026..0.028 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                     Rows Removed by Filter: 2
 Planning Time: 92.236 ms
 Execution Time: 6490.924 ms
(80 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30b.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=950168.28..950168.29 rows=1 width=128) (actual time=6401.243..6401.243 rows=1 loops=1)
   ->  Hash Join  (cost=933664.68..950168.27 rows=1 width=80) (actual time=6388.203..6401.210 rows=28 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=933663.61..950167.19 rows=1 width=84) (actual time=6388.102..6401.101 rows=28 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=933662.55..950166.13 rows=1 width=88) (actual time=6388.022..6401.004 rows=108 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=929232.11..945073.68 rows=1 width=100) (actual time=6315.372..6316.192 rows=108 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=929229.69..945071.25 rows=1 width=104) (actual time=6315.242..6317.972 rows=324 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=928229.69..944071.15 rows=1 width=104) (actual time=6272.294..6307.760 rows=108 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.041..79.318 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=928229.67..928229.67 rows=1 width=91) (actual time=6171.083..6171.083 rows=36 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=871161.79..928229.67 rows=1 width=91) (actual time=6103.611..6170.845 rows=36 loops=3)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=161 width=21) (actual time=5.350..371.745 rows=178 loops=3)
                                                         Filter: ((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))
                                                         Rows Removed by Filter: 842593
                                                   ->  Parallel Hash  (cost=871161.78..871161.78 rows=1 width=70) (actual time=5798.745..5798.745 rows=4543 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1272kB
                                                         ->  Parallel Hash Join  (cost=791134.44..871161.78 rows=1 width=70) (actual time=5225.927..5750.405 rows=4543 loops=3)
                                                               Hash Cond: (n.id = ci.person_id)
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.055..451.857 rows=579860 loops=3)
                                                                     Filter: ((gender)::text = 'm'::text)
                                                                     Rows Removed by Filter: 809304
                                                               ->  Parallel Hash  (cost=791134.42..791134.42 rows=1 width=59) (actual time=5225.031..5225.031 rows=7458 loops=3)
                                                                     Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1880kB
                                                                     ->  Parallel Hash Join  (cost=291113.75..791134.42 rows=1 width=59) (actual time=4005.769..5172.880 rows=7458 loops=3)
                                                                           Hash Cond: (ci.movie_id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=183.497..3009.886 rows=414905 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                                 Rows Removed by Filter: 11666543
                                                                           ->  Parallel Hash  (cost=291113.73..291113.73 rows=1 width=51) (actual time=2105.812..2105.812 rows=11309 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                                 ->  Hash Join  (cost=51720.34..291113.73 rows=1 width=51) (actual time=1899.610..2059.244 rows=11309 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..291111.24 rows=25 width=55) (actual time=1497.176..2055.708 rows=11907 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=929.843..1475.572 rows=24349 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                                   Rows Removed by Filter: 4920891
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=567.246..567.246 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.949..485.250 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.038..253.032 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.771..41.771 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.117..41.756 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.048 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.036 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.493..70.493 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.015..28.019 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.040..0.040 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.026..0.028 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                     Rows Removed by Filter: 2
 Planning Time: 91.542 ms
 Execution Time: 6404.140 ms
(80 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=974687.78..974687.79 rows=1 width=128) (actual time=6829.191..6829.191 rows=1 loops=1)
   ->  Hash Join  (cost=958184.19..974687.77 rows=1 width=80) (actual time=6615.953..6824.555 rows=8024 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=958183.12..974686.71 rows=1 width=84) (actual time=6615.837..6821.789 rows=14123 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=958182.06..974685.64 rows=1 width=88) (actual time=6615.752..6817.521 rows=18841 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=953751.63..969593.19 rows=1 width=100) (actual time=6538.028..6706.169 rows=26153 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=953749.20..969590.76 rows=1 width=104) (actual time=6537.891..6692.763 rows=78897 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=952749.20..968590.66 rows=1 width=104) (actual time=6530.655..6677.698 rows=26299 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.043..77.159 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=952749.19..952749.19 rows=1 width=91) (actual time=6526.983..6526.983 rows=9085 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3032kB
                                             ->  Parallel Hash Join  (cost=872721.85..952749.19 rows=1 width=91) (actual time=5969.945..6500.697 rows=9085 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.046..454.860 rows=579860 loops=3)
                                                         Filter: ((gender)::text = 'm'::text)
                                                         Rows Removed by Filter: 809304
                                                   ->  Parallel Hash  (cost=872721.83..872721.83 rows=1 width=80) (actual time=5969.257..5969.257 rows=15008 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4632kB
                                                         ->  Parallel Hash Join  (cost=372701.16..872721.83 rows=1 width=80) (actual time=4784.900..5936.759 rows=15008 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=167.040..2935.000 rows=414905 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                     Rows Removed by Filter: 11666543
                                                               ->  Parallel Hash  (cost=372701.14..372701.14 rows=1 width=72) (actual time=2935.513..2935.513 rows=22680 loops=3)
                                                                     Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6936kB
                                                                     ->  Parallel Hash Join  (cost=322218.01..372701.14 rows=1 width=72) (actual time=2483.858..2847.915 rows=22680 loops=3)
                                                                           Hash Cond: (t.id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.014..225.121 rows=842771 loops=3)
                                                                           ->  Parallel Hash  (cost=322218.00..322218.00 rows=1 width=51) (actual time=2482.631..2482.631 rows=22680 loops=3)
                                                                                 Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                                                 ->  Hash Join  (cost=51720.34..322218.00 rows=1 width=51) (actual time=2218.124..2441.852 rows=22680 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..322215.41 rows=60 width=55) (actual time=1718.869..2435.699 rows=24129 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1043.471..1848.261 rows=62990 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                                   Rows Removed by Filter: 4882250
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=567.147..567.147 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.394..482.101 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.036..250.531 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.231..41.231 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.128..41.215 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.063..0.063 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.044 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.042 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.602..69.602 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.012..27.911 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.023..0.024 rows=1 loops=1)
                     Filter: ((kind)::text = 'complete+verified'::text)
                     Rows Removed by Filter: 3
 Planning Time: 92.403 ms
 Execution Time: 6835.297 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=975119.34..975119.35 rows=1 width=128) (actual time=6711.019..6711.020 rows=1 loops=1)
   ->  Gather  (cost=975119.11..975119.32 rows=2 width=128) (actual time=6709.821..6717.055 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=974119.11..974119.12 rows=1 width=128) (actual time=6702.188..6702.188 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=923635.97..974119.10 rows=1 width=80) (actual time=6588.597..6701.899 rows=424 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.022..229.174 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=923635.96..923635.96 rows=1 width=83) (actual time=6358.246..6358.246 rows=424 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 168kB
                           ->  Parallel Hash Join  (cost=843608.62..923635.96 rows=1 width=83) (actual time=5856.728..6357.941 rows=424 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.038..446.972 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=843608.60..843608.60 rows=1 width=72) (actual time=5848.807..5848.807 rows=519 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=343587.93..843608.60 rows=1 width=72) (actual time=4335.889..5446.636 rows=519 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=175.440..2886.377 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=343587.91..343587.91 rows=1 width=64) (actual time=2510.235..2510.235 rows=508 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                   ->  Parallel Hash Join  (cost=311072.34..343587.91 rows=1 width=64) (actual time=2290.254..2509.730 rows=508 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Hash Join  (cost=4723.09..37238.26 rows=106 width=4) (actual time=20.380..281.020 rows=605 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.037..155.540 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=15.887..15.888 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=0.780..15.824 rows=3 loops=3)
                                                                           Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                           Rows Removed by Filter: 78329
                                                         ->  Parallel Hash  (cost=306349.24..306349.24 rows=1 width=60) (actual time=2227.982..2227.982 rows=10505 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2456kB
                                                               ->  Parallel Hash Join  (cost=291078.97..306349.24 rows=1 width=60) (actual time=2020.798..2204.541 rows=10505 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.131..160.952 rows=153308 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..76.643 rows=460012 loops=3)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.029 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'votes'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=291076.53..291076.53 rows=1 width=51) (actual time=2020.233..2020.233 rows=11309 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                           ->  Parallel Hash Join  (cost=51720.34..291076.53 rows=1 width=51) (actual time=1825.634..1981.787 rows=11309 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..239357.37 rows=330 width=47) (actual time=1257.744..1404.428 rows=24086 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=879.254..1396.101 rows=24349 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                             Rows Removed by Filter: 4920891
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.076..0.076 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.053 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=567.811..567.811 rows=25571 loops=3)
                                                                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                       ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.491..486.356 rows=25571 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.034..251.649 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.236..41.236 rows=7 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.108..41.211 rows=7 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                         Rows Removed by Filter: 134163
 Planning Time: 118.555 ms
 Execution Time: 6718.135 ms
(72 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31b.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=980989.91..980989.92 rows=1 width=128) (actual time=6224.591..6224.591 rows=1 loops=1)
   ->  Gather  (cost=980989.68..980989.89 rows=2 width=128) (actual time=6224.317..6230.984 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=979989.68..979989.69 rows=1 width=128) (actual time=6216.740..6216.741 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=899962.33..979989.67 rows=1 width=80) (actual time=5912.498..6216.694 rows=28 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.061..452.596 rows=579860 loops=3)
                           Filter: ((gender)::text = 'm'::text)
                           Rows Removed by Filter: 809304
                     ->  Parallel Hash  (cost=899962.31..899962.31 rows=1 width=69) (actual time=5706.175..5706.175 rows=28 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=400520.12..899962.31 rows=1 width=69) (actual time=4995.201..5706.049 rows=28 loops=3)
                                 Hash Cond: (t.id = mi.movie_id)
                                 ->  Parallel Hash Join  (cost=57069.28..556511.17 rows=79 width=29) (actual time=2204.215..3328.868 rows=212 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=233.638..2917.525 rows=414905 loops=3)
                                             Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                             Rows Removed by Filter: 11666543
                                       ->  Parallel Hash  (cost=57067.27..57067.27 rows=161 width=21) (actual time=364.082..364.083 rows=178 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=161 width=21) (actual time=2.672..363.786 rows=178 loops=3)
                                                   Filter: ((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))
                                                   Rows Removed by Filter: 842593
                                 ->  Parallel Hash  (cost=343450.83..343450.83 rows=1 width=64) (actual time=2377.061..2377.061 rows=87 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=104094.63..343450.83 rows=1 width=64) (actual time=2247.931..2376.928 rows=87 loops=3)
                                             Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                             ->  Hash Join  (cost=2.43..239357.37 rows=330 width=47) (actual time=1293.424..1443.162 rows=24086 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=903.246..1435.054 rows=24349 loops=3)
                                                         Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                         Rows Removed by Filter: 4920891
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.030 rows=1 loops=3)
                                                               Filter: ((info)::text = 'genres'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=104092.19..104092.19 rows=1 width=17) (actual time=930.381..930.381 rows=105 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=88821.93..104092.19 rows=1 width=17) (actual time=816.834..930.258 rows=105 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.240..161.741 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.084..78.390 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.081..0.081 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.055..0.057 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=88819.49..88819.49 rows=1 width=8) (actual time=752.634..752.634 rows=105 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=40567.20..88819.49 rows=1 width=8) (actual time=376.912..752.502 rows=105 loops=3)
                                                                     Hash Cond: (mk.movie_id = mc.movie_id)
                                                                     ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=39.478..489.422 rows=25571 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..257.466 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=39.318..39.318 rows=7 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.071..39.301 rows=7 loops=3)
                                                                                       Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                       Rows Removed by Filter: 134163
                                                                     ->  Parallel Hash  (cost=37102.41..37102.41 rows=1 width=4) (actual time=258.697..258.697 rows=45 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=4723.09..37102.41 rows=1 width=4) (actual time=64.377..258.571 rows=45 loops=3)
                                                                                 Hash Cond: (mc.company_id = cn.id)
                                                                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=39 width=8) (actual time=1.717..235.995 rows=2654 loops=3)
                                                                                       Filter: ((note)::text ~~ '%(Blu-ray)%'::text)
                                                                                       Rows Removed by Filter: 867055
                                                                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=21.705..21.705 rows=3 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=3.067..21.647 rows=3 loops=3)
                                                                                             Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                                             Rows Removed by Filter: 78329
 Planning Time: 123.997 ms
 Execution Time: 6232.097 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31c.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=1005633.28..1005633.29 rows=1 width=128) (actual time=7564.270..7564.270 rows=1 loops=1)
   ->  Gather  (cost=1005633.05..1005633.26 rows=2 width=128) (actual time=7562.654..7570.405 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=1004633.05..1004633.06 rows=1 width=128) (actual time=7554.886..7554.886 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=954149.91..1004633.04 rows=1 width=80) (actual time=7399.449..7554.340 rows=942 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.020..231.860 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=954149.90..954149.90 rows=1 width=83) (actual time=7212.383..7212.383 rows=942 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 344kB
                           ->  Parallel Hash Join  (cost=874660.64..954149.90 rows=1 width=83) (actual time=6561.343..7112.476 rows=942 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.044..374.780 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=874660.62..874660.62 rows=1 width=72) (actual time=6556.583..6556.583 rows=942 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                       ->  Parallel Hash Join  (cost=374639.95..874660.62 rows=1 width=72) (actual time=4942.474..6047.032 rows=942 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=174.344..2881.448 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=374639.93..374639.93 rows=1 width=64) (actual time=3118.468..3118.468 rows=947 loops=3)
                                                   Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                   ->  Parallel Hash Join  (cost=342124.37..374639.93 rows=1 width=64) (actual time=2811.610..3038.419 rows=947 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Hash Join  (cost=4723.09..37238.26 rows=106 width=4) (actual time=21.648..283.356 rows=605 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.027..157.238 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=15.955..15.956 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=0.452..15.874 rows=3 loops=3)
                                                                           Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                           Rows Removed by Filter: 78329
                                                         ->  Parallel Hash  (cost=337401.26..337401.26 rows=1 width=60) (actual time=2754.098..2754.098 rows=21129 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4824kB
                                                               ->  Parallel Hash Join  (cost=322130.99..337401.26 rows=1 width=60) (actual time=2508.657..2697.675 rows=21129 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.136..161.328 rows=153308 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..76.952 rows=460012 loops=3)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.041..0.041 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.027..0.029 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'votes'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=322128.55..322128.55 rows=1 width=51) (actual time=2508.281..2508.281 rows=22680 loops=3)
                                                                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                                           ->  Parallel Hash Join  (cost=51720.34..322128.55 rows=1 width=51) (actual time=2232.521..2466.890 rows=22680 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1669.250..1885.378 rows=62198 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1053.428..1867.955 rows=62990 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                             Rows Removed by Filter: 4882250
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.075..0.075 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.050 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=563.180..563.180 rows=25571 loops=3)
                                                                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                       ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.329..482.756 rows=25571 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.053..251.599 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.149..41.149 rows=7 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.112..41.124 rows=7 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                         Rows Removed by Filter: 134163
 Planning Time: 116.979 ms
 Execution Time: 7571.409 ms
(70 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/32a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=75986.58..75986.59 rows=1 width=96) (actual time=359.636..359.636 rows=1 loops=1)
   ->  Gather  (cost=75986.36..75986.57 rows=2 width=96) (actual time=359.449..363.599 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=74986.36..74986.37 rows=1 width=96) (actual time=352.461..352.461 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=24503.19..74986.33 rows=4 width=116) (actual time=352.456..352.456 rows=0 loops=3)
                     Hash Cond: (t2.id = ml.linked_movie_id)
                     ->  Parallel Seq Scan on title t2  (cost=0.00..46532.63 rows=1053463 width=21) (never executed)
                     ->  Parallel Hash  (cost=24503.14..24503.14 rows=4 width=103) (actual time=351.888..351.888 rows=0 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 0kB
                           ->  Hash Join  (cost=2676.61..24503.14 rows=4 width=103) (actual time=350.216..350.216 rows=0 loops=3)
                                 Hash Cond: (ml.link_type_id = lt.id)
                                 ->  Hash Join  (cost=2675.20..24501.72 rows=4 width=25) (actual time=350.101..350.101 rows=0 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=49.07..20347.47 rows=582120 width=29) (actual time=13.707..319.773 rows=96064 loops=3)
                                             Merge Cond: (t1.id = ml.movie_id)
                                             ->  Merge Join  (cost=47.47..247535.04 rows=1884971 width=29) (actual time=13.395..266.265 rows=32619 loops=3)
                                                   Merge Cond: (mk.movie_id = t1.id)
                                                   ->  Parallel Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..115667.54 rows=1884971 width=8) (actual time=0.059..11.686 rows=32619 loops=3)
                                                   ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=21) (actual time=0.060..224.685 rows=187035 loops=3)
                                             ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=12) (actual time=0.043..27.460 rows=120320 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.406..21.406 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=20.877..21.387 rows=1 loops=3)
                                                   Filter: ((keyword)::text = '10,000-mile-club'::text)
                                                   Rows Removed by Filter: 134169
                                 ->  Hash  (cost=1.18..1.18 rows=18 width=86) (actual time=0.070..0.070 rows=18 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=86) (actual time=0.043..0.046 rows=18 loops=3)
 Planning Time: 5.277 ms
 Execution Time: 364.309 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/32b.sql_explained.sql
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=75986.58..75986.59 rows=1 width=96) (actual time=799.235..799.235 rows=1 loops=1)
   ->  Gather  (cost=75986.36..75986.57 rows=2 width=96) (actual time=798.814..805.250 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=74986.36..74986.37 rows=1 width=96) (actual time=791.660..791.661 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=24503.19..74986.33 rows=4 width=116) (actual time=427.680..790.074 rows=1463 loops=3)
                     Hash Cond: (t2.id = ml.linked_movie_id)
                     ->  Parallel Seq Scan on title t2  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.013..232.044 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=24503.14..24503.14 rows=4 width=103) (actual time=426.412..426.412 rows=1463 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 408kB
                           ->  Hash Join  (cost=2676.61..24503.14 rows=4 width=103) (actual time=48.512..349.537 rows=1463 loops=3)
                                 Hash Cond: (ml.link_type_id = lt.id)
                                 ->  Hash Join  (cost=2675.20..24501.72 rows=4 width=25) (actual time=48.389..348.952 rows=1463 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=49.07..20347.47 rows=582120 width=29) (actual time=3.656..318.878 rows=96064 loops=3)
                                             Merge Cond: (t1.id = ml.movie_id)
                                             ->  Merge Join  (cost=47.47..247535.04 rows=1884971 width=29) (actual time=3.469..267.541 rows=32619 loops=3)
                                                   Merge Cond: (mk.movie_id = t1.id)
                                                   ->  Parallel Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..115667.54 rows=1884971 width=8) (actual time=0.014..7.866 rows=32619 loops=3)
                                                   ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=21) (actual time=0.065..230.530 rows=187035 loops=3)
                                             ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=12) (actual time=0.043..25.509 rows=120376 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.940..20.940 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.817..20.926 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
                                 ->  Hash  (cost=1.18..1.18 rows=18 width=86) (actual time=0.069..0.069 rows=18 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=86) (actual time=0.037..0.040 rows=18 loops=3)
 Planning Time: 4.960 ms
 Execution Time: 805.883 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33a.sql_explained.sql
SET
SET
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=154593.22..154593.23 rows=1 width=192) (actual time=1431.059..1431.059 rows=1 loops=1)
   ->  Hash Join  (cost=144214.38..154593.20 rows=1 width=82) (actual time=1431.026..1431.038 rows=8 loops=1)
         Hash Cond: (t2.kind_id = kt2.id)
         ->  Hash Join  (cost=144213.28..154592.10 rows=1 width=86) (actual time=1430.920..1430.930 rows=8 loops=1)
               Hash Cond: (mi_idx1.info_type_id = it1.id)
               ->  Hash Join  (cost=144210.85..154589.67 rows=2 width=90) (actual time=1430.810..1430.836 rows=24 loops=1)
                     Hash Cond: (t1.kind_id = kt1.id)
                     ->  Merge Join  (cost=144209.75..154588.52 rows=12 width=94) (actual time=1430.719..1430.738 rows=24 loops=1)
                           Merge Cond: (ml.movie_id = t1.id)
                           ->  Merge Join  (cost=144209.32..146403.23 rows=12 width=85) (actual time=1409.116..1409.129 rows=24 loops=1)
                                 Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                 ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.034..2.578 rows=8479 loops=1)
                                 ->  Sort  (cost=144208.90..144208.91 rows=4 width=72) (actual time=1405.570..1405.573 rows=22 loops=1)
                                       Sort Key: ml.movie_id
                                       Sort Method: quicksort  Memory: 26kB
                                       ->  Hash Join  (cost=137529.19..144208.86 rows=4 width=72) (actual time=1367.995..1405.483 rows=8 loops=1)
                                             Hash Cond: (cn1.id = mc1.company_id)
                                             ->  Seq Scan on company_name cn1  (cost=0.00..5932.46 rows=85390 width=23) (actual time=0.028..45.799 rows=84843 loops=1)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 150154
                                             ->  Hash  (cost=137529.07..137529.07 rows=10 width=57) (actual time=1352.289..1352.289 rows=29 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                   ->  Merge Join  (cost=132176.15..137529.07 rows=10 width=57) (actual time=1327.114..1352.268 rows=29 loops=1)
                                                         Merge Cond: (mc1.movie_id = ml.movie_id)
                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..131550.35 rows=2609129 width=8) (actual time=0.023..24.913 rows=61895 loops=1)
                                                         ->  Sort  (cost=132175.72..132175.73 rows=2 width=49) (actual time=1320.037..1320.040 rows=29 loops=1)
                                                               Sort Key: ml.movie_id
                                                               Sort Method: quicksort  Memory: 26kB
                                                               ->  Gather  (cost=127279.79..132175.71 rows=2 width=49) (actual time=1284.218..1320.378 rows=11 loops=1)
                                                                     Workers Planned: 1
                                                                     Workers Launched: 1
                                                                     ->  Parallel Hash Join  (cost=126279.79..131175.51 rows=1 width=49) (actual time=1281.789..1312.131 rows=6 loops=2)
                                                                           Hash Cond: (cn2.id = mc2.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.007..19.727 rows=117498 loops=2)
                                                                           ->  Parallel Hash  (cost=126279.78..126279.78 rows=1 width=34) (actual time=1278.146..1278.146 rows=6 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                 ->  Parallel Hash Join  (cost=92541.63..126279.78 rows=1 width=34) (actual time=887.350..1278.098 rows=6 loops=2)
                                                                                       Hash Cond: (mc2.movie_id = t2.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.029..231.740 rows=1304564 loops=2)
                                                                                       ->  Parallel Hash  (cost=92541.62..92541.62 rows=1 width=42) (actual time=885.631..885.632 rows=3 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Hash Join  (cost=76393.09..92541.62 rows=1 width=42) (actual time=635.850..885.575 rows=3 loops=2)
                                                                                                   Hash Cond: (mi_idx2.info_type_id = it2.id)
                                                                                                   ->  Parallel Hash Join  (cost=76390.66..92538.93 rows=96 width=46) (actual time=633.767..885.431 rows=153 loops=2)
                                                                                                         Hash Cond: (mi_idx2.movie_id = t2.id)
                                                                                                         ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=273383 width=13) (actual time=0.044..216.513 rows=327480 loops=2)
                                                                                                               Filter: ((info)::text < '3.0'::text)
                                                                                                               Rows Removed by Filter: 362537
                                                                                                         ->  Parallel Hash  (cost=76386.05..76386.05 rows=369 width=33) (actual time=633.460..633.460 rows=122 loops=2)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                               ->  Hash Join  (cost=75275.92..76386.05 rows=369 width=33) (actual time=568.369..632.929 rows=122 loops=2)
                                                                                                                     Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                     ->  Merge Join  (cost=75274.64..76377.59 rows=2212 width=37) (actual time=568.202..632.562 rows=2166 loops=2)
                                                                                                                           Merge Cond: (t2.id = ml.linked_movie_id)
                                                                                                                           ->  Sort  (cost=72580.89..73046.92 rows=186410 width=25) (actual time=547.441..581.865 rows=222854 loops=2)
                                                                                                                                 Sort Key: t2.id
                                                                                                                                 Sort Method: external merge  Disk: 8048kB
                                                                                                                                 Worker 0:  Sort Method: external merge  Disk: 7936kB
                                                                                                                                 ->  Parallel Seq Scan on title t2  (cost=0.00..51799.95 rows=186410 width=25) (actual time=0.034..395.412 rows=222930 loops=2)
                                                                                                                                       Filter: ((production_year >= 2005) AND (production_year <= 2008))
                                                                                                                                       Rows Removed by Filter: 1041226
                                                                                                                           ->  Sort  (cost=2693.63..2768.62 rows=29997 width=12) (actual time=20.739..23.163 rows=29997 loops=2)
                                                                                                                                 Sort Key: ml.linked_movie_id
                                                                                                                                 Sort Method: quicksort  Memory: 2175kB
                                                                                                                                 Worker 0:  Sort Method: quicksort  Memory: 2175kB
                                                                                                                                 ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.045..6.398 rows=29997 loops=2)
                                                                                                                     ->  Hash  (cost=1.25..1.25 rows=3 width=4) (actual time=0.059..0.059 rows=2 loops=2)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on link_type lt  (cost=0.00..1.25 rows=3 width=4) (actual time=0.043..0.048 rows=2 loops=2)
                                                                                                                                 Filter: ((link)::text = ANY ('{sequel,follows,"followed by"}'::text[]))
                                                                                                                                 Rows Removed by Filter: 16
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=2)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.045 rows=1 loops=2)
                                                                                                               Filter: ((info)::text = 'rating'::text)
                                                                                                               Rows Removed by Filter: 112
                           ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=25) (actual time=0.014..19.135 rows=22690 loops=1)
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.022..0.022 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=1 width=4) (actual time=0.009..0.011 rows=1 loops=1)
                                 Filter: ((kind)::text = 'tv series'::text)
                                 Rows Removed by Filter: 6
               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.023..0.025 rows=1 loops=1)
                           Filter: ((info)::text = 'rating'::text)
                           Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=1)
                     Filter: ((kind)::text = 'tv series'::text)
                     Rows Removed by Filter: 6
 Planning Time: 112.693 ms
 Execution Time: 1434.874 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33b.sql_explained.sql
SET
SET
                                                                                                                                    QUERY PLAN                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=126526.42..126526.43 rows=1 width=192) (actual time=1287.076..1287.077 rows=1 loops=1)
   ->  Hash Join  (cost=121630.57..126526.40 rows=1 width=82) (actual time=1258.083..1287.057 rows=4 loops=1)
         Hash Cond: (mi_idx2.info_type_id = it2.id)
         ->  Hash Join  (cost=121628.15..126523.97 rows=1 width=86) (actual time=1257.976..1286.948 rows=8 loops=1)
               Hash Cond: (t2.kind_id = kt2.id)
               ->  Gather  (cost=121627.05..126522.87 rows=1 width=90) (actual time=1257.879..1292.165 rows=42 loops=1)
                     Workers Planned: 1
                     Workers Launched: 1
                     ->  Parallel Hash Join  (cost=120627.05..125522.77 rows=1 width=90) (actual time=1251.444..1280.349 rows=21 loops=2)
                           Hash Cond: (cn2.id = mc2.company_id)
                           ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.006..16.068 rows=117498 loops=2)
                           ->  Parallel Hash  (cost=120627.03..120627.03 rows=1 width=75) (actual time=1250.363..1250.363 rows=21 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=86888.89..120627.03 rows=1 width=75) (actual time=961.078..1250.280 rows=21 loops=2)
                                       Hash Cond: (mc2.movie_id = t2.id)
                                       ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.006..232.974 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=86888.88..86888.88 rows=1 width=83) (actual time=858.035..858.035 rows=6 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Hash Join  (cost=70741.00..86888.88 rows=1 width=83) (actual time=665.355..858.004 rows=6 loops=2)
                                                   Hash Cond: (mi_idx1.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=70738.57..86886.45 rows=1 width=87) (actual time=665.235..857.881 rows=18 loops=2)
                                                         Hash Cond: (mi_idx2.movie_id = t2.id)
                                                         ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=273383 width=13) (actual time=0.020..213.962 rows=327480 loops=2)
                                                               Filter: ((info)::text < '3.0'::text)
                                                               Rows Removed by Filter: 362537
                                                         ->  Parallel Hash  (cost=70738.56..70738.56 rows=1 width=74) (actual time=610.131..610.132 rows=9 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=21387.24..70738.56 rows=1 width=74) (actual time=369.116..610.056 rows=9 loops=2)
                                                                     Hash Cond: (t2.id = ml.linked_movie_id)
                                                                     ->  Parallel Seq Scan on title t2  (cost=0.00..49166.29 rows=49337 width=25) (actual time=0.021..354.837 rows=59782 loops=2)
                                                                           Filter: (production_year = 2007)
                                                                           Rows Removed by Filter: 1204374
                                                                     ->  Parallel Hash  (cost=21387.06..21387.06 rows=15 width=49) (actual time=241.115..241.115 rows=590 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                           ->  Hash Join  (cost=14591.57..21387.06 rows=15 width=49) (actual time=145.641..240.610 rows=590 loops=2)
                                                                                 Hash Cond: (t1.kind_id = kt1.id)
                                                                                 ->  Merge Join  (cost=14590.47..21385.52 rows=102 width=53) (actual time=145.556..240.338 rows=716 loops=2)
                                                                                       Merge Cond: (t1.id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using title_pkey on title t1  (cost=0.43..87333.68 rows=1053463 width=25) (actual time=0.028..86.029 rows=81444 loops=2)
                                                                                       ->  Sort  (cost=14590.04..14590.65 rows=246 width=44) (actual time=144.263..144.362 rows=1431 loops=2)
                                                                                             Sort Key: ml.movie_id
                                                                                             Sort Method: quicksort  Memory: 213kB
                                                                                             Worker 0:  Sort Method: quicksort  Memory: 213kB
                                                                                             ->  Hash Join  (cost=6611.72..14580.27 rows=246 width=44) (actual time=60.773..143.164 rows=1431 loops=2)
                                                                                                   Hash Cond: (mc1.company_id = cn1.id)
                                                                                                   ->  Merge Join  (cost=651.94..8551.02 rows=26465 width=29) (actual time=10.025..88.923 rows=29022 loops=2)
                                                                                                         Merge Cond: (ml.movie_id = mc1.movie_id)
                                                                                                         ->  Merge Join  (cost=651.06..2920.55 rows=5051 width=21) (actual time=9.909..38.763 rows=6192 loops=2)
                                                                                                               Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                                                                                               ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.046..19.539 rows=63901 loops=2)
                                                                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=8) (actual time=9.830..10.353 rows=6443 loops=2)
                                                                                                                     Sort Key: ml.movie_id
                                                                                                                     Sort Method: quicksort  Memory: 205kB
                                                                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=8) (actual time=0.133..8.718 rows=2315 loops=2)
                                                                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.030..4.504 rows=29997 loops=2)
                                                                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.038..0.038 rows=2 loops=2)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.022..0.027 rows=2 loops=2)
                                                                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                                                       Rows Removed by Filter: 16
                                                                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..131550.35 rows=2609129 width=8) (actual time=0.026..33.787 rows=111067 loops=2)
                                                                                                   ->  Hash  (cost=5932.46..5932.46 rows=2185 width=23) (actual time=50.722..50.722 rows=2340 loops=2)
                                                                                                         Buckets: 4096  Batches: 1  Memory Usage: 160kB
                                                                                                         ->  Seq Scan on company_name cn1  (cost=0.00..5932.46 rows=2185 width=23) (actual time=0.043..49.186 rows=2340 loops=2)
                                                                                                               Filter: ((country_code)::text = '[nl]'::text)
                                                                                                               Rows Removed by Filter: 232657
                                                                                 ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.032..0.033 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=1 width=4) (actual time=0.021..0.023 rows=1 loops=2)
                                                                                             Filter: ((kind)::text = 'tv series'::text)
                                                                                             Rows Removed by Filter: 6
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.044 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=1 width=4) (actual time=0.027..0.029 rows=1 loops=1)
                           Filter: ((kind)::text = 'tv series'::text)
                           Rows Removed by Filter: 6
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 112.648 ms
 Execution Time: 1293.552 ms
(90 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33c.sql_explained.sql
SET
SET
                                                                                                                                       QUERY PLAN                                                                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=141754.28..141754.29 rows=1 width=192) (actual time=1598.020..1598.020 rows=1 loops=1)
   ->  Hash Join  (cost=133569.54..141754.26 rows=1 width=82) (actual time=1482.450..1597.888 rows=114 loops=1)
         Hash Cond: (t1.kind_id = kt1.id)
         ->  Merge Join  (cost=133568.42..141753.15 rows=1 width=86) (actual time=1482.323..1597.720 rows=114 loops=1)
               Merge Cond: (t1.id = ml.movie_id)
               ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=25) (actual time=0.024..119.474 rows=152917 loops=1)
               ->  Sort  (cost=133567.99..133568.00 rows=1 width=77) (actual time=1460.413..1460.424 rows=114 loops=1)
                     Sort Key: mc1.movie_id
                     Sort Method: quicksort  Memory: 42kB
                     ->  Hash Join  (cost=131373.01..133567.98 rows=1 width=77) (actual time=1448.020..1460.282 rows=114 loops=1)
                           Hash Cond: (mi_idx1.info_type_id = it1.id)
                           ->  Merge Join  (cost=131370.59..133565.36 rows=70 width=81) (actual time=1447.935..1460.147 rows=342 loops=1)
                                 Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                 ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.026..9.131 rows=50698 loops=1)
                                 ->  Sort  (cost=131370.16..131370.22 rows=23 width=68) (actual time=1445.443..1445.470 rows=347 loops=1)
                                       Sort Key: mc1.movie_id
                                       Sort Method: quicksort  Memory: 42kB
                                       ->  Gather  (cost=124052.14..131369.64 rows=23 width=68) (actual time=1414.994..1463.090 rows=121 loops=1)
                                             Workers Planned: 1
                                             Workers Launched: 1
                                             ->  Hash Join  (cost=123052.14..130367.34 rows=14 width=68) (actual time=1410.125..1438.350 rows=60 loops=2)
                                                   Hash Cond: (t2.kind_id = kt2.id)
                                                   ->  Parallel Hash Join  (cost=123051.03..130366.03 rows=47 width=72) (actual time=1409.065..1438.143 rows=70 loops=2)
                                                         Hash Cond: (cn2.id = mc2.company_id)
                                                         ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.006..15.585 rows=117498 loops=2)
                                                         ->  Parallel Hash  (cost=123050.62..123050.62 rows=33 width=57) (actual time=1408.439..1408.439 rows=70 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=89312.34..123050.62 rows=33 width=57) (actual time=1017.067..1408.338 rows=70 loops=2)
                                                                     Hash Cond: (mc2.movie_id = t2.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.007..230.944 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=89311.94..89311.94 rows=32 width=65) (actual time=1015.710..1015.710 rows=38 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=33182.88..89311.94 rows=32 width=65) (actual time=552.851..1015.585 rows=38 loops=2)
                                                                                 Hash Cond: (t2.id = ml.linked_movie_id)
                                                                                 ->  Parallel Seq Scan on title t2  (cost=0.00..51799.95 rows=432897 width=25) (actual time=0.035..411.212 rows=521400 loops=2)
                                                                                       Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                                                       Rows Removed by Filter: 742756
                                                                                 ->  Parallel Hash  (cost=33181.88..33181.88 rows=80 width=40) (actual time=548.182..548.182 rows=49 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Parallel Hash Join  (cost=26712.90..33181.88 rows=80 width=40) (actual time=476.088..547.912 rows=49 loops=2)
                                                                                             Hash Cond: (mc1.company_id = cn1.id)
                                                                                             ->  Hash Join  (cost=21066.29..27534.89 rows=149 width=25) (actual time=404.943..476.447 rows=63 loops=2)
                                                                                                   Hash Cond: (mi_idx2.info_type_id = it2.id)
                                                                                                   ->  Parallel Hash Join  (cost=21063.87..27486.73 rows=16791 width=29) (actual time=404.604..475.681 rows=6846 loops=2)
                                                                                                         Hash Cond: (ml.linked_movie_id = mi_idx2.movie_id)
                                                                                                         ->  Merge Join  (cost=869.16..5648.12 rows=10916 width=16) (actual time=9.084..37.891 rows=5049 loops=2)
                                                                                                               Merge Cond: (mc1.movie_id = ml.movie_id)
                                                                                                               ->  Parallel Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..116330.44 rows=1087137 width=8) (actual time=0.016..21.453 rows=49939 loops=2)
                                                                                                               ->  Sort  (cost=868.72..881.22 rows=5000 width=8) (actual time=8.956..9.359 rows=6226 loops=2)
                                                                                                                     Sort Key: ml.movie_id
                                                                                                                     Sort Method: quicksort  Memory: 205kB
                                                                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                                     ->  Hash Join  (cost=1.29..561.53 rows=5000 width=8) (actual time=0.072..7.993 rows=2315 loops=2)
                                                                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.028..3.896 rows=29997 loops=2)
                                                                                                                           ->  Hash  (cost=1.25..1.25 rows=3 width=4) (actual time=0.026..0.026 rows=2 loops=2)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.25 rows=3 width=4) (actual time=0.019..0.023 rows=2 loops=2)
                                                                                                                                       Filter: ((link)::text = ANY ('{sequel,follows,"followed by"}'::text[]))
                                                                                                                                       Rows Removed by Filter: 16
                                                                                                         ->  Parallel Hash  (cost=15122.68..15122.68 rows=291762 width=13) (actual time=353.627..353.628 rows=351960 loops=2)
                                                                                                               Buckets: 131072  Batches: 16  Memory Usage: 3328kB
                                                                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=291762 width=13) (actual time=0.029..228.584 rows=351960 loops=2)
                                                                                                                     Filter: ((info)::text < '3.5'::text)
                                                                                                                     Rows Removed by Filter: 338058
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=2)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.048..0.051 rows=1 loops=2)
                                                                                                               Filter: ((info)::text = 'rating'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=73895 width=23) (actual time=69.892..69.892 rows=63115 loops=2)
                                                                                                   Buckets: 131072  Batches: 1  Memory Usage: 8256kB
                                                                                                   ->  Parallel Seq Scan on company_name cn1  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.023..36.920 rows=63115 loops=2)
                                                                                                         Filter: ((country_code)::text <> '[us]'::text)
                                                                                                         Rows Removed by Filter: 54384
                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.062..0.062 rows=2 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=2 width=4) (actual time=0.041..0.043 rows=2 loops=2)
                                                               Filter: ((kind)::text = ANY ('{"tv series",episode}'::text[]))
                                                               Rows Removed by Filter: 5
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=1)
                                       Filter: ((info)::text = 'rating'::text)
                                       Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.046..0.047 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=2 width=4) (actual time=0.023..0.026 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{"tv series",episode}'::text[]))
                     Rows Removed by Filter: 5
 Planning Time: 109.982 ms
 Execution Time: 1616.916 ms
(92 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=389853.80..389853.81 rows=1 width=32) (actual time=2991.835..2991.835 rows=1 loops=1)
   ->  Gather  (cost=389853.58..389853.79 rows=2 width=32) (actual time=2991.586..2996.801 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=388853.58..388853.59 rows=1 width=32) (actual time=2985.370..2985.370 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=337023.30..388853.51 rows=30 width=17) (actual time=2798.869..2985.277 rows=69 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.009..266.359 rows=337640 loops=3)
                           Filter: (production_year > 2005)
                           Rows Removed by Filter: 505131
                     ->  Parallel Hash  (cost=337022.38..337022.38 rows=74 width=8) (actual time=2669.683..2669.683 rows=589 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=50880.48..337022.38 rows=74 width=8) (actual time=591.098..2669.117 rows=589 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..285615.00 rows=60182 width=4) (actual time=0.954..2071.830 rows=51299 loops=3)
                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                                       Rows Removed by Filter: 4893941
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=586.432..586.432 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.342..475.662 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..255.168 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.685..33.685 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.644..33.631 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.536 ms
 Execution Time: 2997.193 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3b.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=340923.67..340923.68 rows=1 width=32) (actual time=2076.133..2076.133 rows=1 loops=1)
   ->  Gather  (cost=340923.45..340923.66 rows=2 width=32) (actual time=2075.854..2081.357 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=339923.45..339923.46 rows=1 width=32) (actual time=2069.673..2069.673 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=290135.26..339923.45 rows=1 width=17) (actual time=2029.926..2069.646 rows=2 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.009..250.356 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=290135.24..290135.24 rows=1 width=8) (actual time=1801.577..1801.577 rows=7 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=50880.48..290135.24 rows=1 width=8) (actual time=691.550..1801.452 rows=7 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=158 width=4) (actual time=70.373..1206.351 rows=762 loops=3)
                                       Filter: ((info)::text = 'Bulgaria'::text)
                                       Rows Removed by Filter: 4944478
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=594.523..594.523 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.658..474.936 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..255.569 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.720..33.720 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.658..33.669 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.237 ms
 Execution Time: 2081.775 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=409155.23..409155.24 rows=1 width=32) (actual time=4107.037..4107.037 rows=1 loops=1)
   ->  Gather  (cost=409155.02..409155.23 rows=2 width=32) (actual time=4106.679..4112.500 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=408155.02..408155.03 rows=1 width=32) (actual time=4100.438..4100.439 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=354417.68..408154.42 rows=241 width=17) (actual time=3747.535..4099.111 rows=2417 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.009..282.046 rows=583011 loops=3)
                           Filter: (production_year > 1990)
                           Rows Removed by Filter: 259760
                     ->  Parallel Hash  (cost=354413.34..354413.34 rows=347 width=8) (actual time=3741.322..3741.322 rows=4054 loops=3)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                           ->  Parallel Hash Join  (cost=50880.48..354413.34 rows=347 width=8) (actual time=604.236..2851.709 rows=4054 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=4) (actual time=1.009..2217.685 rows=235558 loops=3)
                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                       Rows Removed by Filter: 4709682
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=599.314..599.314 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.516..472.991 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..253.991 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.525..33.525 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.641..33.471 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.505 ms
 Execution Time: 4112.890 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4a.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=118372.74..118372.75 rows=1 width=64) (actual time=1196.405..1196.406 rows=1 loops=1)
   ->  Gather  (cost=67607.95..118372.73 rows=2 width=22) (actual time=936.572..1201.308 rows=740 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=66607.95..117372.53 rows=1 width=22) (actual time=933.564..1189.248 rows=247 loops=3)
               Hash Cond: (t.id = mi_idx.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.009..265.058 rows=337640 loops=3)
                     Filter: (production_year > 2005)
                     Rows Removed by Filter: 505131
               ->  Parallel Hash  (cost=66607.92..66607.92 rows=2 width=13) (actual time=877.877..877.877 rows=1940 loops=3)
                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                     ->  Parallel Hash Join  (cost=50882.90..66607.92 rows=2 width=13) (actual time=607.906..802.035 rows=1940 loops=3)
                           Hash Cond: (mi_idx.movie_id = mk.movie_id)
                           ->  Hash Join  (cost=2.43..15720.19 rows=1934 width=9) (actual time=0.176..179.340 rows=117663 loops=3)
                                 Hash Cond: (mi_idx.info_type_id = it.id)
                                 ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=218500 width=13) (actual time=0.037..145.139 rows=174440 loops=3)
                                       Filter: ((info)::text > '5.0'::text)
                                       Rows Removed by Filter: 285572
                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.063..0.063 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.048 rows=1 loops=3)
                                             Filter: ((info)::text = 'rating'::text)
                                             Rows Removed by Filter: 112
                           ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=605.854..605.855 rows=4317 loops=3)
                                 Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                 ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.854..473.059 rows=4317 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..253.520 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.656..33.657 rows=30 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.664..33.603 rows=30 loops=3)
                                                   Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                   Rows Removed by Filter: 134140
 Planning Time: 3.980 ms
 Execution Time: 1202.236 ms
(35 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4b.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=116799.72..116799.73 rows=1 width=64) (actual time=881.200..881.201 rows=1 loops=1)
   ->  Gather  (cost=67011.42..116799.71 rows=1 width=22) (actual time=817.638..887.065 rows=6 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=66011.42..115799.61 rows=1 width=22) (actual time=816.947..874.868 rows=2 loops=3)
               Hash Cond: (t.id = mi_idx.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.011..250.101 rows=130555 loops=3)
                     Filter: (production_year > 2010)
                     Rows Removed by Filter: 712215
               ->  Parallel Hash  (cost=66011.41..66011.41 rows=1 width=13) (actual time=607.080..607.080 rows=7 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=17758.80..66011.41 rows=1 width=13) (actual time=285.850..606.947 rows=7 loops=3)
                           Hash Cond: (mk.movie_id = mi_idx.movie_id)
                           ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=35.639..477.975 rows=4317 loops=3)
                                 Hash Cond: (mk.keyword_id = k.id)
                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..256.788 rows=1507977 loops=3)
                                 ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=35.269..35.269 rows=30 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.677..35.221 rows=30 loops=3)
                                             Filter: ((keyword)::text ~~ '%sequel%'::text)
                                             Rows Removed by Filter: 134140
                           ->  Parallel Hash  (cost=15132.23..15132.23 rows=23 width=9) (actual time=127.930..127.930 rows=102 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Hash Join  (cost=2.43..15132.23 rows=23 width=9) (actual time=1.773..127.799 rows=102 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=2615 width=13) (actual time=0.115..126.766 rows=2794 loops=3)
                                             Filter: ((info)::text > '9.0'::text)
                                             Rows Removed by Filter: 457218
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.048 rows=1 loops=3)
                                                   Filter: ((info)::text = 'rating'::text)
                                                   Rows Removed by Filter: 112
 Planning Time: 3.989 ms
 Execution Time: 887.513 ms
(35 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=119900.33..119900.34 rows=1 width=64) (actual time=1248.136..1248.137 rows=1 loops=1)
   ->  Gather  (cost=119900.11..119900.32 rows=2 width=64) (actual time=1247.731..1254.152 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=118900.11..118900.12 rows=1 width=64) (actual time=1241.294..1241.295 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=66992.13..118900.10 rows=2 width=22) (actual time=878.303..1239.902 rows=1567 loops=3)
                     Hash Cond: (t.id = mi_idx.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.008..284.669 rows=583011 loops=3)
                           Filter: (production_year > 1990)
                           Rows Removed by Filter: 259760
                     ->  Parallel Hash  (cost=66992.09..66992.09 rows=3 width=13) (actual time=876.265..876.265 rows=2697 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 568kB
                           ->  Parallel Hash Join  (cost=50882.90..66992.09 rows=3 width=13) (actual time=607.939..829.360 rows=2697 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                 ->  Hash Join  (cost=2.43..16099.73 rows=3167 width=9) (actual time=0.170..202.862 rows=149656 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=357862 width=13) (actual time=0.035..153.686 rows=287152 loops=3)
                                             Filter: ((info)::text > '2.0'::text)
                                             Rows Removed by Filter: 172860
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.065 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.048 rows=1 loops=3)
                                                   Filter: ((info)::text = 'rating'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=605.728..605.728 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.968..476.122 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.021..256.820 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.631..33.631 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.665..33.579 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.944 ms
 Execution Time: 1254.639 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5a.sql_explained.sql
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=372724.06..372724.07 rows=1 width=32) (actual time=266.030..266.030 rows=1 loops=1)
   ->  Gather  (cost=372723.84..372724.05 rows=2 width=32) (actual time=265.807..268.414 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=371723.84..371723.85 rows=1 width=32) (actual time=259.175..259.176 rows=1 loops=3)
               ->  Hash Join  (cost=85882.87..371723.72 rows=48 width=17) (actual time=259.172..259.172 rows=0 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=85879.33..371720.05 rows=48 width=21) (actual time=258.830..258.830 rows=0 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..285615.00 rows=60182 width=8) (never executed)
                                 Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                           ->  Parallel Hash  (cost=85877.27..85877.27 rows=165 width=25) (actual time=258.428..258.428 rows=0 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                 ->  Parallel Hash Join  (cost=35112.01..85877.27 rows=165 width=25) (actual time=258.356..258.357 rows=0 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (never executed)
                                             Filter: (production_year > 2005)
                                       ->  Parallel Hash  (cost=35106.92..35106.92 rows=407 width=4) (actual time=258.315..258.315 rows=0 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                             ->  Hash Join  (cost=1.06..35106.92 rows=407 width=4) (actual time=258.281..258.282 rows=0 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=1629 width=8) (actual time=8.996..256.547 rows=8008 loops=3)
                                                         Filter: (((note)::text ~~ '%(theatrical)%'::text) AND ((note)::text ~~ '%(France)%'::text))
                                                         Rows Removed by Filter: 861701
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.097..0.097 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.034..0.048 rows=113 loops=3)
 Planning Time: 4.477 ms
 Execution Time: 268.842 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5b.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=328691.22..328691.23 rows=1 width=32) (actual time=247.877..247.877 rows=1 loops=1)
   ->  Gather  (cost=328691.00..328691.21 rows=2 width=32) (actual time=247.694..249.886 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=327691.00..327691.01 rows=1 width=32) (actual time=241.365..241.365 rows=1 loops=3)
               ->  Hash Join  (cost=87607.92..327691.00 rows=1 width=17) (actual time=241.361..241.361 rows=0 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=87604.38..327687.46 rows=1 width=21) (actual time=241.037..241.037 rows=0 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=221252 width=8) (never executed)
                                 Filter: ((info)::text = ANY ('{USA,America}'::text[]))
                           ->  Parallel Hash  (cost=87604.36..87604.36 rows=1 width=25) (actual time=240.663..240.663 rows=0 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                 ->  Parallel Hash Join  (cost=37816.17..87604.36 rows=1 width=25) (actual time=240.597..240.598 rows=0 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (never executed)
                                             Filter: (production_year > 2010)
                                       ->  Parallel Hash  (cost=37816.09..37816.09 rows=6 width=4) (actual time=240.555..240.555 rows=0 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                             ->  Hash Join  (cost=1.06..37816.09 rows=6 width=4) (actual time=240.529..240.530 rows=0 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=25 width=8) (actual time=9.734..240.198 rows=473 loops=3)
                                                         Filter: (((note)::text ~~ '%(VHS)%'::text) AND ((note)::text ~~ '%(USA)%'::text) AND ((note)::text ~~ '%(1994)%'::text))
                                                         Rows Removed by Filter: 869237
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.031..0.033 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.096..0.096 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.030..0.044 rows=113 loops=3)
 Planning Time: 4.381 ms
 Execution Time: 250.344 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5c.sql_explained.sql
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=391106.63..391106.64 rows=1 width=32) (actual time=3023.539..3023.539 rows=1 loops=1)
   ->  Gather  (cost=391106.42..391106.63 rows=2 width=32) (actual time=3023.138..3029.953 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=390106.42..390106.43 rows=1 width=32) (actual time=3016.605..3016.606 rows=1 loops=3)
               ->  Hash Join  (cost=87874.47..390061.87 rows=17818 width=17) (actual time=748.956..3016.358 rows=223 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=87870.93..390009.80 rows=17818 width=21) (actual time=748.613..3015.879 rows=223 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.070..2334.145 rows=235558 loops=3)
                                 Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                 Rows Removed by Filter: 4709682
                           ->  Parallel Hash  (cost=87706.73..87706.73 rows=13136 width=25) (actual time=653.685..653.685 rows=256 loops=3)
                                 Buckets: 32768  Batches: 1  Memory Usage: 352kB
                                 ->  Parallel Hash Join  (cost=35744.04..87706.73 rows=13136 width=25) (actual time=315.127..652.878 rows=256 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.017..290.170 rows=583011 loops=3)
                                             Filter: (production_year > 1990)
                                             Rows Removed by Filter: 259760
                                       ->  Parallel Hash  (cost=35507.44..35507.44 rows=18928 width=4) (actual time=298.907..298.907 rows=266 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 608kB
                                             ->  Hash Join  (cost=1.06..35507.44 rows=18928 width=4) (actual time=213.030..298.538 rows=266 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=75712 width=8) (actual time=0.027..288.151 rows=98543 loops=3)
                                                         Filter: (((note)::text !~~ '%(TV)%'::text) AND ((note)::text ~~ '%(USA)%'::text))
                                                         Rows Removed by Filter: 771167
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.096..0.096 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.032..0.046 rows=113 loops=3)
 Planning Time: 4.288 ms
 Execution Time: 3030.439 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=622340.59..622340.60 rows=1 width=96) (actual time=4946.985..4946.986 rows=1 loops=1)
   ->  Gather  (cost=622340.37..622340.58 rows=2 width=96) (actual time=4946.782..4952.419 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=621340.37..621340.38 rows=1 width=96) (actual time=4940.151..4940.151 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=571552.17..621340.36 rows=1 width=48) (actual time=4907.925..4940.116 rows=2 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.015..250.726 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=39) (actual time=4671.726..4671.726 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=39) (actual time=3542.544..4671.606 rows=2 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=813.504..4200.715 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.035..2235.005 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=500.046..500.046 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=202.537..499.940 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=470.736..470.736 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=102.103..470.662 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..265.247 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=22.961..22.961 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.526..22.940 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.710 ms
 Execution Time: 4952.999 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6b.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=622719.90..622719.91 rows=1 width=96) (actual time=5059.607..5059.607 rows=1 loops=1)
   ->  Gather  (cost=622719.67..622719.88 rows=2 width=96) (actual time=5059.003..5065.001 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=621719.67..621719.68 rows=1 width=96) (actual time=5052.499..5052.499 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=544400.32..621719.67 rows=1 width=48) (actual time=4902.477..5052.489 rows=4 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=201.254..501.278 rows=1 loops=3)
                           Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                           Rows Removed by Filter: 1389163
                     ->  Parallel Hash  (cost=544400.31..544400.31 rows=1 width=37) (actual time=4550.527..4550.527 rows=128 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=101052.25..544400.31 rows=1 width=37) (actual time=890.784..4550.254 rows=128 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=49166.44..492513.86 rows=167 width=29) (actual time=246.257..3997.039 rows=1033 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.033..2161.394 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=49166.29..49166.29 rows=12 width=21) (actual time=231.260..231.261 rows=146 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=12 width=21) (actual time=95.392..230.974 rows=146 loops=3)
                                                   Filter: (production_year > 2014)
                                                   Rows Removed by Filter: 842625
                                 ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=552.588..552.588 rows=11849 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                       ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.456..487.936 rows=11849 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.023..255.615 rows=1507977 loops=3)
                                             ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=44.128..44.128 rows=8 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.171..44.102 rows=8 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                         Rows Removed by Filter: 134162
 Planning Time: 4.728 ms
 Execution Time: 5065.482 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=621712.31..621712.32 rows=1 width=96) (actual time=5004.606..5004.606 rows=1 loops=1)
   ->  Gather  (cost=621712.09..621712.30 rows=2 width=96) (actual time=5004.376..5010.179 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=620712.09..620712.10 rows=1 width=96) (actual time=4998.032..4998.032 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=543392.73..620712.08 rows=1 width=48) (actual time=4849.316..4998.017 rows=1 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=199.463..496.873 rows=1 loops=3)
                           Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                           Rows Removed by Filter: 1389163
                     ->  Parallel Hash  (cost=543392.72..543392.72 rows=1 width=37) (actual time=4500.427..4500.427 rows=11 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=100044.67..543392.72 rows=1 width=37) (actual time=1213.609..4500.287 rows=11 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=49166.44..492513.86 rows=167 width=29) (actual time=254.336..4039.006 rows=1033 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.038..2200.107 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=49166.29..49166.29 rows=12 width=21) (actual time=233.447..233.448 rows=146 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=12 width=21) (actual time=82.898..233.139 rows=146 loops=3)
                                                   Filter: (production_year > 2014)
                                                   Rows Removed by Filter: 842625
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=461.033..461.033 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=99.261..460.972 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..256.745 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=21.741..21.741 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.506..21.720 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.308 ms
 Execution Time: 5010.767 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6d.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=624885.62..624885.63 rows=1 width=96) (actual time=4921.044..4921.044 rows=1 loops=1)
   ->  Gather  (cost=624885.39..624885.60 rows=2 width=96) (actual time=4920.546..4926.665 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=623885.39..623885.40 rows=1 width=96) (actual time=4914.015..4914.015 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=572559.75..623885.39 rows=1 width=48) (actual time=4768.590..4913.950 rows=29 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.009..267.028 rows=460484 loops=3)
                           Filter: (production_year > 2000)
                           Rows Removed by Filter: 382286
                     ->  Parallel Hash  (cost=572559.74..572559.74 rows=1 width=39) (actual time=4598.528..4598.528 rows=37 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=129206.67..572559.74 rows=1 width=39) (actual time=1343.036..4598.356 rows=37 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=788.198..4043.417 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.029..2094.083 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=486.437..486.437 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=195.232..486.389 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=554.720..554.720 rows=11849 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                       ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.107..487.598 rows=11849 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..254.791 rows=1507977 loops=3)
                                             ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=43.929..43.929 rows=8 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.171..43.904 rows=8 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                         Rows Removed by Filter: 134162
 Planning Time: 4.578 ms
 Execution Time: 4927.152 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6e.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=623878.03..623878.04 rows=1 width=96) (actual time=5035.643..5035.643 rows=1 loops=1)
   ->  Gather  (cost=623877.81..623878.02 rows=2 width=96) (actual time=5035.383..5042.648 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=622877.81..622877.82 rows=1 width=96) (actual time=5028.609..5028.609 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=571552.17..622877.80 rows=1 width=48) (actual time=4998.275..5028.571 rows=2 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.014..279.925 rows=460484 loops=3)
                           Filter: (production_year > 2000)
                           Rows Removed by Filter: 382286
                     ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=39) (actual time=4701.573..4701.573 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=39) (actual time=3563.037..4701.453 rows=2 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=822.014..4237.261 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.037..2263.318 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=506.436..506.436 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=203.343..506.339 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=464.089..464.089 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=159.208..464.019 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.023..259.521 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=22.205..22.205 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.513..22.183 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.280 ms
 Execution Time: 5043.212 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6f.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=652048.60..652048.61 rows=1 width=96) (actual time=7193.649..7193.649 rows=1 loops=1)
   ->  Gather  (cost=652048.38..652048.59 rows=2 width=96) (actual time=7189.856..7329.980 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=651048.38..651048.39 rows=1 width=96) (actual time=7183.019..7183.020 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=565020.96..651031.37 rows=2268 width=48) (actual time=6553.277..7074.823 rows=261826 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.066..402.680 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=564992.61..564992.61 rows=2268 width=37) (actual time=5609.524..5609.525 rows=261826 loops=3)
                           Buckets: 65536 (originally 8192)  Batches: 16 (originally 1)  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=104652.02..564992.61 rows=2268 width=37) (actual time=999.038..5326.301 rows=261826 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.047..2323.989 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=104651.25..104651.25 rows=62 width=41) (actual time=998.868..998.868 rows=4722 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1304kB
                                       ->  Parallel Hash Join  (cost=51885.81..104651.25 rows=62 width=41) (actual time=592.025..939.310 rows=4722 loops=3)
                                             Hash Cond: (t.id = mk.movie_id)
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.013..281.347 rows=460484 loops=3)
                                                   Filter: (production_year > 2000)
                                                   Rows Removed by Filter: 382286
                                             ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=591.785..591.785 rows=11849 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                                   ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=45.206..490.771 rows=11849 loops=3)
                                                         Hash Cond: (mk.keyword_id = k.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.022..258.165 rows=1507977 loops=3)
                                                         ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=44.758..44.759 rows=8 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.175..44.732 rows=8 loops=3)
                                                                     Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                                     Rows Removed by Filter: 134162
 Planning Time: 4.618 ms
 Execution Time: 7330.473 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7a.sql_explained.sql
SET
SET
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=693399.56..693399.57 rows=1 width=64) (actual time=8121.929..8121.929 rows=1 loops=1)
   ->  Gather  (cost=693399.34..693399.55 rows=2 width=64) (actual time=8121.615..8128.611 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=692399.34..692399.35 rows=1 width=64) (actual time=8114.188..8114.188 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=675186.31..692399.33 rows=1 width=32) (actual time=8027.511..8114.168 rows=11 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..16090.49 rows=299338 width=4) (actual time=0.035..121.915 rows=224897 loops=3)
                           Filter: ((name)::text ~~ '%a%'::text)
                           Rows Removed by Filter: 75550
                     ->  Parallel Hash  (cost=675186.30..675186.30 rows=1 width=44) (actual time=7969.686..7969.686 rows=5 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Hash Join  (cost=622849.52..675186.30 rows=1 width=44) (actual time=7928.576..7969.570 rows=5 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=622267.21..674603.97 rows=1 width=52) (actual time=7667.325..7958.372 rows=130 loops=3)
                                       Hash Cond: (t.id = ci.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=143147 width=21) (actual time=0.031..273.348 rows=113395 loops=3)
                                             Filter: ((production_year >= 1980) AND (production_year <= 1995))
                                             Rows Removed by Filter: 729375
                                       ->  Parallel Hash  (cost=622267.19..622267.19 rows=1 width=31) (actual time=7665.587..7665.587 rows=890 loops=3)
                                             Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                             ->  Parallel Hash Join  (cost=161930.27..622267.19 rows=1 width=31) (actual time=1101.507..4774.199 rows=890 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.034..2225.293 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=161930.25..161930.25 rows=1 width=23) (actual time=1066.050..1066.050 rows=6 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=66488.22..161930.25 rows=1 width=23) (actual time=347.099..1065.950 rows=6 loops=3)
                                                               Hash Cond: (n.id = pi.person_id)
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..94683.23 rows=202346 width=19) (actual time=0.057..730.444 rows=181097 loops=3)
                                                                     Filter: (((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'B%'::text))))
                                                                     Rows Removed by Filter: 1208067
                                                               ->  Parallel Hash  (cost=66488.21..66488.21 rows=1 width=4) (actual time=315.846..315.846 rows=21 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Hash Join  (cost=2.43..66488.21 rows=1 width=4) (actual time=9.114..315.773 rows=21 loops=3)
                                                                           Hash Cond: (pi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on person_info pi  (cost=0.00..66485.75 rows=12 width=8) (actual time=8.990..315.621 rows=21 loops=3)
                                                                                 Filter: ((note)::text = 'Volker Boehm'::text)
                                                                                 Rows Removed by Filter: 987867
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.065 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.053 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'mini biography'::text)
                                                                                       Rows Removed by Filter: 112
                                 ->  Hash  (cost=561.48..561.48 rows=1666 width=4) (actual time=11.076..11.076 rows=5186 loops=3)
                                       Buckets: 8192 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 247kB
                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=4) (actual time=0.187..9.343 rows=5186 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.038..4.713 rows=29997 loops=3)
                                             ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.067..0.068 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=3)
                                                         Filter: ((link)::text = 'features'::text)
                                                         Rows Removed by Filter: 17
 Planning Time: 14.593 ms
 Execution Time: 8129.393 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7b.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=663974.41..663974.42 rows=1 width=64) (actual time=5167.948..5167.948 rows=1 loops=1)
   ->  Gather  (cost=663974.19..663974.40 rows=2 width=64) (actual time=5166.516..5173.370 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=662974.19..662974.20 rows=1 width=64) (actual time=5159.563..5159.564 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=645761.16..662974.18 rows=1 width=32) (actual time=5113.811..5159.541 rows=5 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..16090.49 rows=299338 width=4) (actual time=0.052..115.688 rows=224897 loops=3)
                           Filter: ((name)::text ~~ '%a%'::text)
                           Rows Removed by Filter: 75550
                     ->  Parallel Hash  (cost=645761.15..645761.15 rows=1 width=44) (actual time=5021.284..5021.284 rows=3 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Hash Join  (cost=201453.00..645761.15 rows=1 width=44) (actual time=4343.035..5021.033 rows=3 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=200870.69..645178.82 rows=1 width=52) (actual time=2699.466..5010.183 rows=7 loops=3)
                                       Hash Cond: (n.id = pi.person_id)
                                       ->  Parallel Hash Join  (cost=134382.47..578648.77 rows=11153 width=48) (actual time=1024.400..4691.549 rows=11015 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Hash Join  (cost=82162.96..525510.35 rows=350058 width=27) (actual time=473.336..4353.729 rows=304108 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.029..2186.602 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=40251 width=19) (actual time=472.454..472.455 rows=30659 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 6080kB
                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40251 width=19) (actual time=0.134..450.068 rows=30659 loops=3)
                                                               Filter: (((name_pcode_cf)::text ~~ 'D%'::text) AND ((gender)::text = 'm'::text))
                                                               Rows Removed by Filter: 1358505
                                             ->  Parallel Hash  (cost=51799.95..51799.95 rows=33565 width=21) (actual time=279.021..279.021 rows=25355 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 5344kB
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=33565 width=21) (actual time=0.027..255.418 rows=25355 loops=3)
                                                         Filter: ((production_year >= 1980) AND (production_year <= 1984))
                                                         Rows Removed by Filter: 817416
                                       ->  Parallel Hash  (cost=66488.21..66488.21 rows=1 width=4) (actual time=317.252..317.252 rows=21 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=2.43..66488.21 rows=1 width=4) (actual time=6.400..317.175 rows=21 loops=3)
                                                   Hash Cond: (pi.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on person_info pi  (cost=0.00..66485.75 rows=12 width=8) (actual time=6.280..317.028 rows=21 loops=3)
                                                         Filter: ((note)::text = 'Volker Boehm'::text)
                                                         Rows Removed by Filter: 987867
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.050 rows=1 loops=3)
                                                               Filter: ((info)::text = 'mini biography'::text)
                                                               Rows Removed by Filter: 112
                                 ->  Hash  (cost=561.48..561.48 rows=1666 width=4) (actual time=10.792..10.793 rows=5186 loops=3)
                                       Buckets: 8192 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 247kB
                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=4) (actual time=0.165..9.141 rows=5186 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.036..4.530 rows=29997 loops=3)
                                             ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.028..0.031 rows=1 loops=3)
                                                         Filter: ((link)::text = 'features'::text)
                                                         Rows Removed by Filter: 17
 Planning Time: 14.243 ms
 Execution Time: 5174.082 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7c.sql_explained.sql
SET
SET
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=697422.31..697422.32 rows=1 width=64) (actual time=8775.374..8775.374 rows=1 loops=1)
   ->  Gather  (cost=697422.09..697422.30 rows=2 width=64) (actual time=8769.061..9443.112 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=696422.09..696422.10 rows=1 width=64) (actual time=8762.164..8762.164 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=678258.59..696422.08 rows=2 width=109) (actual time=8561.184..8634.239 rows=22728 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..17029.39 rows=302423 width=4) (actual time=0.043..125.375 rows=228698 loops=3)
                           Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%a%'::text) OR ((name)::text ~~ 'A%'::text)))
                           Rows Removed by Filter: 71749
                     ->  Parallel Hash  (cost=678258.58..678258.58 rows=1 width=121) (actual time=8351.352..8351.352 rows=13386 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 2592kB
                           ->  Hash Join  (cost=624016.03..678258.58 rows=1 width=121) (actual time=7614.361..8268.435 rows=13386 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=623371.14..677606.36 rows=189 width=129) (actual time=7595.444..8219.749 rows=176455 loops=3)
                                       Hash Cond: (t.id = ci.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=649194 width=4) (actual time=0.025..292.726 rows=518532 loops=3)
                                             Filter: ((production_year >= 1980) AND (production_year <= 2010))
                                             Rows Removed by Filter: 324238
                                       ->  Parallel Hash  (cost=623367.30..623367.30 rows=307 width=125) (actual time=7042.785..7042.785 rows=305764 loops=3)
                                             Buckets: 8192 (originally 1024)  Batches: 256 (originally 1)  Memory Usage: 3232kB
                                             ->  Parallel Hash Join  (cost=163029.14..623367.30 rows=307 width=125) (actual time=1309.454..5210.494 rows=305764 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.047..2177.363 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=163028.71..163028.71 rows=35 width=117) (actual time=1309.003..1309.003 rows=4354 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 11384kB
                                                         ->  Parallel Hash Join  (cost=98354.03..163028.71 rows=35 width=117) (actual time=1204.528..1272.065 rows=4354 loops=3)
                                                               Hash Cond: (pi.person_id = n.id)
                                                               ->  Hash Join  (cost=2.43..63495.30 rows=306 width=98) (actual time=0.104..342.972 rows=28061 loops=3)
                                                                     Hash Cond: (pi.info_type_id = it.id)
                                                                     ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=34617 width=102) (actual time=0.042..325.072 rows=28061 loops=3)
                                                                           Filter: (note IS NOT NULL)
                                                                           Rows Removed by Filter: 959827
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.050 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.047 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'mini biography'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=94683.23..94683.23 rows=199790 width=19) (actual time=773.071..773.071 rows=169207 loops=3)
                                                                     Buckets: 65536  Batches: 8  Memory Usage: 4032kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..94683.23 rows=199790 width=19) (actual time=0.073..710.841 rows=169207 loops=3)
                                                                           Filter: (((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'A%'::text))))
                                                                           Rows Removed by Filter: 1219957
                                 ->  Hash  (cost=561.57..561.57 rows=6666 width=4) (actual time=18.292..18.292 rows=21505 loops=3)
                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 1013kB
                                       ->  Hash Join  (cost=1.32..561.57 rows=6666 width=4) (actual time=0.146..11.608 rows=21505 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.036..4.743 rows=29997 loops=3)
                                             ->  Hash  (cost=1.27..1.27 rows=4 width=4) (actual time=0.058..0.058 rows=4 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.27 rows=4 width=4) (actual time=0.028..0.033 rows=4 loops=3)
                                                         Filter: ((link)::text = ANY ('{references,"referenced in",features,"featured in"}'::text[]))
                                                         Rows Removed by Filter: 14
 Planning Time: 14.446 ms
 Execution Time: 9444.059 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8a.sql_explained.sql
SET
SET
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=631023.55..631023.56 rows=1 width=64) (actual time=3777.538..3777.538 rows=1 loops=1)
   ->  Gather  (cost=631023.33..631023.54 rows=2 width=64) (actual time=3776.688..3784.923 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=630023.33..630023.34 rows=1 width=64) (actual time=3769.597..3769.597 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=579540.20..630023.33 rows=1 width=33) (actual time=3555.898..3769.526 rows=21 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.007..224.801 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=579540.18..579540.18 rows=1 width=24) (actual time=3441.146..3441.146 rows=21 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=563388.51..579540.18 rows=1 width=24) (actual time=3410.149..3440.994 rows=21 loops=3)
                                 Hash Cond: (an1.person_id = ci.person_id)
                                 ->  Parallel Hash Join  (cost=81879.04..98016.48 rows=3793 width=24) (actual time=510.930..633.937 rows=1344 loops=3)
                                       Hash Cond: (an1.person_id = n1.id)
                                       ->  Parallel Seq Scan on aka_name an1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.035..78.868 rows=300448 loops=3)
                                       ->  Parallel Hash  (cost=81659.82..81659.82 rows=17538 width=4) (actual time=509.897..509.897 rows=6970 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 1376kB
                                             ->  Parallel Seq Scan on name n1  (cost=0.00..81659.82 rows=17538 width=4) (actual time=0.316..503.403 rows=6970 loops=3)
                                                   Filter: (((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))
                                                   Rows Removed by Filter: 1382193
                                 ->  Parallel Hash  (cost=481509.44..481509.44 rows=2 width=12) (actual time=2806.632..2806.632 rows=2479 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 504kB
                                       ->  Hash Join  (cost=39896.72..481509.44 rows=2 width=12) (actual time=1124.498..2718.690 rows=2479 loops=3)
                                             Hash Cond: (ci.role_id = rt.id)
                                             ->  Parallel Hash Join  (cost=39895.56..481508.19 rows=25 width=16) (actual time=311.129..2717.149 rows=6533 loops=3)
                                                   Hash Cond: (ci.movie_id = mc.movie_id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=40775 width=12) (actual time=1.073..2397.452 rows=31032 loops=3)
                                                         Filter: ((note)::text = '(voice: English version)'::text)
                                                         Rows Removed by Filter: 12050416
                                                   ->  Parallel Hash  (cost=39892.48..39892.48 rows=246 width=4) (actual time=309.678..309.678 rows=16109 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2968kB
                                                         ->  Parallel Hash Join  (cost=4773.19..39892.48 rows=246 width=4) (actual time=24.916..275.264 rows=16109 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=8470 width=8) (actual time=0.063..243.858 rows=16299 loops=3)
                                                                     Filter: (((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text))
                                                                     Rows Removed by Filter: 853411
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=4022 width=4) (actual time=24.713..24.713 rows=2251 loops=3)
                                                                     Buckets: 8192  Batches: 1  Memory Usage: 352kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=4022 width=4) (actual time=0.033..23.152 rows=2251 loops=3)
                                                                           Filter: ((country_code)::text = '[jp]'::text)
                                                                           Rows Removed by Filter: 76082
                                             ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.045..0.047 rows=1 loops=3)
                                                         Filter: ((role)::text = 'actress'::text)
                                                         Rows Removed by Filter: 11
 Planning Time: 9.168 ms
 Execution Time: 3785.564 ms
(48 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8b.sql_explained.sql
SET
SET
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=642938.22..642938.23 rows=1 width=64) (actual time=5143.398..5143.398 rows=1 loops=1)
   ->  Gather  (cost=642938.11..642938.22 rows=1 width=64) (actual time=5143.090..5148.473 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=641938.11..641938.12 rows=1 width=64) (actual time=5137.705..5137.705 rows=1 loops=2)
               ->  Hash Join  (cost=637200.09..641938.10 rows=1 width=33) (actual time=5119.275..5137.668 rows=3 loops=2)
                     Hash Cond: (ci.role_id = rt.id)
                     ->  Parallel Hash Join  (cost=637198.93..641936.94 rows=1 width=37) (actual time=5119.037..5137.428 rows=3 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=4022 width=4) (actual time=0.014..21.880 rows=3376 loops=2)
                                 Filter: ((country_code)::text = '[jp]'::text)
                                 Rows Removed by Filter: 114122
                           ->  Parallel Hash  (cost=637198.91..637198.91 rows=1 width=41) (actual time=5114.657..5114.657 rows=3 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                 ->  Parallel Hash Join  (cost=596664.89..637198.91 rows=1 width=41) (actual time=4992.877..5114.586 rows=3 loops=2)
                                       Hash Cond: (mc.movie_id = ci.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..40532.74 rows=338 width=8) (actual time=0.079..358.282 rows=4284 loops=2)
                                             Filter: (((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text) AND (((note)::text ~~ '%(2006)%'::text) OR ((note)::text ~~ '%(2007)%'::text)))
                                             Rows Removed by Filter: 1300280
                                       ->  Parallel Hash  (cost=596664.88..596664.88 rows=1 width=45) (actual time=4755.260..4755.260 rows=4 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=580513.21..596664.88 rows=1 width=45) (actual time=4717.265..4755.182 rows=4 loops=2)
                                                   Hash Cond: (an.person_id = ci.person_id)
                                                   ->  Parallel Hash Join  (cost=81879.04..98016.48 rows=3793 width=24) (actual time=742.154..915.633 rows=2016 loops=2)
                                                         Hash Cond: (an.person_id = n.id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.021..108.361 rows=450672 loops=2)
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=17538 width=4) (actual time=741.308..741.309 rows=10456 loops=2)
                                                               Buckets: 65536  Batches: 1  Memory Usage: 1376kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=17538 width=4) (actual time=0.305..732.994 rows=10456 loops=2)
                                                                     Filter: (((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))
                                                                     Rows Removed by Filter: 2073290
                                                   ->  Parallel Hash  (cost=498634.15..498634.15 rows=1 width=33) (actual time=3839.207..3839.207 rows=113 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                         ->  Parallel Hash Join  (cost=57067.49..498634.15 rows=1 width=33) (actual time=428.463..3839.022 rows=113 loops=2)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=40775 width=12) (actual time=0.857..3448.684 rows=46548 loops=2)
                                                                     Filter: ((note)::text = '(voice: English version)'::text)
                                                                     Rows Removed by Filter: 18075624
                                                               ->  Parallel Hash  (cost=57067.27..57067.27 rows=18 width=21) (actual time=383.605..383.605 rows=4 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=18 width=21) (actual time=287.061..383.541 rows=4 loops=2)
                                                                           Filter: ((production_year >= 2006) AND (production_year <= 2007) AND (((title)::text ~~ 'One Piece%'::text) OR ((title)::text ~~ 'Dragon Ball Z%'::text)))
                                                                           Rows Removed by Filter: 1264152
                     ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.032..0.035 rows=1 loops=2)
                                 Filter: ((role)::text = 'actress'::text)
                                 Rows Removed by Filter: 11
 Planning Time: 9.376 ms
 Execution Time: 5149.148 ms
(50 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8c.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=767932.80..767932.81 rows=1 width=64) (actual time=8347.518..8347.518 rows=1 loops=1)
   ->  Gather  (cost=767932.58..767932.79 rows=2 width=64) (actual time=8342.872..8509.320 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=766932.58..766932.59 rows=1 width=64) (actual time=8335.955..8335.955 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=243772.58..752972.57 rows=2792002 width=33) (actual time=7817.269..8102.773 rows=829204 loops=3)
                     Hash Cond: (ci.person_id = a1.person_id)
                     ->  Parallel Hash Join  (cost=118006.90..594573.48 rows=1215217 width=21) (actual time=5844.129..6155.008 rows=656886 loops=3)
                           Hash Cond: (ci.movie_id = t.id)
                           ->  Hash Join  (cost=1.16..457349.15 rows=1258484 width=8) (actual time=2636.502..4085.246 rows=909648 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.037..2283.604 rows=12081448 loops=3)
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=3)
                                             Filter: ((role)::text = 'writer'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=110366.87..110366.87 rows=395029 width=25) (actual time=1504.256..1504.256 rows=384599 loops=3)
                                 Buckets: 65536  Batches: 32  Memory Usage: 2784kB
                                 ->  Parallel Hash Join  (cost=44347.81..110366.87 rows=395029 width=25) (actual time=1070.946..1368.952 rows=384599 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.026..271.935 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=37865.94..37865.94 rows=395029 width=4) (actual time=522.191..522.191 rows=384599 loops=3)
                                             Buckets: 131072  Batches: 16  Memory Usage: 3904kB
                                             ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=4) (actual time=42.819..412.045 rows=384599 loops=3)
                                                   Hash Cond: (mc.company_id = cn.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.013..168.379 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=42.081..42.081 rows=28281 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.043..25.131 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                     ->  Parallel Hash  (cost=118870.18..118870.18 rows=375560 width=24) (actual time=1448.730..1448.730 rows=300448 loops=3)
                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=22047.10..118870.18 rows=375560 width=24) (actual time=976.083..1346.183 rows=300448 loops=3)
                                 Hash Cond: (n1.id = a1.person_id)
                                 ->  Parallel Seq Scan on name n1  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.060..430.941 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=15151.60..15151.60 rows=375560 width=20) (actual time=193.282..193.282 rows=300448 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 3680kB
                                       ->  Parallel Seq Scan on aka_name a1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.057..92.298 rows=300448 loops=3)
 Planning Time: 8.699 ms
 Execution Time: 8510.016 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8d.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=767932.80..767932.81 rows=1 width=64) (actual time=7274.055..7274.055 rows=1 loops=1)
   ->  Gather  (cost=767932.58..767932.79 rows=2 width=64) (actual time=7270.178..7407.211 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=766932.58..766932.59 rows=1 width=64) (actual time=7263.356..7263.356 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=243772.58..752972.57 rows=2792002 width=33) (actual time=7155.701..7232.629 rows=107668 loops=3)
                     Hash Cond: (ci.person_id = an1.person_id)
                     ->  Parallel Hash Join  (cost=118006.90..594573.48 rows=1215217 width=21) (actual time=5517.370..5651.483 rows=95179 loops=3)
                           Hash Cond: (ci.movie_id = t.id)
                           ->  Hash Join  (cost=1.16..457349.15 rows=1258484 width=8) (actual time=3112.644..3968.680 rows=92134 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.038..2278.957 rows=12081448 loops=3)
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.033..0.035 rows=1 loops=3)
                                             Filter: ((role)::text = 'costume designer'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=110366.87..110366.87 rows=395029 width=25) (actual time=1509.216..1509.216 rows=384599 loops=3)
                                 Buckets: 65536  Batches: 32  Memory Usage: 2784kB
                                 ->  Parallel Hash Join  (cost=44347.81..110366.87 rows=395029 width=25) (actual time=1085.523..1375.468 rows=384599 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.026..267.689 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=37865.94..37865.94 rows=395029 width=4) (actual time=529.739..529.740 rows=384599 loops=3)
                                             Buckets: 131072  Batches: 16  Memory Usage: 3872kB
                                             ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=4) (actual time=42.904..416.261 rows=384599 loops=3)
                                                   Hash Cond: (mc.company_id = cn.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.011..172.289 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=41.910..41.911 rows=28281 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.040..24.769 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                     ->  Parallel Hash  (cost=118870.18..118870.18 rows=375560 width=24) (actual time=1445.470..1445.470 rows=300448 loops=3)
                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=22047.10..118870.18 rows=375560 width=24) (actual time=981.427..1342.517 rows=300448 loops=3)
                                 Hash Cond: (n1.id = an1.person_id)
                                 ->  Parallel Seq Scan on name n1  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.065..434.596 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=15151.60..15151.60 rows=375560 width=20) (actual time=193.958..193.958 rows=300448 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 3680kB
                                       ->  Parallel Seq Scan on aka_name an1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.047..93.288 rows=300448 loops=3)
 Planning Time: 8.768 ms
 Execution Time: 7407.895 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9a.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=727877.31..727877.32 rows=1 width=96) (actual time=4603.317..4603.317 rows=1 loops=1)
   ->  Gather  (cost=674329.47..727877.30 rows=1 width=49) (actual time=4551.201..4609.680 rows=121 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=673329.47..726877.20 rows=1 width=49) (actual time=4393.831..4596.129 rows=40 loops=3)
               Hash Cond: (t.id = ci.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=466073 width=21) (actual time=0.016..269.124 rows=369296 loops=3)
                     Filter: ((production_year >= 2005) AND (production_year <= 2015))
                     Rows Removed by Filter: 473475
               ->  Parallel Hash  (cost=673329.45..673329.45 rows=1 width=40) (actual time=4285.352..4285.352 rows=114 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=668418.17..673329.45 rows=1 width=40) (actual time=4262.071..4285.179 rows=114 loops=3)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.016..20.316 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
                           ->  Parallel Hash  (cost=668418.15..668418.15 rows=1 width=44) (actual time=4261.723..4261.723 rows=116 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=613978.62..668418.15 rows=1 width=44) (actual time=3886.519..4261.613 rows=116 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.039..245.312 rows=1046780 loops=3)
                                       ->  Parallel Hash  (cost=613978.60..613978.60 rows=1 width=32) (actual time=3884.716..3884.716 rows=124 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=578389.44..613978.60 rows=1 width=32) (actual time=3585.542..3884.579 rows=124 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=131225 width=8) (actual time=0.030..287.678 rows=196998 loops=3)
                                                         Filter: ((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                                         Rows Removed by Filter: 672712
                                                   ->  Parallel Hash  (cost=578389.42..578389.42 rows=2 width=24) (actual time=3575.498..3575.498 rows=142 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Hash Join  (cost=97799.03..578389.42 rows=2 width=24) (actual time=1622.323..3575.375 rows=142 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Hash Join  (cost=97797.87..578388.18 rows=19 width=28) (actual time=1622.207..3575.212 rows=142 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.098..2835.050 rows=289159 loops=3)
                                                                           Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                           Rows Removed by Filter: 11792289
                                                                     ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=24) (actual time=698.156..698.157 rows=519 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=24) (actual time=580.981..697.653 rows=519 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.036..72.662 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=4) (actual time=579.463..579.463 rows=2256 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=4) (actual time=215.420..509.192 rows=2256 loops=3)
                                                                                             Filter: (((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1386908
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.040..0.043 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actress'::text)
                                                                           Rows Removed by Filter: 11
 Planning Time: 16.284 ms
 Execution Time: 4610.464 ms
(54 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9b.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=691306.83..691306.84 rows=1 width=128) (actual time=4464.209..4464.209 rows=1 loops=1)
   ->  Gather  (cost=638698.30..691306.82 rows=1 width=64) (actual time=4224.698..4472.264 rows=40 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=637698.30..690306.72 rows=1 width=64) (actual time=4289.963..4456.637 rows=13 loops=3)
               Hash Cond: (t.id = ci.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=215591 width=21) (actual time=0.019..261.232 rows=170942 loops=3)
                     Filter: ((production_year >= 2007) AND (production_year <= 2010))
                     Rows Removed by Filter: 671829
               ->  Parallel Hash  (cost=637698.28..637698.28 rows=1 width=55) (actual time=4173.891..4173.891 rows=31 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=632787.00..637698.28 rows=1 width=55) (actual time=4149.605..4173.775 rows=31 loops=3)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.017..21.733 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
                           ->  Parallel Hash  (cost=632786.98..632786.98 rows=1 width=59) (actual time=4149.033..4149.033 rows=31 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=594815.82..632786.98 rows=1 width=59) (actual time=3901.966..4148.934 rows=31 loops=3)
                                       Hash Cond: (mc.movie_id = ci.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=41669 width=8) (actual time=0.022..274.606 rows=66173 loops=3)
                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                             Rows Removed by Filter: 803537
                                       ->  Parallel Hash  (cost=594815.80..594815.80 rows=1 width=51) (actual time=3866.080..3866.080 rows=79 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=540376.27..594815.80 rows=1 width=51) (actual time=3476.516..3865.945 rows=79 loops=3)
                                                   Hash Cond: (chn.id = ci.person_role_id)
                                                   ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.056..260.750 rows=1046780 loops=3)
                                                   ->  Parallel Hash  (cost=540376.25..540376.25 rows=1 width=39) (actual time=3474.652..3474.652 rows=88 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Hash Join  (cost=97799.03..540376.25 rows=1 width=39) (actual time=1853.600..3474.506 rows=88 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Hash Join  (cost=97797.87..540375.04 rows=15 width=43) (actual time=1853.485..3474.361 rows=88 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=298009 width=16) (actual time=0.069..2450.196 rows=237943 loops=3)
                                                                           Filter: ((note)::text = '(voice)'::text)
                                                                           Rows Removed by Filter: 11843505
                                                                     ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=39) (actual time=989.164..989.164 rows=432 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                           ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=39) (actual time=866.707..988.676 rows=432 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.051..78.855 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=864.942..864.942 rows=1803 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 504kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=216.313..493.785 rows=1803 loops=3)
                                                                                             Filter: (((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1387361
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.062..0.063 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.039..0.041 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actress'::text)
                                                                           Rows Removed by Filter: 11
 Planning Time: 15.597 ms
 Execution Time: 4473.046 ms
(54 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9c.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=750479.65..750479.66 rows=1 width=128) (actual time=5135.407..5135.407 rows=1 loops=1)
   ->  Gather  (cost=750479.42..750479.63 rows=2 width=128) (actual time=5131.600..5208.996 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=749479.42..749479.43 rows=1 width=128) (actual time=5124.493..5124.493 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=732915.55..749475.64 rows=378 width=64) (actual time=5009.568..5123.072 rows=2715 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.037..72.146 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=732913.48..732913.48 rows=165 width=56) (actual time=5006.806..5006.806 rows=1501 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=682429.67..732913.48 rows=165 width=56) (actual time=4645.807..4987.988 rows=1501 loops=3)
                                 Hash Cond: (t.id = ci.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.007..218.801 rows=842771 loops=3)
                                 ->  Parallel Hash  (cost=682427.61..682427.61 rows=165 width=47) (actual time=4644.243..4644.244 rows=1501 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                       ->  Parallel Hash Join  (cost=648686.41..682427.61 rows=165 width=47) (actual time=4333.316..4614.744 rows=1501 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=643335.63..677075.64 rows=453 width=51) (actual time=4293.128..4573.001 rows=4128 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.020..155.696 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=643333.50..643333.50 rows=170 width=43) (actual time=4292.020..4292.020 rows=1895 loops=3)
                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 600kB
                                                         ->  Parallel Hash Join  (cost=155467.08..643333.50 rows=170 width=43) (actual time=4028.935..4234.335 rows=1895 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Hash Join  (cost=81911.39..562103.89 rows=353 width=31) (actual time=1421.258..3339.430 rows=2184 loops=3)
                                                                     Hash Cond: (ci.role_id = rt.id)
                                                                     ->  Parallel Hash Join  (cost=81910.23..562087.69 rows=4234 width=35) (actual time=1421.194..3338.547 rows=2185 loops=3)
                                                                           Hash Cond: (ci.person_id = n.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.076..2763.437 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=529.738..529.738 rows=16670 loops=3)
                                                                                 Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=217.354..516.233 rows=16670 loops=3)
                                                                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                       Rows Removed by Filter: 1372493
                                                                     ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.045..0.047 rows=1 loops=3)
                                                                                 Filter: ((role)::text = 'actress'::text)
                                                                                 Rows Removed by Filter: 11
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=664.623..664.623 rows=1046780 loops=3)
                                                                     Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.060..295.953 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.941..38.941 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.027..24.714 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 15.815 ms
 Execution Time: 5209.761 ms
(51 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9d.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=756571.53..756571.54 rows=1 width=128) (actual time=6800.440..6800.440 rows=1 loops=1)
   ->  Gather  (cost=756571.30..756571.51 rows=2 width=128) (actual time=6791.441..7028.012 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=755571.30..755571.31 rows=1 width=128) (actual time=6784.326..6784.327 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=738933.47..755496.36 rows=7494 width=64) (actual time=6595.750..6711.683 rows=161027 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.226..79.864 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=738892.70..738892.70 rows=3262 width=56) (actual time=6397.938..6397.938 rows=57856 loops=3)
                           Buckets: 32768 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2848kB
                           ->  Parallel Hash Join  (cost=688395.99..738892.70 rows=3262 width=56) (actual time=6093.505..6341.367 rows=57856 loops=3)
                                 Hash Cond: (t.id = ci.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.024..235.166 rows=842771 loops=3)
                                 ->  Parallel Hash  (cost=688355.22..688355.22 rows=3262 width=47) (actual time=5527.332..5527.333 rows=57856 loops=3)
                                       Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2432kB
                                       ->  Parallel Hash Join  (cost=654556.12..688355.22 rows=3262 width=47) (actual time=5226.626..5465.310 rows=57856 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=649205.34..682980.87 rows=8976 width=51) (actual time=5184.236..5392.085 rows=142133 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.024..169.524 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=649163.11..649163.11 rows=3378 width=43) (actual time=4765.081..4765.082 rows=85164 loops=3)
                                                         Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2976kB
                                                         ->  Parallel Hash Join  (cost=158158.83..649163.11 rows=3378 width=43) (actual time=4439.901..4661.981 rows=85164 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Hash Join  (cost=84603.14..567826.09 rows=6986 width=31) (actual time=3584.411..3700.625 rows=92002 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Hash Join  (cost=1.16..480518.83 rows=30581 width=12) (actual time=940.872..2981.294 rows=92055 loops=3)
                                                                           Hash Cond: (ci.role_id = rt.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.062..2917.986 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.041..0.042 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=3)
                                                                                       Filter: ((role)::text = 'actress'::text)
                                                                                       Rows Removed by Filter: 11
                                                                     ->  Parallel Hash  (cost=77318.68..77318.68 rows=396664 width=19) (actual time=554.424..554.425 rows=320518 loops=3)
                                                                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                                                                           ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=396664 width=19) (actual time=182.245..441.821 rows=320518 loops=3)
                                                                                 Filter: ((gender)::text = 'f'::text)
                                                                                 Rows Removed by Filter: 1068645
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=689.136..689.136 rows=1046780 loops=3)
                                                                     Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.095..320.291 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=41.351..41.351 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.030..25.838 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 15.378 ms
 Execution Time: 7029.175 ms
(51 rows)

