execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10a.sql_explained.sql
SET
SET
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=629274.70..629274.71 rows=1 width=64) (actual time=3811.342..3811.342 rows=1 loops=1)
   ->  Gather  (cost=629274.48..629274.69 rows=2 width=64) (actual time=3810.900..3818.444 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=628274.48..628274.49 rows=1 width=64) (actual time=3803.993..3803.994 rows=1 loops=3)
               ->  Hash Join  (cost=567292.56..628274.47 rows=2 width=33) (actual time=3436.521..3803.918 rows=35 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=567291.47..628273.38 rows=2 width=37) (actual time=3436.234..3803.612 rows=35 loops=3)
                           Hash Cond: (chn.id = ci.person_role_id)
                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.042..240.493 rows=1046780 loops=3)
                           ->  Parallel Hash  (cost=567291.40..567291.40 rows=5 width=25) (actual time=3434.188..3434.188 rows=37 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=516526.82..567291.40 rows=5 width=25) (actual time=3311.282..3434.061 rows=37 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.015..258.391 rows=337640 loops=3)
                                             Filter: (production_year > 2005)
                                             Rows Removed by Filter: 505131
                                       ->  Parallel Hash  (cost=516526.68..516526.68 rows=11 width=16) (actual time=3137.518..3137.518 rows=92 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=483987.14..516526.68 rows=11 width=16) (actual time=2904.139..3137.328 rows=92 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Hash Join  (cost=4733.23..37248.39 rows=6486 width=8) (actual time=22.266..297.717 rows=2930 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.034..154.984 rows=869710 loops=3)
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=825 width=4) (actual time=21.583..21.584 rows=454 loops=3)
                                                               Buckets: 2048  Batches: 1  Memory Usage: 112kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=825 width=4) (actual time=0.038..21.095 rows=454 loops=3)
                                                                     Filter: ((country_code)::text = '[ru]'::text)
                                                                     Rows Removed by Filter: 77879
                                                   ->  Parallel Hash  (cost=479245.16..479245.16 rows=700 width=8) (actual time=2838.542..2838.542 rows=8625 loops=3)
                                                         Buckets: 32768 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 1552kB
                                                         ->  Hash Join  (cost=1.16..479245.16 rows=700 width=8) (actual time=0.274..2718.040 rows=8625 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=8405 width=12) (actual time=0.160..2712.973 rows=10763 loops=3)
                                                                     Filter: (((note)::text ~~ '%(voice)%'::text) AND ((note)::text ~~ '%(uncredited)%'::text))
                                                                     Rows Removed by Filter: 12070685
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.039..0.042 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actor'::text)
                                                                           Rows Removed by Filter: 11
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.064..0.064 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.043..0.045 rows=4 loops=3)
 Planning Time: 8.431 ms
 Execution Time: 3819.117 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10b.sql_explained.sql
SET
SET
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=612898.77..612898.78 rows=1 width=64) (actual time=4545.352..4545.352 rows=1 loops=1)
   ->  Gather  (cost=612898.55..612898.76 rows=2 width=64) (actual time=4542.033..4603.310 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=611898.55..611898.56 rows=1 width=64) (actual time=4534.659..4534.659 rows=1 loops=3)
               ->  Hash Join  (cost=160692.60..611898.28 rows=55 width=33) (actual time=4534.652..4534.652 rows=0 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=160691.51..611896.89 rows=55 width=37) (actual time=4534.342..4534.440 rows=0 loops=3)
                           Hash Cond: (ci.person_role_id = chn.id)
                           ->  Hash Join  (cost=87135.83..530671.90 rows=115 width=25) (actual time=3588.537..3588.538 rows=0 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Hash Join  (cost=87134.66..530665.85 rows=1377 width=29) (actual time=1989.361..3588.299 rows=871 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=551821 width=12) (actual time=365.051..2953.044 rows=478480 loops=3)
                                             Filter: ((note)::text ~~ '%(producer)%'::text)
                                             Rows Removed by Filter: 11602968
                                       ->  Parallel Hash  (cost=87121.90..87121.90 rows=1021 width=29) (actual time=581.469..581.469 rows=420 loops=3)
                                             Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                             ->  Parallel Hash Join  (cost=37329.47..87121.90 rows=1021 width=29) (actual time=319.069..580.877 rows=420 loops=3)
                                                   Hash Cond: (t.id = mc.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.017..245.369 rows=130555 loops=3)
                                                         Filter: (production_year > 2010)
                                                         Rows Removed by Filter: 712215
                                                   ->  Parallel Hash  (cost=37248.39..37248.39 rows=6486 width=8) (actual time=313.920..313.920 rows=2930 loops=3)
                                                         Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                         ->  Parallel Hash Join  (cost=4733.23..37248.39 rows=6486 width=8) (actual time=24.851..311.241 rows=2930 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.043..164.820 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=825 width=4) (actual time=24.235..24.235 rows=454 loops=3)
                                                                     Buckets: 2048  Batches: 1  Memory Usage: 112kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=825 width=4) (actual time=0.063..23.656 rows=454 loops=3)
                                                                           Filter: ((country_code)::text = '[ru]'::text)
                                                                           Rows Removed by Filter: 77879
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.056..0.058 rows=1 loops=3)
                                             Filter: ((role)::text = 'actor'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=661.359..661.359 rows=1046780 loops=3)
                                 Buckets: 65536  Batches: 64  Memory Usage: 3232kB
                                 ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.084..316.228 rows=1046780 loops=3)
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.070..0.070 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.043..0.044 rows=4 loops=3)
 Planning Time: 8.499 ms
 Execution Time: 4604.274 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/10c.sql_explained.sql
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=652016.30..652016.31 rows=1 width=64) (actual time=4960.001..4960.002 rows=1 loops=1)
   ->  Gather  (cost=652016.08..652016.29 rows=2 width=64) (actual time=4956.172..5052.502 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=651016.08..651016.09 rows=1 width=64) (actual time=4949.304..4949.304 rows=1 loops=3)
               ->  Hash Join  (cost=609518.31..650122.02 rows=178812 width=33) (actual time=4911.715..4949.268 rows=3 loops=3)
                     Hash Cond: (ci.role_id = rt.id)
                     ->  Hash Join  (cost=609517.04..649485.59 rows=178812 width=37) (actual time=4911.420..4948.971 rows=3 loops=3)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=609515.95..648517.80 rows=178812 width=41) (actual time=4911.308..4948.856 rows=3 loops=3)
                                 Hash Cond: (mc.movie_id = t.id)
                                 ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=8) (actual time=30.962..399.854 rows=384599 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.032..160.378 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=30.785..30.785 rows=28281 loops=3)
                                             Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.018..19.971 rows=28281 loops=3)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=600222.44..600222.44 rows=185178 width=45) (actual time=4376.608..4376.608 rows=4 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 576kB
                                       ->  Parallel Hash Join  (cost=136144.88..600222.44 rows=185178 width=45) (actual time=4284.037..4375.427 rows=4 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Hash Join  (cost=73555.68..529520.84 rows=266824 width=24) (actual time=3591.045..3760.171 rows=5 loops=3)
                                                   Hash Cond: (ci.person_role_id = chn.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=551821 width=12) (actual time=322.393..2740.827 rows=478480 loops=3)
                                                         Filter: ((note)::text ~~ '%(producer)%'::text)
                                                         Rows Removed by Filter: 11602968
                                                   ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=626.941..626.941 rows=1046780 loops=3)
                                                         Buckets: 65536  Batches: 64  Memory Usage: 3232kB
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.057..287.511 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=49166.29..49166.29 rows=731112 width=21) (actual time=488.926..488.926 rows=583011 loops=3)
                                                   Buckets: 65536  Batches: 32  Memory Usage: 3616kB
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.032..291.808 rows=583011 loops=3)
                                                         Filter: (production_year > 1990)
                                                         Rows Removed by Filter: 259760
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.049..0.049 rows=4 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.036..0.038 rows=4 loops=3)
                     ->  Hash  (cost=1.12..1.12 rows=12 width=4) (actual time=0.063..0.063 rows=12 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on role_type rt  (cost=0.00..1.12 rows=12 width=4) (actual time=0.040..0.043 rows=12 loops=3)
 Planning Time: 8.282 ms
 Execution Time: 5053.184 ms
(44 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11a.sql_explained.sql
SET
SET
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=25460.06..25460.07 rows=1 width=96) (actual time=311.282..311.282 rows=1 loops=1)
   ->  Gather  (cost=19952.24..25460.06 rows=1 width=118) (actual time=261.993..316.041 rows=310 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Parallel Hash Join  (cost=18952.24..24459.96 rows=1 width=118) (actual time=259.664..305.501 rows=155 loops=2)
               Hash Cond: (cn.id = mc.company_id)
               ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.012..47.536 rows=24151 loops=2)
                     Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                     Rows Removed by Filter: 93348
               ->  Parallel Hash  (cost=18952.23..18952.23 rows=1 width=103) (actual time=254.649..254.649 rows=332 loops=2)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Hash Join  (cost=8687.12..18952.23 rows=1 width=103) (actual time=132.659..254.444 rows=332 loops=2)
                           Hash Cond: (mk.keyword_id = k.id)
                           ->  Merge Join  (cost=6060.98..16306.51 rows=7458 width=107) (actual time=90.015..222.736 rows=16065 loops=2)
                                 Merge Cond: (ml.movie_id = mk.movie_id)
                                 ->  Merge Join  (cost=6016.36..13086.62 rows=160 width=115) (actual time=89.924..183.087 rows=1397 loops=2)
                                       Merge Cond: (t.id = ml.movie_id)
                                       ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=379985 width=21) (actual time=0.038..90.555 rows=26100 loops=2)
                                             Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                             Rows Removed by Filter: 56295
                                       ->  Sort  (cost=6015.92..6018.59 rows=1065 width=94) (actual time=89.112..89.436 rows=4393 loops=2)
                                             Sort Key: mc.movie_id
                                             Sort Method: quicksort  Memory: 536kB
                                             Worker 0:  Sort Method: quicksort  Memory: 536kB
                                             ->  Hash Join  (cost=652.13..5962.37 rows=1065 width=94) (actual time=12.852..86.977 rows=4393 loops=2)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Merge Join  (cost=651.06..5938.28 rows=4260 width=98) (actual time=12.761..85.570 rows=5069 loops=2)
                                                         Merge Cond: (mc.movie_id = ml.movie_id)
                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.057..67.191 rows=49142 loops=2)
                                                               Filter: (note IS NULL)
                                                               Rows Removed by Filter: 50735
                                                         ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.522..12.917 rows=5369 loops=2)
                                                               Sort Key: ml.movie_id
                                                               Sort Method: quicksort  Memory: 205kB
                                                               Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                               ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.140..11.294 rows=2315 loops=2)
                                                                     Hash Cond: (ml.link_type_id = lt.id)
                                                                     ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.020..6.928 rows=29997 loops=2)
                                                                     ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.050..0.050 rows=2 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.033..0.038 rows=2 loops=2)
                                                                                 Filter: ((link)::text ~~ '%follow%'::text)
                                                                                 Rows Removed by Filter: 16
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=2)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                                 ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.023..27.869 rows=96539 loops=2)
                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=30.092..30.092 rows=1 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.702..30.071 rows=1 loops=2)
                                       Filter: ((keyword)::text = 'sequel'::text)
                                       Rows Removed by Filter: 134169
 Planning Time: 14.216 ms
 Execution Time: 317.047 ms
(56 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=37292.30..37292.31 rows=1 width=96) (actual time=501.755..501.756 rows=1 loops=1)
   ->  Hash Join  (cost=15626.08..37292.29 rows=1 width=118) (actual time=501.655..501.735 rows=14 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=12999.94..34666.15 rows=1 width=122) (actual time=480.285..480.359 rows=56 loops=1)
               Merge Cond: (ml.movie_id = mk.movie_id)
               ->  Merge Join  (cost=12999.51..31520.71 rows=1 width=130) (actual time=449.063..449.110 rows=14 loops=1)
                     Merge Cond: (t.id = ml.movie_id)
                     ->  Gather Merge  (cost=1000.45..93601.60 rows=5 width=21) (actual time=365.014..496.347 rows=3 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=2 width=21) (actual time=211.408..427.989 rows=3 loops=3)
                                 Filter: (((title)::text ~~ '%Money%'::text) AND (production_year = 1998))
                                 Rows Removed by Filter: 280846
                     ->  Sort  (cost=11999.06..11999.54 rows=192 width=109) (actual time=83.995..84.024 rows=450 loops=1)
                           Sort Key: mc.movie_id
                           Sort Method: quicksort  Memory: 61kB
                           ->  Gather  (cost=7378.27..11991.77 rows=192 width=109) (actual time=64.158..85.168 rows=450 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Hash Join  (cost=6378.27..10972.57 rows=80 width=109) (actual time=59.129..77.125 rows=150 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=6377.21..10969.78 rows=321 width=113) (actual time=58.946..76.896 rows=153 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Merge Join  (cost=651.06..5238.97 rows=1775 width=98) (actual time=12.181..30.807 rows=692 loops=3)
                                                   Merge Cond: (mc.movie_id = ml.movie_id)
                                                   ->  Parallel Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..116330.44 rows=530595 width=12) (actual time=0.112..17.101 rows=16381 loops=3)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 16912
                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=11.949..12.062 rows=1516 loops=3)
                                                         Sort Key: ml.movie_id
                                                         Sort Method: quicksort  Memory: 103kB
                                                         Worker 0:  Sort Method: quicksort  Memory: 103kB
                                                         Worker 1:  Sort Method: quicksort  Memory: 103kB
                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.159..11.278 rows=1158 loops=3)
                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.024..7.120 rows=29997 loops=3)
                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.060..0.060 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.044..0.049 rows=1 loops=3)
                                                                           Filter: ((link)::text ~~ '%follows%'::text)
                                                                           Rows Removed by Filter: 17
                                             ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=44.843..44.843 rows=16101 loops=3)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 3264kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.017..35.457 rows=16101 loops=3)
                                                         Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                         Rows Removed by Filter: 62232
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.042..0.044 rows=1 loops=3)
                                                   Filter: ((kind)::text = 'production companies'::text)
                                                   Rows Removed by Filter: 3
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.033..24.170 rows=69469 loops=1)
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.298..21.298 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.254..21.286 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 14.003 ms
 Execution Time: 635.222 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11c.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=26126.74..26126.75 rows=1 width=96) (actual time=671.340..671.340 rows=1 loops=1)
   ->  Hash Join  (cost=22974.01..26126.73 rows=1 width=60) (actual time=527.263..667.487 rows=6946 loops=1)
         Hash Cond: (ml.link_type_id = lt.id)
         ->  Hash Join  (cost=22972.60..26125.32 rows=1 width=64) (actual time=527.144..665.811 rows=6946 loops=1)
               Hash Cond: (mk.keyword_id = k.id)
               ->  Merge Join  (cost=20178.73..23330.26 rows=454 width=68) (actual time=302.767..556.582 rows=780776 loops=1)
                     Merge Cond: (mk.movie_id = ml.movie_id)
                     ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.047..20.833 rows=77819 loops=1)
                     ->  Sort  (cost=20178.30..20178.32 rows=10 width=76) (actual time=301.381..352.650 rows=780794 loops=1)
                           Sort Key: mc.movie_id
                           Sort Method: quicksort  Memory: 1609kB
                           ->  Gather  (cost=6420.11..20178.13 rows=10 width=76) (actual time=69.290..296.864 rows=8393 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Hash Join  (cost=5420.11..19177.13 rows=4 width=76) (actual time=62.770..210.857 rows=2798 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=5419.02..19176.02 rows=5 width=80) (actual time=62.571..209.796 rows=2801 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Merge Join  (cost=4.62..13682.01 rows=30328 width=65) (actual time=1.341..175.267 rows=34978 loops=3)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=2.03..8120.68 rows=11307 width=29) (actual time=0.844..115.000 rows=9909 loops=3)
                                                         Merge Cond: (t.id = ml.movie_id)
                                                         ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..89967.34 rows=952979 width=21) (actual time=0.153..97.495 rows=59309 loops=3)
                                                               Filter: (production_year > 1950)
                                                               Rows Removed by Filter: 2750
                                                         ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=8) (actual time=0.054..7.392 rows=29997 loops=3)
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1335700 width=36) (actual time=0.049..49.558 rows=77547 loops=3)
                                                         Filter: (note IS NOT NULL)
                                                         Rows Removed by Filter: 66584
                                             ->  Parallel Hash  (cost=5414.09..5414.09 rows=25 width=23) (actual time=29.636..29.636 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=25 width=23) (actual time=0.149..29.525 rows=30 loops=3)
                                                         Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '20th Century Fox%'::text) OR ((name)::text ~~ 'Twentieth Century Fox%'::text)))
                                                         Rows Removed by Filter: 78303
                                       ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.066..0.066 rows=3 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=3 width=4) (actual time=0.045..0.048 rows=3 loops=3)
                                                   Filter: ((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))
                                                   Rows Removed by Filter: 1
               ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=42.638..42.638 rows=3 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=1.633..42.624 rows=3 loops=1)
                           Filter: ((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))
                           Rows Removed by Filter: 134167
         ->  Hash  (cost=1.18..1.18 rows=18 width=4) (actual time=0.053..0.053 rows=18 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=4) (actual time=0.036..0.039 rows=18 loops=1)
 Planning Time: 14.518 ms
 Execution Time: 672.610 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/11d.sql_explained.sql
SET
SET
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=34220.63..34220.64 rows=1 width=96) (actual time=356.598..356.599 rows=1 loops=1)
   ->  Hash Join  (cost=26974.32..34220.25 rows=51 width=60) (actual time=270.879..351.112 rows=14899 loops=1)
         Hash Cond: (cn.id = mc.company_id)
         ->  Seq Scan on company_name cn  (cost=0.00..5932.46 rows=210072 width=23) (actual time=0.024..57.876 rows=210031 loops=1)
               Filter: ((country_code)::text <> '[pl]'::text)
               Rows Removed by Filter: 24966
         ->  Hash  (cost=26973.61..26973.61 rows=57 width=45) (actual time=270.751..270.751 rows=14916 loops=1)
               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1231kB
               ->  Hash Join  (cost=21742.73..26973.61 rows=57 width=45) (actual time=226.761..264.488 rows=14916 loops=1)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Merge Join  (cost=21741.65..26972.11 rows=76 width=49) (actual time=226.653..260.760 rows=15510 loops=1)
                           Merge Cond: (mc.movie_id = ml.movie_id)
                           ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1335700 width=36) (actual time=0.024..26.650 rows=42219 loops=1)
                                 Filter: (note IS NOT NULL)
                                 Rows Removed by Filter: 41437
                           ->  Sort  (cost=21741.22..21741.29 rows=28 width=29) (actual time=226.363..227.439 rows=15913 loops=1)
                                 Sort Key: mk.movie_id
                                 Sort Method: quicksort  Memory: 159kB
                                 ->  Gather  (cost=3836.65..21740.54 rows=28 width=29) (actual time=41.262..225.697 rows=1460 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 2
                                       ->  Hash Join  (cost=2836.65..20737.74 rows=12 width=29) (actual time=37.660..214.607 rows=487 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Hash Join  (cost=2835.24..20736.30 rows=12 width=33) (actual time=37.447..214.242 rows=487 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Merge Join  (cost=41.37..16560.07 rows=526594 width=37) (actual time=0.589..178.238 rows=95464 loops=3)
                                                         Merge Cond: (ml.movie_id = mk.movie_id)
                                                         ->  Merge Join  (cost=2.03..8120.68 rows=11307 width=29) (actual time=0.349..107.755 rows=9909 loops=3)
                                                               Merge Cond: (t.id = ml.movie_id)
                                                               ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..89967.34 rows=952979 width=21) (actual time=0.024..90.851 rows=59309 loops=3)
                                                                     Filter: (production_year > 1950)
                                                                     Rows Removed by Filter: 2750
                                                               ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=8) (actual time=0.057..7.115 rows=29997 loops=3)
                                                         ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.047..41.321 rows=175231 loops=3)
                                                   ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=27.098..27.098 rows=3 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=1.111..27.083 rows=3 loops=3)
                                                               Filter: ((keyword)::text = ANY ('{sequel,revenge,based-on-novel}'::text[]))
                                                               Rows Removed by Filter: 134167
                                             ->  Hash  (cost=1.18..1.18 rows=18 width=4) (actual time=0.069..0.069 rows=18 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=4) (actual time=0.045..0.048 rows=18 loops=3)
                     ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.057..0.057 rows=3 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=3 width=4) (actual time=0.036..0.038 rows=3 loops=1)
                                 Filter: ((kind IS NOT NULL) AND ((kind)::text <> 'production companies'::text))
                                 Rows Removed by Filter: 1
 Planning Time: 13.248 ms
 Execution Time: 357.570 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12a.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=346907.90..346907.91 rows=1 width=96) (actual time=3512.101..3512.101 rows=1 loops=1)
   ->  Gather  (cost=346907.78..346907.89 rows=1 width=96) (actual time=3511.799..3517.520 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=345907.78..345907.79 rows=1 width=96) (actual time=3506.308..3506.308 rows=1 loops=2)
               ->  Hash Join  (cost=340996.48..345907.77 rows=1 width=41) (actual time=3476.650..3506.115 rows=198 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=340995.42..345906.71 rows=1 width=45) (actual time=3476.400..3505.774 rows=354 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.015..24.221 rows=42422 loops=2)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 75077
                           ->  Parallel Hash  (cost=340995.41..340995.41 rows=1 width=30) (actual time=3475.958..3475.958 rows=967 loops=2)
                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                 ->  Parallel Hash Join  (cost=307257.26..340995.41 rows=1 width=30) (actual time=2940.023..3338.643 rows=967 loops=2)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.012..229.957 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=307257.25..307257.25 rows=1 width=34) (actual time=2934.715..2934.715 rows=278 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=254758.25..307257.25 rows=1 width=34) (actual time=2541.918..2934.283 rows=278 loops=2)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=186410 width=21) (actual time=0.036..371.572 rows=222930 loops=2)
                                                         Filter: ((production_year >= 2005) AND (production_year <= 2008))
                                                         Rows Removed by Filter: 1041226
                                                   ->  Parallel Hash  (cost=254758.24..254758.24 rows=1 width=13) (actual time=2528.064..2528.064 rows=972 loops=2)
                                                         Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                         ->  Parallel Hash Join  (cost=15184.50..254758.24 rows=1 width=13) (actual time=2150.278..2431.236 rows=972 loops=2)
                                                               Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                               ->  Hash Join  (cost=2.43..239572.30 rows=1028 width=4) (actual time=1926.985..2187.955 rows=136360 loops=2)
                                                                     Hash Cond: (mi.info_type_id = it1.id)
                                                                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=116213 width=8) (actual time=1337.137..2153.519 rows=137322 loops=2)
                                                                           Filter: ((info)::text = ANY ('{Drama,Horror}'::text[]))
                                                                           Rows Removed by Filter: 7280538
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.028 rows=1 loops=2)
                                                                                 Filter: ((info)::text = 'genres'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=15179.85..15179.85 rows=178 width=9) (actual time=223.059..223.059 rows=7924 loops=2)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                     ->  Hash Join  (cost=2.43..15179.85 rows=178 width=9) (actual time=0.156..199.048 rows=7924 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.051..192.818 rows=26824 loops=2)
                                                                                 Filter: ((info)::text > '8.0'::text)
                                                                                 Rows Removed by Filter: 663193
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.035 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 14.330 ms
 Execution Time: 3518.235 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12b.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348978.79..348978.80 rows=1 width=64) (actual time=3658.677..3658.677 rows=1 loops=1)
   ->  Gather  (cost=348978.68..348978.79 rows=1 width=64) (actual time=3658.396..3663.688 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347978.68..347978.69 rows=1 width=64) (actual time=3653.177..3653.177 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343067.38..347978.67 rows=1 width=60) (actual time=3626.898..3653.146 rows=5 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.016..24.070 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343067.37..343067.37 rows=1 width=64) (actual time=3624.499..3624.499 rows=16 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=102227.57..343067.37 rows=1 width=64) (actual time=3141.164..3624.419 rows=16 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=1462.382..2530.745 rows=60932 loops=2)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.026..1595.329 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'budget'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102225.13..102225.13 rows=1 width=33) (actual time=1087.403..1087.403 rows=16 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=86954.86..102225.13 rows=1 width=33) (actual time=1087.314..1087.333 rows=16 loops=2)
                                             Hash Cond: (mi_idx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=194.675..194.677 rows=5 loops=2)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.022..111.102 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.033 rows=1 loops=2)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86951.75..86951.75 rows=55 width=29) (actual time=892.582..892.582 rows=1984 loops=2)
                                                   Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 376kB
                                                   ->  Hash Join  (cost=54436.04..86951.75 rows=55 width=29) (actual time=461.787..882.909 rows=1984 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Parallel Hash Join  (cost=54434.96..86950.06 rows=111 width=33) (actual time=461.656..881.897 rows=1984 loops=2)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.011..231.608 rows=1304564 loops=2)
                                                               ->  Parallel Hash  (cost=54433.61..54433.61 rows=108 width=21) (actual time=460.645..460.645 rows=1268 loops=2)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=108 width=21) (actual time=0.738..455.812 rows=1268 loops=2)
                                                                           Filter: ((production_year > 2000) AND (((title)::text ~~ 'Birdemic%'::text) OR ((title)::text ~~ '%Movie%'::text)))
                                                                           Rows Removed by Filter: 1262888
                                                         ->  Hash  (cost=1.06..1.06 rows=2 width=4) (actual time=0.066..0.066 rows=2 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.06 rows=2 width=4) (actual time=0.044..0.047 rows=2 loops=2)
                                                                     Filter: ((kind IS NOT NULL) AND (((kind)::text = 'production companies'::text) OR ((kind)::text = 'distributors'::text)))
                                                                     Rows Removed by Filter: 2
 Planning Time: 14.162 ms
 Execution Time: 3664.450 ms
(53 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/12c.sql_explained.sql
SET
SET
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=363505.12..363505.13 rows=1 width=96) (actual time=3863.861..3863.861 rows=1 loops=1)
   ->  Gather  (cost=363505.00..363505.11 rows=1 width=96) (actual time=3863.240..3869.027 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=362505.00..362505.01 rows=1 width=96) (actual time=3857.859..3857.859 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=357593.71..362504.99 rows=1 width=41) (actual time=3824.900..3856.624 rows=2356 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.015..24.960 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=357593.68..357593.68 rows=2 width=26) (actual time=3824.251..3824.251 rows=7768 loops=2)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1176kB
                           ->  Hash Join  (cost=323855.49..357593.68 rows=2 width=26) (actual time=3593.227..3806.023 rows=7768 loops=2)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=323854.42..357592.57 rows=10 width=30) (actual time=3366.853..3801.581 rows=22503 loops=2)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.013..234.478 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=323854.40..323854.40 rows=2 width=34) (actual time=3366.628..3366.628 rows=3982 loops=2)
                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                             ->  Parallel Hash Join  (cost=270431.08..323854.40 rows=2 width=34) (actual time=2887.839..3360.045 rows=3982 loops=2)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=432897 width=21) (actual time=0.033..396.376 rows=521400 loops=2)
                                                         Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                         Rows Removed by Filter: 742756
                                                   ->  Parallel Hash  (cost=270431.01..270431.01 rows=5 width=13) (actual time=2886.961..2886.961 rows=11094 loops=2)
                                                         Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1592kB
                                                         ->  Parallel Hash Join  (cost=15354.10..270431.01 rows=5 width=13) (actual time=2506.343..2857.690 rows=11094 loops=2)
                                                               Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                               ->  Hash Join  (cost=2.43..255074.87 rows=1187 width=4) (actual time=2241.697..2556.783 rows=162628 loops=2)
                                                                     Hash Cond: (mi.info_type_id = it1.id)
                                                                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=134092 width=8) (actual time=1561.773..2516.022 rows=163656 loops=2)
                                                                           Filter: ((info)::text = ANY ('{Drama,Horror,Western,Family}'::text[]))
                                                                           Rows Removed by Filter: 7254204
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.018..0.031 rows=1 loops=2)
                                                                                 Filter: ((info)::text = 'genres'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=15342.82..15342.82 rows=708 width=9) (actual time=264.530..264.530 rows=60786 loops=2)
                                                                     Buckets: 131072 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 6832kB
                                                                     ->  Hash Join  (cost=2.43..15342.82 rows=708 width=9) (actual time=0.155..225.202 rows=60786 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=79942 width=13) (actual time=0.053..203.613 rows=96948 loops=2)
                                                                                 Filter: ((info)::text > '7.0'::text)
                                                                                 Rows Removed by Filter: 593070
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.035 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=2)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
 Planning Time: 14.000 ms
 Execution Time: 3869.858 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13a.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=345137.34..345137.35 rows=1 width=96) (actual time=3400.469..3400.469 rows=1 loops=1)
   ->  Gather  (cost=345137.12..345137.33 rows=2 width=96) (actual time=3395.169..3417.607 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=344137.12..344137.13 rows=1 width=96) (actual time=3387.463..3387.464 rows=1 loops=3)
               ->  Hash Join  (cost=293653.26..344137.03 rows=11 width=65) (actual time=3202.596..3371.453 rows=37034 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=293652.16..344135.60 rows=79 width=69) (actual time=2977.741..3360.599 rows=44730 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.016..219.690 rows=842771 loops=3)
                           ->  Parallel Hash  (cost=293651.17..293651.17 rows=79 width=60) (actual time=2977.083..2977.083 rows=44730 loops=3)
                                 Buckets: 262144 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 13880kB
                                 ->  Parallel Hash Join  (cost=52811.08..293651.17 rows=79 width=60) (actual time=1200.581..2856.909 rows=44730 loops=3)
                                       Hash Cond: (mi.movie_id = mc.movie_id)
                                       ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=469.306..1988.714 rows=1012240 loops=3)
                                             Hash Cond: (mi.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.053..1216.041 rows=4945240 loops=3)
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.020..0.032 rows=1 loops=3)
                                                         Filter: ((info)::text = 'release dates'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=52805.23..52805.23 rows=274 width=13) (actual time=729.707..729.707 rows=10503 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2040kB
                                             ->  Hash Join  (cost=20112.16..52805.23 rows=274 width=13) (actual time=650.995..701.117 rows=10503 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Hash Join  (cost=20111.09..52798.24 rows=1095 width=17) (actual time=649.431..696.943 rows=27966 loops=3)
                                                         Hash Cond: (mc.movie_id = miidx.movie_id)
                                                         ->  Parallel Hash Join  (cost=4793.88..37309.04 rows=44647 width=8) (actual time=26.657..331.118 rows=49377 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.013..167.648 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=5677 width=4) (actual time=26.516..26.516 rows=3258 loops=3)
                                                                     Buckets: 16384  Batches: 1  Memory Usage: 576kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=5677 width=4) (actual time=0.025..24.361 rows=3258 loops=3)
                                                                           Filter: ((country_code)::text = '[de]'::text)
                                                                           Rows Removed by Filter: 75074
                                                         ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=291.046..291.046 rows=153308 loops=3)
                                                               Buckets: 131072 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 3360kB
                                                               ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.157..166.971 rows=153308 loops=3)
                                                                     Hash Cond: (miidx.info_type_id = it.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.044..80.841 rows=460012 loops=3)
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'rating'::text)
                                                                                 Rows Removed by Filter: 112
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.070..0.070 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.045..0.047 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 20.722 ms
 Execution Time: 3418.411 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13b.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348980.78..348980.79 rows=1 width=96) (actual time=4279.851..4279.851 rows=1 loops=1)
   ->  Gather  (cost=348980.66..348980.77 rows=1 width=96) (actual time=4279.607..4285.398 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347980.66..347980.67 rows=1 width=96) (actual time=4274.120..4274.121 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343069.37..347980.65 rows=1 width=41) (actual time=4246.063..4273.971 rows=186 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.016..24.214 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343069.35..343069.35 rows=1 width=26) (actual time=4244.758..4244.758 rows=313 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102229.55..343069.35 rows=1 width=26) (actual time=2452.692..4244.525 rows=313 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=679.098..2800.563 rows=1518360 loops=2)
                                       Hash Cond: (mi.info_type_id = it2.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.033..1676.929 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102227.11..102227.11 rows=1 width=38) (actual time=1297.907..1297.907 rows=58 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=86956.85..102227.11 rows=1 width=38) (actual time=1139.892..1297.815 rows=58 loops=2)
                                             Hash Cond: (miidx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.129..238.260 rows=229962 loops=2)
                                                   Hash Cond: (miidx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.019..114.789 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86954.33..86954.33 rows=7 width=29) (actual time=1035.341..1035.341 rows=178 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=54438.22..86954.33 rows=7 width=29) (actual time=906.984..1035.127 rows=178 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Hash Join  (cost=54437.16..86953.12 rows=29 width=33) (actual time=683.638..1034.918 rows=384 loops=2)
                                                               Hash Cond: (t.kind_id = kt.id)
                                                               ->  Parallel Hash Join  (cost=54436.06..86951.16 rows=202 width=37) (actual time=613.080..1034.498 rows=1330 loops=2)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.011..234.055 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=54433.61..54433.61 rows=196 width=25) (actual time=612.795..612.795 rows=1109 loops=2)
                                                                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=196 width=25) (actual time=0.454..610.642 rows=1109 loops=2)
                                                                                 Filter: (((title)::text <> ''::text) AND (((title)::text ~~ '%Champion%'::text) OR ((title)::text ~~ '%Loser%'::text)))
                                                                                 Rows Removed by Filter: 1263047
                                                               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=2)
                                                                           Filter: ((kind)::text = 'movie'::text)
                                                                           Rows Removed by Filter: 6
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
 Planning Time: 21.099 ms
 Execution Time: 4286.376 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13c.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=348980.78..348980.79 rows=1 width=96) (actual time=4092.973..4092.973 rows=1 loops=1)
   ->  Gather  (cost=348980.66..348980.77 rows=1 width=96) (actual time=4092.718..4098.320 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=347980.66..347980.67 rows=1 width=96) (actual time=4087.234..4087.235 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=343069.37..347980.65 rows=1 width=41) (actual time=4063.248..4087.169 rows=26 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.016..24.317 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=343069.35..343069.35 rows=1 width=26) (actual time=4058.160..4058.160 rows=81 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=102229.55..343069.35 rows=1 width=26) (actual time=2318.143..4058.049 rows=81 loops=2)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=674.388..2781.234 rows=1518360 loops=2)
                                       Hash Cond: (mi.info_type_id = it2.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.027..1668.257 rows=7417860 loops=2)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.035 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.024 rows=1 loops=2)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=102227.11..102227.11 rows=1 width=38) (actual time=1133.085..1133.085 rows=16 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=86956.85..102227.11 rows=1 width=38) (actual time=1065.842..1133.040 rows=16 loops=2)
                                             Hash Cond: (miidx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.148..238.446 rows=229962 loops=2)
                                                   Hash Cond: (miidx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.033..115.617 rows=690018 loops=2)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.046..0.046 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=86954.33..86954.33 rows=7 width=29) (actual time=871.805..871.805 rows=40 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Hash Join  (cost=54438.22..86954.33 rows=7 width=29) (actual time=768.944..871.698 rows=40 loops=2)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Hash Join  (cost=54437.16..86953.12 rows=29 width=33) (actual time=560.389..871.554 rows=90 loops=2)
                                                               Hash Cond: (t.kind_id = kt.id)
                                                               ->  Parallel Hash Join  (cost=54436.06..86951.16 rows=202 width=37) (actual time=473.956..871.415 rows=184 loops=2)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.006..229.761 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=54433.61..54433.61 rows=196 width=25) (actual time=473.543..473.543 rows=147 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=196 width=25) (actual time=7.106..473.286 rows=147 loops=2)
                                                                                 Filter: (((title)::text <> ''::text) AND (((title)::text ~~ 'Champion%'::text) OR ((title)::text ~~ 'Loser%'::text)))
                                                                                 Rows Removed by Filter: 1264009
                                                               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=2)
                                                                           Filter: ((kind)::text = 'movie'::text)
                                                                           Rows Removed by Filter: 6
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.044..0.046 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
 Planning Time: 20.956 ms
 Execution Time: 4099.236 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/13d.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=346725.46..346725.47 rows=1 width=96) (actual time=8914.111..8914.111 rows=1 loops=1)
   ->  Gather  (cost=346725.34..346725.45 rows=1 width=96) (actual time=8912.250..9130.901 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=345725.34..345725.35 rows=1 width=96) (actual time=8906.862..8906.862 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=340435.70..345724.28 rows=141 width=41) (actual time=8575.639..8782.075 rows=335195 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=23) (actual time=0.026..24.767 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=340432.26..340432.26 rows=275 width=26) (actual time=8525.736..8525.736 rows=959748 loops=2)
                           Buckets: 65536 (originally 1024)  Batches: 64 (originally 1)  Memory Usage: 4352kB
                           ->  Hash Join  (cost=306684.12..340432.26 rows=275 width=26) (actual time=6489.335..7937.092 rows=959748 loops=2)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=306683.05..340425.77 rows=1004 width=30) (actual time=6429.802..7455.570 rows=4061793 loops=2)
                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.015..235.059 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=306680.43..306680.43 rows=210 width=34) (actual time=5840.800..5840.800 rows=362366 loops=2)
                                             Buckets: 65536 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 3680kB
                                             ->  Hash Join  (cost=256185.00..306680.43 rows=210 width=34) (actual time=4954.958..5612.169 rows=362366 loops=2)
                                                   Hash Cond: (t.kind_id = kt.id)
                                                   ->  Parallel Hash Join  (cost=256183.90..306673.14 rows=1468 width=38) (actual time=4938.629..5505.438 rows=559492 loops=2)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.043..330.975 rows=1264156 loops=2)
                                                         ->  Parallel Hash  (cost=256165.55..256165.55 rows=1468 width=13) (actual time=4088.917..4088.917 rows=559492 loops=2)
                                                               Buckets: 131072 (originally 4096)  Batches: 16 (originally 1)  Memory Usage: 4384kB
                                                               ->  Parallel Hash Join  (cost=15319.64..256165.55 rows=1468 width=13) (actual time=3522.492..3866.281 rows=559492 loops=2)
                                                                     Hash Cond: (mi.movie_id = miidx.movie_id)
                                                                     ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=665.279..2767.415 rows=1518360 loops=2)
                                                                           Hash Cond: (mi.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.039..1635.841 rows=7417860 loops=2)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.033 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=383.296..383.297 rows=229962 loops=2)
                                                                           Buckets: 131072 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 3328kB
                                                                           ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.139..240.445 rows=229962 loops=2)
                                                                                 Hash Cond: (miidx.info_type_id = it.id)
                                                                                 ->  Parallel Seq Scan on movie_info_idx miidx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.035..113.457 rows=690018 loops=2)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.035 rows=1 loops=2)
                                                                                             Filter: ((info)::text = 'rating'::text)
                                                                                             Rows Removed by Filter: 112
                                                   ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.042..0.042 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.027..0.029 rows=1 loops=2)
                                                               Filter: ((kind)::text = 'movie'::text)
                                                               Rows Removed by Filter: 6
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=2)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
 Planning Time: 20.453 ms
 Execution Time: 9131.995 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14a.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=420522.53..420522.54 rows=1 width=64) (actual time=3505.975..3505.976 rows=1 loops=1)
   ->  Gather  (cost=420522.31..420522.52 rows=2 width=64) (actual time=3505.142..3511.554 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=419522.31..419522.32 rows=1 width=64) (actual time=3498.242..3498.242 rows=1 loops=3)
               ->  Hash Join  (cost=369734.11..419522.30 rows=1 width=22) (actual time=3401.103..3497.969 rows=254 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=369733.01..419521.20 rows=1 width=26) (actual time=3237.615..3497.548 rows=328 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=25) (actual time=0.027..240.043 rows=130555 loops=3)
                                 Filter: (production_year > 2010)
                                 Rows Removed by Filter: 712215
                           ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3234.185..3234.185 rows=6989 loops=3)
                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                 ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2949.015..3192.645 rows=6989 loops=3)
                                       Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                       ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.161..221.989 rows=151410 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.049..158.138 rows=447629 loops=3)
                                                   Filter: ((info)::text < '8.5'::text)
                                                   Rows Removed by Filter: 12383
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2947.841..2947.842 rows=7972 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                             ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2392.180..2901.005 rows=7972 loops=3)
                                                   Hash Cond: (mi.movie_id = mk.movie_id)
                                                   ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1813.992..2294.365 rows=204750 loops=3)
                                                         Hash Cond: (mi.info_type_id = it1.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.020..2242.811 rows=235558 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4709682
                                                         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.033..0.045 rows=1 loops=3)
                                                                     Filter: ((info)::text = 'countries'::text)
                                                                     Rows Removed by Filter: 112
                                                   ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=577.461..577.461 rows=12364 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=44.934..485.904 rows=12364 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..252.740 rows=1507977 loops=3)
                                                               ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=44.640..44.640 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.644..44.627 rows=3 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                           Rows Removed by Filter: 134167
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.028..0.030 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 12.775 ms
 Execution Time: 3512.253 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14b.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=426312.24..426312.25 rows=1 width=64) (actual time=3212.857..3212.857 rows=1 loops=1)
   ->  Gather  (cost=426312.02..426312.23 rows=2 width=64) (actual time=3212.604..3219.337 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=425312.02..425312.03 rows=1 width=64) (actual time=3205.658..3205.658 rows=1 loops=3)
               ->  Hash Join  (cost=409759.67..425312.01 rows=1 width=22) (actual time=3192.229..3205.648 rows=0 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=409758.57..425310.91 rows=1 width=26) (actual time=3134.627..3205.366 rows=1 loops=3)
                           Hash Cond: (mi_idx.movie_id = t.id)
                           ->  Hash Join  (cost=2.43..15549.59 rows=1379 width=9) (actual time=0.156..166.445 rows=86616 loops=3)
                                 Hash Cond: (mi_idx.info_type_id = it2.id)
                                 ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=155862 width=13) (actual time=0.044..141.029 rows=125612 loops=3)
                                       Filter: ((info)::text > '6.0'::text)
                                       Rows Removed by Filter: 334399
                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.026 rows=1 loops=3)
                                             Filter: ((info)::text = 'rating'::text)
                                             Rows Removed by Filter: 112
                           ->  Parallel Hash  (cost=409756.13..409756.13 rows=1 width=33) (actual time=3029.194..3029.194 rows=3 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=361504.10..409756.13 rows=1 width=33) (actual time=2701.149..3029.101 rows=3 loops=3)
                                       Hash Cond: (mk.movie_id = t.id)
                                       ->  Hash Join  (cost=2626.15..50878.06 rows=28 width=4) (actual time=22.529..468.720 rows=6509 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.007..259.845 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=2 width=4) (actual time=22.259..22.259 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=2 width=4) (actual time=1.305..22.242 rows=1 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title}'::text[]))
                                                         Rows Removed by Filter: 134169
                                       ->  Parallel Hash  (cost=358877.94..358877.94 rows=1 width=29) (actual time=2558.594..2558.594 rows=41 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=57070.27..358877.94 rows=1 width=29) (actual time=2109.805..2558.442 rows=41 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=57067.84..358875.48 rows=12 width=33) (actual time=328.871..2558.307 rows=49 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.069..2250.071 rows=235558 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4709682
                                                         ->  Parallel Hash  (cost=57067.27..57067.27 rows=46 width=25) (actual time=281.257..281.257 rows=152 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=46 width=25) (actual time=0.413..280.976 rows=152 loops=3)
                                                                     Filter: ((production_year > 2010) AND (((title)::text ~~ '%murder%'::text) OR ((title)::text ~~ '%Murder%'::text) OR ((title)::text ~~ '%Mord%'::text)))
                                                                     Rows Removed by Filter: 842619
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.027..0.038 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.029..0.030 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 12.831 ms
 Execution Time: 3220.059 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/14c.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=421498.92..421498.93 rows=1 width=64) (actual time=3563.968..3563.968 rows=1 loops=1)
   ->  Gather  (cost=421498.70..421498.91 rows=2 width=64) (actual time=3563.106..3570.515 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=420498.70..420498.71 rows=1 width=64) (actual time=3556.257..3556.258 rows=1 loops=3)
               ->  Hash Join  (cost=369734.12..420498.70 rows=1 width=22) (actual time=3253.272..3555.124 rows=1372 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=369733.01..420497.58 rows=1 width=26) (actual time=3249.019..3554.184 rows=1710 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.025..258.487 rows=337640 loops=3)
                                 Filter: (production_year > 2005)
                                 Rows Removed by Filter: 505131
                           ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3247.830..3247.831 rows=6989 loops=3)
                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                 ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2964.649..3208.174 rows=6989 loops=3)
                                       Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                       ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.176..222.110 rows=151410 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.056..158.495 rows=447629 loops=3)
                                                   Filter: ((info)::text < '8.5'::text)
                                                   Rows Removed by Filter: 12383
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                                       ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2963.097..2963.097 rows=7972 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                             ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2400.616..2910.941 rows=7972 loops=3)
                                                   Hash Cond: (mi.movie_id = mk.movie_id)
                                                   ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1835.907..2317.018 rows=204750 loops=3)
                                                         Hash Cond: (mi.info_type_id = it1.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.086..2265.191 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.035..0.047 rows=1 loops=3)
                                                                     Filter: ((info)::text = 'countries'::text)
                                                                     Rows Removed by Filter: 112
                                                   ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=564.309..564.309 rows=12364 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=31.740..475.703 rows=12364 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.018..255.672 rows=1507977 loops=3)
                                                               ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=31.602..31.602 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.450..31.589 rows=3 loops=3)
                                                                           Filter: ((keyword IS NOT NULL) AND ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[])))
                                                                           Rows Removed by Filter: 134167
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.055..0.056 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.030..0.033 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 12.372 ms
 Execution Time: 3571.308 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=409625.94..409625.95 rows=1 width=64) (actual time=2735.271..2735.271 rows=1 loops=1)
   ->  Gather  (cost=409625.72..409625.93 rows=2 width=64) (actual time=2734.976..2742.812 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=408625.72..408625.73 rows=1 width=64) (actual time=2727.346..2727.347 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=400362.74..408625.68 rows=8 width=60) (actual time=2670.852..2727.250 rows=109 loops=3)
                     Hash Cond: (at.movie_id = t.id)
                     ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.041..39.810 rows=120491 loops=3)
                     ->  Parallel Hash  (cost=400362.70..400362.70 rows=3 width=76) (actual time=2668.468..2668.468 rows=466 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 168kB
                           ->  Parallel Hash Join  (cost=396456.49..400362.70 rows=3 width=76) (actual time=2612.838..2667.980 rows=466 loops=3)
                                 Hash Cond: (k.id = mk.keyword_id)
                                 ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.102..48.828 rows=44723 loops=3)
                                       Heap Fetches: 134170
                                 ->  Parallel Hash  (cost=396456.03..396456.03 rows=3 width=80) (actual time=2612.640..2612.640 rows=466 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                       ->  Parallel Hash Join  (cost=346083.67..396456.03 rows=3 width=80) (actual time=2165.869..2612.228 rows=466 loops=3)
                                             Hash Cond: (mk.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.008..257.499 rows=1507977 loops=3)
                                             ->  Parallel Hash  (cost=346083.66..346083.66 rows=1 width=72) (actual time=2165.530..2165.530 rows=220 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=294758.03..346083.66 rows=1 width=72) (actual time=1848.629..2165.142 rows=220 loops=3)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.018..263.486 rows=460484 loops=3)
                                                               Filter: (production_year > 2000)
                                                               Rows Removed by Filter: 382286
                                                         ->  Parallel Hash  (cost=294758.02..294758.02 rows=1 width=51) (actual time=1847.372..1847.373 rows=223 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Hash Join  (cost=289846.73..294758.02 rows=1 width=51) (actual time=1818.546..1847.140 rows=223 loops=3)
                                                                     Hash Cond: (mc.company_type_id = ct.id)
                                                                     ->  Parallel Hash Join  (cost=289845.64..294756.93 rows=1 width=55) (actual time=1818.423..1846.941 rows=223 loops=3)
                                                                           Hash Cond: (cn.id = mc.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.020..25.137 rows=28281 loops=3)
                                                                                 Filter: ((country_code)::text = '[us]'::text)
                                                                                 Rows Removed by Filter: 50051
                                                                           ->  Parallel Hash  (cost=289845.63..289845.63 rows=1 width=59) (actual time=1818.223..1818.223 rows=233 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=254710.18..289845.63 rows=1 width=59) (actual time=1560.018..1817.860 rows=233 loops=3)
                                                                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=7675 width=12) (actual time=0.029..255.484 rows=20555 loops=3)
                                                                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))
                                                                                             Rows Removed by Filter: 849155
                                                                                       ->  Parallel Hash  (cost=254710.16..254710.16 rows=2 width=47) (actual time=1557.834..1557.834 rows=590 loops=3)
                                                                                             Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                                                                             ->  Hash Join  (cost=2.43..254710.16 rows=2 width=47) (actual time=297.517..1212.136 rows=590 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=51) (actual time=297.379..1211.429 rows=590 loops=3)
                                                                                                         Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                                                                                         Rows Removed by Filter: 4944650
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.070..0.070 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.049..0.060 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'release dates'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.071..0.071 rows=4 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.045..0.046 rows=4 loops=3)
 Planning Time: 31.983 ms
 Execution Time: 2743.653 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=411365.11..411365.12 rows=1 width=64) (actual time=2335.855..2335.855 rows=1 loops=1)
   ->  Gather  (cost=411364.89..411365.10 rows=2 width=64) (actual time=2335.616..2342.869 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=410364.89..410364.90 rows=1 width=64) (actual time=2328.156..2328.156 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=402101.92..410364.87 rows=4 width=60) (actual time=2320.603..2328.127 rows=12 loops=3)
                     Hash Cond: (at.movie_id = t.id)
                     ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.044..35.455 rows=120491 loops=3)
                     ->  Parallel Hash  (cost=402101.90..402101.90 rows=2 width=76) (actual time=2276.312..2276.312 rows=50 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=147394.15..402101.90 rows=2 width=76) (actual time=1350.454..2276.190 rows=50 loops=3)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..254710.16 rows=2 width=47) (actual time=299.784..1229.785 rows=590 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=51) (actual time=299.651..1229.088 rows=590 loops=3)
                                             Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                             Rows Removed by Filter: 4944650
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.050 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.028..0.039 rows=1 loops=3)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=147391.71..147391.71 rows=1 width=29) (actual time=1046.078..1046.078 rows=144 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=143485.50..147391.71 rows=1 width=29) (actual time=1002.740..1045.882 rows=144 loops=3)
                                             Hash Cond: (k.id = mk.keyword_id)
                                             ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.052..38.103 rows=44723 loops=3)
                                                   Heap Fetches: 134170
                                             ->  Parallel Hash  (cost=143485.07..143485.07 rows=1 width=33) (actual time=1002.546..1002.546 rows=144 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=93112.71..143485.07 rows=1 width=33) (actual time=575.213..1002.386 rows=144 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.008..250.579 rows=1507977 loops=3)
                                                         ->  Parallel Hash  (cost=93112.69..93112.69 rows=1 width=25) (actual time=566.391..566.391 rows=85 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=40186.82..93112.69 rows=1 width=25) (actual time=280.662..566.194 rows=85 loops=3)
                                                                     Hash Cond: (t.id = mc.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=300243 width=21) (actual time=0.035..260.431 rows=238753 loops=3)
                                                                           Filter: ((production_year >= 2005) AND (production_year <= 2010))
                                                                           Rows Removed by Filter: 604018
                                                                     ->  Parallel Hash  (cost=40186.81..40186.81 rows=1 width=4) (actual time=277.492..277.493 rows=93 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Hash Join  (cost=5069.61..40186.81 rows=1 width=4) (actual time=24.016..277.313 rows=93 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=5068.52..40185.72 rows=1 width=8) (actual time=23.887..277.137 rows=93 loops=3)
                                                                                       Hash Cond: (mc.company_id = cn.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=7675 width=12) (actual time=0.047..250.950 rows=20555 loops=3)
                                                                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND ((note)::text ~~ '%(worldwide)%'::text))
                                                                                             Rows Removed by Filter: 849155
                                                                                       ->  Parallel Hash  (cost=5068.50..5068.50 rows=1 width=4) (actual time=22.791..22.791 rows=0 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..5068.50 rows=1 width=4) (actual time=16.155..22.754 rows=0 loops=3)
                                                                                                   Filter: (((country_code)::text = '[us]'::text) AND ((name)::text = 'YouTube'::text))
                                                                                                   Rows Removed by Filter: 78332
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.069..0.069 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.043..0.045 rows=4 loops=3)
 Planning Time: 32.726 ms
 Execution Time: 2343.794 ms
(59 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15c.sql_explained.sql
SET
SET
                                                                                                                            QUERY PLAN                                                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=424524.77..424524.78 rows=1 width=64) (actual time=3764.084..3764.084 rows=1 loops=1)
   ->  Gather  (cost=424524.55..424524.76 rows=2 width=64) (actual time=3763.914..3772.824 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=423524.55..423524.56 rows=1 width=64) (actual time=3756.198..3756.198 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=419547.77..423524.17 rows=76 width=60) (actual time=3703.173..3755.796 rows=757 loops=3)
                     Hash Cond: (k.id = mk.keyword_id)
                     ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.061..47.224 rows=44723 loops=3)
                           Heap Fetches: 134170
                     ->  Parallel Hash  (cost=419546.40..419546.40 rows=76 width=64) (actual time=3702.496..3702.496 rows=757 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                           ->  Parallel Hash Join  (cost=369174.02..419546.40 rows=76 width=64) (actual time=3167.053..3598.424 rows=757 loops=3)
                                 Hash Cond: (mk.movie_id = t.id)
                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.008..251.371 rows=1507977 loops=3)
                                 ->  Parallel Hash  (cost=369173.97..369173.97 rows=4 width=76) (actual time=3162.255..3162.255 rows=95 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=364262.66..369173.97 rows=4 width=76) (actual time=3141.072..3162.104 rows=95 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Hash Join  (cost=364261.57..369172.86 rows=4 width=80) (actual time=3140.941..3161.938 rows=95 loops=3)
                                                   Hash Cond: (cn.id = mc.company_id)
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.017..18.168 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
                                                   ->  Parallel Hash  (cost=364261.48..364261.48 rows=7 width=84) (actual time=3140.639..3140.640 rows=133 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=330523.34..364261.48 rows=7 width=84) (actual time=2869.915..3140.409 rows=133 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.008..164.578 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=330523.33..330523.33 rows=1 width=72) (actual time=2867.062..2867.062 rows=40 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=278615.36..330523.33 rows=1 width=72) (actual time=2535.344..2866.924 rows=40 loops=3)
                                                                           Hash Cond: (t.id = at.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.038..281.677 rows=583011 loops=3)
                                                                                 Filter: (production_year > 1990)
                                                                                 Rows Removed by Filter: 259760
                                                                           ->  Parallel Hash  (cost=278615.33..278615.33 rows=2 width=51) (actual time=2524.720..2524.721 rows=40 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=270164.12..278615.33 rows=2 width=51) (actual time=2468.486..2524.581 rows=40 loops=3)
                                                                                       Hash Cond: (at.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=4) (actual time=0.048..38.699 rows=120491 loops=3)
                                                                                       ->  Parallel Hash  (cost=270164.10..270164.10 rows=2 width=47) (actual time=2467.049..2467.049 rows=594 loops=3)
                                                                                             Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                                             ->  Hash Join  (cost=2.43..270164.10 rows=2 width=47) (actual time=307.608..1188.583 rows=594 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=51) (actual time=307.480..1187.881 rows=594 loops=3)
                                                                                                         Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                                         Rows Removed by Filter: 4944646
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.060 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.049 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'release dates'::text)
                                                                                                               Rows Removed by Filter: 112
                                             ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.074..0.074 rows=4 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.047..0.049 rows=4 loops=3)
 Planning Time: 31.724 ms
 Execution Time: 3773.825 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/15d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=397267.91..397267.92 rows=1 width=64) (actual time=2548.643..2548.643 rows=1 loops=1)
   ->  Gather  (cost=397267.69..397267.90 rows=2 width=64) (actual time=2547.190..2554.595 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=396267.69..396267.70 rows=1 width=64) (actual time=2539.862..2539.862 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=345880.45..396258.32 rows=1873 width=38) (actual time=2103.305..2538.632 rows=3782 loops=3)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Parallel Hash Join  (cost=341484.68..391857.62 rows=1873 width=42) (actual time=2035.134..2468.429 rows=3782 loops=3)
                           Hash Cond: (mk.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.008..249.246 rows=1507977 loops=3)
                           ->  Parallel Hash  (cost=341483.66..341483.66 rows=81 width=54) (actual time=2026.819..2026.819 rows=292 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Hash Join  (cost=336383.26..341483.66 rows=81 width=54) (actual time=2005.800..2026.541 rows=292 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=336382.17..341482.14 rows=81 width=58) (actual time=2005.693..2026.337 rows=292 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.008..17.060 rows=28281 loops=3)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 50051
                                             ->  Parallel Hash  (cost=336380.22..336380.22 rows=156 width=62) (actual time=2005.561..2005.561 rows=700 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                   ->  Parallel Hash Join  (cost=302641.96..336380.22 rows=156 width=62) (actual time=1691.804..1963.265 rows=700 loops=3)
                                                         Hash Cond: (mc.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.009..156.575 rows=869710 loops=3)
                                                         ->  Parallel Hash  (cost=302641.58..302641.58 rows=30 width=50) (actual time=1690.673..1690.673 rows=195 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=250733.50..302641.58 rows=30 width=50) (actual time=1356.682..1690.330 rows=195 loops=3)
                                                                     Hash Cond: (t.id = at.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.030..270.549 rows=583011 loops=3)
                                                                           Filter: (production_year > 1990)
                                                                           Rows Removed by Filter: 259760
                                                                     ->  Parallel Hash  (cost=250732.96..250732.96 rows=43 width=29) (actual time=1354.258..1354.258 rows=197 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=239269.32..250732.96 rows=43 width=29) (actual time=1297.932..1353.886 rows=197 loops=3)
                                                                                 Hash Cond: (at.movie_id = mi.movie_id)
                                                                                 ->  Parallel Seq Scan on aka_title at  (cost=0.00..7698.13 rows=150613 width=25) (actual time=0.042..36.984 rows=120491 loops=3)
                                                                                 ->  Parallel Hash  (cost=239268.80..239268.80 rows=42 width=4) (actual time=1297.327..1297.327 rows=3560 loops=3)
                                                                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                                                                       ->  Hash Join  (cost=2.43..239268.80 rows=42 width=4) (actual time=295.966..1206.919 rows=3560 loops=3)
                                                                                             Hash Cond: (mi.info_type_id = it1.id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=4774 width=8) (actual time=43.934..1204.285 rows=3603 loops=3)
                                                                                                   Filter: ((note)::text ~~ '%internet%'::text)
                                                                                                   Rows Removed by Filter: 4941637
                                                                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.049 rows=1 loops=3)
                                                                                                         Filter: ((info)::text = 'release dates'::text)
                                                                                                         Rows Removed by Filter: 112
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.048..0.049 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.028..0.029 rows=4 loops=3)
                     ->  Parallel Hash  (cost=3696.98..3696.98 rows=55904 width=4) (actual time=65.623..65.623 rows=44723 loops=3)
                           Buckets: 262144  Batches: 1  Memory Usage: 7328kB
                           ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.056..42.365 rows=44723 loops=3)
                                 Heap Fetches: 134170
 Planning Time: 31.358 ms
 Execution Time: 2555.396 ms
(57 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=683598.14..683598.15 rows=1 width=64) (actual time=6021.761..6021.761 rows=1 loops=1)
   ->  Gather  (cost=683597.92..683598.13 rows=2 width=64) (actual time=6020.598..6028.073 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=682597.92..682597.93 rows=1 width=64) (actual time=6013.454..6013.454 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=666037.80..682597.77 rows=31 width=33) (actual time=5902.024..6013.326 rows=128 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.038..74.244 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=666037.56..666037.56 rows=19 width=25) (actual time=5898.559..5898.559 rows=108 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=661126.21..666037.56 rows=19 width=25) (actual time=5880.113..5898.414 rows=108 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.008..16.938 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=661125.74..661125.74 rows=37 width=29) (actual time=5878.424..5878.424 rows=363 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                       ->  Parallel Hash Join  (cost=627387.45..661125.74 rows=37 width=29) (actual time=5613.618..5878.161 rows=363 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.015..154.297 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=627387.27..627387.27 rows=14 width=37) (actual time=5604.760..5604.760 rows=391 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                   ->  Parallel Hash Join  (cost=547897.96..627387.27 rows=14 width=37) (actual time=5030.903..5604.266 rows=391 loops=3)
                                                         Hash Cond: (n.id = ci.person_id)
                                                         ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.042..373.934 rows=1389164 loops=3)
                                                         ->  Parallel Hash  (cost=547897.79..547897.79 rows=14 width=33) (actual time=5028.248..5028.248 rows=391 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                               ->  Parallel Hash Join  (cost=103031.36..547897.79 rows=14 width=33) (actual time=805.616..5027.520 rows=391 loops=3)
                                                                     Hash Cond: (ci.movie_id = mk.movie_id)
                                                                     ->  Parallel Hash Join  (cost=52153.14..495500.56 rows=405052 width=29) (actual time=271.705..4431.447 rows=388676 loops=3)
                                                                           Hash Cond: (ci.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.025..2165.514 rows=12081448 loops=3)
                                                                           ->  Parallel Hash  (cost=51799.95..51799.95 rows=28255 width=21) (actual time=270.447..270.447 rows=22748 loops=3)
                                                                                 Buckets: 131072  Batches: 1  Memory Usage: 4736kB
                                                                                 ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=28255 width=21) (actual time=0.033..251.179 rows=22748 loops=3)
                                                                                       Filter: ((episode_nr >= 50) AND (episode_nr < 100))
                                                                                       Rows Removed by Filter: 820022
                                                                     ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=514.938..514.938 rows=13947 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                           ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.090..460.006 rows=13947 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..254.182 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.977..18.977 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.787..18.959 rows=1 loops=3)
                                                                                             Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                             Rows Removed by Filter: 134169
 Planning Time: 15.559 ms
 Execution Time: 6028.804 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16b.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=697874.98..697874.99 rows=1 width=64) (actual time=10055.106..10055.106 rows=1 loops=1)
   ->  Gather  (cost=697874.76..697874.97 rows=2 width=64) (actual time=10045.505..10379.812 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=696874.76..696874.77 rows=1 width=64) (actual time=10037.653..10037.654 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=617374.97..696869.01 rows=1150 width=33) (actual time=8774.237..9694.448 rows=1236864 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.062..390.374 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=617360.59..617360.59 rows=1150 width=41) (actual time=7824.955..7824.955 rows=1236864 loops=3)
                           Buckets: 65536 (originally 4096)  Batches: 32 (originally 1)  Memory Usage: 11520kB
                           ->  Parallel Hash Join  (cost=600795.85..617360.59 rows=1150 width=41) (actual time=6846.814..7302.983 rows=1236864 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.049..82.065 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=21) (actual time=6627.968..6627.968 rows=944185 loops=3)
                                       Buckets: 65536 (originally 2048)  Batches: 64 (originally 1)  Memory Usage: 3456kB
                                       ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=21) (actual time=1397.399..5959.810 rows=944185 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.044..2350.595 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=29) (actual time=1397.223..1397.223 rows=22772 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6776kB
                                                   ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=29) (actual time=1006.839..1350.462 rows=22772 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=33) (actual time=963.198..1289.966 rows=49517 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.008..173.762 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=25) (actual time=962.839..962.839 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=25) (actual time=533.251..892.691 rows=13947 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.031..218.805 rows=842771 loops=3)
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=532.945..532.945 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.858..466.378 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.044..259.040 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.635..19.636 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.876..19.624 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=42.756..42.756 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.035..26.616 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.889 ms
 Execution Time: 10381.992 ms
(47 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16c.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=698025.50..698025.51 rows=1 width=64) (actual time=7200.535..7200.535 rows=1 loops=1)
   ->  Gather  (cost=698025.28..698025.49 rows=2 width=64) (actual time=7194.879..7338.360 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=697025.28..697025.29 rows=1 width=64) (actual time=7187.679..7187.679 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=617532.05..697023.11 rows=434 width=33) (actual time=6766.501..7155.060 rows=106644 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.051..388.437 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=617526.63..617526.63 rows=434 width=41) (actual time=5855.747..5855.747 rows=106644 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 8 (originally 1)  Memory Usage: 4256kB
                           ->  Parallel Hash Join  (cost=600964.87..617526.63 rows=434 width=41) (actual time=5666.071..5777.887 rows=106644 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.026..74.862 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=600962.51..600962.51 rows=189 width=21) (actual time=5474.635..5474.635 rows=73870 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2368kB
                                       ->  Parallel Hash Join  (cost=140625.02..600962.51 rows=189 width=21) (actual time=1244.384..5313.908 rows=73870 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.144..2154.179 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=140624.89..140624.89 rows=10 width=29) (actual time=1243.873..1243.873 rows=2846 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                                   ->  Parallel Hash Join  (cost=106886.67..140624.89 rows=10 width=29) (actual time=931.237..1217.935 rows=2846 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=101535.88..135274.04 rows=28 width=33) (actual time=890.273..1175.285 rows=3802 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.006..157.351 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=101535.82..101535.82 rows=5 width=25) (actual time=889.745..889.746 rows=2309 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 600kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..101535.82 rows=5 width=25) (actual time=521.742..833.740 rows=2309 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=397676 width=21) (actual time=0.020..266.323 rows=315635 loops=3)
                                                                                 Filter: (episode_nr < 100)
                                                                                 Rows Removed by Filter: 527135
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=521.599..521.599 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=18.683..458.008 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.070..252.806 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.520..18.520 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.813..18.508 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=40.012..40.012 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.028..25.838 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.631 ms
 Execution Time: 7339.080 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/16d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=700256.85..700256.86 rows=1 width=64) (actual time=7508.742..7508.743 rows=1 loops=1)
   ->  Gather  (cost=700256.63..700256.84 rows=2 width=64) (actual time=7503.454..7649.933 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=699256.63..699256.64 rows=1 width=64) (actual time=7495.976..7495.976 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=619764.46..699255.04 rows=318 width=33) (actual time=7089.469..7470.465 rows=83152 loops=3)
                     Hash Cond: (n.id = an.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.055..401.048 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=619760.48..619760.48 rows=318 width=41) (actual time=6160.984..6160.984 rows=83152 loops=3)
                           Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 3424kB
                           ->  Parallel Hash Join  (cost=603199.22..619760.48 rows=318 width=41) (actual time=5981.952..6090.463 rows=83152 loops=3)
                                 Hash Cond: (an.person_id = ci.person_id)
                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.033..82.424 rows=300448 loops=3)
                                 ->  Parallel Hash  (cost=603197.49..603197.49 rows=138 width=21) (actual time=5783.067..5783.067 rows=56424 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 1920kB
                                       ->  Parallel Hash Join  (cost=142860.13..603197.49 rows=138 width=21) (actual time=1443.053..5585.421 rows=56424 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.030..2325.208 rows=12081448 loops=3)
                                             ->  Parallel Hash  (cost=142860.03..142860.03 rows=8 width=29) (actual time=1442.806..1442.807 rows=2255 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                                                   ->  Parallel Hash Join  (cost=109121.82..142860.03 rows=8 width=29) (actual time=1112.656..1402.605 rows=2255 loops=3)
                                                         Hash Cond: (mc.company_id = cn.id)
                                                         ->  Parallel Hash Join  (cost=103771.04..137509.19 rows=20 width=33) (actual time=1069.311..1357.699 rows=2887 loops=3)
                                                               Hash Cond: (mc.movie_id = t.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.007..165.774 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=103770.99..103770.99 rows=4 width=25) (actual time=1068.769..1068.769 rows=1795 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                                     ->  Parallel Hash Join  (cost=50878.23..103770.99 rows=4 width=25) (actual time=527.507..824.737 rows=1795 loops=3)
                                                                           Hash Cond: (t.id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=291411 width=21) (actual time=0.023..260.243 rows=230852 loops=3)
                                                                                 Filter: ((episode_nr >= 5) AND (episode_nr < 100))
                                                                                 Rows Removed by Filter: 611919
                                                                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=527.265..527.265 rows=13947 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=18.899..465.670 rows=13947 loops=3)
                                                                                       Hash Cond: (mk.keyword_id = k.id)
                                                                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.078..260.297 rows=1507977 loops=3)
                                                                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.717..18.718 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.842..18.705 rows=1 loops=3)
                                                                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                                   Rows Removed by Filter: 134169
                                                         ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=42.456..42.456 rows=28281 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.028..26.121 rows=28281 loops=3)
                                                                     Filter: ((country_code)::text = '[us]'::text)
                                                                     Rows Removed by Filter: 50051
 Planning Time: 14.562 ms
 Execution Time: 7650.650 ms
(49 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17a.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=680693.62..680693.63 rows=1 width=64) (actual time=7030.682..7030.682 rows=1 loops=1)
   ->  Gather  (cost=680693.40..680693.61 rows=2 width=32) (actual time=7025.174..7098.390 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=679693.40..679693.41 rows=1 width=32) (actual time=7018.091..7018.091 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=600795.85..679693.30 rows=40 width=15) (actual time=6735.792..6999.759 rows=86096 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=140320 width=19) (actual time=8.078..447.606 rows=114466 loops=3)
                           Filter: ((name)::text ~~ 'B%'::text)
                           Rows Removed by Filter: 1274697
                     ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=4) (actual time=6226.719..6226.719 rows=944185 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4192kB
                           ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=4) (actual time=1430.629..5769.041 rows=944185 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.046..2269.031 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=12) (actual time=1430.464..1430.464 rows=22772 loops=3)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5304kB
                                       ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=12) (actual time=1052.850..1380.184 rows=22772 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=16) (actual time=1009.803..1321.128 rows=49517 loops=3)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.010..168.243 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=1009.463..1009.463 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=530.900..892.012 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.019..222.655 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=530.680..530.680 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=18.897..465.335 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..259.124 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.761..18.762 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.824..18.735 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=42.159..42.159 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.035..26.134 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 9.185 ms
 Execution Time: 7099.053 ms
(44 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17b.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=64) (actual time=8016.957..8016.957 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=8015.025..8022.887 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=8008.073..8008.073 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=7647.486..8003.384 rows=17435 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.030..213.412 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=7645.789..7645.789 rows=17435 loops=3)
                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4280kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=7593.408..7629.801 rows=17435 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.006..17.127 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=7593.322..7593.322 rows=17435 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4472kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=7274.360..7563.083 rows=17435 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.017..157.656 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=7273.742..7273.742 rows=2214 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=2236.888..4679.176 rows=2214 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=1727.208..4151.987 rows=89570 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.030..2124.580 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=442.664..442.664 rows=12058 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3032kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=178.846..430.188 rows=12058 loops=3)
                                                                           Filter: ((name)::text ~~ 'Z%'::text)
                                                                           Rows Removed by Filter: 1377106
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=509.536..509.536 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.110..457.964 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..251.814 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.991..18.991 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.795..18.973 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.223 ms
 Execution Time: 8023.514 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17c.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=64) (actual time=5667.375..5667.375 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=5666.729..5674.427 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=5659.632..5659.632 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=5337.035..5659.380 rows=639 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.027..223.033 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=5320.903..5320.903 rows=639 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=5261.724..5287.740 rows=639 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.007..14.789 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=5261.578..5261.578 rows=639 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=4967.427..5237.537 rows=639 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.014..163.280 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=4963.625..4963.625 rows=83 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=2420.074..4963.414 rows=83 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=1905.549..4447.313 rows=4167 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.039..2291.341 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=601.194..601.194 rows=888 loops=3)
                                                                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=181.045..421.539 rows=888 loops=3)
                                                                           Filter: ((name)::text ~~ 'X%'::text)
                                                                           Rows Removed by Filter: 1388276
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=514.351..514.351 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.535..462.492 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..256.275 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.414..19.414 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.800..19.395 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.213 ms
 Execution Time: 5675.077 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17d.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=661669.41..661669.42 rows=1 width=32) (actual time=6936.674..6936.674 rows=1 loops=1)
   ->  Gather  (cost=661669.19..661669.40 rows=2 width=32) (actual time=6935.904..6943.189 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=660669.19..660669.20 rows=1 width=32) (actual time=6929.012..6929.012 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=610186.06..660669.19 rows=1 width=15) (actual time=6597.430..6927.905 rows=3846 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.032..213.988 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=610186.05..610186.05 rows=1 width=27) (actual time=6592.245..6592.246 rows=3846 loops=3)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                           ->  Parallel Hash Join  (cost=605290.32..610186.05 rows=1 width=27) (actual time=6556.945..6585.847 rows=3846 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.006..16.114 rows=78332 loops=3)
                                 ->  Parallel Hash  (cost=605290.31..605290.31 rows=1 width=31) (actual time=6556.861..6556.861 rows=3846 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1048kB
                                       ->  Parallel Hash Join  (cost=571552.17..605290.31 rows=1 width=31) (actual time=6237.480..6517.829 rows=3846 loops=3)
                                             Hash Cond: (mc.movie_id = ci.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.017..158.212 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=23) (actual time=6235.211..6235.211 rows=657 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                   ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=23) (actual time=1274.472..4966.485 rows=657 loops=3)
                                                         Hash Cond: (ci.movie_id = mk.movie_id)
                                                         ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=739.533..4451.321 rows=16097 loops=3)
                                                               Hash Cond: (ci.person_id = n.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.031..2154.325 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=736.690..736.690 rows=1739 loops=3)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=3.456..488.907 rows=1739 loops=3)
                                                                           Filter: ((name)::text ~~ '%Bert%'::text)
                                                                           Rows Removed by Filter: 1387425
                                                         ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=510.566..510.566 rows=13947 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                               ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.339..457.833 rows=13947 loops=3)
                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.019..251.504 rows=1507977 loops=3)
                                                                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.101..19.101 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.794..19.082 rows=1 loops=3)
                                                                                 Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                 Rows Removed by Filter: 134169
 Planning Time: 9.299 ms
 Execution Time: 6943.892 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17e.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=694312.07..694312.08 rows=1 width=32) (actual time=7764.995..7764.995 rows=1 loops=1)
   ->  Gather  (cost=694311.86..694312.07 rows=2 width=32) (actual time=7759.556..7919.911 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=693311.86..693311.87 rows=1 width=32) (actual time=7752.814..7752.814 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=600795.85..693310.60 rows=501 width=15) (actual time=6938.106..7591.252 rows=944185 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.044..373.497 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=600789.59..600789.59 rows=501 width=4) (actual time=6018.857..6018.857 rows=944185 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4192kB
                           ->  Parallel Hash Join  (cost=140451.09..600789.59 rows=501 width=4) (actual time=1380.561..5573.745 rows=944185 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.040..2142.210 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=140450.75..140450.75 rows=27 width=12) (actual time=1380.431..1380.431 rows=22772 loops=3)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5304kB
                                       ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=12) (actual time=1019.478..1335.627 rows=22772 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=16) (actual time=977.731..1278.917 rows=49517 loops=3)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.009..157.641 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=977.459..977.459 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=525.780..881.888 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.036..219.250 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=525.540..525.540 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=18.803..459.932 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.037..252.636 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.655..18.655 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.792..18.631 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=40.831..40.831 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4416kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.030..25.403 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 9.143 ms
 Execution Time: 7921.737 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/17f.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=682238.58..682238.59 rows=1 width=32) (actual time=6912.483..6912.484 rows=1 loops=1)
   ->  Gather  (cost=682238.36..682238.57 rows=2 width=32) (actual time=6905.513..6963.781 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=681238.36..681238.37 rows=1 width=32) (actual time=6898.858..6898.858 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=647498.67..681237.95 rows=167 width=15) (actual time=6328.047..6833.262 rows=371040 loops=3)
                     Hash Cond: (mc.company_id = cn.id)
                     ->  Parallel Hash Join  (cost=641393.41..675132.25 rows=167 width=19) (actual time=6259.167..6667.428 rows=371040 loops=3)
                           Hash Cond: (mc.movie_id = ci.movie_id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.017..158.808 rows=869710 loops=3)
                           ->  Parallel Hash  (cost=641392.63..641392.63 rows=63 width=27) (actual time=6258.810..6258.810 rows=49831 loops=3)
                                 Buckets: 262144 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 13400kB
                                 ->  Parallel Hash Join  (cost=561705.80..641392.63 rows=63 width=27) (actual time=6056.344..6205.573 rows=49831 loops=3)
                                       Hash Cond: (n.id = ci.person_id)
                                       ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=210479 width=19) (actual time=0.056..509.205 rows=178905 loops=3)
                                             Filter: ((name)::text ~~ '%B%'::text)
                                             Rows Removed by Filter: 1210258
                                       ->  Parallel Hash  (cost=561699.31..561699.31 rows=519 width=16) (actual time=5458.193..5458.193 rows=346131 loops=3)
                                             Buckets: 65536 (originally 2048)  Batches: 16 (originally 1)  Memory Usage: 3680kB
                                             ->  Parallel Hash Join  (cost=101361.58..561699.31 rows=519 width=16) (actual time=978.120..5191.707 rows=346131 loops=3)
                                                   Hash Cond: (ci.movie_id = t.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.026..2230.709 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=8) (actual time=977.994..977.994 rows=13947 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                         ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=8) (actual time=522.864..879.079 rows=13947 loops=3)
                                                               Hash Cond: (t.id = mk.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=4) (actual time=0.047..218.746 rows=842771 loops=3)
                                                               ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=522.633..522.633 rows=13947 loops=3)
                                                                     Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                                                     ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.015..460.727 rows=13947 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.034..253.087 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.807..18.807 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.805..18.785 rows=1 loops=3)
                                                                                       Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                                                       Rows Removed by Filter: 134169
                     ->  Parallel Hash  (cost=4377.34..4377.34 rows=138234 width=4) (actual time=66.231..66.231 rows=78332 loops=3)
                           Buckets: 262144  Batches: 1  Memory Usage: 11264kB
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4377.34 rows=138234 width=4) (actual time=0.022..23.018 rows=78332 loops=3)
 Planning Time: 9.166 ms
 Execution Time: 6964.392 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18a.sql_explained.sql
SET
SET
                                                                                          QUERY PLAN                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=833190.17..833190.18 rows=1 width=96) (actual time=5952.901..5952.901 rows=1 loops=1)
   ->  Gather  (cost=833189.95..833190.16 rows=2 width=96) (actual time=5952.571..5958.617 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=832189.95..832189.96 rows=1 width=96) (actual time=5945.688..5945.689 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=781706.81..832189.94 rows=1 width=65) (actual time=5670.021..5945.418 rows=137 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.048..221.435 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=781706.80..781706.80 rows=1 width=60) (actual time=5613.316..5613.316 rows=137 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=540867.00..781706.80 rows=1 width=60) (actual time=4899.701..5613.043 rows=137 loops=3)
                                 Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                 ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=47) (actual time=1009.382..1746.526 rows=40621 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=51) (actual time=0.042..1121.300 rows=4945240 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.025 rows=1 loops=3)
                                                   Filter: ((info)::text = 'budget'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=540864.56..540864.56 rows=1 width=13) (actual time=3860.923..3860.923 rows=1145 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                       ->  Parallel Hash Join  (cost=525594.29..540864.56 rows=1 width=13) (actual time=3470.010..3646.643 rows=1145 loops=3)
                                             Hash Cond: (mi_idx.movie_id = ci.movie_id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.152..157.152 rows=153308 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.032..75.118 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.041 rows=1 loops=3)
                                                               Filter: ((info)::text = 'votes'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=525591.38..525591.38 rows=39 width=4) (actual time=3469.616..3469.616 rows=2240 loops=3)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                   ->  Parallel Hash Join  (cost=81660.72..525591.38 rows=39 width=4) (actual time=1876.709..3244.984 rows=2240 loops=3)
                                                         Hash Cond: (ci.person_id = n.id)
                                                         ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=941346 width=8) (actual time=297.387..2570.507 rows=793090 loops=3)
                                                               Filter: ((note)::text = ANY ('{(producer),"(executive producer)"}'::text[]))
                                                               Rows Removed by Filter: 11288358
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=72 width=4) (actual time=585.478..585.478 rows=3021 loops=3)
                                                               Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=72 width=4) (actual time=0.187..507.425 rows=3021 loops=3)
                                                                     Filter: (((name)::text ~~ '%Tim%'::text) AND ((gender)::text = 'm'::text))
                                                                     Rows Removed by Filter: 1386143
 Planning Time: 9.515 ms
 Execution Time: 5959.307 ms
(46 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18b.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=886874.06..886874.07 rows=1 width=96) (actual time=5351.469..5351.469 rows=1 loops=1)
   ->  Gather  (cost=886873.83..886874.04 rows=2 width=96) (actual time=5351.072..5357.555 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=885873.83..885873.84 rows=1 width=96) (actual time=5343.995..5343.995 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=832828.60..885873.82 rows=1 width=65) (actual time=5277.832..5343.964 rows=4 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=332069 width=21) (actual time=0.046..256.053 rows=261496 loops=3)
                           Filter: ((production_year >= 2008) AND (production_year <= 2014))
                           Rows Removed by Filter: 581275
                     ->  Parallel Hash  (cost=832828.59..832828.59 rows=1 width=60) (actual time=5058.933..5058.933 rows=5 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=754551.36..832828.59 rows=1 width=60) (actual time=4799.422..5058.831 rows=5 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=255610 width=4) (actual time=187.500..442.157 rows=320518 loops=3)
                                       Filter: ((gender IS NOT NULL) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1068645
                                 ->  Parallel Hash  (cost=754551.35..754551.35 rows=1 width=64) (actual time=4582.242..4582.242 rows=137 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=254530.67..754551.35 rows=1 width=64) (actual time=3472.154..4581.995 rows=137 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=203.164..2881.744 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=254530.66..254530.66 rows=1 width=56) (actual time=1651.227..1651.227 rows=244 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=15184.50..254530.66 rows=1 width=56) (actual time=1486.509..1650.454 rows=244 loops=3)
                                                         Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                         ->  Hash Join  (cost=2.43..239347.45 rows=298 width=47) (actual time=1330.592..1489.983 rows=24086 loops=3)
                                                               Hash Cond: (mi.info_type_id = it1.id)
                                                               ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=33653 width=51) (actual time=933.011..1481.730 rows=24349 loops=3)
                                                                     Filter: ((note IS NULL) AND ((info)::text = ANY ('{Horror,Thriller}'::text[])))
                                                                     Rows Removed by Filter: 4920891
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.014..0.027 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'genres'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=15179.85..15179.85 rows=178 width=9) (actual time=155.466..155.466 rows=5283 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 952kB
                                                               ->  Hash Join  (cost=2.43..15179.85 rows=178 width=9) (actual time=0.282..133.731 rows=5283 loops=3)
                                                                     Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.065..129.529 rows=17883 loops=3)
                                                                           Filter: ((info)::text > '8.0'::text)
                                                                           Rows Removed by Filter: 442129
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.070..0.070 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.046 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'rating'::text)
                                                                                 Rows Removed by Filter: 112
 Planning Time: 9.151 ms
 Execution Time: 5358.241 ms
(52 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/18c.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=917260.31..917260.32 rows=1 width=96) (actual time=6207.608..6207.609 rows=1 loops=1)
   ->  Gather  (cost=917260.08..917260.29 rows=2 width=96) (actual time=6204.154..6223.472 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=916260.08..916260.09 rows=1 width=96) (actual time=6197.208..6197.208 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=865776.83..916260.00 rows=11 width=65) (actual time=5834.841..6190.446 rows=9358 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.053..220.093 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=865776.69..865776.69 rows=11 width=60) (actual time=5832.790..5832.790 rows=9358 loops=3)
                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2200kB
                           ->  Parallel Hash Join  (cost=785749.31..865776.69 rows=11 width=60) (actual time=5258.604..5787.090 rows=9358 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=4) (actual time=0.051..445.960 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=785748.97..785748.97 rows=27 width=64) (actual time=5258.040..5258.040 rows=18052 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4504kB
                                       ->  Parallel Hash Join  (cost=285728.20..785748.97 rows=27 width=64) (actual time=3337.261..5214.409 rows=18052 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=165.370..2907.248 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=285727.93..285727.93 rows=21 width=56) (actual time=2227.257..2227.257 rows=34172 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 7704kB
                                                   ->  Parallel Hash Join  (cost=15319.64..285727.93 rows=21 width=56) (actual time=2146.080..2195.753 rows=34172 loops=3)
                                                         Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                                         ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1639.656..1855.975 rows=62198 loops=3)
                                                               Hash Cond: (mi.info_type_id = it1.id)
                                                               ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1035.164..1838.756 rows=62990 loops=3)
                                                                     Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                     Rows Removed by Filter: 4882250
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.030..0.030 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.015..0.027 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'genres'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=9) (actual time=259.115..259.115 rows=153308 loops=3)
                                                               Buckets: 65536 (originally 16384)  Batches: 8 (originally 1)  Memory Usage: 2880kB
                                                               ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.170..163.014 rows=153308 loops=3)
                                                                     Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.044..77.549 rows=460012 loops=3)
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.067 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.048 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'votes'::text)
                                                                                 Rows Removed by Filter: 112
 Planning Time: 9.160 ms
 Execution Time: 6224.260 ms
(48 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19a.sql_explained.sql
SET
SET
                                                                                                            QUERY PLAN                                                                                                             
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=982370.28..982370.29 rows=1 width=64) (actual time=6465.896..6465.896 rows=1 loops=1)
   ->  Gather  (cost=982370.06..982370.27 rows=2 width=64) (actual time=6465.487..6473.213 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=981370.06..981370.07 rows=1 width=64) (actual time=6457.699..6457.699 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=928667.96..981370.06 rows=1 width=32) (actual time=6295.107..6457.615 rows=61 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=240570 width=21) (actual time=0.044..261.664 rows=191519 loops=3)
                           Filter: ((production_year >= 2005) AND (production_year <= 2009))
                           Rows Removed by Filter: 651252
                     ->  Parallel Hash  (cost=928667.95..928667.95 rows=1 width=27) (actual time=6172.505..6172.505 rows=104 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=923756.66..928667.95 rows=1 width=27) (actual time=6146.634..6172.337 rows=104 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.026..23.009 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=923756.65..923756.65 rows=1 width=31) (actual time=6146.230..6146.230 rows=107 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=888167.49..923756.65 rows=1 width=31) (actual time=5865.825..6146.116 rows=107 loops=3)
                                             Hash Cond: (mc.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=131225 width=8) (actual time=0.039..300.226 rows=196998 loops=3)
                                                   Filter: ((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                                   Rows Removed by Filter: 672712
                                             ->  Parallel Hash  (cost=888167.48..888167.48 rows=1 width=23) (actual time=5825.618..5825.619 rows=68 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=833727.94..888167.48 rows=1 width=23) (actual time=5444.583..5825.519 rows=68 loops=3)
                                                         Hash Cond: (chn.id = ci.person_role_id)
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.039..254.395 rows=1046780 loops=3)
                                                         ->  Parallel Hash  (cost=833727.93..833727.93 rows=1 width=27) (actual time=5441.386..5441.386 rows=75 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=578391.87..833727.93 rows=1 width=27) (actual time=4128.716..5441.263 rows=75 loops=3)
                                                                     Hash Cond: (mi.movie_id = ci.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255330.90 rows=2019 width=4) (actual time=422.711..1767.145 rows=150346 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=182.446..1729.805 rows=150368 loops=3)
                                                                                 Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                 Rows Removed by Filter: 4794872
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.057..0.058 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.034..0.045 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=578389.42..578389.42 rows=2 width=23) (actual time=3656.578..3656.578 rows=142 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Hash Join  (cost=97799.03..578389.42 rows=2 width=23) (actual time=1643.068..3656.419 rows=142 loops=3)
                                                                                 Hash Cond: (ci.role_id = rt.id)
                                                                                 ->  Parallel Hash Join  (cost=97797.87..578388.18 rows=19 width=27) (actual time=1642.933..3656.240 rows=142 loops=3)
                                                                                       Hash Cond: (ci.person_id = n.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.045..2923.774 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=23) (actual time=691.268..691.268 rows=519 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=23) (actual time=566.691..690.726 rows=519 loops=3)
                                                                                                   Hash Cond: (an.person_id = n.id)
                                                                                                   ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.050..79.594 rows=300448 loops=3)
                                                                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=564.788..564.788 rows=2256 loops=3)
                                                                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=216.321..511.773 rows=2256 loops=3)
                                                                                                               Filter: (((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))
                                                                                                               Rows Removed by Filter: 1386908
                                                                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.078..0.083 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.046..0.049 rows=1 loops=3)
                                                                                             Filter: ((role)::text = 'actress'::text)
                                                                                             Rows Removed by Filter: 11
 Planning Time: 52.434 ms
 Execution Time: 6474.168 ms
(69 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=947597.06..947597.07 rows=1 width=64) (actual time=8257.797..8257.798 rows=1 loops=1)
   ->  Gather  (cost=947596.94..947597.05 rows=1 width=64) (actual time=8257.501..8263.046 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=946596.94..946596.95 rows=1 width=64) (actual time=8251.595..8251.596 rows=1 loops=2)
               ->  Parallel Hash Join  (cost=941685.65..946596.94 rows=1 width=32) (actual time=8229.002..8251.570 rows=8 loops=2)
                     Hash Cond: (cn.id = mc.company_id)
                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.014..23.885 rows=42422 loops=2)
                           Filter: ((country_code)::text = '[us]'::text)
                           Rows Removed by Filter: 75077
                     ->  Parallel Hash  (cost=941685.64..941685.64 rows=1 width=36) (actual time=8223.089..8223.089 rows=8 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=903714.47..941685.64 rows=1 width=36) (actual time=8106.567..8223.024 rows=8 loops=2)
                                 Hash Cond: (mc.movie_id = t.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=41669 width=8) (actual time=0.028..401.121 rows=99260 loops=2)
                                       Filter: (((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                       Rows Removed by Filter: 1205305
                                 ->  Parallel Hash  (cost=903714.46..903714.46 rows=1 width=44) (actual time=7810.467..7810.467 rows=2 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Hash Join  (cost=849274.92..903714.46 rows=1 width=44) (actual time=7722.771..7810.427 rows=2 loops=2)
                                             Hash Cond: (chn.id = ci.person_role_id)
                                             ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.029..352.332 rows=1570170 loops=2)
                                             ->  Parallel Hash  (cost=849274.91..849274.91 rows=1 width=48) (actual time=7270.013..7270.013 rows=2 loops=2)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Parallel Hash Join  (cost=833137.42..849274.91 rows=1 width=48) (actual time=7202.286..7269.952 rows=2 loops=2)
                                                         Hash Cond: (n.id = ci.person_id)
                                                         ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=23) (actual time=799.510..972.676 rows=648 loops=2)
                                                               Hash Cond: (an.person_id = n.id)
                                                               ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.031..107.922 rows=450672 loops=2)
                                                               ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=798.228..798.228 rows=2704 loops=2)
                                                                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=329.157..776.988 rows=2704 loops=2)
                                                                           Filter: (((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))
                                                                           Rows Removed by Filter: 2081041
                                                         ->  Parallel Hash  (cost=751477.09..751477.09 rows=1 width=37) (actual time=6297.082..6297.082 rows=8 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=496679.24..751477.09 rows=1 width=37) (actual time=4792.271..6297.023 rows=8 loops=2)
                                                                     Hash Cond: (mi.movie_id = t.id)
                                                                     ->  Hash Join  (cost=2.43..254799.18 rows=291 width=4) (actual time=615.690..2493.904 rows=34739 loops=2)
                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=32862 width=8) (actual time=615.529..2481.539 rows=34739 loops=2)
                                                                                 Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%2007%'::text) OR ((info)::text ~~ 'USA:%2008%'::text)))
                                                                                 Rows Removed by Filter: 7383121
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.047 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=496676.80..496676.80 rows=1 width=33) (actual time=3798.182..3798.182 rows=8 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Hash Join  (cost=54434.90..496676.80 rows=1 width=33) (actual time=1693.274..3798.080 rows=8 loops=2)
                                                                                 Hash Cond: (ci.role_id = rt.id)
                                                                                 ->  Parallel Hash Join  (cost=54433.73..496675.63 rows=3 width=37) (actual time=490.531..3797.943 rows=36 loops=2)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=298009 width=16) (actual time=0.095..3388.066 rows=356914 loops=2)
                                                                                             Filter: ((note)::text = '(voice)'::text)
                                                                                             Rows Removed by Filter: 17765258
                                                                                       ->  Parallel Hash  (cost=54433.61..54433.61 rows=10 width=21) (actual time=361.266..361.266 rows=4 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=10 width=21) (actual time=162.946..361.202 rows=4 loops=2)
                                                                                                   Filter: ((production_year >= 2007) AND (production_year <= 2008) AND ((title)::text ~~ '%Kung%Fu%Panda%'::text))
                                                                                                   Rows Removed by Filter: 1264152
                                                                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=2)
                                                                                             Filter: ((role)::text = 'actress'::text)
                                                                                             Rows Removed by Filter: 11
 Planning Time: 51.886 ms
 Execution Time: 8263.990 ms
(69 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19c.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=979421.66..979421.67 rows=1 width=64) (actual time=8507.222..8507.222 rows=1 loops=1)
   ->  Gather  (cost=979421.44..979421.65 rows=2 width=64) (actual time=8506.423..8513.861 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=978421.44..978421.45 rows=1 width=64) (actual time=8498.542..8498.542 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=961861.47..978421.43 rows=2 width=32) (actual time=8383.679..8498.111 rows=1192 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.025..73.545 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=961861.46..961861.46 rows=1 width=40) (actual time=8380.770..8380.770 rows=877 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                           ->  Parallel Hash Join  (cost=956950.17..961861.46 rows=1 width=40) (actual time=8356.739..8378.233 rows=877 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.018..17.620 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=956950.15..956950.15 rows=2 width=44) (actual time=8356.549..8356.549 rows=2862 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                       ->  Parallel Hash Join  (cost=923212.00..956950.15 rows=2 width=44) (actual time=8056.230..8334.476 rows=2862 loops=3)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.024..156.868 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=923211.99..923211.99 rows=1 width=52) (actual time=8051.727..8051.727 rows=710 loops=3)
                                                   Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                   ->  Parallel Hash Join  (cost=868772.46..923211.99 rows=1 width=52) (actual time=7549.554..7936.527 rows=710 loops=3)
                                                         Hash Cond: (chn.id = ci.person_role_id)
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=1.013..239.304 rows=1046780 loops=3)
                                                         ->  Parallel Hash  (cost=868772.44..868772.44 rows=1 width=56) (actual time=7546.966..7546.966 rows=755 loops=3)
                                                               Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                               ->  Parallel Hash Join  (cost=817446.81..868772.44 rows=1 width=56) (actual time=7212.210..7534.761 rows=755 loops=3)
                                                                     Hash Cond: (t.id = mi.movie_id)
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.039..268.705 rows=460484 loops=3)
                                                                           Filter: (production_year > 2000)
                                                                           Rows Removed by Filter: 382286
                                                                     ->  Parallel Hash  (cost=817446.79..817446.79 rows=2 width=35) (actual time=7210.157..7210.157 rows=840 loops=3)
                                                                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                                           ->  Parallel Hash Join  (cost=562110.73..817446.79 rows=2 width=35) (actual time=3967.975..5245.330 rows=840 loops=3)
                                                                                 Hash Cond: (mi.movie_id = ci.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..255330.90 rows=2019 width=4) (actual time=412.799..1673.863 rows=150346 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=176.908..1637.188 rows=150368 loops=3)
                                                                                             Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                             Rows Removed by Filter: 4794872
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.048 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'release dates'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=562103.89..562103.89 rows=353 width=31) (actual time=3549.848..3549.848 rows=2184 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 568kB
                                                                                       ->  Hash Join  (cost=81911.39..562103.89 rows=353 width=31) (actual time=1437.224..3378.393 rows=2184 loops=3)
                                                                                             Hash Cond: (ci.role_id = rt.id)
                                                                                             ->  Parallel Hash Join  (cost=81910.23..562087.69 rows=4234 width=35) (actual time=1437.106..3377.478 rows=2185 loops=3)
                                                                                                   Hash Cond: (ci.person_id = n.id)
                                                                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.075..2800.670 rows=289159 loops=3)
                                                                                                         Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                                         Rows Removed by Filter: 11792289
                                                                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=532.163..532.163 rows=16670 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=217.821..519.518 rows=16670 loops=3)
                                                                                                               Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                                               Rows Removed by Filter: 1372493
                                                                                             ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=3)
                                                                                                         Filter: ((role)::text = 'actress'::text)
                                                                                                         Rows Removed by Filter: 11
 Planning Time: 51.391 ms
 Execution Time: 8514.842 ms
(67 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/19d.sql_explained.sql
SET
SET
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=992869.82..992869.83 rows=1 width=64) (actual time=9590.303..9590.304 rows=1 loops=1)
   ->  Gather  (cost=992869.60..992869.81 rows=2 width=64) (actual time=9518.173..9857.297 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=991869.60..991869.61 rows=1 width=64) (actual time=9536.886..9536.886 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=975303.84..991864.20 rows=1080 width=32) (actual time=9162.557..9382.958 rows=586882 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.034..74.536 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=975297.96..975297.96 rows=470 width=40) (actual time=8937.755..8937.755 rows=262348 loops=3)
                           Buckets: 65536 (originally 2048)  Batches: 32 (originally 1)  Memory Usage: 4384kB
                           ->  Parallel Hash Join  (cost=941555.37..975297.96 rows=470 width=40) (actual time=8185.524..8711.803 rows=262348 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Hash Join  (cost=936204.59..969943.78 rows=1294 width=44) (actual time=8144.997..8527.367 rows=1076352 loops=3)
                                       Hash Cond: (mc.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.035..160.782 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=936201.50..936201.50 rows=247 width=52) (actual time=7746.380..7746.380 rows=113945 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 2624kB
                                             ->  Parallel Hash Join  (cost=884874.85..936201.50 rows=247 width=52) (actual time=7441.867..7631.674 rows=113945 loops=3)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.045..271.898 rows=460484 loops=3)
                                                         Filter: (production_year > 2000)
                                                         Rows Removed by Filter: 382286
                                                   ->  Parallel Hash  (cost=884869.20..884869.20 rows=452 width=31) (actual time=6991.875..6991.875 rows=166016 loops=3)
                                                         Buckets: 65536 (originally 2048)  Batches: 16 (originally 1)  Memory Usage: 2944kB
                                                         ->  Parallel Hash Join  (cost=636506.19..884869.20 rows=452 width=31) (actual time=6649.950..6863.324 rows=166016 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Hash Join  (cost=565505.50..808738.07 rows=934 width=35) (actual time=5878.959..6007.236 rows=182242 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Hash Join  (cost=480903.52..721760.35 rows=4089 width=16) (actual time=5077.808..5261.333 rows=182372 loops=3)
                                                                           Hash Cond: (mi.movie_id = ci.movie_id)
                                                                           ->  Hash Join  (cost=2.43..240637.08 rows=54704 width=4) (actual time=453.191..1888.415 rows=1012240 loops=3)
                                                                                 Hash Cond: (mi.info_type_id = it.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..223799.50 rows=6181550 width=8) (actual time=0.057..1128.283 rows=4945240 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.043 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'release dates'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=480518.83..480518.83 rows=30581 width=12) (actual time=2936.630..2936.631 rows=92055 loops=3)
                                                                                 Buckets: 65536 (originally 131072)  Batches: 8 (originally 1)  Memory Usage: 2176kB
                                                                                 ->  Hash Join  (cost=1.16..480518.83 rows=30581 width=12) (actual time=900.639..2860.782 rows=92055 loops=3)
                                                                                       Hash Cond: (ci.role_id = rt.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.053..2797.930 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.029..0.030 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=3)
                                                                                                   Filter: ((role)::text = 'actress'::text)
                                                                                                   Rows Removed by Filter: 11
                                                                     ->  Parallel Hash  (cost=77318.68..77318.68 rows=396664 width=19) (actual time=549.778..549.779 rows=320518 loops=3)
                                                                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                                                                           ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=396664 width=19) (actual time=182.268..440.114 rows=320518 loops=3)
                                                                                 Filter: ((gender)::text = 'f'::text)
                                                                                 Rows Removed by Filter: 1068645
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=4) (actual time=561.840..561.840 rows=1046780 loops=3)
                                                                     Buckets: 131072  Batches: 64  Memory Usage: 3008kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=4) (actual time=0.060..281.404 rows=1046780 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.651..39.651 rows=28281 loops=3)
                                       Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.033..25.315 rows=28281 loops=3)
                                             Filter: ((country_code)::text = '[us]'::text)
                                             Rows Removed by Filter: 50051
 Planning Time: 51.595 ms
 Execution Time: 9858.289 ms
(65 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=104638.31..104638.32 rows=1 width=68) (actual time=847.513..847.513 rows=1 loops=1)
   ->  Gather  (cost=104638.09..104638.30 rows=2 width=68) (actual time=847.022..852.596 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=103638.09..103638.10 rows=1 width=68) (actual time=840.456..840.456 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=53154.41..103637.73 rows=47 width=45) (actual time=736.583..840.357 rows=47 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=25) (actual time=0.041..217.023 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=53153.83..53153.83 rows=47 width=32) (actual time=517.279..517.279 rows=47 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=37883.38..53153.83 rows=47 width=32) (actual time=516.807..516.989 rows=47 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mc.movie_id)
                                 ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=134.020..134.059 rows=83 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.028..78.234 rows=460012 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.056 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=3)
                                                   Filter: ((info)::text = 'top 250 rank'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=37857.14..37857.14 rows=1905 width=28) (actual time=382.675..382.675 rows=9552 loops=3)
                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2112kB
                                       ->  Hash Join  (cost=1.06..37857.14 rows=1905 width=28) (actual time=276.783..371.987 rows=9552 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=7618 width=32) (actual time=52.007..368.215 rows=9630 loops=3)
                                                   Filter: (((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND (((note)::text ~~ '%(co-production)%'::text) OR ((note)::text ~~ '%(presents)%'::text)))
                                                   Rows Removed by Filter: 860080
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.035 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'production companies'::text)
                                                         Rows Removed by Filter: 3
 Planning Time: 4.139 ms
 Execution Time: 853.106 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1b.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=103766.13..103766.14 rows=1 width=68) (actual time=740.414..740.415 rows=1 loops=1)
   ->  Gather  (cost=103765.91..103766.12 rows=2 width=68) (actual time=740.217..745.817 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=102765.91..102765.92 rows=1 width=68) (actual time=733.681..733.681 rows=1 loops=3)
               ->  Hash Join  (cost=68268.30..102758.62 rows=972 width=45) (actual time=719.058..733.659 rows=1 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=68267.24..102736.53 rows=3890 width=49) (actual time=576.096..733.310 rows=22 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=556503 width=32) (actual time=0.039..265.247 rows=445696 loops=3)
                                 Filter: ((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)
                                 Rows Removed by Filter: 424014
                           ->  Parallel Hash  (cost=68249.11..68249.11 rows=1450 width=29) (actual time=423.346..423.346 rows=1 loops=3)
                                 Buckets: 4096  Batches: 1  Memory Usage: 96kB
                                 ->  Parallel Hash Join  (cost=15317.21..68249.11 rows=1450 width=29) (actual time=369.393..423.231 rows=1 loops=3)
                                       Hash Cond: (t.id = mi_idx.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=300243 width=25) (actual time=0.040..262.639 rows=238753 loops=3)
                                             Filter: ((production_year >= 2005) AND (production_year <= 2010))
                                             Rows Removed by Filter: 604018
                                       ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=4) (actual time=132.284..132.284 rows=3 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 160kB
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=132.235..132.237 rows=3 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.044..75.990 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.046 rows=1 loops=3)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.041..0.043 rows=1 loops=3)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 3.868 ms
 Execution Time: 746.346 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=101209.01..101209.02 rows=1 width=68) (actual time=714.322..714.323 rows=1 loops=1)
   ->  Gather  (cost=101208.79..101209.00 rows=2 width=68) (actual time=713.870..719.601 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=100208.79..100208.80 rows=1 width=68) (actual time=707.408..707.408 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=50420.55..100208.75 rows=5 width=45) (actual time=689.012..707.401 rows=1 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=25) (actual time=0.039..242.493 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=50420.11..50420.11 rows=35 width=32) (actual time=447.652..447.652 rows=8 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=35149.70..50420.11 rows=35 width=32) (actual time=447.305..447.402 rows=8 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mc.movie_id)
                                 ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=133.175..133.211 rows=83 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.035..77.660 rows=460012 loops=3)
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.037 rows=1 loops=3)
                                                   Filter: ((info)::text = 'top 250 rank'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=35129.26..35129.26 rows=1441 width=28) (actual time=314.019..314.019 rows=5937 loops=3)
                                       Buckets: 32768 (originally 4096)  Batches: 1 (originally 1)  Memory Usage: 1536kB
                                       ->  Hash Join  (cost=1.06..35129.26 rows=1441 width=28) (actual time=214.110..301.569 rows=5937 loops=3)
                                             Hash Cond: (mc.company_type_id = ct.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=5762 width=32) (actual time=137.918..299.036 rows=5939 loops=3)
                                                   Filter: (((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text) AND ((note)::text ~~ '%(co-production)%'::text))
                                                   Rows Removed by Filter: 863771
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.061..0.061 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.042..0.043 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'production companies'::text)
                                                         Rows Removed by Filter: 3
 Planning Time: 3.975 ms
 Execution Time: 720.111 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/1d.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=102217.02..102217.03 rows=1 width=68) (actual time=770.546..770.547 rows=1 loops=1)
   ->  Gather  (cost=102216.80..102217.01 rows=2 width=68) (actual time=770.284..776.010 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=101216.80..101216.81 rows=1 width=68) (actual time=763.878..763.879 rows=1 loops=3)
               ->  Hash Join  (cost=66690.26..101202.81 rows=1865 width=45) (actual time=745.391..763.862 rows=1 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=66689.20..101161.42 rows=7460 width=49) (actual time=564.016..763.539 rows=26 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=556503 width=32) (actual time=0.036..265.638 rows=445696 loops=3)
                                 Filter: ((note)::text !~~ '%(as Metro-Goldwyn-Mayer Pictures)%'::text)
                                 Rows Removed by Filter: 424014
                           ->  Parallel Hash  (cost=66654.42..66654.42 rows=2782 width=29) (actual time=452.938..452.938 rows=2 loops=3)
                                 Buckets: 8192  Batches: 1  Memory Usage: 160kB
                                 ->  Parallel Hash Join  (cost=15317.21..66654.42 rows=2782 width=29) (actual time=359.596..452.804 rows=2 loops=3)
                                       Hash Cond: (t.id = mi_idx.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.043..271.028 rows=460484 loops=3)
                                             Filter: (production_year > 2000)
                                             Rows Removed by Filter: 382286
                                       ->  Parallel Hash  (cost=15253.60..15253.60 rows=5089 width=4) (actual time=132.904..132.904 rows=3 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 160kB
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=4) (actual time=132.804..132.807 rows=3 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=8) (actual time=0.040..76.713 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.062..0.063 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=3)
                                                               Filter: ((info)::text = 'bottom 10 rank'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=3)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 3.806 ms
 Execution Time: 776.499 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20a.sql_explained.sql
SET
SET
                                                                                                 QUERY PLAN                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=690921.15..690921.16 rows=1 width=32) (actual time=5618.607..5618.608 rows=1 loops=1)
   ->  Hash Join  (cost=611431.78..690921.14 rows=1 width=17) (actual time=5239.236..5618.578 rows=33 loops=1)
         Hash Cond: (t.kind_id = kt.id)
         ->  Gather  (cost=611430.68..690920.04 rows=1 width=21) (actual time=5239.105..5624.864 rows=33 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=610430.68..689919.94 rows=1 width=21) (actual time=5213.045..5610.790 rows=11 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.044..377.395 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=610430.67..610430.67 rows=1 width=25) (actual time=5062.674..5062.674 rows=11 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Hash Join  (cost=557690.68..610430.67 rows=1 width=25) (actual time=5006.692..5062.565 rows=11 loops=3)
                                 Hash Cond: (t.id = cc.movie_id)
                                 ->  Parallel Hash Join  (cost=554588.26..607328.24 rows=1 width=37) (actual time=4710.688..4963.722 rows=59 loops=3)
                                       Hash Cond: (t.id = mk.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=952979 width=25) (actual time=0.052..280.057 rows=762424 loops=3)
                                             Filter: (production_year > 1950)
                                             Rows Removed by Filter: 80347
                                       ->  Parallel Hash  (cost=554588.25..554588.25 rows=1 width=12) (actual time=4608.628..4608.628 rows=59 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=111235.39..554588.25 rows=1 width=12) (actual time=1290.676..4608.506 rows=59 loops=3)
                                                   Hash Cond: (ci.movie_id = mk.movie_id)
                                                   ->  Parallel Hash Join  (cost=59349.58..502696.95 rows=1460 width=8) (actual time=601.338..3998.898 rows=185 loops=3)
                                                         Hash Cond: (ci.person_role_id = chn.id)
                                                         ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.027..2123.069 rows=12081448 loops=3)
                                                         ->  Parallel Hash  (cost=59346.31..59346.31 rows=262 width=4) (actual time=537.562..537.562 rows=10 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Seq Scan on char_name chn  (cost=0.00..59346.31 rows=262 width=4) (actual time=57.028..537.480 rows=10 loops=3)
                                                                     Filter: (((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))
                                                                     Rows Removed by Filter: 1046770
                                                   ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=4) (actual time=609.403..609.403 rows=11849 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                         ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=4) (actual time=58.258..502.091 rows=11849 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.039..256.045 rows=1507977 loops=3)
                                                               ->  Hash  (cost=3632.40..3632.40 rows=8 width=4) (actual time=58.011..58.011 rows=8 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=4) (actual time=0.236..57.993 rows=8 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                                           Rows Removed by Filter: 134162
                                 ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=98.525..98.525 rows=85941 loops=3)
                                       Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                       ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.237..72.103 rows=85941 loops=3)
                                             Hash Cond: (cc.status_id = cct2.id)
                                             ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.119..53.957 rows=85941 loops=3)
                                                   Hash Cond: (cc.subject_id = cct1.id)
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.040..23.215 rows=135086 loops=3)
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'cast'::text)
                                                               Rows Removed by Filter: 3
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.064..0.064 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.045..0.047 rows=2 loops=3)
                                                         Filter: ((kind)::text ~~ '%complete%'::text)
                                                         Rows Removed by Filter: 2
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.036..0.038 rows=1 loops=1)
                     Filter: ((kind)::text = 'movie'::text)
                     Rows Removed by Filter: 6
 Planning Time: 34.867 ms
 Execution Time: 5625.923 ms
(64 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20b.sql_explained.sql
SET
SET
                                                                                                   QUERY PLAN                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=687335.89..687335.90 rows=1 width=32) (actual time=5609.383..5609.384 rows=1 loops=1)
   ->  Gather  (cost=687335.68..687335.89 rows=2 width=32) (actual time=5608.884..5616.519 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=686335.68..686335.69 rows=1 width=32) (actual time=5601.324..5601.324 rows=1 loops=3)
               ->  Hash Join  (cost=635010.03..686335.67 rows=1 width=17) (actual time=5555.415..5601.296 rows=6 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=635008.93..686334.57 rows=1 width=21) (actual time=5555.095..5600.972 rows=6 loops=3)
                           Hash Cond: (t.id = cc.movie_id)
                           ->  Parallel Hash Join  (cost=631906.51..683232.14 rows=1 width=33) (actual time=5460.101..5505.973 rows=17 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.048..276.499 rows=460484 loops=3)
                                       Filter: (production_year > 2000)
                                       Rows Removed by Filter: 382286
                                 ->  Parallel Hash  (cost=631906.50..631906.50 rows=1 width=8) (actual time=5182.473..5182.473 rows=17 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=583654.16..631906.50 rows=1 width=8) (actual time=4955.610..5182.274 rows=17 loops=3)
                                             Hash Cond: (mk.movie_id = ci.movie_id)
                                             ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=4) (actual time=41.741..490.298 rows=11849 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.054..260.244 rows=1507977 loops=3)
                                                   ->  Hash  (cost=3632.40..3632.40 rows=8 width=4) (actual time=41.425..41.425 rows=8 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=4) (actual time=0.182..41.405 rows=8 loops=3)
                                                               Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                               Rows Removed by Filter: 134162
                                             ->  Parallel Hash  (cost=580021.64..580021.64 rows=1 width=4) (actual time=4689.517..4689.518 rows=5 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=136670.44..580021.64 rows=1 width=4) (actual time=1378.492..4689.402 rows=5 loops=3)
                                                         Hash Cond: (ci.person_id = n.id)
                                                         ->  Parallel Hash Join  (cost=59349.58..502696.95 rows=1460 width=8) (actual time=599.053..4193.898 rows=185 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.036..2288.726 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=59346.31..59346.31 rows=262 width=4) (actual time=556.717..556.717 rows=10 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..59346.31 rows=262 width=4) (actual time=24.979..556.540 rows=10 loops=3)
                                                                           Filter: (((name)::text !~~ '%Sherlock%'::text) AND (((name)::text ~~ '%Tony%Stark%'::text) OR ((name)::text ~~ '%Iron%Man%'::text)))
                                                                           Rows Removed by Filter: 1046770
                                                         ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=4) (actual time=495.390..495.390 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=4) (actual time=198.641..495.316 rows=1 loops=3)
                                                                     Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                                     Rows Removed by Filter: 1389163
                           ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=94.664..94.665 rows=85941 loops=3)
                                 Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                 ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.227..68.188 rows=85941 loops=3)
                                       Hash Cond: (cc.status_id = cct2.id)
                                       ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.131..49.951 rows=85941 loops=3)
                                             Hash Cond: (cc.subject_id = cct1.id)
                                             ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.048..19.118 rows=135086 loops=3)
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.027..0.027 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'cast'::text)
                                                         Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.045..0.045 rows=2 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.034 rows=2 loops=3)
                                                   Filter: ((kind)::text ~~ '%complete%'::text)
                                                   Rows Removed by Filter: 2
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.037..0.039 rows=1 loops=3)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 34.948 ms
 Execution Time: 5617.518 ms
(67 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/20c.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=689631.09..689631.10 rows=1 width=64) (actual time=6267.510..6267.510 rows=1 loops=1)
   ->  Gather  (cost=610141.72..689631.08 rows=1 width=32) (actual time=5687.697..6270.644 rows=5406 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Hash Join  (cost=609141.72..688630.98 rows=1 width=32) (actual time=5681.135..6253.755 rows=1802 loops=3)
               Hash Cond: (t.kind_id = kt.id)
               ->  Parallel Hash Join  (cost=609140.62..688629.88 rows=1 width=36) (actual time=5680.781..6252.460 rows=1906 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.043..369.052 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=609140.61..609140.61 rows=1 width=25) (actual time=5679.373..5679.373 rows=1906 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=557788.53..609140.61 rows=1 width=25) (actual time=5284.937..5613.931 rows=1906 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Hash Join  (cost=3102.42..54447.27 rows=1923 width=29) (actual time=94.633..433.555 rows=7852 loops=3)
                                       Hash Cond: (t.id = cc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.037..268.665 rows=460484 loops=3)
                                             Filter: (production_year > 2000)
                                             Rows Removed by Filter: 382286
                                       ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=94.209..94.209 rows=85941 loops=3)
                                             Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                             ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.243..67.590 rows=85941 loops=3)
                                                   Hash Cond: (cc.status_id = cct2.id)
                                                   ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.118..49.376 rows=85941 loops=3)
                                                         Hash Cond: (cc.subject_id = cct1.id)
                                                         ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.040..18.695 rows=135086 loops=3)
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.022..0.022 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.010..0.011 rows=1 loops=3)
                                                                     Filter: ((kind)::text = 'cast'::text)
                                                                     Rows Removed by Filter: 3
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.063..0.063 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.048..0.050 rows=2 loops=3)
                                                               Filter: ((kind)::text ~~ '%complete%'::text)
                                                               Rows Removed by Filter: 2
                                 ->  Parallel Hash  (cost=554683.94..554683.94 rows=174 width=12) (actual time=5176.176..5176.177 rows=12272 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2776kB
                                       ->  Parallel Hash Join  (cost=109433.18..554683.94 rows=174 width=12) (actual time=1095.174..4930.919 rows=12272 loops=3)
                                             Hash Cond: (ci.movie_id = mk.movie_id)
                                             ->  Parallel Hash Join  (cost=57211.57..500558.94 rows=507378 width=8) (actual time=503.803..4292.205 rows=207862 loops=3)
                                                   Hash Cond: (ci.person_role_id = chn.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.035..2157.847 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=56075.12..56075.12 rows=90916 width=4) (actual time=502.000..502.000 rows=60051 loops=3)
                                                         Buckets: 262144  Batches: 1  Memory Usage: 9152kB
                                                         ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=4) (actual time=0.048..461.390 rows=60051 loops=3)
                                                               Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                                               Rows Removed by Filter: 986729
                                             ->  Parallel Hash  (cost=52219.86..52219.86 rows=140 width=4) (actual time=590.655..590.655 rows=8030 loops=3)
                                                   Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                   ->  Hash Join  (cost=3967.95..52219.86 rows=140 width=4) (actual time=46.241..486.770 rows=8030 loops=3)
                                                         Hash Cond: (mk.keyword_id = k.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.043..252.938 rows=1507977 loops=3)
                                                         ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=46.077..46.078 rows=10 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.211..46.059 rows=10 loops=3)
                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                     Rows Removed by Filter: 134160
               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.035..0.037 rows=1 loops=3)
                           Filter: ((kind)::text = 'movie'::text)
                           Rows Removed by Filter: 6
 Planning Time: 34.112 ms
 Execution Time: 6274.303 ms
(64 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21a.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=63661.87..63661.88 rows=1 width=96) (actual time=731.372..731.372 rows=1 loops=1)
   ->  Gather  (cost=63661.76..63661.87 rows=1 width=96) (actual time=731.105..737.042 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=62661.76..62661.77 rows=1 width=96) (actual time=725.456..725.456 rows=1 loops=2)
               ->  Hash Join  (cost=57154.03..62661.75 rows=1 width=118) (actual time=668.277..725.135 rows=705 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=57152.97..62660.68 rows=1 width=122) (actual time=665.988..724.783 rows=752 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.036..60.483 rows=24151 loops=2)
                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                 Rows Removed by Filter: 93348
                           ->  Parallel Hash  (cost=57152.95..57152.95 rows=1 width=107) (actual time=660.374..660.374 rows=1562 loops=2)
                                 Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                 ->  Hash Join  (cost=3473.02..57152.95 rows=1 width=107) (actual time=310.406..568.460 rows=1562 loops=2)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=846.89..54494.99 rows=12124 width=111) (actual time=82.294..546.873 rows=27148 loops=2)
                                             Merge Cond: (ml.movie_id = mk.movie_id)
                                             ->  Merge Join  (cost=651.93..51228.28 rows=260 width=123) (actual time=80.703..505.700 rows=3220 loops=2)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=651.50..46001.67 rows=102 width=111) (actual time=77.750..469.152 rows=656 loops=2)
                                                         Merge Cond: (ml.movie_id = t.id)
                                                         ->  Merge Join  (cost=651.07..37165.42 rows=282 width=90) (actual time=15.516..258.493 rows=1391 loops=2)
                                                               Merge Cond: (mi.movie_id = ml.movie_id)
                                                               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1002971.17 rows=60182 width=4) (actual time=1.349..246.814 rows=2058 loops=2)
                                                                     Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                                                                     Rows Removed by Filter: 255305
                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.503..10.753 rows=3172 loops=2)
                                                                     Sort Key: ml.movie_id
                                                                     Sort Method: quicksort  Memory: 205kB
                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.137..9.250 rows=2315 loops=2)
                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.030..4.972 rows=29997 loops=2)
                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.058..0.058 rows=2 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.037..0.042 rows=2 loops=2)
                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                       Rows Removed by Filter: 16
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=911963 width=21) (actual time=0.031..206.103 rows=51993 loops=2)
                                                               Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                                               Rows Removed by Filter: 110576
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.059..32.916 rows=40588 loops=2)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 39291
                                             ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.038..27.355 rows=102619 loops=2)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.753..18.753 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.114..18.739 rows=1 loops=2)
                                                   Filter: ((keyword)::text = 'sequel'::text)
                                                   Rows Removed by Filter: 134169
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.062..0.062 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.041..0.042 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 32.342 ms
 Execution Time: 737.863 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21b.sql_explained.sql
SET
SET
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=61990.17..61990.18 rows=1 width=96) (actual time=520.124..520.124 rows=1 loops=1)
   ->  Gather  (cost=61990.05..61990.16 rows=1 width=96) (actual time=519.909..525.383 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=60990.05..60990.06 rows=1 width=96) (actual time=514.235..514.236 rows=1 loops=2)
               ->  Hash Join  (cost=55482.32..60990.04 rows=1 width=118) (actual time=483.954..514.196 rows=19 loops=2)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=55481.26..60988.98 rows=1 width=122) (actual time=483.772..514.009 rows=19 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.040..59.618 rows=24151 loops=2)
                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                 Rows Removed by Filter: 93348
                           ->  Parallel Hash  (cost=55481.25..55481.25 rows=1 width=107) (actual time=450.896..450.896 rows=66 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                 ->  Hash Join  (cost=3474.93..55481.25 rows=1 width=107) (actual time=409.092..450.728 rows=66 loops=2)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=848.79..52824.70 rows=11587 width=111) (actual time=32.496..431.872 rows=2784 loops=2)
                                             Merge Cond: (ml.movie_id = mk.movie_id)
                                             ->  Merge Join  (cost=651.93..49563.13 rows=249 width=123) (actual time=25.422..403.352 rows=770 loops=2)
                                                   Merge Cond: (ml.movie_id = mc.movie_id)
                                                   ->  Merge Join  (cost=651.50..44336.66 rows=97 width=111) (actual time=24.492..369.890 rows=338 loops=2)
                                                         Merge Cond: (ml.movie_id = t.id)
                                                         ->  Merge Join  (cost=651.07..35476.61 rows=237 width=90) (actual time=15.827..182.665 rows=544 loops=2)
                                                               Merge Cond: (mi.movie_id = ml.movie_id)
                                                               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..956609.55 rows=50482 width=4) (actual time=1.443..171.108 rows=1524 loops=2)
                                                                     Filter: ((info)::text = ANY ('{Germany,German}'::text[]))
                                                                     Rows Removed by Filter: 255930
                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=10.721..10.922 rows=2527 loops=2)
                                                                     Sort Key: ml.movie_id
                                                                     Sort Method: quicksort  Memory: 205kB
                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.124..9.458 rows=2315 loops=2)
                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.029..5.143 rows=29997 loops=2)
                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.041..0.041 rows=2 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.024..0.029 rows=2 loops=2)
                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                       Rows Removed by Filter: 16
                                                         ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=1038952 width=21) (actual time=0.044..180.573 rows=80664 loops=2)
                                                               Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                               Rows Removed by Filter: 83756
                                                   ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.050..30.122 rows=42314 loops=2)
                                                         Filter: (note IS NULL)
                                                         Rows Removed by Filter: 42471
                                             ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.036..19.542 rows=84660 loops=2)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=18.543..18.543 rows=1 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.110..18.531 rows=1 loops=2)
                                                   Filter: ((keyword)::text = 'sequel'::text)
                                                   Rows Removed by Filter: 134169
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.057..0.057 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.039..0.041 rows=1 loops=2)
                                 Filter: ((kind)::text = 'production companies'::text)
                                 Rows Removed by Filter: 3
 Planning Time: 31.395 ms
 Execution Time: 526.267 ms
(58 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/21c.sql_explained.sql
SET
SET
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=54436.16..54436.17 rows=1 width=96) (actual time=640.704..640.705 rows=1 loops=1)
   ->  Hash Join  (cost=22630.14..54436.15 rows=1 width=118) (actual time=311.574..639.844 rows=1874 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=20004.00..51778.36 rows=12060 width=122) (actual time=225.043..617.342 rows=33031 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Merge Join  (cost=208.46..1509126.58 rows=11385503 width=12) (actual time=0.178..384.380 rows=55032 loops=1)
                     Merge Cond: (mi.movie_id = mk.movie_id)
                     ->  Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1194599.22 rows=893642 width=4) (actual time=0.135..321.338 rows=28657 loops=1)
                           Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))
                           Rows Removed by Filter: 414007
                     ->  Materialize  (cost=0.43..153366.95 rows=4523930 width=8) (actual time=0.039..39.021 rows=85569 loops=1)
                           ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.028..23.175 rows=82171 loops=1)
               ->  Sort  (cost=19795.25..19795.61 rows=144 width=130) (actual time=219.196..221.266 rows=33234 loops=1)
                     Sort Key: mc.movie_id
                     Sort Method: quicksort  Memory: 203kB
                     ->  Gather  (cost=7378.71..19790.09 rows=144 width=130) (actual time=93.527..219.728 rows=1130 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Hash Join  (cost=6378.71..18775.69 rows=60 width=130) (actual time=82.897..206.313 rows=377 loops=3)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Parallel Hash Join  (cost=6377.65..18773.33 rows=240 width=134) (actual time=82.701..205.988 rows=393 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Merge Join  (cost=651.50..13043.69 rows=1331 width=119) (actual time=14.273..152.546 rows=1672 loops=3)
                                             Merge Cond: (ml.movie_id = mc.movie_id)
                                             ->  Merge Join  (cost=651.07..7805.34 rows=520 width=107) (actual time=14.086..108.782 rows=749 loops=3)
                                                   Merge Cond: (t.id = ml.movie_id)
                                                   ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=789968 width=21) (actual time=0.091..91.186 rows=48445 loops=3)
                                                         Filter: ((production_year >= 1950) AND (production_year <= 2010))
                                                         Rows Removed by Filter: 13625
                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.773..12.955 rows=2315 loops=3)
                                                         Sort Key: ml.movie_id
                                                         Sort Method: quicksort  Memory: 205kB
                                                         Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                         Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.147..11.461 rows=2315 loops=3)
                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.030..7.095 rows=29997 loops=3)
                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.049..0.049 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.032..0.037 rows=2 loops=3)
                                                                           Filter: ((link)::text ~~ '%follow%'::text)
                                                                           Rows Removed by Filter: 16
                                             ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.046..39.869 rows=45348 loops=3)
                                                   Filter: (note IS NULL)
                                                   Rows Removed by Filter: 46158
                                       ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=51.782..51.782 rows=16101 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.030..40.443 rows=16101 loops=3)
                                                   Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                   Rows Removed by Filter: 62232
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.031..0.033 rows=1 loops=3)
                                             Filter: ((kind)::text = 'production companies'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.338..19.338 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.134..19.326 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 31.959 ms
 Execution Time: 642.849 ms
(62 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=414666.61..414666.62 rows=1 width=96) (actual time=3269.737..3269.738 rows=1 loops=1)
   ->  Gather  (cost=414666.39..414666.60 rows=2 width=96) (actual time=3268.211..3275.673 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=413666.39..413666.40 rows=1 width=96) (actual time=3260.568..3260.568 rows=1 loops=3)
               ->  Hash Join  (cost=363451.32..413666.38 rows=1 width=41) (actual time=3100.578..3260.098 rows=950 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=363450.20..413665.27 rows=1 width=45) (actual time=3025.111..3259.558 rows=1009 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=279670 width=25) (actual time=0.018..260.430 rows=220688 loops=3)
                                 Filter: (production_year > 2008)
                                 Rows Removed by Filter: 622082
                           ->  Parallel Hash  (cost=363450.19..363450.19 rows=1 width=40) (actual time=2965.048..2965.048 rows=13395 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4088kB
                                 ->  Hash Join  (cost=358450.15..363450.19 rows=1 width=40) (actual time=2902.788..2948.984 rows=13395 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=358449.06..363449.10 rows=1 width=44) (actual time=2902.703..2945.410 rows=13395 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.036..30.669 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=358449.05..358449.05 rows=1 width=29) (actual time=2902.558..2902.558 rows=14738 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3832kB
                                                   ->  Parallel Hash Join  (cost=323145.98..358449.05 rows=1 width=29) (actual time=2596.266..2878.265 rows=14738 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.013..265.194 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=323145.97..323145.97 rows=1 width=17) (actual time=2593.685..2593.685 rows=5361 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                                                               ->  Parallel Hash Join  (cost=67689.63..323145.97 rows=1 width=17) (actual time=2175.748..2550.915 rows=5361 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255449.73 rows=2405 width=4) (actual time=1346.995..1694.362 rows=196255 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=271735 width=8) (actual time=0.713..1644.640 rows=223112 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Germany,German,USA,American}'::text[]))
                                                                                 Rows Removed by Filter: 4722128
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.035 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.013..0.025 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'countries'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=67687.20..67687.20 rows=1 width=13) (actual time=827.998..827.998 rows=8267 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1752kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..67687.20 rows=1 width=13) (actual time=569.353..796.397 rows=8267 loops=3)
                                                                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..16456.75 rows=4327 width=9) (actual time=0.193..209.230 rows=108039 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=488953 width=13) (actual time=0.045..156.383 rows=390635 loops=3)
                                                                                             Filter: ((info)::text < '7.0'::text)
                                                                                             Rows Removed by Filter: 69377
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.044 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=568.619..568.619 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=37.604..477.598 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..252.854 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=37.427..37.427 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.678..37.414 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.030..0.030 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.018..0.019 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.060..0.060 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.039..0.041 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 81.616 ms
 Execution Time: 3276.630 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22b.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=414463.52..414463.53 rows=1 width=96) (actual time=3334.044..3334.044 rows=1 loops=1)
   ->  Gather  (cost=414463.29..414463.50 rows=2 width=96) (actual time=3332.037..3341.557 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=413463.29..413463.30 rows=1 width=96) (actual time=3324.254..3324.254 rows=1 loops=3)
               ->  Hash Join  (cost=363451.32..413463.29 rows=1 width=41) (actual time=3227.454..3324.218 rows=10 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=363450.20..413462.17 rows=1 width=45) (actual time=3227.146..3323.906 rows=11 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=225511 width=25) (actual time=0.020..258.639 rows=177790 loops=3)
                                 Filter: (production_year > 2009)
                                 Rows Removed by Filter: 664981
                           ->  Parallel Hash  (cost=363450.19..363450.19 rows=1 width=40) (actual time=3035.356..3035.356 rows=13395 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4088kB
                                 ->  Hash Join  (cost=358450.15..363450.19 rows=1 width=40) (actual time=2984.456..3019.645 rows=13395 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=358449.06..363449.10 rows=1 width=44) (actual time=2984.372..3016.108 rows=13395 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.014..19.178 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=358449.05..358449.05 rows=1 width=29) (actual time=2984.241..2984.242 rows=14738 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3832kB
                                                   ->  Parallel Hash Join  (cost=323145.98..358449.05 rows=1 width=29) (actual time=2664.748..2956.739 rows=14738 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.014..274.575 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=323145.97..323145.97 rows=1 width=17) (actual time=2663.111..2663.112 rows=5361 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1016kB
                                                               ->  Parallel Hash Join  (cost=67689.63..323145.97 rows=1 width=17) (actual time=2251.241..2636.657 rows=5361 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..255449.73 rows=2405 width=4) (actual time=1407.916..1765.445 rows=196255 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=271735 width=8) (actual time=0.711..1714.939 rows=223112 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Germany,German,USA,American}'::text[]))
                                                                                 Rows Removed by Filter: 4722128
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.028 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'countries'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=67687.20..67687.20 rows=1 width=13) (actual time=842.543..842.543 rows=8267 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1752kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..67687.20 rows=1 width=13) (actual time=583.893..815.745 rows=8267 loops=3)
                                                                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..16456.75 rows=4327 width=9) (actual time=0.199..213.311 rows=108039 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=488953 width=13) (actual time=0.051..160.382 rows=390635 loops=3)
                                                                                             Filter: ((info)::text < '7.0'::text)
                                                                                             Rows Removed by Filter: 69377
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=583.114..583.114 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.530..477.965 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.038..257.406 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.307..32.307 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.528..32.293 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.032..0.032 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.017..0.019 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.063..0.063 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.037..0.040 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 80.878 ms
 Execution Time: 3342.829 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22c.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=461803.15..461803.16 rows=1 width=96) (actual time=3948.115..3948.115 rows=1 loops=1)
   ->  Gather  (cost=461802.92..461803.13 rows=2 width=96) (actual time=3946.147..3953.971 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=460802.92..460802.93 rows=1 width=96) (actual time=3938.492..3938.492 rows=1 loops=3)
               ->  Hash Join  (cost=410038.34..460802.92 rows=1 width=41) (actual time=3629.827..3935.335 rows=7163 loops=3)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Parallel Hash Join  (cost=410037.22..460801.80 rows=1 width=45) (actual time=3617.599..3933.190 rows=7732 loops=3)
                           Hash Cond: (t.id = mi.movie_id)
                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.018..262.810 rows=337640 loops=3)
                                 Filter: (production_year > 2005)
                                 Rows Removed by Filter: 505131
                           ->  Parallel Hash  (cost=410037.21..410037.21 rows=1 width=40) (actual time=3613.567..3613.567 rows=21916 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6008kB
                                 ->  Hash Join  (cost=405037.17..410037.21 rows=1 width=40) (actual time=3554.639..3594.470 rows=21916 loops=3)
                                       Hash Cond: (mc.company_type_id = ct.id)
                                       ->  Parallel Hash Join  (cost=405036.08..410036.12 rows=1 width=44) (actual time=3554.552..3588.761 rows=21916 loops=3)
                                             Hash Cond: (cn.id = mc.company_id)
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.014..18.974 rows=42077 loops=3)
                                                   Filter: ((country_code)::text <> '[us]'::text)
                                                   Rows Removed by Filter: 36256
                                             ->  Parallel Hash  (cost=405036.07..405036.07 rows=1 width=29) (actual time=3554.438..3554.438 rows=23616 loops=3)
                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6520kB
                                                   ->  Parallel Hash Join  (cost=369733.01..405036.07 rows=1 width=29) (actual time=3226.424..3515.767 rows=23616 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.016..269.117 rows=101090 loops=3)
                                                               Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                               Rows Removed by Filter: 768619
                                                         ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=3225.895..3225.895 rows=6989 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1560kB
                                                               ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=2941.630..3184.717 rows=6989 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.171..221.724 rows=151410 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.049..157.621 rows=447629 loops=3)
                                                                                 Filter: ((info)::text < '8.5'::text)
                                                                                 Rows Removed by Filter: 12383
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=2940.183..2940.183 rows=7972 loops=3)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=2382.170..2890.152 rows=7972 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=1822.116..2300.855 rows=204750 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=3.608..2248.650 rows=238737 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                                                             Rows Removed by Filter: 4706503
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.067..0.068 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.052 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'countries'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=559.623..559.623 rows=12364 loops=3)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.228..472.767 rows=12364 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.034..252.623 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.058..32.058 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.534..32.046 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                       ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.030..0.030 rows=4 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.018..0.019 rows=4 loops=3)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.053..0.053 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.031..0.034 rows=2 loops=3)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 81.217 ms
 Execution Time: 3955.654 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/22d.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=460238.12..460238.13 rows=1 width=96) (actual time=5673.769..5673.769 rows=1 loops=1)
   ->  Gather  (cost=460238.00..460238.11 rows=1 width=96) (actual time=5673.009..5679.171 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=459238.00..459238.01 rows=1 width=96) (actual time=5667.063..5667.064 rows=1 loops=2)
               ->  Hash Join  (cost=454237.96..459238.00 rows=1 width=41) (actual time=5603.220..5657.798 rows=23140 loops=2)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=454236.84..459236.88 rows=1 width=45) (actual time=5602.982..5652.040 rows=24954 loops=2)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=454235.75..459235.79 rows=1 width=49) (actual time=5602.898..5645.942 rows=24954 loops=2)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.012..26.065 rows=63115 loops=2)
                                       Filter: ((country_code)::text <> '[us]'::text)
                                       Rows Removed by Filter: 54384
                                 ->  Parallel Hash  (cost=454235.74..454235.74 rows=1 width=34) (actual time=5602.456..5602.456 rows=35884 loops=2)
                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6808kB
                                       ->  Parallel Hash Join  (cost=420497.60..454235.74 rows=1 width=34) (actual time=5141.450..5567.904 rows=35884 loops=2)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.007..235.884 rows=1304564 loops=2)
                                             ->  Parallel Hash  (cost=420497.58..420497.58 rows=1 width=42) (actual time=5140.981..5140.981 rows=2566 loops=2)
                                                   Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                                                   ->  Parallel Hash Join  (cost=369733.01..420497.58 rows=1 width=42) (actual time=4662.117..5124.827 rows=2566 loops=2)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.015..392.305 rows=506460 loops=2)
                                                               Filter: (production_year > 2005)
                                                               Rows Removed by Filter: 757696
                                                         ->  Parallel Hash  (cost=369732.99..369732.99 rows=1 width=17) (actual time=4661.138..4661.138 rows=10484 loops=2)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                               ->  Parallel Hash Join  (cost=353063.77..369732.99 rows=1 width=17) (actual time=4276.518..4640.304 rows=10484 loops=2)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..16653.02 rows=4965 width=9) (actual time=0.202..331.411 rows=227115 loops=2)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.089..235.545 rows=671443 loops=2)
                                                                                 Filter: ((info)::text < '8.5'::text)
                                                                                 Rows Removed by Filter: 18574
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=2)
                                                                                       Filter: ((info)::text = 'rating'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=353061.34..353061.34 rows=1 width=8) (actual time=4275.328..4275.328 rows=11958 loops=2)
                                                                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                           ->  Parallel Hash Join  (cost=51216.64..353061.34 rows=1 width=8) (actual time=3481.660..4241.690 rows=11958 loops=2)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..301837.78 rows=2490 width=4) (actual time=2704.244..3422.061 rows=307126 loops=2)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=2.049..3343.281 rows=358105 loops=2)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                                                             Rows Removed by Filter: 7059755
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.036..0.047 rows=1 loops=2)
                                                                                                   Filter: ((info)::text = 'countries'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=777.183..777.183 rows=18546 loops=2)
                                                                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                       ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.176..688.548 rows=18546 loops=2)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.042..374.119 rows=2261965 loops=2)
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=31.881..31.881 rows=3 loops=2)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.513..31.858 rows=3 loops=2)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.027..0.027 rows=4 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.015..0.017 rows=4 loops=2)
                     ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.046..0.046 rows=2 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.027..0.029 rows=2 loops=2)
                                 Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                 Rows Removed by Filter: 5
 Planning Time: 84.559 ms
 Execution Time: 5680.102 ms
(74 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23a.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=418779.45..418779.46 rows=1 width=64) (actual time=2386.605..2386.605 rows=1 loops=1)
   ->  Gather  (cost=418779.23..418779.44 rows=2 width=64) (actual time=2386.269..2394.277 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=417779.23..417779.24 rows=1 width=64) (actual time=2378.460..2378.460 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=413873.01..417779.22 rows=1 width=65) (actual time=2333.866..2378.334 rows=206 loops=3)
                     Hash Cond: (k.id = mk.keyword_id)
                     ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.102..39.622 rows=44723 loops=3)
                           Heap Fetches: 134170
                     ->  Parallel Hash  (cost=413872.58..413872.58 rows=1 width=69) (actual time=2332.983..2332.983 rows=206 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=363500.14..413872.58 rows=1 width=69) (actual time=2252.546..2332.834 rows=206 loops=3)
                                 Hash Cond: (mc.company_type_id = ct.id)
                                 ->  Hash Join  (cost=363499.05..413871.49 rows=1 width=73) (actual time=2252.447..2332.687 rows=206 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Hash Join  (cost=363496.62..413868.99 rows=26 width=77) (actual time=2252.340..2332.533 rows=206 loops=3)
                                             Hash Cond: (mk.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.037..251.797 rows=1507977 loops=3)
                                             ->  Parallel Hash  (cost=363496.59..363496.59 rows=3 width=89) (actual time=1900.358..1900.358 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Parallel Hash Join  (cost=358585.30..363496.59 rows=3 width=89) (actual time=1895.051..1900.273 rows=2 loops=3)
                                                         Hash Cond: (cn.id = mc.company_id)
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..16.959 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                                                         ->  Parallel Hash  (cost=358585.24..358585.24 rows=5 width=93) (actual time=1880.561..1880.561 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=324847.09..358585.24 rows=5 width=93) (actual time=1826.787..1880.489 rows=2 loops=3)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.013..152.735 rows=869710 loops=3)
                                                                     ->  Parallel Hash  (cost=324847.07..324847.07 rows=2 width=81) (actual time=1620.939..1620.940 rows=2 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=54685.18..324847.07 rows=2 width=81) (actual time=1143.390..1620.846 rows=2 loops=3)
                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=8) (actual time=303.846..1233.283 rows=594 loops=3)
                                                                                       Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                       Rows Removed by Filter: 4944646
                                                                                 ->  Parallel Hash  (cost=54671.45..54671.45 rows=1099 width=73) (actual time=387.073..387.073 rows=344 loops=3)
                                                                                       Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                                                                       ->  Hash Join  (cost=3236.49..54671.45 rows=1099 width=73) (actual time=269.340..386.587 rows=344 loops=3)
                                                                                             Hash Cond: (t.kind_id = kt.id)
                                                                                             ->  Hash Join  (cost=3235.39..54637.93 rows=7692 width=29) (actual time=50.597..386.242 rows=694 loops=3)
                                                                                                   Hash Cond: (t.id = cc.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.034..281.632 rows=460484 loops=3)
                                                                                                         Filter: (production_year > 2000)
                                                                                                         Rows Removed by Filter: 382286
                                                                                                   ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=49.243..49.243 rows=24592 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.157..41.799 rows=24592 loops=3)
                                                                                                               Hash Cond: (cc.status_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.037..20.941 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'complete+verified'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                             ->  Hash  (cost=1.09..1.09 rows=1 width=52) (actual time=0.047..0.047 rows=1 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=52) (actual time=0.033..0.035 rows=1 loops=3)
                                                                                                         Filter: ((kind)::text = 'movie'::text)
                                                                                                         Rows Removed by Filter: 6
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.030..0.041 rows=1 loops=3)
                                                   Filter: ((info)::text = 'release dates'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.043..0.043 rows=4 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.020..0.021 rows=4 loops=3)
 Planning Time: 81.431 ms
 Execution Time: 2395.401 ms
(71 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23b.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=400136.80..400136.81 rows=1 width=64) (actual time=4246.811..4246.812 rows=1 loops=1)
   ->  Gather  (cost=400136.69..400136.80 rows=1 width=64) (actual time=4246.488..4252.393 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=399136.69..399136.70 rows=1 width=64) (actual time=4240.576..4240.576 rows=1 loops=2)
               ->  Hash Join  (cost=394225.39..399136.68 rows=1 width=65) (actual time=4236.983..4240.565 rows=8 loops=2)
                     Hash Cond: (t.kind_id = kt.id)
                     ->  Hash Join  (cost=394224.29..399135.58 rows=1 width=21) (actual time=4236.733..4240.312 rows=8 loops=2)
                           Hash Cond: (mc.company_type_id = ct.id)
                           ->  Parallel Hash Join  (cost=394223.20..399134.49 rows=1 width=25) (actual time=4236.638..4240.216 rows=8 loops=2)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.010..24.567 rows=42422 loops=2)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 75077
                                 ->  Parallel Hash  (cost=394223.19..394223.19 rows=1 width=29) (actual time=4211.258..4211.258 rows=8 loops=2)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Hash Join  (cost=360485.03..394223.19 rows=1 width=29) (actual time=4200.031..4211.189 rows=8 loops=2)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Parallel Hash Join  (cost=357249.64..390987.79 rows=1 width=45) (actual time=3933.545..4164.516 rows=6 loops=2)
                                                   Hash Cond: (mc.movie_id = t.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.006..228.562 rows=1304564 loops=2)
                                                   ->  Parallel Hash  (cost=357249.63..357249.63 rows=1 width=33) (actual time=3776.250..3776.250 rows=5 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                         ->  Parallel Hash Join  (cost=305924.00..357249.63 rows=1 width=33) (actual time=3532.070..3776.218 rows=5 loops=2)
                                                               Hash Cond: (t.id = mi.movie_id)
                                                               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.015..400.772 rows=690726 loops=2)
                                                                     Filter: (production_year > 2000)
                                                                     Rows Removed by Filter: 573430
                                                               ->  Parallel Hash  (cost=305923.99..305923.99 rows=1 width=8) (actual time=3305.595..3305.595 rows=5 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Hash Join  (cost=257671.78..305923.99 rows=1 width=8) (actual time=2809.817..3305.511 rows=5 loops=2)
                                                                           Hash Cond: (mk.movie_id = mi.movie_id)
                                                                           ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=29.148..678.821 rows=566 loops=2)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..374.315 rows=2261965 loops=2)
                                                                                 ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=28.875..28.875 rows=4 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.871..28.848 rows=4 loops=2)
                                                                                             Filter: ((keyword)::text = ANY ('{nerd,loner,alienation,dignity}'::text[]))
                                                                                             Rows Removed by Filter: 134166
                                                                           ->  Parallel Hash  (cost=254710.16..254710.16 rows=2 width=4) (actual time=2626.295..2626.295 rows=886 loops=2)
                                                                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                                                 ->  Hash Join  (cost=2.43..254710.16 rows=2 width=4) (actual time=429.637..1692.733 rows=886 loops=2)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=176 width=8) (actual time=429.513..1691.815 rows=886 loops=2)
                                                                                             Filter: (((note)::text ~~ '%internet%'::text) AND ((info)::text ~~ 'USA:% 200%'::text))
                                                                                             Rows Removed by Filter: 7416974
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.048 rows=1 loops=2)
                                                                                                   Filter: ((info)::text = 'release dates'::text)
                                                                                                   Rows Removed by Filter: 112
                                             ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=45.589..45.589 rows=24592 loops=2)
                                                   Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                   ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.163..38.377 rows=24592 loops=2)
                                                         Hash Cond: (cc.status_id = cct1.id)
                                                         ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.026..17.622 rows=135086 loops=2)
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.044..0.045 rows=1 loops=2)
                                                                     Filter: ((kind)::text = 'complete+verified'::text)
                                                                     Rows Removed by Filter: 3
                           ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.032..0.032 rows=4 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.015..0.017 rows=4 loops=2)
                     ->  Hash  (cost=1.09..1.09 rows=1 width=52) (actual time=0.055..0.055 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=52) (actual time=0.031..0.033 rows=1 loops=2)
                                 Filter: ((kind)::text = 'movie'::text)
                                 Rows Removed by Filter: 6
 Planning Time: 81.645 ms
 Execution Time: 4253.391 ms
(72 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/23c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=419448.86..419448.87 rows=1 width=64) (actual time=2503.931..2503.931 rows=1 loops=1)
   ->  Gather  (cost=419448.64..419448.85 rows=2 width=64) (actual time=2503.309..2512.561 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=418448.64..418448.65 rows=1 width=64) (actual time=2495.197..2495.198 rows=1 loops=3)
               ->  Hash Join  (cost=414542.42..418448.63 rows=2 width=65) (actual time=2444.966..2495.087 rows=209 loops=3)
                     Hash Cond: (mc.company_type_id = ct.id)
                     ->  Parallel Hash Join  (cost=414541.33..418447.54 rows=2 width=69) (actual time=2444.687..2494.750 rows=209 loops=3)
                           Hash Cond: (k.id = mk.keyword_id)
                           ->  Parallel Index Only Scan using keyword_pkey on keyword k  (cost=0.42..3696.98 rows=55904 width=4) (actual time=0.074..45.164 rows=44723 loops=3)
                                 Heap Fetches: 134170
                           ->  Parallel Hash  (cost=414540.87..414540.87 rows=3 width=73) (actual time=2443.946..2443.946 rows=209 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                 ->  Parallel Hash Join  (cost=409629.58..414540.87 rows=3 width=73) (actual time=2431.269..2443.788 rows=209 loops=3)
                                       Hash Cond: (cn.id = mc.company_id)
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.013..17.164 rows=28281 loops=3)
                                             Filter: ((country_code)::text = '[us]'::text)
                                             Rows Removed by Filter: 50051
                                       ->  Parallel Hash  (cost=409629.53..409629.53 rows=4 width=77) (actual time=2423.706..2423.706 rows=209 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=359255.99..409629.53 rows=4 width=77) (actual time=2274.279..2423.538 rows=209 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=359253.57..409626.13 rows=360 width=81) (actual time=2274.166..2423.375 rows=209 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.032..262.998 rows=1507977 loops=3)
                                                         ->  Parallel Hash  (cost=359253.22..359253.22 rows=28 width=93) (actual time=1979.966..1979.967 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=325515.05..359253.22 rows=28 width=93) (actual time=1861.998..1979.890 rows=2 loops=3)
                                                                     Hash Cond: (mc.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=12) (actual time=0.011..162.630 rows=869710 loops=3)
                                                                     ->  Parallel Hash  (cost=325514.95..325514.95 rows=8 width=81) (actual time=1710.518..1710.518 rows=2 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=55353.07..325514.95 rows=8 width=81) (actual time=1178.562..1710.419 rows=2 loops=3)
                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=200 width=8) (actual time=317.400..1300.417 rows=594 loops=3)
                                                                                       Filter: ((info IS NOT NULL) AND ((note)::text ~~ '%internet%'::text) AND (((info)::text ~~ 'USA:% 199%'::text) OR ((info)::text ~~ 'USA:% 200%'::text)))
                                                                                       Rows Removed by Filter: 4944646
                                                                                 ->  Parallel Hash  (cost=55283.32..55283.32 rows=5580 width=73) (actual time=409.376..409.376 rows=1684 loops=3)
                                                                                       Buckets: 16384  Batches: 1  Memory Usage: 512kB
                                                                                       ->  Hash Join  (cost=3236.54..55283.32 rows=5580 width=73) (actual time=272.304..407.439 rows=1684 loops=3)
                                                                                             Hash Cond: (t.kind_id = kt.id)
                                                                                             ->  Hash Join  (cost=3235.39..55241.01 rows=9766 width=29) (actual time=47.165..406.457 rows=2141 loops=3)
                                                                                                   Hash Cond: (t.id = cc.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=25) (actual time=0.037..292.453 rows=583011 loops=3)
                                                                                                         Filter: (production_year > 1990)
                                                                                                         Rows Removed by Filter: 259760
                                                                                                   ->  Hash  (cost=2813.24..2813.24 rows=33772 width=4) (actual time=45.489..45.489 rows=24592 loops=3)
                                                                                                         Buckets: 65536  Batches: 1  Memory Usage: 1377kB
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=4) (actual time=0.150..38.278 rows=24592 loops=3)
                                                                                                               Hash Cond: (cc.status_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=8) (actual time=0.030..17.597 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.059..0.060 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'complete+verified'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                             ->  Hash  (cost=1.10..1.10 rows=4 width=52) (actual time=0.046..0.046 rows=4 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.10 rows=4 width=52) (actual time=0.030..0.034 rows=4 loops=3)
                                                                                                         Filter: ((kind)::text = ANY ('{movie,"tv movie","video movie","video game"}'::text[]))
                                                                                                         Rows Removed by Filter: 3
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.053..0.053 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.042 rows=1 loops=3)
                                                               Filter: ((info)::text = 'release dates'::text)
                                                               Rows Removed by Filter: 112
                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.058..0.058 rows=4 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.028..0.029 rows=4 loops=3)
 Planning Time: 81.906 ms
 Execution Time: 2513.630 ms
(71 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/24a.sql_explained.sql
SET
SET
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1028775.06..1028775.07 rows=1 width=96) (actual time=7007.142..7007.142 rows=1 loops=1)
   ->  Hash Join  (cost=773581.49..1028775.05 rows=1 width=48) (actual time=5924.973..7007.007 rows=275 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Gather  (cost=773579.07..1028772.62 rows=1 width=52) (actual time=5924.863..7013.728 rows=275 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=772579.07..1027772.52 rows=1 width=52) (actual time=5953.184..6998.440 rows=92 loops=3)
                     Hash Cond: (mi.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=129652 width=8) (actual time=269.199..1694.232 rows=100416 loops=3)
                           Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))
                           Rows Removed by Filter: 4844824
                     ->  Parallel Hash  (cost=772579.06..772579.06 rows=1 width=64) (actual time=5291.445..5291.445 rows=42 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=767667.77..772579.06 rows=1 width=64) (actual time=5268.923..5291.350 rows=42 loops=3)
                                 Hash Cond: (cn.id = mc.company_id)
                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.010..21.056 rows=28281 loops=3)
                                       Filter: ((country_code)::text = '[us]'::text)
                                       Rows Removed by Filter: 50051
                                 ->  Parallel Hash  (cost=767667.75..767667.75 rows=1 width=68) (actual time=5267.270..5267.271 rows=115 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=733929.61..767667.75 rows=1 width=68) (actual time=5077.278..5267.161 rows=115 loops=3)
                                             Hash Cond: (mc.movie_id = t.id)
                                             ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.011..156.479 rows=869710 loops=3)
                                             ->  Parallel Hash  (cost=733929.60..733929.60 rows=1 width=60) (actual time=5003.456..5003.456 rows=13 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Hash Join  (cost=679490.06..733929.60 rows=1 width=60) (actual time=4747.577..5003.379 rows=13 loops=3)
                                                         Hash Cond: (ci.role_id = rt.id)
                                                         ->  Parallel Hash Join  (cost=679488.90..733928.43 rows=1 width=64) (actual time=4747.450..5003.246 rows=13 loops=3)
                                                               Hash Cond: (chn.id = ci.person_role_id)
                                                               ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.043..244.483 rows=1046780 loops=3)
                                                               ->  Parallel Hash  (cost=679488.88..679488.88 rows=1 width=52) (actual time=4632.563..4632.563 rows=13 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=663335.18..679488.88 rows=1 width=52) (actual time=4536.606..4632.437 rows=13 loops=3)
                                                                           Hash Cond: (n.id = ci.person_id)
                                                                           ->  Parallel Hash Join  (cost=81910.23..98047.67 rows=4333 width=23) (actual time=548.053..674.982 rows=3508 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.033..74.505 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=547.062..547.063 rows=16670 loops=3)
                                                                                       Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=223.608..533.667 rows=16670 loops=3)
                                                                                             Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1372493
                                                                           ->  Parallel Hash  (cost=581424.93..581424.93 rows=2 width=41) (actual time=3956.655..3956.655 rows=875 loops=3)
                                                                                 Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 280kB
                                                                                 ->  Parallel Hash Join  (cost=100834.61..581424.93 rows=2 width=41) (actual time=886.886..3736.156 rows=875 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=1.656..2813.346 rows=289159 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11792289
                                                                                       ->  Parallel Hash  (cost=100834.53..100834.53 rows=7 width=25) (actual time=880.461..880.462 rows=165 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=51046.31..100834.53 rows=7 width=25) (actual time=610.403..880.242 rows=165 loops=3)
                                                                                                   Hash Cond: (t.id = mk.movie_id)
                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.029..252.557 rows=130555 loops=3)
                                                                                                         Filter: (production_year > 2010)
                                                                                                         Rows Removed by Filter: 712215
                                                                                                   ->  Parallel Hash  (cost=51045.79..51045.79 rows=42 width=4) (actual time=606.175..606.175 rows=3232 loops=3)
                                                                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                                                                         ->  Hash Join  (cost=2793.88..51045.79 rows=42 width=4) (actual time=30.483..465.893 rows=3232 loops=3)
                                                                                                               Hash Cond: (mk.keyword_id = k.id)
                                                                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.038..252.642 rows=1507977 loops=3)
                                                                                                               ->  Hash  (cost=2793.84..2793.84 rows=3 width=4) (actual time=29.061..29.061 rows=3 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on keyword k  (cost=0.00..2793.84 rows=3 width=4) (actual time=0.072..29.046 rows=3 loops=3)
                                                                                                                           Filter: ((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat}'::text[]))
                                                                                                                           Rows Removed by Filter: 134167
                                                         ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=3)
                                                                     Filter: ((role)::text = 'actress'::text)
                                                                     Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 99.269 ms
 Execution Time: 7014.991 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/24b.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1031111.24..1031111.25 rows=1 width=96) (actual time=6548.231..6548.231 rows=1 loops=1)
   ->  Hash Join  (cost=775917.68..1031111.23 rows=1 width=48) (actual time=6547.545..6548.177 rows=45 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Gather  (cost=775915.25..1031108.81 rows=1 width=52) (actual time=6547.433..6554.600 rows=45 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=774915.25..1030108.71 rows=1 width=52) (actual time=5862.964..6539.851 rows=15 loops=3)
                     Hash Cond: (mi.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=129652 width=8) (actual time=207.664..1676.643 rows=100416 loops=3)
                           Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%201%'::text) OR ((info)::text ~~ 'USA:%201%'::text)))
                           Rows Removed by Filter: 4844824
                     ->  Parallel Hash  (cost=774915.24..774915.24 rows=1 width=64) (actual time=4850.580..4850.580 rows=8 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Hash Join  (cost=720475.70..774915.24 rows=1 width=64) (actual time=4810.950..4850.490 rows=8 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Hash Join  (cost=720474.54..774914.07 rows=1 width=68) (actual time=4810.843..4850.381 rows=8 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.032..239.990 rows=1046780 loops=3)
                                       ->  Parallel Hash  (cost=720474.52..720474.52 rows=1 width=56) (actual time=4484.634..4484.634 rows=8 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                             ->  Parallel Hash Join  (cost=704320.82..720474.52 rows=1 width=56) (actual time=4457.647..4484.525 rows=8 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Hash Join  (cost=81910.23..98047.67 rows=4333 width=23) (actual time=547.180..672.128 rows=3508 loops=3)
                                                         Hash Cond: (an.person_id = n.id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.029..72.799 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=546.251..546.251 rows=16670 loops=3)
                                                               Buckets: 65536  Batches: 1  Memory Usage: 3328kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=223.646..532.617 rows=16670 loops=3)
                                                                     Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                     Rows Removed by Filter: 1372493
                                                   ->  Parallel Hash  (cost=622410.58..622410.58 rows=1 width=45) (actual time=3811.846..3811.846 rows=36 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=141820.27..622410.58 rows=1 width=45) (actual time=1087.726..3811.739 rows=36 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.060..2776.362 rows=289159 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                     Rows Removed by Filter: 11792289
                                                               ->  Parallel Hash  (cost=141820.25..141820.25 rows=1 width=29) (actual time=997.438..997.438 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Hash Join  (cost=108082.11..141820.25 rows=1 width=29) (actual time=947.646..997.376 rows=2 loops=3)
                                                                           Hash Cond: (mc.company_id = cn.id)
                                                                           ->  Parallel Hash Join  (cost=103013.59..136751.74 rows=1 width=33) (actual time=820.506..975.302 rows=21 loops=3)
                                                                                 Hash Cond: (mc.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.014..154.212 rows=869710 loops=3)
                                                                                 ->  Parallel Hash  (cost=103013.58..103013.58 rows=1 width=25) (actual time=712.879..712.879 rows=2 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Hash Join  (cost=54761.74..103013.58 rows=1 width=25) (actual time=513.590..712.778 rows=2 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Hash Join  (cost=51800.14..100051.91 rows=28 width=29) (actual time=481.572..680.761 rows=29 loops=3)
                                                                                                   Hash Cond: (mk.movie_id = t.id)
                                                                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.127..249.727 rows=1507977 loops=3)
                                                                                                   ->  Parallel Hash  (cost=51799.95..51799.95 rows=15 width=21) (actual time=250.563..250.564 rows=3 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=15 width=21) (actual time=63.611..250.466 rows=3 loops=3)
                                                                                                               Filter: ((production_year > 2010) AND ((title)::text ~~ 'Kung Fu Panda%'::text))
                                                                                                               Rows Removed by Filter: 842768
                                                                                             ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=31.955..31.955 rows=3 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.096..31.936 rows=3 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{hero,martial-arts,hand-to-hand-combat,computer-animated-movie}'::text[]))
                                                                                                         Rows Removed by Filter: 134167
                                                                           ->  Parallel Hash  (cost=5068.50..5068.50 rows=1 width=4) (actual time=22.003..22.003 rows=0 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                 ->  Parallel Seq Scan on company_name cn  (cost=0.00..5068.50 rows=1 width=4) (actual time=16.637..21.958 rows=0 loops=3)
                                                                                       Filter: (((country_code)::text = '[us]'::text) AND ((name)::text = 'DreamWorks Animation'::text))
                                                                                       Rows Removed by Filter: 78332
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.030..0.032 rows=1 loops=3)
                                             Filter: ((role)::text = 'actress'::text)
                                             Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.036..0.036 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.015..0.025 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 99.803 ms
 Execution Time: 6555.710 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=937486.93..937486.94 rows=1 width=128) (actual time=6186.202..6186.203 rows=1 loops=1)
   ->  Gather  (cost=937486.70..937486.91 rows=2 width=128) (actual time=6185.087..6193.146 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=936486.70..936486.71 rows=1 width=128) (actual time=6177.593..6177.594 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=886003.56..936486.69 rows=1 width=80) (actual time=5940.477..6176.255 rows=1469 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.019..238.249 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=886003.55..886003.55 rows=1 width=79) (actual time=5811.511..5811.512 rows=1469 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 440kB
                           ->  Parallel Hash Join  (cost=805976.20..886003.55 rows=1 width=79) (actual time=5231.522..5767.489 rows=1469 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.059..465.162 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=805976.19..805976.19 rows=1 width=68) (actual time=5230.824..5230.824 rows=2371 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 664kB
                                       ->  Parallel Hash Join  (cost=305955.51..805976.19 rows=1 width=68) (actual time=3975.237..5145.130 rows=2371 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=329.492..3030.467 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=305955.50..305955.50 rows=1 width=60) (actual time=2060.599..2060.599 rows=3796 loops=3)
                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 984kB
                                                   ->  Parallel Hash Join  (cost=290685.23..305955.50 rows=1 width=60) (actual time=1843.934..2029.440 rows=3796 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.149..165.340 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.042..81.341 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.039 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.028 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=290682.79..290682.79 rows=1 width=51) (actual time=1843.010..1843.010 rows=4146 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 920kB
                                                               ->  Parallel Hash Join  (cost=51384.54..290682.79 rows=1 width=51) (actual time=1695.954..1825.627 rows=4146 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..239300.13 rows=144 width=47) (actual time=1149.372..1273.525 rows=10138 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=16278 width=51) (actual time=801.509..1268.977 rows=10267 loops=3)
                                                                                 Filter: ((info)::text = 'Horror'::text)
                                                                                 Rows Removed by Filter: 4934973
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.095..0.096 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.056..0.069 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'genres'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=51381.24..51381.24 rows=70 width=4) (actual time=546.514..546.515 rows=20699 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3512kB
                                                                           ->  Hash Join  (cost=3129.33..51381.24 rows=70 width=4) (actual time=34.963..479.741 rows=20699 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.059..254.311 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=3129.26..3129.26 rows=5 width=4) (actual time=34.789..34.789 rows=5 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..3129.26 rows=5 width=4) (actual time=1.022..34.764 rows=5 loops=3)
                                                                                             Filter: ((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))
                                                                                             Rows Removed by Filter: 134165
 Planning Time: 29.204 ms
 Execution Time: 6194.053 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25b.sql_explained.sql
SET
SET
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=938224.64..938224.65 rows=1 width=128) (actual time=5559.723..5559.723 rows=1 loops=1)
   ->  Gather  (cost=938224.41..938224.62 rows=2 width=128) (actual time=5559.503..5566.149 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=937224.41..937224.42 rows=1 width=128) (actual time=5552.287..5552.288 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=857197.05..937224.40 rows=1 width=80) (actual time=5310.646..5552.262 rows=2 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.044..454.340 rows=579860 loops=3)
                           Filter: ((gender)::text = 'm'::text)
                           Rows Removed by Filter: 809304
                     ->  Parallel Hash  (cost=857197.04..857197.04 rows=1 width=69) (actual time=5040.859..5040.865 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                           ->  Parallel Hash Join  (cost=617898.78..857197.04 rows=1 width=69) (actual time=5028.240..5040.790 rows=2 loops=3)
                                 Hash Cond: (mi.movie_id = t.id)
                                 ->  Hash Join  (cost=2.43..239300.13 rows=144 width=47) (actual time=1088.639..1208.738 rows=10138 loops=3)
                                       Hash Cond: (mi.info_type_id = it1.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=16278 width=51) (actual time=760.178..1204.384 rows=10267 loops=3)
                                             Filter: ((info)::text = 'Horror'::text)
                                             Rows Removed by Filter: 4934973
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.017..0.029 rows=1 loops=3)
                                                   Filter: ((info)::text = 'genres'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=617896.35..617896.35 rows=1 width=42) (actual time=3830.374..3830.374 rows=2 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Parallel Hash Join  (cost=602626.08..617896.35 rows=1 width=42) (actual time=3826.190..3830.315 rows=2 loops=3)
                                             Hash Cond: (mi_idx.movie_id = t.id)
                                             ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.173..159.546 rows=153308 loops=3)
                                                   Hash Cond: (mi_idx.info_type_id = it2.id)
                                                   ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..76.559 rows=460012 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.077..0.077 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.050..0.053 rows=1 loops=3)
                                                               Filter: ((info)::text = 'votes'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=602623.64..602623.64 rows=1 width=33) (actual time=3656.004..3656.005 rows=2 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Parallel Hash Join  (cost=554371.45..602623.64 rows=1 width=33) (actual time=3643.137..3655.929 rows=2 loops=3)
                                                         Hash Cond: (mk.movie_id = t.id)
                                                         ->  Hash Join  (cost=3129.33..51381.24 rows=70 width=4) (actual time=34.501..478.894 rows=20699 loops=3)
                                                               Hash Cond: (mk.keyword_id = k.id)
                                                               ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.031..255.819 rows=1507977 loops=3)
                                                               ->  Hash  (cost=3129.26..3129.26 rows=5 width=4) (actual time=34.352..34.352 rows=5 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on keyword k  (cost=0.00..3129.26 rows=5 width=4) (actual time=0.896..34.332 rows=5 loops=3)
                                                                           Filter: ((keyword)::text = ANY ('{murder,blood,gore,death,female-nudity}'::text[]))
                                                                           Rows Removed by Filter: 134165
                                                         ->  Parallel Hash  (cost=551242.03..551242.03 rows=8 width=29) (actual time=3173.372..3173.372 rows=8 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=51800.14..551242.03 rows=8 width=29) (actual time=2081.741..3173.264 rows=8 loops=3)
                                                                     Hash Cond: (ci.movie_id = t.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=163.696..2883.723 rows=414905 loops=3)
                                                                           Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                           Rows Removed by Filter: 11666543
                                                                     ->  Parallel Hash  (cost=51799.95..51799.95 rows=15 width=21) (actual time=246.489..246.489 rows=24 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=15 width=21) (actual time=8.379..246.395 rows=24 loops=3)
                                                                                 Filter: ((production_year > 2010) AND ((title)::text ~~ 'Vampire%'::text))
                                                                                 Rows Removed by Filter: 842746
 Planning Time: 29.574 ms
 Execution Time: 5566.947 ms
(62 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/25c.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                        
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=968932.69..968932.70 rows=1 width=128) (actual time=6647.752..6647.753 rows=1 loops=1)
   ->  Gather  (cost=968932.46..968932.67 rows=2 width=128) (actual time=6645.524..6652.769 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=967932.46..967932.47 rows=1 width=128) (actual time=6638.284..6638.285 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=917449.32..967932.45 rows=1 width=80) (actual time=6280.141..6632.622 rows=8718 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.019..229.753 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=917449.31..917449.31 rows=1 width=79) (actual time=6274.565..6274.565 rows=8718 loops=3)
                           Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2648kB
                           ->  Parallel Hash Join  (cost=837421.96..917449.31 rows=1 width=79) (actual time=5726.314..6241.568 rows=8718 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.052..440.856 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=837421.95..837421.95 rows=1 width=68) (actual time=5725.406..5725.407 rows=14300 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3960kB
                                       ->  Parallel Hash Join  (cost=337401.27..837421.95 rows=1 width=68) (actual time=4553.627..5687.745 rows=14300 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=194.435..2883.300 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=337401.26..337401.26 rows=1 width=60) (actual time=2738.621..2738.621 rows=21129 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4824kB
                                                   ->  Parallel Hash Join  (cost=322130.99..337401.26 rows=1 width=60) (actual time=2493.184..2684.392 rows=21129 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.137..163.061 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.031..78.832 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.025..0.027 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=322128.55..322128.55 rows=1 width=51) (actual time=2492.808..2492.809 rows=22680 loops=3)
                                                               Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                               ->  Parallel Hash Join  (cost=51720.34..322128.55 rows=1 width=51) (actual time=2221.206..2454.842 rows=22680 loops=3)
                                                                     Hash Cond: (mi.movie_id = mk.movie_id)
                                                                     ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1653.687..1869.535 rows=62198 loops=3)
                                                                           Hash Cond: (mi.info_type_id = it1.id)
                                                                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1044.997..1852.085 rows=62990 loops=3)
                                                                                 Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                 Rows Removed by Filter: 4882250
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.083..0.083 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.046..0.058 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'genres'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=567.424..567.424 rows=25571 loops=3)
                                                                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                           ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.128..485.686 rows=25571 loops=3)
                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.042..253.771 rows=1507977 loops=3)
                                                                                 ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=39.969..39.970 rows=7 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.157..39.944 rows=7 loops=3)
                                                                                             Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                             Rows Removed by Filter: 134163
 Planning Time: 29.201 ms
 Execution Time: 6654.218 ms
(60 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26a.sql_explained.sql
SET
SET
                                                                                                                QUERY PLAN                                                                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=722071.79..722071.80 rows=1 width=128) (actual time=7201.997..7201.997 rows=1 loops=1)
   ->  Hash Join  (cost=706649.20..722071.78 rows=1 width=53) (actual time=7115.896..7200.979 rows=1728 loops=1)
         Hash Cond: (t.kind_id = kt.id)
         ->  Hash Join  (cost=706648.10..722070.67 rows=1 width=57) (actual time=7060.469..7200.419 rows=1844 loops=1)
               Hash Cond: (mi_idx.info_type_id = it2.id)
               ->  Gather  (cost=706645.67..722068.24 rows=1 width=61) (actual time=7060.381..7306.160 rows=2580 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Parallel Hash Join  (cost=705645.67..721068.14 rows=1 width=61) (actual time=7051.756..7187.396 rows=860 loops=3)
                           Hash Cond: (mi_idx.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=79942 width=13) (actual time=0.057..132.649 rows=64632 loops=3)
                                 Filter: ((info)::text > '7.0'::text)
                                 Rows Removed by Filter: 395380
                           ->  Parallel Hash  (cost=705645.66..705645.66 rows=1 width=68) (actual time=7044.518..7044.518 rows=1906 loops=3)
                                 Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 728kB
                                 ->  Parallel Hash Join  (cost=648661.37..705645.66 rows=1 width=68) (actual time=6502.065..6981.763 rows=1906 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.059..459.061 rows=60051 loops=3)
                                             Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                             Rows Removed by Filter: 986729
                                       ->  Parallel Hash  (cost=648661.29..648661.29 rows=6 width=56) (actual time=6501.706..6501.706 rows=69092 loops=3)
                                             Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 9560kB
                                             ->  Parallel Hash Join  (cost=569172.01..648661.29 rows=6 width=56) (actual time=6036.594..6431.131 rows=69092 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.051..377.709 rows=1389164 loops=3)
                                                   ->  Parallel Hash  (cost=569171.94..569171.94 rows=6 width=45) (actual time=5140.856..5140.856 rows=69092 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2560kB
                                                         ->  Parallel Hash Join  (cost=108834.99..569171.94 rows=6 width=45) (actual time=1011.865..4937.978 rows=69092 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.030..2144.023 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=108834.98..108834.98 rows=1 width=33) (actual time=1011.383..1011.384 rows=532 loops=3)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                                                     ->  Hash Join  (cost=58439.25..108834.98 rows=1 width=33) (actual time=518.701..993.340 rows=532 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Hash Join  (cost=54471.30..104857.99 rows=3441 width=37) (actual time=463.333..933.646 rows=121797 loops=3)
                                                                                 Hash Cond: (mk.movie_id = t.id)
                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.043..250.053 rows=1507977 loops=3)
                                                                                 ->  Parallel Hash  (cost=54447.27..54447.27 rows=1923 width=29) (actual time=462.891..462.891 rows=7852 loops=3)
                                                                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2016kB
                                                                                       ->  Hash Join  (cost=3102.42..54447.27 rows=1923 width=29) (actual time=94.379..438.630 rows=7852 loops=3)
                                                                                             Hash Cond: (t.id = cc.movie_id)
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.041..276.152 rows=460484 loops=3)
                                                                                                   Filter: (production_year > 2000)
                                                                                                   Rows Removed by Filter: 382286
                                                                                             ->  Hash  (cost=2996.88..2996.88 rows=8443 width=4) (actual time=93.975..93.975 rows=85941 loops=3)
                                                                                                   Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 4046kB
                                                                                                   ->  Hash Join  (cost=2.12..2996.88 rows=8443 width=4) (actual time=0.248..66.650 rows=85941 loops=3)
                                                                                                         Hash Cond: (cc.status_id = cct2.id)
                                                                                                         ->  Hash Join  (cost=1.06..2813.24 rows=33772 width=8) (actual time=0.128..48.430 rows=85941 loops=3)
                                                                                                               Hash Cond: (cc.subject_id = cct1.id)
                                                                                                               ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.029..17.819 rows=135086 loops=3)
                                                                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.020..0.022 rows=1 loops=3)
                                                                                                                           Filter: ((kind)::text = 'cast'::text)
                                                                                                                           Rows Removed by Filter: 3
                                                                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.067..0.068 rows=2 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.054..0.056 rows=2 loops=3)
                                                                                                                     Filter: ((kind)::text ~~ '%complete%'::text)
                                                                                                                     Rows Removed by Filter: 2
                                                                           ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=48.117..48.117 rows=10 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.220..48.076 rows=10 loops=3)
                                                                                       Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                                       Rows Removed by Filter: 134160
               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=1)
                           Filter: ((info)::text = 'rating'::text)
                           Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.025..0.025 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.013..0.014 rows=1 loops=1)
                     Filter: ((kind)::text = 'movie'::text)
                     Rows Removed by Filter: 6
 Planning Time: 85.983 ms
 Execution Time: 7309.698 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26b.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=719517.69..719517.70 rows=1 width=96) (actual time=6422.789..6422.789 rows=1 loops=1)
   ->  Hash Join  (cost=662439.50..719517.69 rows=1 width=38) (actual time=5944.555..6422.715 rows=93 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=662438.44..719516.62 rows=1 width=42) (actual time=5944.424..6422.561 rows=93 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=662437.38..719515.56 rows=1 width=46) (actual time=5944.333..6422.433 rows=180 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=658006.94..714423.11 rows=1 width=54) (actual time=5865.089..6337.459 rows=191 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=657006.94..713423.01 rows=1 width=54) (actual time=5861.326..6328.791 rows=64 loops=3)
                                 Hash Cond: (chn.id = ci.person_role_id)
                                 ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.046..458.667 rows=60051 loops=3)
                                       Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                                       Rows Removed by Filter: 986729
                                 ->  Parallel Hash  (cost=657006.93..657006.93 rows=1 width=42) (actual time=5856.581..5856.581 rows=2660 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                       ->  Hash Join  (cost=577517.63..657006.93 rows=1 width=42) (actual time=5044.132..5621.347 rows=2660 loops=3)
                                             Hash Cond: (mi_idx.info_type_id = it2.id)
                                             ->  Parallel Hash Join  (cost=577515.21..657004.49 rows=6 width=46) (actual time=5043.765..5619.249 rows=5809 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.043..368.575 rows=1389164 loops=3)
                                                   ->  Parallel Hash  (cost=577515.13..577515.13 rows=6 width=50) (actual time=5043.281..5043.281 rows=5809 loops=3)
                                                         Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2136kB
                                                         ->  Parallel Hash Join  (cost=117178.19..577515.13 rows=6 width=50) (actual time=1087.678..4777.931 rows=5809 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.024..2157.405 rows=12081448 loops=3)
                                                               ->  Parallel Hash  (cost=117178.17..117178.17 rows=1 width=38) (actual time=1086.175..1086.176 rows=39 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Hash Join  (cost=101980.10..117178.17 rows=1 width=38) (actual time=1006.496..1086.064 rows=39 loops=3)
                                                                           Hash Cond: (mi_idx.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=20101 width=13) (actual time=0.067..129.343 rows=17883 loops=3)
                                                                                 Filter: ((info)::text > '8.0'::text)
                                                                                 Rows Removed by Filter: 442129
                                                                           ->  Parallel Hash  (cost=101980.06..101980.06 rows=3 width=25) (actual time=952.893..952.893 rows=480 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Hash Join  (cost=51215.31..101980.06 rows=3 width=25) (actual time=843.799..952.295 rows=480 loops=3)
                                                                                       Hash Cond: (t.kind_id = kt.id)
                                                                                       ->  Parallel Hash Join  (cost=51214.21..101978.87 rows=23 width=29) (actual time=640.383..951.782 rows=1008 loops=3)
                                                                                             Hash Cond: (t.id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.044..266.990 rows=337640 loops=3)
                                                                                                   Filter: (production_year > 2005)
                                                                                                   Rows Removed by Filter: 505131
                                                                                             ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=638.346..638.346 rows=3328 loops=3)
                                                                                                   Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 696kB
                                                                                                   ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.405..467.102 rows=3328 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.047..250.305 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.196..32.196 rows=4 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=0.152..32.175 rows=4 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,fight}'::text[]))
                                                                                                                     Rows Removed by Filter: 134166
                                                                                       ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.038..0.038 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=3)
                                                                                                   Filter: ((kind)::text = 'movie'::text)
                                                                                                   Rows Removed by Filter: 6
                                             ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.072..0.072 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.052..0.055 rows=1 loops=3)
                                                         Filter: ((info)::text = 'rating'::text)
                                                         Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=68.070..68.070 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.012..26.135 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.021..0.021 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.048..0.048 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.033..0.035 rows=2 loops=1)
                     Filter: ((kind)::text ~~ '%complete%'::text)
                     Rows Removed by Filter: 2
 Planning Time: 86.300 ms
 Execution Time: 6424.763 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/26c.sql_explained.sql
SET
SET
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=722078.21..722078.22 rows=1 width=96) (actual time=8358.429..8358.429 rows=1 loops=1)
   ->  Hash Join  (cost=665321.10..722078.20 rows=1 width=38) (actual time=7865.170..8355.260 rows=5400 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Gather  (cost=665320.04..722077.14 rows=1 width=42) (actual time=7865.057..8503.200 rows=6359 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=664320.04..721077.04 rows=1 width=42) (actual time=7857.705..8343.064 rows=2120 loops=3)
                     Hash Cond: (chn.id = ci.person_role_id)
                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..56075.12 rows=90916 width=20) (actual time=0.048..466.195 rows=60051 loops=3)
                           Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%man%'::text) OR ((name)::text ~~ '%Man%'::text)))
                           Rows Removed by Filter: 986729
                     ->  Parallel Hash  (cost=664319.99..664319.99 rows=4 width=30) (actual time=7856.837..7856.837 rows=73556 loops=3)
                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 7416kB
                           ->  Parallel Hash Join  (cost=584830.72..664319.99 rows=4 width=30) (actual time=7407.894..7786.548 rows=73556 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.050..387.754 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=584830.67..584830.67 rows=4 width=34) (actual time=6475.945..6475.945 rows=73556 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 8 (originally 1)  Memory Usage: 2336kB
                                       ->  Hash Join  (cost=533504.83..584830.67 rows=4 width=34) (actual time=6170.529..6391.105 rows=73556 loops=3)
                                             Hash Cond: (t.kind_id = kt.id)
                                             ->  Parallel Hash Join  (cost=533503.73..584829.46 rows=26 width=38) (actual time=6166.587..6373.262 rows=81357 loops=3)
                                                   Hash Cond: (t.id = mk.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.038..288.833 rows=460484 loops=3)
                                                         Filter: (production_year > 2000)
                                                         Rows Removed by Filter: 382286
                                                   ->  Parallel Hash  (cost=533503.13..533503.13 rows=48 width=33) (actual time=5688.637..5688.637 rows=232511 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 3616kB
                                                         ->  Hash Join  (cost=72499.97..533503.13 rows=48 width=33) (actual time=839.371..5393.762 rows=232511 loops=3)
                                                               Hash Cond: (cc.status_id = cct2.id)
                                                               ->  Hash Join  (cost=72498.91..533501.03 rows=192 width=37) (actual time=839.265..5326.255 rows=232511 loops=3)
                                                                     Hash Cond: (mk.movie_id = cc.movie_id)
                                                                     ->  Parallel Hash Join  (cost=68068.47..528405.98 rows=138 width=25) (actual time=769.920..4931.620 rows=360905 loops=3)
                                                                           Hash Cond: (ci.movie_id = mk.movie_id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.030..2198.529 rows=12081448 loops=3)
                                                                           ->  Parallel Hash  (cost=68068.42..68068.42 rows=4 width=13) (actual time=769.729..769.729 rows=6392 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1464kB
                                                                                 ->  Hash Join  (cost=52224.04..68068.42 rows=4 width=13) (actual time=598.927..748.519 rows=6392 loops=3)
                                                                                       Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                                       ->  Parallel Hash Join  (cost=52221.61..68064.84 rows=426 width=17) (actual time=598.794..745.812 rows=19234 loops=3)
                                                                                             Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..76.037 rows=460012 loops=3)
                                                                                             ->  Parallel Hash  (cost=52219.86..52219.86 rows=140 width=4) (actual time=598.401..598.402 rows=8030 loops=3)
                                                                                                   Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1528kB
                                                                                                   ->  Hash Join  (cost=3967.95..52219.86 rows=140 width=4) (actual time=47.772..490.732 rows=8030 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.039..253.656 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3967.82..3967.82 rows=10 width=4) (actual time=47.486..47.486 rows=10 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3967.82 rows=10 width=4) (actual time=0.230..47.457 rows=10 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{superhero,marvel-comics,based-on-comic,tv-special,fight,violence,magnet,web,claw,laser}'::text[]))
                                                                                                                     Rows Removed by Filter: 134160
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.053..0.056 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'rating'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=66.736..66.736 rows=135086 loops=3)
                                                                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.031..25.428 rows=135086 loops=3)
                                                               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.045..0.045 rows=2 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.032..0.034 rows=2 loops=3)
                                                                           Filter: ((kind)::text ~~ '%complete%'::text)
                                                                           Rows Removed by Filter: 2
                                             ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.056..0.056 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=3)
                                                         Filter: ((kind)::text = 'movie'::text)
                                                         Rows Removed by Filter: 6
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.048..0.048 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.037 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 85.370 ms
 Execution Time: 8512.149 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27a.sql_explained.sql
SET
SET
                                                                                                                    QUERY PLAN                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=62724.94..62724.95 rows=1 width=96) (actual time=313.467..313.468 rows=1 loops=1)
   ->  Merge Join  (cost=26778.72..62724.94 rows=1 width=118) (actual time=312.597..313.256 rows=477 loops=1)
         Merge Cond: (mi.movie_id = ml.movie_id)
         ->  Gather Merge  (cost=1000.46..988404.79 rows=132912 width=4) (actual time=9.541..21.536 rows=2822 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..972063.42 rows=55380 width=4) (actual time=1.417..158.694 rows=1126 loops=3)
                     Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                     Rows Removed by Filter: 148910
         ->  Sort  (cost=25778.26..25778.26 rows=1 width=138) (actual time=302.665..302.695 rows=475 loops=1)
               Sort Key: t.id
               Sort Method: quicksort  Memory: 49kB
               ->  Hash Join  (cost=22622.22..25778.25 rows=1 width=138) (actual time=279.298..302.469 rows=172 loops=1)
                     Hash Cond: (mk.keyword_id = k.id)
                     ->  Merge Join  (cost=19996.08..23150.40 rows=652 width=142) (actual time=255.842..281.658 rows=3278 loops=1)
                           Merge Cond: (mk.movie_id = ml.movie_id)
                           ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.031..19.738 rows=69431 loops=1)
                           ->  Sort  (cost=19995.65..19995.68 rows=14 width=134) (actual time=253.022..253.229 rows=3270 loops=1)
                                 Sort Key: t.id
                                 Sort Method: quicksort  Memory: 62kB
                                 ->  Hash Join  (cost=19698.66..19995.38 rows=14 width=134) (actual time=249.934..252.791 rows=269 loops=1)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Hash Join  (cost=19697.58..19994.16 rows=27 width=138) (actual time=249.824..252.609 rows=269 loops=1)
                                             Hash Cond: (cc.status_id = cct2.id)
                                             ->  Merge Join  (cost=19696.52..19992.51 rows=109 width=142) (actual time=249.748..252.447 rows=333 loops=1)
                                                   Merge Cond: (cc.movie_id = ml.movie_id)
                                                   ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.034..2.317 rows=5140 loops=1)
                                                   ->  Sort  (cost=19696.10..19696.27 rows=69 width=130) (actual time=249.311..249.363 rows=756 loops=1)
                                                         Sort Key: t.id
                                                         Sort Method: quicksort  Memory: 120kB
                                                         ->  Gather  (cost=7378.71..19693.99 rows=69 width=130) (actual time=131.852..250.323 rows=698 loops=1)
                                                               Workers Planned: 2
                                                               Workers Launched: 2
                                                               ->  Parallel Hash Join  (cost=6378.71..18687.09 rows=29 width=130) (actual time=125.113..241.296 rows=233 loops=3)
                                                                     Hash Cond: (mc.company_id = cn.id)
                                                                     ->  Hash Join  (cost=652.57..12960.52 rows=160 width=115) (actual time=21.834..177.010 rows=931 loops=3)
                                                                           Hash Cond: (mc.company_type_id = ct.id)
                                                                           ->  Merge Join  (cost=651.50..12956.00 rows=640 width=119) (actual time=21.685..176.494 rows=1104 loops=3)
                                                                                 Merge Cond: (ml.movie_id = mc.movie_id)
                                                                                 ->  Merge Join  (cost=651.07..7725.24 rows=250 width=107) (actual time=18.106..129.226 rows=444 loops=3)
                                                                                       Merge Cond: (t.id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using title_pkey on title t  (cost=0.43..92601.00 rows=379985 width=21) (actual time=0.689..114.381 rows=19945 loops=3)
                                                                                             Filter: ((production_year >= 1950) AND (production_year <= 2000))
                                                                                             Rows Removed by Filter: 42153
                                                                                       ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=12.347..12.533 rows=2315 loops=3)
                                                                                             Sort Key: ml.movie_id
                                                                                             Sort Method: quicksort  Memory: 205kB
                                                                                             Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                             Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                                                             ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.139..11.021 rows=2315 loops=3)
                                                                                                   Hash Cond: (ml.link_type_id = lt.id)
                                                                                                   ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.031..6.639 rows=29997 loops=3)
                                                                                                   ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.048..0.048 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.032..0.037 rows=2 loops=3)
                                                                                                               Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                               Rows Removed by Filter: 16
                                                                                 ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.067..43.642 rows=42217 loops=3)
                                                                                       Filter: (note IS NULL)
                                                                                       Rows Removed by Filter: 42672
                                                                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.086..0.087 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.074..0.076 rows=1 loops=3)
                                                                                       Filter: ((kind)::text = 'production companies'::text)
                                                                                       Rows Removed by Filter: 3
                                                                     ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=62.854..62.854 rows=16101 loops=3)
                                                                           Buckets: 65536  Batches: 1  Memory Usage: 3264kB
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.062..50.916 rows=16101 loops=3)
                                                                                 Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                                 Rows Removed by Filter: 62232
                                             ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.020 rows=1 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                                                         Filter: ((kind)::text = 'complete'::text)
                                                         Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.057..0.057 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.044..0.046 rows=2 loops=1)
                                                   Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                                                   Rows Removed by Filter: 2
                     ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.418..20.418 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.121..20.406 rows=1 loops=1)
                                 Filter: ((keyword)::text = 'sequel'::text)
                                 Rows Removed by Filter: 134169
 Planning Time: 84.514 ms
 Execution Time: 327.031 ms
(87 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27b.sql_explained.sql
SET
SET
                                                                                                                     QUERY PLAN                                                                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=62047.93..62047.94 rows=1 width=96) (actual time=535.988..535.988 rows=1 loops=1)
   ->  Hash Join  (cost=58902.55..62047.92 rows=1 width=118) (actual time=535.122..535.861 rows=247 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=56276.42..59421.66 rows=47 width=122) (actual time=514.358..515.007 rows=1919 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.031..18.782 rows=69431 loops=1)
               ->  Materialize  (cost=56275.98..56275.99 rows=1 width=138) (actual time=487.833..488.058 rows=1911 loops=1)
                     ->  Sort  (cost=56275.98..56275.99 rows=1 width=138) (actual time=487.822..487.839 rows=247 loops=1)
                           Sort Key: t.id
                           Sort Method: quicksort  Memory: 59kB
                           ->  Hash Join  (cost=55981.58..56275.97 rows=1 width=138) (actual time=487.166..487.555 rows=247 loops=1)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Hash Join  (cost=55980.51..56274.91 rows=1 width=142) (actual time=487.071..487.378 rows=418 loops=1)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Merge Join  (cost=55979.44..56273.83 rows=2 width=146) (actual time=486.991..487.185 rows=418 loops=1)
                                             Merge Cond: (cc.movie_id = ml.movie_id)
                                             ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.041..1.886 rows=4705 loops=1)
                                             ->  Sort  (cost=55979.02..55979.02 rows=1 width=134) (actual time=484.480..484.546 rows=908 loops=1)
                                                   Sort Key: t.id
                                                   Sort Method: quicksort  Memory: 128kB
                                                   ->  Gather  (cost=50471.19..55979.01 rows=1 width=134) (actual time=421.285..484.459 rows=737 loops=1)
                                                         Workers Planned: 1
                                                         Workers Launched: 1
                                                         ->  Parallel Hash Join  (cost=49471.19..54978.91 rows=1 width=134) (actual time=426.297..478.582 rows=368 loops=2)
                                                               Hash Cond: (cn.id = mc.company_id)
                                                               ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.040..61.321 rows=24151 loops=2)
                                                                     Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                     Rows Removed by Filter: 93348
                                                               ->  Parallel Hash  (cost=49471.16..49471.16 rows=3 width=119) (actual time=413.369..413.369 rows=718 loops=2)
                                                                     Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 184kB
                                                                     ->  Hash Join  (cost=653.00..49471.16 rows=3 width=119) (actual time=258.070..379.408 rows=718 loops=2)
                                                                           Hash Cond: (mc.company_type_id = ct.id)
                                                                           ->  Merge Join  (cost=651.94..49470.03 rows=13 width=123) (actual time=257.970..379.083 rows=736 loops=2)
                                                                                 Merge Cond: (ml.movie_id = mc.movie_id)
                                                                                 ->  Merge Join  (cost=651.51..44246.14 rows=5 width=111) (actual time=239.930..354.272 rows=151 loops=2)
                                                                                       Merge Cond: (mi.movie_id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..972063.42 rows=55380 width=4) (actual time=1.537..140.023 rows=1440 loops=2)
                                                                                             Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                                                                                             Rows Removed by Filter: 187318
                                                                                       ->  Materialize  (cost=651.07..8854.49 rows=33 width=107) (actual time=26.495..213.986 rows=235 loops=2)
                                                                                             ->  Merge Join  (cost=651.07..8854.40 rows=33 width=107) (actual time=26.483..213.872 rows=141 loops=2)
                                                                                                   Merge Cond: (t.id = ml.movie_id)
                                                                                                   ->  Index Scan using title_pkey on title t  (cost=0.43..108402.95 rows=50313 width=21) (actual time=2.959..203.234 rows=4216 loops=2)
                                                                                                         Filter: (production_year = 1998)
                                                                                                         Rows Removed by Filter: 182255
                                                                                                   ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=9.741..9.916 rows=2315 loops=2)
                                                                                                         Sort Key: ml.movie_id
                                                                                                         Sort Method: quicksort  Memory: 205kB
                                                                                                         Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                         ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.120..8.526 rows=2315 loops=2)
                                                                                                               Hash Cond: (ml.link_type_id = lt.id)
                                                                                                               ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.019..4.323 rows=29997 loops=2)
                                                                                                               ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.034..0.035 rows=2 loops=2)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                     ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.018..0.023 rows=2 loops=2)
                                                                                                                           Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                                           Rows Removed by Filter: 16
                                                                                 ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.018..22.159 rows=34556 loops=2)
                                                                                       Filter: (note IS NULL)
                                                                                       Rows Removed by Filter: 35332
                                                                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.032..0.034 rows=1 loops=2)
                                                                                       Filter: ((kind)::text = 'production companies'::text)
                                                                                       Rows Removed by Filter: 3
                                       ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.026..0.026 rows=2 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.011..0.013 rows=2 loops=1)
                                                   Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                                                   Rows Removed by Filter: 2
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.037 rows=1 loops=1)
                                             Filter: ((kind)::text = 'complete'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.563..20.563 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.122..20.551 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 85.638 ms
 Execution Time: 537.340 ms
(82 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/27c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=64696.47..64696.48 rows=1 width=96) (actual time=605.003..605.003 rows=1 loops=1)
   ->  Hash Join  (cost=61522.37..64696.47 rows=1 width=118) (actual time=580.036..604.697 rows=743 loops=1)
         Hash Cond: (mk.keyword_id = k.id)
         ->  Merge Join  (cost=58896.24..62065.93 rows=1677 width=122) (actual time=556.361..582.849 rows=11620 loops=1)
               Merge Cond: (mk.movie_id = ml.movie_id)
               ->  Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..142057.13 rows=4523930 width=8) (actual time=0.030..18.227 rows=69431 loops=1)
               ->  Sort  (cost=58895.80..58895.89 rows=36 width=138) (actual time=553.678..554.395 rows=11612 loops=1)
                     Sort Key: ml.movie_id
                     Sort Method: quicksort  Memory: 210kB
                     ->  Hash Join  (cost=58588.08..58894.87 rows=36 width=138) (actual time=548.435..552.765 rows=1150 loops=1)
                           Hash Cond: (cc.subject_id = cct1.id)
                           ->  Hash Join  (cost=58587.01..58893.03 rows=143 width=142) (actual time=548.339..552.339 rows=1436 loops=1)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Merge Join  (cost=58585.95..58888.88 rows=572 width=146) (actual time=548.263..551.868 rows=1436 loops=1)
                                       Merge Cond: (cc.movie_id = ml.movie_id)
                                       ->  Index Scan using movie_id_complete_cast on complete_cast cc  (cost=0.42..6344.49 rows=135086 width=12) (actual time=0.036..2.293 rows=5142 loops=1)
                                       ->  Sort  (cost=58585.52..58586.43 rows=363 width=134) (actual time=547.875..548.204 rows=4252 loops=1)
                                             Sort Key: ml.movie_id
                                             Sort Method: quicksort  Memory: 654kB
                                             ->  Gather  (cost=7421.33..58570.09 rows=363 width=134) (actual time=80.590..546.550 rows=3966 loops=1)
                                                   Workers Planned: 2
                                                   Workers Launched: 2
                                                   ->  Hash Join  (cost=6421.33..57533.79 rows=151 width=134) (actual time=93.191..517.721 rows=1322 loops=3)
                                                         Hash Cond: (mc.company_type_id = ct.id)
                                                         ->  Parallel Hash Join  (cost=6420.26..57529.46 rows=605 width=138) (actual time=92.996..517.082 rows=1361 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Merge Join  (cost=694.11..51794.52 rows=3349 width=123) (actual time=14.243..465.333 rows=3944 loops=3)
                                                                     Merge Cond: (ml.movie_id = mc.movie_id)
                                                                     ->  Merge Join  (cost=693.68..46534.00 rows=1310 width=111) (actual time=14.058..425.186 rows=1247 loops=3)
                                                                           Merge Cond: (ml.movie_id = t.id)
                                                                           ->  Merge Join  (cost=651.07..37496.27 rows=1747 width=90) (actual time=11.113..173.769 rows=1288 loops=3)
                                                                                 Merge Cond: (mi.movie_id = ml.movie_id)
                                                                                 ->  Parallel Index Scan using movie_id_movie_info on movie_info mi  (cost=0.43..1010698.11 rows=372351 width=4) (actual time=0.197..161.739 rows=11321 loops=3)
                                                                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,English}'::text[]))
                                                                                       Rows Removed by Filter: 160210
                                                                                 ->  Sort  (cost=650.63..654.80 rows=1666 width=86) (actual time=9.706..9.961 rows=2956 loops=3)
                                                                                       Sort Key: ml.movie_id
                                                                                       Sort Method: quicksort  Memory: 205kB
                                                                                       Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                       Worker 1:  Sort Method: quicksort  Memory: 205kB
                                                                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=86) (actual time=0.136..8.485 rows=2315 loops=3)
                                                                                             Hash Cond: (ml.link_type_id = lt.id)
                                                                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.030..4.231 rows=29997 loops=3)
                                                                                             ->  Hash  (cost=1.23..1.23 rows=1 width=86) (actual time=0.044..0.045 rows=2 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=86) (actual time=0.020..0.025 rows=2 loops=3)
                                                                                                         Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                         Rows Removed by Filter: 16
                                                                           ->  Index Scan using title_pkey on title t  (cost=0.43..114723.73 rows=1895923 width=21) (actual time=0.024..240.284 rows=133937 loops=3)
                                                                                 Filter: ((production_year >= 1950) AND (production_year <= 2010))
                                                                                 Rows Removed by Filter: 37735
                                                                     ->  Index Scan using movie_id_movie_companies on movie_companies mc  (cost=0.43..131550.35 rows=1273429 width=12) (actual time=0.034..35.648 rows=47778 loops=3)
                                                                           Filter: (note IS NULL)
                                                                           Rows Removed by Filter: 47336
                                                               ->  Parallel Hash  (cost=5414.09..5414.09 rows=24965 width=23) (actual time=49.499..49.499 rows=16101 loops=3)
                                                                     Buckets: 65536  Batches: 1  Memory Usage: 3264kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..5414.09 rows=24965 width=23) (actual time=0.038..38.330 rows=16101 loops=3)
                                                                           Filter: (((country_code)::text <> '[pl]'::text) AND (((name)::text ~~ '%Film%'::text) OR ((name)::text ~~ '%Warner%'::text)))
                                                                           Rows Removed by Filter: 62232
                                                         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.031..0.032 rows=1 loops=3)
                                                                     Filter: ((kind)::text = 'production companies'::text)
                                                                     Rows Removed by Filter: 3
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.022..0.022 rows=2 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.010..0.011 rows=2 loops=1)
                                             Filter: ((kind)::text ~~ 'complete%'::text)
                                             Rows Removed by Filter: 2
                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=1)
                                       Filter: ((kind)::text = 'cast'::text)
                                       Rows Removed by Filter: 3
         ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.692..20.692 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.132..20.680 rows=1 loops=1)
                     Filter: ((keyword)::text = 'sequel'::text)
                     Rows Removed by Filter: 134169
 Planning Time: 85.304 ms
 Execution Time: 607.463 ms
(81 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28a.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=468295.89..468295.90 rows=1 width=96) (actual time=4045.111..4045.111 rows=1 loops=1)
   ->  Hash Join  (cost=451069.27..468295.88 rows=1 width=41) (actual time=3859.063..4043.138 rows=4803 loops=1)
         Hash Cond: (mi_idx.info_type_id = it2.id)
         ->  Gather  (cost=451066.84..468293.45 rows=1 width=45) (actual time=3858.933..4048.166 rows=15325 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=450066.84..467293.35 rows=1 width=45) (actual time=3839.629..4030.748 rows=5108 loops=3)
                     Hash Cond: (mi_idx.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.073..159.263 rows=447629 loops=3)
                           Filter: ((info)::text < '8.5'::text)
                           Rows Removed by Filter: 12383
                     ->  Parallel Hash  (cost=450066.83..450066.83 rows=1 width=56) (actual time=3821.749..3821.749 rows=1704 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                           ->  Hash Join  (cost=147280.54..450066.83 rows=1 width=56) (actual time=3340.842..3805.748 rows=1704 loops=3)
                                 Hash Cond: (cc.status_id = cct2.id)
                                 ->  Hash Join  (cost=147279.45..450065.74 rows=1 width=60) (actual time=3340.723..3805.125 rows=2155 loops=3)
                                       Hash Cond: (cc.subject_id = cct1.id)
                                       ->  Hash Join  (cost=147278.39..450064.67 rows=1 width=64) (actual time=3314.542..3803.291 rows=13930 loops=3)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Hash Join  (cost=142847.96..444972.22 rows=1 width=52) (actual time=3230.002..3700.567 rows=15212 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=142845.53..444969.79 rows=1 width=56) (actual time=1385.067..3696.218 rows=17574 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.088..2274.834 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Parallel Hash  (cost=142845.52..142845.52 rows=1 width=48) (actual time=1376.877..1376.877 rows=16473 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5176kB
                                                               ->  Parallel Hash Join  (cost=137845.48..142845.52 rows=1 width=48) (actual time=1310.412..1358.248 rows=16473 loops=3)
                                                                     Hash Cond: (cn.id = mc.company_id)
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.046..33.467 rows=42077 loops=3)
                                                                           Filter: ((country_code)::text <> '[us]'::text)
                                                                           Rows Removed by Filter: 36256
                                                                     ->  Parallel Hash  (cost=137845.47..137845.47 rows=1 width=33) (actual time=1310.243..1310.243 rows=17485 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4504kB
                                                                           ->  Hash Join  (cost=102542.40..137845.47 rows=1 width=33) (actual time=980.291..1277.200 rows=17485 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=102541.31..137844.38 rows=1 width=37) (actual time=980.191..1272.613 rows=17485 loops=3)
                                                                                       Hash Cond: (mc.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.018..275.101 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=102541.20..102541.20 rows=9 width=25) (actual time=978.553..978.554 rows=3895 loops=3)
                                                                                             Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 984kB
                                                                                             ->  Hash Join  (cost=51215.33..102541.20 rows=9 width=25) (actual time=583.934..929.940 rows=3895 loops=3)
                                                                                                   Hash Cond: (t.kind_id = kt.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..102539.96 rows=31 width=29) (actual time=583.220..927.940 rows=4924 loops=3)
                                                                                                         Hash Cond: (t.id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=25) (actual time=0.013..277.541 rows=460484 loops=3)
                                                                                                               Filter: (production_year > 2000)
                                                                                                               Rows Removed by Filter: 382286
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=582.548..582.548 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=49.257..491.754 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..255.669 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=48.956..48.956 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.662..48.934 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.097..0.097 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.081..0.084 rows=2 loops=3)
                                                                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                                                                               Rows Removed by Filter: 5
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.044..0.044 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.025..0.027 rows=4 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.070..0.070 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.056 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=72.651..72.651 rows=135086 loops=3)
                                                   Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.031..31.303 rows=135086 loops=3)
                                       ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.029..0.029 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.015..0.017 rows=1 loops=3)
                                                   Filter: ((kind)::text = 'crew'::text)
                                                   Rows Removed by Filter: 3
                                 ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.071..0.071 rows=3 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=3 width=4) (actual time=0.045..0.047 rows=3 loops=3)
                                             Filter: ((kind)::text <> 'complete+verified'::text)
                                             Rows Removed by Filter: 1
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.050..0.050 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.025 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 111.264 ms
 Execution Time: 4053.867 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28b.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=418889.66..418889.67 rows=1 width=96) (actual time=3091.569..3091.570 rows=1 loops=1)
   ->  Hash Join  (cost=403298.67..418889.65 rows=1 width=41) (actual time=2957.011..3091.483 rows=148 loops=1)
         Hash Cond: (mi_idx.info_type_id = it2.id)
         ->  Gather  (cost=403296.25..418887.22 rows=1 width=45) (actual time=2956.893..3097.715 rows=224 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Hash Join  (cost=402296.25..417887.12 rows=1 width=45) (actual time=2998.903..3083.012 rows=75 loops=3)
                     Hash Cond: (mi_idx.movie_id = t.id)
                     ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=124848 width=13) (actual time=0.056..137.668 rows=99992 loops=3)
                           Filter: ((info)::text > '6.5'::text)
                           Rows Removed by Filter: 360020
                     ->  Parallel Hash  (cost=402296.24..402296.24 rows=1 width=56) (actual time=2933.418..2933.418 rows=70 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=350869.64..402296.24 rows=1 width=56) (actual time=2918.331..2932.832 rows=70 loops=3)
                                 Hash Cond: (cc.subject_id = cct1.id)
                                 ->  Hash Join  (cost=350868.57..402295.17 rows=1 width=60) (actual time=2830.546..2932.640 rows=544 loops=3)
                                       Hash Cond: (cc.status_id = cct2.id)
                                       ->  Hash Join  (cost=350867.49..402294.08 rows=1 width=64) (actual time=2830.470..2932.357 rows=1108 loops=3)
                                             Hash Cond: (t.id = cc.movie_id)
                                             ->  Hash Join  (cost=346437.05..397201.63 rows=1 width=52) (actual time=2548.896..2844.733 rows=1608 loops=3)
                                                   Hash Cond: (t.kind_id = kt.id)
                                                   ->  Parallel Hash Join  (cost=346435.94..397200.52 rows=1 width=56) (actual time=2547.802..2844.141 rows=1675 loops=3)
                                                         Hash Cond: (t.id = mi.movie_id)
                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.010..264.329 rows=337640 loops=3)
                                                               Filter: (production_year > 2005)
                                                               Rows Removed by Filter: 505131
                                                         ->  Parallel Hash  (cost=346435.93..346435.93 rows=1 width=31) (actual time=2536.450..2536.450 rows=4086 loops=3)
                                                               Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1112kB
                                                               ->  Parallel Hash Join  (cost=341435.89..346435.93 rows=1 width=31) (actual time=2508.372..2531.647 rows=4086 loops=3)
                                                                     Hash Cond: (cn.id = mc.company_id)
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.009..17.391 rows=42077 loops=3)
                                                                           Filter: ((country_code)::text <> '[us]'::text)
                                                                           Rows Removed by Filter: 36256
                                                                     ->  Parallel Hash  (cost=341435.88..341435.88 rows=1 width=16) (actual time=2508.247..2508.247 rows=4250 loops=3)
                                                                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                           ->  Hash Join  (cost=306132.81..341435.88 rows=1 width=16) (actual time=2199.969..2478.426 rows=4250 loops=3)
                                                                                 Hash Cond: (mc.company_type_id = ct.id)
                                                                                 ->  Parallel Hash Join  (cost=306131.72..341434.79 rows=1 width=20) (actual time=2199.874..2477.275 rows=4250 loops=3)
                                                                                       Hash Cond: (mc.movie_id = mi.movie_id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.037..265.332 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=306131.71..306131.71 rows=1 width=8) (actual time=2196.738..2196.739 rows=653 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Hash Join  (cost=51216.64..306131.71 rows=1 width=8) (actual time=1900.545..2196.173 rows=653 loops=3)
                                                                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..306129.23 rows=21 width=12) (actual time=563.792..2195.619 rows=1510 loops=3)
                                                                                                         Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=55380 width=8) (actual time=0.979..1621.809 rows=44746 loops=3)
                                                                                                               Filter: ((info)::text = ANY ('{Sweden,Germany,Swedish,German}'::text[]))
                                                                                                               Rows Removed by Filter: 4900494
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=561.834..561.835 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=32.954..472.799 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..252.328 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.776..32.776 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.522..32.758 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.035 rows=1 loops=3)
                                                                                                               Filter: ((info)::text = 'countries'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                                 ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.042..0.042 rows=4 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.024..0.026 rows=4 loops=3)
                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.094..0.094 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.078..0.081 rows=2 loops=3)
                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                               Rows Removed by Filter: 5
                                             ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=69.268..69.268 rows=135086 loops=3)
                                                   Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                   ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.030..28.340 rows=135086 loops=3)
                                       ->  Hash  (cost=1.05..1.05 rows=3 width=4) (actual time=0.023..0.023 rows=3 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=3 width=4) (actual time=0.008..0.010 rows=3 loops=3)
                                                   Filter: ((kind)::text <> 'complete+verified'::text)
                                                   Rows Removed by Filter: 1
                                 ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.072..0.072 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.049..0.050 rows=1 loops=3)
                                             Filter: ((kind)::text = 'crew'::text)
                                             Rows Removed by Filter: 3
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.044..0.044 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.023..0.026 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 111.035 ms
 Execution Time: 3099.030 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/28c.sql_explained.sql
SET
SET
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=467734.71..467734.72 rows=1 width=96) (actual time=3904.732..3904.732 rows=1 loops=1)
   ->  Hash Join  (cost=449846.07..467734.70 rows=1 width=41) (actual time=3672.147..3901.098 rows=8373 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=449845.01..467733.64 rows=1 width=45) (actual time=3672.027..3898.189 rows=15126 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=449843.95..467732.57 rows=1 width=49) (actual time=3671.948..3894.135 rows=16719 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=445413.51..462640.12 rows=1 width=61) (actual time=3573.096..3789.438 rows=21489 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=445411.09..462637.70 rows=1 width=65) (actual time=3572.973..3778.370 rows=64628 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=444411.09..461637.60 rows=1 width=65) (actual time=3569.943..3769.114 rows=21543 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=561018 width=13) (actual time=0.356..156.794 rows=447629 loops=3)
                                             Filter: ((info)::text < '8.5'::text)
                                             Rows Removed by Filter: 12383
                                       ->  Parallel Hash  (cost=444411.07..444411.07 rows=1 width=52) (actual time=3556.532..3556.532 rows=7276 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                             ->  Hash Join  (cost=142286.81..444411.07 rows=1 width=52) (actual time=3082.481..3535.317 rows=7276 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=142284.38..444408.65 rows=1 width=56) (actual time=1290.639..3533.127 rows=8340 loops=3)
                                                         Hash Cond: (mi.movie_id = t.id)
                                                         ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=0.971..2219.088 rows=238737 loops=3)
                                                               Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Danish,Norwegian,German,USA,American}'::text[]))
                                                               Rows Removed by Filter: 4706503
                                                         ->  Parallel Hash  (cost=142284.37..142284.37 rows=1 width=48) (actual time=1278.470..1278.470 rows=7967 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2552kB
                                                               ->  Hash Join  (cost=137284.33..142284.37 rows=1 width=48) (actual time=1239.136..1269.831 rows=7967 loops=3)
                                                                     Hash Cond: (mc.company_type_id = ct.id)
                                                                     ->  Parallel Hash Join  (cost=137283.24..142283.28 rows=1 width=52) (actual time=1239.039..1267.760 rows=7967 loops=3)
                                                                           Hash Cond: (cn.id = mc.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.013..20.355 rows=42077 loops=3)
                                                                                 Filter: ((country_code)::text <> '[us]'::text)
                                                                                 Rows Removed by Filter: 36256
                                                                           ->  Parallel Hash  (cost=137283.23..137283.23 rows=1 width=37) (actual time=1238.923..1238.923 rows=8618 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2328kB
                                                                                 ->  Parallel Hash Join  (cost=101980.16..137283.23 rows=1 width=37) (actual time=933.368..1211.495 rows=8618 loops=3)
                                                                                       Hash Cond: (mc.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=54933 width=12) (actual time=0.043..267.423 rows=101090 loops=3)
                                                                                             Filter: (((note)::text !~~ '%(USA)%'::text) AND ((note)::text ~~ '%(200%)%'::text))
                                                                                             Rows Removed by Filter: 768619
                                                                                       ->  Parallel Hash  (cost=101980.08..101980.08 rows=7 width=25) (actual time=927.836..927.836 rows=2691 loops=3)
                                                                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 632kB
                                                                                             ->  Hash Join  (cost=51215.33..101980.08 rows=7 width=25) (actual time=562.001..883.840 rows=2691 loops=3)
                                                                                                   Hash Cond: (t.kind_id = kt.id)
                                                                                                   ->  Parallel Hash Join  (cost=51214.21..101978.87 rows=23 width=29) (actual time=561.312..882.396 rows=3246 loops=3)
                                                                                                         Hash Cond: (t.id = mk.movie_id)
                                                                                                         ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=25) (actual time=0.023..272.014 rows=337640 loops=3)
                                                                                                               Filter: (production_year > 2005)
                                                                                                               Rows Removed by Filter: 505131
                                                                                                         ->  Parallel Hash  (cost=51213.51..51213.51 rows=56 width=4) (actual time=560.904..560.904 rows=12364 loops=3)
                                                                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2488kB
                                                                                                               ->  Hash Join  (cost=2961.60..51213.51 rows=56 width=4) (actual time=33.267..472.674 rows=12364 loops=3)
                                                                                                                     Hash Cond: (mk.keyword_id = k.id)
                                                                                                                     ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..251.952 rows=1507977 loops=3)
                                                                                                                     ->  Hash  (cost=2961.55..2961.55 rows=4 width=4) (actual time=32.998..32.999 rows=3 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on keyword k  (cost=0.00..2961.55 rows=4 width=4) (actual time=1.610..32.983 rows=3 loops=3)
                                                                                                                                 Filter: ((keyword)::text = ANY ('{murder,murder-in-title,blood,violence}'::text[]))
                                                                                                                                 Rows Removed by Filter: 134167
                                                                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.075..0.076 rows=2 loops=3)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on kind_type kt  (cost=0.00..1.09 rows=2 width=4) (actual time=0.057..0.060 rows=2 loops=3)
                                                                                                               Filter: ((kind)::text = ANY ('{movie,episode}'::text[]))
                                                                                                               Rows Removed by Filter: 5
                                                                     ->  Hash  (cost=1.04..1.04 rows=4 width=4) (actual time=0.040..0.040 rows=4 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on company_type ct  (cost=0.00..1.04 rows=4 width=4) (actual time=0.025..0.027 rows=4 loops=3)
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.050 rows=1 loops=3)
                                                               Filter: ((info)::text = 'countries'::text)
                                                               Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.029..0.032 rows=1 loops=1)
                                       Filter: ((info)::text = 'rating'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.135..70.135 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.023..29.005 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.027..0.027 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=1)
                     Filter: ((kind)::text = 'complete'::text)
                     Rows Removed by Filter: 3
 Planning Time: 110.054 ms
 Execution Time: 3907.890 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29a.sql_explained.sql
SET
SET
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1085189.97..1085189.98 rows=1 width=96) (actual time=9177.486..9177.487 rows=1 loops=1)
   ->  Hash Join  (cost=1002792.89..1085189.96 rows=1 width=48) (actual time=9174.699..9176.998 rows=1620 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=1002791.82..1085188.89 rows=1 width=52) (actual time=9174.548..9176.464 rows=1620 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=1002790.76..1085187.83 rows=1 width=56) (actual time=9174.456..9175.954 rows=1620 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=998360.33..1080095.38 rows=1 width=68) (actual time=9091.891..9095.254 rows=1620 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=997360.33..1079095.28 rows=1 width=68) (actual time=8928.774..8928.928 rows=540 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=226.759..535.375 rows=16670 loops=3)
                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1372493
                                 ->  Parallel Hash  (cost=997360.31..997360.31 rows=1 width=65) (actual time=8388.469..8388.469 rows=540 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                       ->  Hash Join  (cost=980800.35..997360.31 rows=1 width=65) (actual time=8304.845..8364.417 rows=540 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Hash Join  (cost=978174.21..994734.17 rows=1 width=69) (actual time=8282.426..8336.124 rows=58320 loops=3)
                                                   Hash Cond: (ci.role_id = rt.id)
                                                   ->  Parallel Hash Join  (cost=978173.05..994733.01 rows=1 width=73) (actual time=8282.287..8321.518 rows=58320 loops=3)
                                                         Hash Cond: (an.person_id = ci.person_id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.034..77.762 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=978173.04..978173.04 rows=1 width=69) (actual time=8182.486..8182.486 rows=19440 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6072kB
                                                               ->  Parallel Hash Join  (cost=911370.37..978173.04 rows=1 width=69) (actual time=6612.678..7129.652 rows=19440 loops=3)
                                                                     Hash Cond: (ci.person_role_id = chn.id)
                                                                     ->  Parallel Hash Join  (cost=858566.42..925369.09 rows=1 width=57) (actual time=6342.430..6845.219 rows=149955 loops=3)
                                                                           Hash Cond: (pi.person_id = ci.person_id)
                                                                           ->  Hash Join  (cost=2.43..66764.11 rows=10928 width=4) (actual time=0.107..448.924 rows=206842 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.042..286.920 rows=987888 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.042..0.042 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.018..0.029 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'trivia'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=858563.98..858563.98 rows=1 width=53) (actual time=6332.105..6332.106 rows=13941 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4344kB
                                                                                 ->  Parallel Hash Join  (cost=396900.01..858563.98 rows=1 width=53) (actual time=2960.687..5807.446 rows=13941 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..460336.89 rows=353886 width=16) (actual time=0.089..2842.702 rows=278900 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11802548
                                                                                       ->  Parallel Hash  (cost=396900.00..396900.00 rows=1 width=37) (actual time=2922.686..2922.686 rows=369 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=391988.71..396900.00 rows=1 width=37) (actual time=2901.811..2922.469 rows=369 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.038..28.679 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=391988.70..391988.70 rows=1 width=41) (actual time=2890.196..2890.196 rows=1603 loops=3)
                                                                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                                         ->  Parallel Hash Join  (cost=358250.56..391988.70 rows=1 width=41) (actual time=2777.989..2778.362 rows=1603 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = t.id)
                                                                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.028..160.300 rows=869710 loops=3)
                                                                                                               ->  Parallel Hash  (cost=358250.54..358250.54 rows=1 width=33) (actual time=2509.809..2509.810 rows=81 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                     ->  Hash Join  (cost=102687.90..358250.54 rows=1 width=33) (actual time=2163.689..2509.663 rows=81 loops=3)
                                                                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                                                                           ->  Parallel Hash Join  (cost=102685.48..358248.12 rows=1 width=37) (actual time=2163.568..2509.524 rows=81 loops=3)
                                                                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=182.488..1774.527 rows=150368 loops=3)
                                                                                                                                       Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                                                                                                                       Rows Removed by Filter: 4794872
                                                                                                                                 ->  Parallel Hash  (cost=102685.41..102685.41 rows=5 width=29) (actual time=718.171..718.171 rows=45 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                       ->  Parallel Hash Join  (cost=54433.65..102685.41 rows=5 width=29) (actual time=681.269..718.047 rows=45 loops=3)
                                                                                                                                             Hash Cond: (mk.movie_id = t.id)
                                                                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.010..258.330 rows=1507977 loops=3)
                                                                                                                                             ->  Parallel Hash  (cost=54433.61..54433.61 rows=3 width=21) (actual time=278.357..278.357 rows=1 loops=3)
                                                                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=3 width=21) (actual time=178.661..278.245 rows=1 loops=3)
                                                                                                                                                         Filter: ((production_year >= 2000) AND (production_year <= 2010) AND ((title)::text = 'Shrek 2'::text))
                                                                                                                                                         Rows Removed by Filter: 842770
                                                                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.053 rows=1 loops=3)
                                                                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=52803.93..52803.93 rows=1 width=20) (actual time=266.562..266.562 rows=0 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..52803.93 rows=1 width=20) (actual time=182.736..266.526 rows=0 loops=3)
                                                                                 Filter: ((name)::text = 'Queen'::text)
                                                                                 Rows Removed by Filter: 1046779
                                                   ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.079..0.079 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.062..0.064 rows=1 loops=3)
                                                               Filter: ((role)::text = 'actress'::text)
                                                               Rows Removed by Filter: 11
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.360..22.361 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.092..22.334 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'computer-animation'::text)
                                                         Rows Removed by Filter: 134169
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.751..70.751 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.024..29.331 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.022..0.022 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.037..0.038 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 147.839 ms
 Execution Time: 9181.020 ms
(111 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29b.sql_explained.sql
SET
SET
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1069734.87..1069734.88 rows=1 width=96) (actual time=7126.539..7126.539 rows=1 loops=1)
   ->  Hash Join  (cost=987337.79..1069734.86 rows=1 width=48) (actual time=7125.738..7126.524 rows=15 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=987336.72..1069733.79 rows=1 width=52) (actual time=7125.621..7126.403 rows=15 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=987335.66..1069732.73 rows=1 width=56) (actual time=7125.547..7126.324 rows=15 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Gather  (cost=982905.23..1064640.28 rows=1 width=68) (actual time=7044.438..7045.916 rows=15 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Parallel Hash Join  (cost=981905.23..1063640.18 rows=1 width=68) (actual time=6934.114..7035.845 rows=5 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=221.175..526.040 rows=16670 loops=3)
                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                       Rows Removed by Filter: 1372493
                                 ->  Parallel Hash  (cost=981905.21..981905.21 rows=1 width=65) (actual time=6505.701..6505.701 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Hash Join  (cost=965345.25..981905.21 rows=1 width=65) (actual time=6469.404..6505.633 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Hash Join  (cost=962719.11..979279.07 rows=1 width=69) (actual time=6447.671..6483.861 rows=540 loops=3)
                                                   Hash Cond: (ci.role_id = rt.id)
                                                   ->  Parallel Hash Join  (cost=962717.95..979277.91 rows=1 width=73) (actual time=6447.545..6483.601 rows=540 loops=3)
                                                         Hash Cond: (an.person_id = ci.person_id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.026..72.905 rows=300448 loops=3)
                                                         ->  Parallel Hash  (cost=962717.94..962717.94 rows=1 width=69) (actual time=6372.047..6372.047 rows=180 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=895915.27..962717.94 rows=1 width=69) (actual time=6224.062..6371.860 rows=180 loops=3)
                                                                     Hash Cond: (ci.person_role_id = chn.id)
                                                                     ->  Parallel Hash Join  (cost=843111.32..909913.99 rows=1 width=57) (actual time=5676.663..6119.071 rows=2489 loops=3)
                                                                           Hash Cond: (pi.person_id = ci.person_id)
                                                                           ->  Hash Join  (cost=2.43..66764.11 rows=10928 width=4) (actual time=0.103..445.676 rows=47448 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.025..305.165 rows=987888 loops=3)
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.041 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.018..0.028 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'height'::text)
                                                                                             Rows Removed by Filter: 112
                                                                           ->  Parallel Hash  (cost=843108.88..843108.88 rows=1 width=53) (actual time=5663.858..5663.858 rows=7101 loops=3)
                                                                                 Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2200kB
                                                                                 ->  Parallel Hash Join  (cost=381444.91..843108.88 rows=1 width=53) (actual time=2484.617..5185.971 rows=7101 loops=3)
                                                                                       Hash Cond: (ci.movie_id = t.id)
                                                                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..460336.89 rows=353886 width=16) (actual time=0.088..2688.972 rows=278900 loops=3)
                                                                                             Filter: ((note)::text = ANY ('{(voice),"(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                             Rows Removed by Filter: 11802548
                                                                                       ->  Parallel Hash  (cost=381444.90..381444.90 rows=1 width=37) (actual time=2457.498..2457.498 rows=189 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=376533.61..381444.90 rows=1 width=37) (actual time=2439.854..2457.332 rows=189 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.008..16.299 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=376533.60..376533.60 rows=1 width=41) (actual time=2438.013..2438.013 rows=811 loops=3)
                                                                                                         Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 248kB
                                                                                                         ->  Parallel Hash Join  (cost=342795.46..376533.60 rows=1 width=41) (actual time=2331.324..2331.527 rows=811 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = t.id)
                                                                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.144..151.229 rows=869710 loops=3)
                                                                                                               ->  Parallel Hash  (cost=342795.44..342795.44 rows=1 width=33) (actual time=2073.546..2073.546 rows=45 loops=3)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                     ->  Hash Join  (cost=102687.84..342795.44 rows=1 width=33) (actual time=1805.756..2073.481 rows=45 loops=3)
                                                                                                                           Hash Cond: (mi.info_type_id = it.id)
                                                                                                                           ->  Parallel Hash Join  (cost=102685.41..342793.02 rows=1 width=37) (actual time=1805.609..2073.324 rows=45 loops=3)
                                                                                                                                 Hash Cond: (mi.movie_id = t.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=227791 width=8) (actual time=139.997..1372.887 rows=129228 loops=3)
                                                                                                                                       Filter: ((info)::text ~~ 'USA:%200%'::text)
                                                                                                                                       Rows Removed by Filter: 4816012
                                                                                                                                 ->  Parallel Hash  (cost=102685.39..102685.39 rows=2 width=29) (actual time=685.823..685.823 rows=45 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                                                                       ->  Parallel Hash Join  (cost=54433.62..102685.39 rows=2 width=29) (actual time=649.805..685.717 rows=45 loops=3)
                                                                                                                                             Hash Cond: (mk.movie_id = t.id)
                                                                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.010..247.748 rows=1507977 loops=3)
                                                                                                                                             ->  Parallel Hash  (cost=54433.61..54433.61 rows=1 width=21) (actual time=257.310..257.310 rows=1 loops=3)
                                                                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                                                                   ->  Parallel Seq Scan on title t  (cost=0.00..54433.61 rows=1 width=21) (actual time=238.017..257.217 rows=1 loops=3)
                                                                                                                                                         Filter: ((production_year >= 2000) AND (production_year <= 2005) AND ((title)::text = 'Shrek 2'::text))
                                                                                                                                                         Rows Removed by Filter: 842770
                                                                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.041..0.052 rows=1 loops=3)
                                                                                                                                       Filter: ((info)::text = 'release dates'::text)
                                                                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=52803.93..52803.93 rows=1 width=20) (actual time=252.433..252.433 rows=0 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                           ->  Parallel Seq Scan on char_name chn  (cost=0.00..52803.93 rows=1 width=20) (actual time=173.143..252.395 rows=0 loops=3)
                                                                                 Filter: ((name)::text = 'Queen'::text)
                                                                                 Rows Removed by Filter: 1046779
                                                   ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.066..0.066 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.049..0.051 rows=1 loops=3)
                                                               Filter: ((role)::text = 'actress'::text)
                                                               Rows Removed by Filter: 11
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.666..21.666 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.086..21.644 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'computer-animation'::text)
                                                         Rows Removed by Filter: 134169
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=71.176..71.176 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.014..29.077 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.009 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.054..0.054 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.034..0.036 rows=1 loops=1)
                     Filter: ((kind)::text = 'cast'::text)
                     Rows Removed by Filter: 3
 Planning Time: 145.389 ms
 Execution Time: 7128.873 ms
(111 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/29c.sql_explained.sql
SET
SET
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=1104796.41..1104796.42 rows=1 width=96) (actual time=8145.923..8145.924 rows=1 loops=1)
   ->  Hash Join  (cost=849233.65..1104796.40 rows=1 width=48) (actual time=7080.388..8140.331 rows=16308 loops=1)
         Hash Cond: (mi.info_type_id = it.id)
         ->  Hash Join  (cost=849231.22..1104793.97 rows=1 width=52) (actual time=7080.279..8136.182 rows=16308 loops=1)
               Hash Cond: (ci.role_id = rt.id)
               ->  Hash Join  (cost=849230.06..1104792.80 rows=1 width=56) (actual time=7080.180..8132.263 rows=16308 loops=1)
                     Hash Cond: (cc.status_id = cct2.id)
                     ->  Hash Join  (cost=849229.00..1104791.74 rows=1 width=60) (actual time=7022.300..8127.323 rows=28022 loops=1)
                           Hash Cond: (cc.subject_id = cct1.id)
                           ->  Gather  (cost=849227.94..1104790.67 rows=1 width=64) (actual time=7022.220..8126.823 rows=28022 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=848227.94..1103790.57 rows=1 width=64) (actual time=7049.584..8105.036 rows=9341 loops=3)
                                       Hash Cond: (mi.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..254707.25 rows=228101 width=8) (actual time=176.537..1702.987 rows=150368 loops=3)
                                             Filter: ((info IS NOT NULL) AND (((info)::text ~~ 'Japan:%200%'::text) OR ((info)::text ~~ 'USA:%200%'::text)))
                                             Rows Removed by Filter: 4794872
                                       ->  Parallel Hash  (cost=848227.92..848227.92 rows=1 width=80) (actual time=6380.461..6380.461 rows=3288 loops=3)
                                             Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1304kB
                                             ->  Parallel Hash Join  (cost=793788.39..848227.92 rows=1 width=80) (actual time=5749.777..6043.603 rows=3288 loops=3)
                                                   Hash Cond: (chn.id = ci.person_role_id)
                                                   ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.050..238.082 rows=1046780 loops=3)
                                                   ->  Parallel Hash  (cost=793788.37..793788.37 rows=1 width=68) (actual time=5668.083..5668.083 rows=3428 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1272kB
                                                         ->  Parallel Hash Join  (cost=777228.20..793788.37 rows=1 width=68) (actual time=5466.439..5551.376 rows=3428 loops=3)
                                                               Hash Cond: (n.id = ci.person_id)
                                                               ->  Parallel Hash Join  (cost=148593.14..165153.19 rows=28 width=27) (actual time=1187.120..1301.567 rows=5368 loops=3)
                                                                     Hash Cond: (an.person_id = n.id)
                                                                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=4) (actual time=0.026..71.085 rows=300448 loops=3)
                                                                     ->  Parallel Hash  (cost=148591.56..148591.56 rows=126 width=23) (actual time=1186.219..1186.219 rows=3355 loops=3)
                                                                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 888kB
                                                                           ->  Hash Join  (cost=81912.66..148591.56 rows=126 width=23) (actual time=543.342..995.273 rows=3355 loops=3)
                                                                                 Hash Cond: (pi.info_type_id = it3.id)
                                                                                 ->  Parallel Hash Join  (cost=81910.23..148550.34 rows=14247 width=27) (actual time=542.297..992.475 rows=15416 loops=3)
                                                                                       Hash Cond: (pi.person_id = n.id)
                                                                                       ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=1234860 width=8) (actual time=0.031..301.126 rows=987888 loops=3)
                                                                                       ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=541.555..541.555 rows=16670 loops=3)
                                                                                             Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                             ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=221.826..528.199 rows=16670 loops=3)
                                                                                                   Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                                   Rows Removed by Filter: 1372493
                                                                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.061..0.062 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on info_type it3  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.050 rows=1 loops=3)
                                                                                             Filter: ((info)::text = 'trivia'::text)
                                                                                             Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=628635.05..628635.05 rows=1 width=57) (actual time=4247.948..4247.948 rows=3451 loops=3)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1208kB
                                                                     ->  Parallel Hash Join  (cost=148044.74..628635.05 rows=1 width=57) (actual time=1170.979..4040.131 rows=3451 loops=3)
                                                                           Hash Cond: (ci.movie_id = t.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.230..2834.360 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Parallel Hash  (cost=148044.70..148044.70 rows=3 width=41) (actual time=1165.180..1165.181 rows=105 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                 ->  Parallel Hash Join  (cost=94621.37..148044.70 rows=3 width=41) (actual time=1066.711..1165.073 rows=105 loops=3)
                                                                                       Hash Cond: (t.id = mc.movie_id)
                                                                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=432897 width=21) (actual time=0.009..282.309 rows=347600 loops=3)
                                                                                             Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                                                             Rows Removed by Filter: 495171
                                                                                       ->  Parallel Hash  (cost=94621.24..94621.24 rows=10 width=20) (actual time=843.355..843.355 rows=144 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                             ->  Parallel Hash Join  (cost=89709.93..94621.24 rows=10 width=20) (actual time=819.010..843.193 rows=144 loops=3)
                                                                                                   Hash Cond: (cn.id = mc.company_id)
                                                                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.024..21.064 rows=28281 loops=3)
                                                                                                         Filter: ((country_code)::text = '[us]'::text)
                                                                                                         Rows Removed by Filter: 50051
                                                                                                   ->  Parallel Hash  (cost=89709.68..89709.68 rows=20 width=24) (actual time=818.497..818.497 rows=589 loops=3)
                                                                                                         Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 152kB
                                                                                                         ->  Hash Join  (cost=55308.66..89709.68 rows=20 width=24) (actual time=589.588..817.625 rows=589 loops=3)
                                                                                                               Hash Cond: (mc.movie_id = cc.movie_id)
                                                                                                               ->  Parallel Hash Join  (cost=50878.23..84616.67 rows=74 width=12) (actual time=462.342..729.928 rows=1073 loops=3)
                                                                                                                     Hash Cond: (mc.movie_id = mk.movie_id)
                                                                                                                     ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.033..158.985 rows=869710 loops=3)
                                                                                                                     ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=458.001..458.001 rows=138 loops=3)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                                                           ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=26.280..457.803 rows=138 loops=3)
                                                                                                                                 Hash Cond: (mk.keyword_id = k.id)
                                                                                                                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.020..252.638 rows=1507977 loops=3)
                                                                                                                                 ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.738..21.739 rows=1 loops=3)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.093..21.727 rows=1 loops=3)
                                                                                                                                             Filter: ((keyword)::text = 'computer-animation'::text)
                                                                                                                                             Rows Removed by Filter: 134169
                                                                                                               ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.177..70.177 rows=135086 loops=3)
                                                                                                                     Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                                                                                                                     ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.036..28.263 rows=135086 loops=3)
                           ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.020..0.021 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                                       Filter: ((kind)::text = 'cast'::text)
                                       Rows Removed by Filter: 3
                     ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=1)
                                 Filter: ((kind)::text = 'complete+verified'::text)
                                 Rows Removed by Filter: 3
               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=1)
                           Filter: ((role)::text = 'actress'::text)
                           Rows Removed by Filter: 11
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.040..0.040 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.015..0.026 rows=1 loops=1)
                     Filter: ((info)::text = 'release dates'::text)
                     Rows Removed by Filter: 112
 Planning Time: 145.107 ms
 Execution Time: 8155.028 ms
(109 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=139838.09..139838.10 rows=1 width=32) (actual time=1290.501..1290.501 rows=1 loops=1)
   ->  Gather  (cost=139837.88..139838.09 rows=2 width=32) (actual time=1289.824..1296.476 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=138837.88..138837.89 rows=1 width=32) (actual time=1283.191..1283.191 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=88354.74..138837.87 rows=3 width=17) (actual time=920.556..1281.775 rows=2611 loops=3)
                     Hash Cond: (t.id = mc.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.010..234.965 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=88354.70..88354.70 rows=3 width=8) (actual time=916.632..916.632 rows=2611 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                           ->  Parallel Hash Join  (cost=55672.11..88354.70 rows=3 width=8) (actual time=533.854..834.099 rows=2611 loops=3)
                                 Hash Cond: (mc.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=4793.88..37309.04 rows=44647 width=4) (actual time=22.670..314.308 rows=49377 loops=3)
                                       Hash Cond: (mc.company_id = cn.id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.042..158.392 rows=869710 loops=3)
                                       ->  Parallel Hash  (cost=4722.92..4722.92 rows=5677 width=4) (actual time=22.456..22.456 rows=3258 loops=3)
                                             Buckets: 16384  Batches: 1  Memory Usage: 544kB
                                             ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=5677 width=4) (actual time=0.023..20.528 rows=3258 loops=3)
                                                   Filter: ((country_code)::text = '[de]'::text)
                                                   Rows Removed by Filter: 75074
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=510.278..510.278 rows=13947 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=21.788..463.493 rows=13947 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..254.530 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.615..21.615 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.999..21.592 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.349 ms
 Execution Time: 1296.918 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2b.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=139653.63..139653.64 rows=1 width=32) (actual time=1293.554..1293.555 rows=1 loops=1)
   ->  Gather  (cost=89170.30..139653.63 rows=2 width=17) (actual time=920.688..1298.850 rows=5228 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=88170.30..138653.43 rows=1 width=17) (actual time=914.113..1283.896 rows=1743 loops=3)
               Hash Cond: (t.id = mc.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.010..241.274 rows=842771 loops=3)
               ->  Parallel Hash  (cost=88170.28..88170.28 rows=1 width=8) (actual time=911.708..911.708 rows=1743 loops=3)
                     Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                     ->  Parallel Hash Join  (cost=55617.21..88170.28 rows=1 width=8) (actual time=540.084..832.986 rows=1743 loops=3)
                           Hash Cond: (mc.movie_id = mk.movie_id)
                           ->  Parallel Hash Join  (cost=4738.98..37254.14 rows=10108 width=4) (actual time=22.229..311.333 rows=18803 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.035..164.200 rows=869710 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=1285 width=4) (actual time=22.073..22.074 rows=780 loops=3)
                                       Buckets: 4096  Batches: 1  Memory Usage: 128kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=1285 width=4) (actual time=0.027..21.400 rows=780 loops=3)
                                             Filter: ((country_code)::text = '[nl]'::text)
                                             Rows Removed by Filter: 77552
                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=516.623..516.623 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=22.334..463.127 rows=13947 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..254.070 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.180..22.180 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=1.007..22.158 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
 Planning Time: 4.324 ms
 Execution Time: 1301.035 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2c.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=139600.06..139600.07 rows=1 width=32) (actual time=813.489..813.490 rows=1 loops=1)
   ->  Gather  (cost=89116.82..139600.05 rows=1 width=17) (actual time=813.483..820.601 rows=0 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=88116.82..138599.95 rows=1 width=17) (actual time=806.445..806.446 rows=0 loops=3)
               Hash Cond: (t.id = mc.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (never executed)
               ->  Parallel Hash  (cost=88116.81..88116.81 rows=1 width=8) (actual time=805.922..805.922 rows=0 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 0kB
                     ->  Parallel Hash Join  (cost=55601.29..88116.81 rows=1 width=8) (actual time=805.781..805.782 rows=0 loops=3)
                           Hash Cond: (mc.movie_id = mk.movie_id)
                           ->  Parallel Hash Join  (cost=4723.07..37238.23 rows=92 width=4) (actual time=239.485..295.054 rows=1 loops=3)
                                 Hash Cond: (mc.company_id = cn.id)
                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.045..164.837 rows=869710 loops=3)
                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=12 width=4) (actual time=21.083..21.084 rows=0 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=12 width=4) (actual time=15.172..21.039 rows=0 loops=3)
                                             Filter: ((country_code)::text = '[sm]'::text)
                                             Rows Removed by Filter: 78332
                           ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=510.632..510.633 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                 ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=22.311..460.267 rows=13947 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..252.433 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=22.050..22.050 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.992..22.030 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
 Planning Time: 4.382 ms
 Execution Time: 821.037 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/2d.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=141451.03..141451.04 rows=1 width=32) (actual time=1342.392..1342.393 rows=1 loops=1)
   ->  Gather  (cost=141450.82..141451.03 rows=2 width=32) (actual time=1340.826..1347.677 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=140450.82..140450.83 rows=1 width=32) (actual time=1334.207..1334.208 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=106712.36..140450.75 rows=27 width=17) (actual time=1010.196..1327.471 rows=22772 loops=3)
                     Hash Cond: (mc.company_id = cn.id)
                     ->  Parallel Hash Join  (cost=101361.58..135099.77 rows=74 width=21) (actual time=968.965..1271.667 rows=49517 loops=3)
                           Hash Cond: (mc.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.026..157.471 rows=869710 loops=3)
                           ->  Parallel Hash  (cost=101361.41..101361.41 rows=14 width=25) (actual time=968.590..968.590 rows=13947 loops=3)
                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3800kB
                                 ->  Parallel Hash Join  (cost=50878.23..101361.41 rows=14 width=25) (actual time=529.354..900.307 rows=13947 loops=3)
                                       Hash Cond: (t.id = mk.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.010..231.436 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=4) (actual time=529.181..529.181 rows=13947 loops=3)
                                             Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2680kB
                                             ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=4) (actual time=19.797..461.053 rows=13947 loops=3)
                                                   Hash Cond: (mk.keyword_id = k.id)
                                                   ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.039..255.106 rows=1507977 loops=3)
                                                   ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=19.536..19.536 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.959..19.517 rows=1 loops=3)
                                                               Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                               Rows Removed by Filter: 134169
                     ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.834..39.835 rows=28281 loops=3)
                           Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.031..25.738 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
 Planning Time: 4.328 ms
 Execution Time: 1348.149 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30a.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=944426.03..944426.04 rows=1 width=128) (actual time=6340.181..6340.181 rows=1 loops=1)
   ->  Hash Join  (cost=927922.43..944426.02 rows=1 width=80) (actual time=6221.384..6339.673 rows=757 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=927921.36..944424.94 rows=1 width=84) (actual time=6221.265..6339.343 rows=757 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=927920.30..944423.88 rows=1 width=88) (actual time=6221.193..6338.867 rows=2492 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=923489.86..939331.43 rows=1 width=100) (actual time=6099.109..6244.599 rows=6214 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=923487.44..939329.00 rows=1 width=104) (actual time=6098.998..6242.788 rows=18687 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=922487.44..938328.90 rows=1 width=104) (actual time=6101.955..6232.134 rows=6229 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.037..80.638 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=922487.42..922487.42 rows=1 width=91) (actual time=6085.397..6085.397 rows=2263 loops=3)
                                             Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                             ->  Parallel Hash Join  (cost=842460.08..922487.42 rows=1 width=91) (actual time=5526.070..6053.051 rows=2263 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.059..458.891 rows=579860 loops=3)
                                                         Filter: ((gender)::text = 'm'::text)
                                                         Rows Removed by Filter: 809304
                                                   ->  Parallel Hash  (cost=842460.07..842460.07 rows=1 width=80) (actual time=5524.847..5524.847 rows=3573 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1176kB
                                                         ->  Parallel Hash Join  (cost=342439.39..842460.07 rows=1 width=80) (actual time=4332.371..5480.174 rows=3573 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=168.722..2953.743 rows=414905 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                     Rows Removed by Filter: 11666543
                                                               ->  Parallel Hash  (cost=342439.38..342439.38 rows=1 width=72) (actual time=2468.601..2468.601 rows=5468 loops=3)
                                                                     Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1496kB
                                                                     ->  Parallel Hash Join  (cost=291113.75..342439.38 rows=1 width=72) (actual time=2110.345..2451.286 rows=5468 loops=3)
                                                                           Hash Cond: (t.id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.027..282.024 rows=460484 loops=3)
                                                                                 Filter: (production_year > 2000)
                                                                                 Rows Removed by Filter: 382286
                                                                           ->  Parallel Hash  (cost=291113.73..291113.73 rows=1 width=51) (actual time=2106.938..2106.938 rows=11309 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                                 ->  Hash Join  (cost=51720.34..291113.73 rows=1 width=51) (actual time=1910.396..2069.071 rows=11309 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..291111.24 rows=25 width=55) (actual time=1507.993..2065.576 rows=11907 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=931.045..1476.296 rows=24349 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                                   Rows Removed by Filter: 4920891
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=576.862..576.862 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.125..488.878 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..253.705 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.952..40.952 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.185..40.929 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.049 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.042..0.042 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.028..0.031 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.694..70.694 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.036..28.889 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.057..0.057 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.036..0.039 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                     Rows Removed by Filter: 2
 Planning Time: 92.344 ms
 Execution Time: 6343.693 ms
(80 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30b.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=950168.28..950168.29 rows=1 width=128) (actual time=6417.085..6417.085 rows=1 loops=1)
   ->  Hash Join  (cost=933664.68..950168.27 rows=1 width=80) (actual time=6346.654..6417.049 rows=28 loops=1)
         Hash Cond: (cc.subject_id = cct1.id)
         ->  Hash Join  (cost=933663.61..950167.19 rows=1 width=84) (actual time=6346.542..6416.930 rows=28 loops=1)
               Hash Cond: (cc.status_id = cct2.id)
               ->  Hash Join  (cost=933662.55..950166.13 rows=1 width=88) (actual time=6346.461..6416.832 rows=108 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=929232.11..945073.68 rows=1 width=100) (actual time=6272.630..6331.392 rows=108 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=929229.69..945071.25 rows=1 width=104) (actual time=6272.510..6333.204 rows=324 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=928229.69..944071.15 rows=1 width=104) (actual time=6287.080..6322.647 rows=108 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.027..80.073 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=928229.67..928229.67 rows=1 width=91) (actual time=6185.410..6185.410 rows=36 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=871161.79..928229.67 rows=1 width=91) (actual time=6129.381..6185.163 rows=36 loops=3)
                                                   Hash Cond: (t.id = mi.movie_id)
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=161 width=21) (actual time=2.622..374.746 rows=178 loops=3)
                                                         Filter: ((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))
                                                         Rows Removed by Filter: 842593
                                                   ->  Parallel Hash  (cost=871161.78..871161.78 rows=1 width=70) (actual time=5810.052..5810.052 rows=4543 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1272kB
                                                         ->  Parallel Hash Join  (cost=791134.44..871161.78 rows=1 width=70) (actual time=5237.581..5759.476 rows=4543 loops=3)
                                                               Hash Cond: (n.id = ci.person_id)
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.053..451.400 rows=579860 loops=3)
                                                                     Filter: ((gender)::text = 'm'::text)
                                                                     Rows Removed by Filter: 809304
                                                               ->  Parallel Hash  (cost=791134.42..791134.42 rows=1 width=59) (actual time=5236.789..5236.790 rows=7458 loops=3)
                                                                     Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1912kB
                                                                     ->  Parallel Hash Join  (cost=291113.75..791134.42 rows=1 width=59) (actual time=4010.875..5182.057 rows=7458 loops=3)
                                                                           Hash Cond: (ci.movie_id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=209.327..3018.786 rows=414905 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                                 Rows Removed by Filter: 11666543
                                                                           ->  Parallel Hash  (cost=291113.73..291113.73 rows=1 width=51) (actual time=2106.841..2106.841 rows=11309 loops=3)
                                                                                 Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                                 ->  Hash Join  (cost=51720.34..291113.73 rows=1 width=51) (actual time=1906.795..2067.369 rows=11309 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..291111.24 rows=25 width=55) (actual time=1503.433..2063.832 rows=11907 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=931.004..1478.735 rows=24349 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                                   Rows Removed by Filter: 4920891
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=572.340..572.340 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.495..486.282 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..252.983 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.354..41.355 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.192..41.338 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.067..0.067 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.035..0.048 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.041..0.042 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=71.101..71.101 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.013..28.745 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.009..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'complete+verified'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=2 width=4) (actual time=0.048..0.049 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=2 width=4) (actual time=0.035..0.037 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{cast,crew}'::text[]))
                     Rows Removed by Filter: 2
 Planning Time: 91.714 ms
 Execution Time: 6420.060 ms
(80 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/30c.sql_explained.sql
SET
SET
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=974687.78..974687.79 rows=1 width=128) (actual time=6905.873..6905.873 rows=1 loops=1)
   ->  Hash Join  (cost=958184.19..974687.77 rows=1 width=80) (actual time=6681.779..6901.299 rows=8024 loops=1)
         Hash Cond: (cc.status_id = cct2.id)
         ->  Hash Join  (cost=958183.12..974686.71 rows=1 width=84) (actual time=6681.652..6898.530 rows=14123 loops=1)
               Hash Cond: (cc.subject_id = cct1.id)
               ->  Hash Join  (cost=958182.06..974685.64 rows=1 width=88) (actual time=6681.572..6894.245 rows=18841 loops=1)
                     Hash Cond: (t.id = cc.movie_id)
                     ->  Hash Join  (cost=953751.63..969593.19 rows=1 width=100) (actual time=6607.209..6781.855 rows=26153 loops=1)
                           Hash Cond: (mi_idx.info_type_id = it2.id)
                           ->  Gather  (cost=953749.20..969590.76 rows=1 width=104) (actual time=6607.081..6768.742 rows=78897 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=952749.20..968590.66 rows=1 width=104) (actual time=6598.040..6749.920 rows=26299 loops=3)
                                       Hash Cond: (mi_idx.movie_id = t.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..80.719 rows=460012 loops=3)
                                       ->  Parallel Hash  (cost=952749.19..952749.19 rows=1 width=91) (actual time=6594.460..6594.460 rows=9085 loops=3)
                                             Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 3032kB
                                             ->  Parallel Hash Join  (cost=872721.85..952749.19 rows=1 width=91) (actual time=6028.355..6563.809 rows=9085 loops=3)
                                                   Hash Cond: (n.id = ci.person_id)
                                                   ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.062..459.092 rows=579860 loops=3)
                                                         Filter: ((gender)::text = 'm'::text)
                                                         Rows Removed by Filter: 809304
                                                   ->  Parallel Hash  (cost=872721.83..872721.83 rows=1 width=80) (actual time=6027.772..6027.772 rows=15008 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4632kB
                                                         ->  Parallel Hash Join  (cost=372701.16..872721.83 rows=1 width=80) (actual time=4839.072..5994.442 rows=15008 loops=3)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=166.812..2927.367 rows=414905 loops=3)
                                                                     Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                                     Rows Removed by Filter: 11666543
                                                               ->  Parallel Hash  (cost=372701.14..372701.14 rows=1 width=72) (actual time=2995.175..2995.175 rows=22680 loops=3)
                                                                     Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 6936kB
                                                                     ->  Parallel Hash Join  (cost=322218.01..372701.14 rows=1 width=72) (actual time=2532.632..2903.209 rows=22680 loops=3)
                                                                           Hash Cond: (t.id = mi.movie_id)
                                                                           ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.013..231.498 rows=842771 loops=3)
                                                                           ->  Parallel Hash  (cost=322218.00..322218.00 rows=1 width=51) (actual time=2530.772..2530.772 rows=22680 loops=3)
                                                                                 Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                                                 ->  Hash Join  (cost=51720.34..322218.00 rows=1 width=51) (actual time=2258.102..2486.824 rows=22680 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Hash Join  (cost=51717.91..322215.41 rows=60 width=55) (actual time=1746.375..2480.655 rows=24129 loops=3)
                                                                                             Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                             ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1064.443..1888.669 rows=62990 loops=3)
                                                                                                   Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                                   Rows Removed by Filter: 4882250
                                                                                             ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=570.091..570.091 rows=25571 loops=3)
                                                                                                   Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                                   ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.448..486.007 rows=25571 loops=3)
                                                                                                         Hash Cond: (mk.keyword_id = k.id)
                                                                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..253.032 rows=1507977 loops=3)
                                                                                                         ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.281..41.282 rows=7 loops=3)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                               ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.186..41.255 rows=7 loops=3)
                                                                                                                     Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                                     Rows Removed by Filter: 134163
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.063..0.063 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.032..0.044 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.051..0.051 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.038..0.040 rows=1 loops=1)
                                       Filter: ((info)::text = 'votes'::text)
                                       Rows Removed by Filter: 112
                     ->  Hash  (cost=2081.86..2081.86 rows=135086 width=12) (actual time=70.620..70.620 rows=135086 loops=1)
                           Buckets: 131072  Batches: 4  Memory Usage: 2471kB
                           ->  Seq Scan on complete_cast cc  (cost=0.00..2081.86 rows=135086 width=12) (actual time=0.013..28.926 rows=135086 loops=1)
               ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.019..0.019 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on comp_cast_type cct1  (cost=0.00..1.05 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                           Filter: ((kind)::text = 'cast'::text)
                           Rows Removed by Filter: 3
         ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on comp_cast_type cct2  (cost=0.00..1.05 rows=1 width=4) (actual time=0.035..0.036 rows=1 loops=1)
                     Filter: ((kind)::text = 'complete+verified'::text)
                     Rows Removed by Filter: 3
 Planning Time: 92.113 ms
 Execution Time: 6911.868 ms
(78 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31a.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=975119.34..975119.35 rows=1 width=128) (actual time=6873.449..6873.449 rows=1 loops=1)
   ->  Gather  (cost=975119.11..975119.32 rows=2 width=128) (actual time=6872.314..6879.677 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=974119.11..974119.12 rows=1 width=128) (actual time=6864.520..6864.520 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=923635.97..974119.10 rows=1 width=80) (actual time=6751.253..6864.231 rows=424 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.009..228.831 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=923635.96..923635.96 rows=1 width=83) (actual time=6524.745..6524.745 rows=424 loops=3)
                           Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                           ->  Parallel Hash Join  (cost=843608.62..923635.96 rows=1 width=83) (actual time=5924.650..6408.729 rows=424 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.045..435.776 rows=579860 loops=3)
                                       Filter: ((gender)::text = 'm'::text)
                                       Rows Removed by Filter: 809304
                                 ->  Parallel Hash  (cost=843608.60..843608.60 rows=1 width=72) (actual time=5910.872..5910.872 rows=519 loops=3)
                                       Buckets: 2048 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 216kB
                                       ->  Parallel Hash Join  (cost=343587.93..843608.60 rows=1 width=72) (actual time=4376.435..5493.217 rows=519 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=168.325..2915.995 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=343587.91..343587.91 rows=1 width=64) (actual time=2527.244..2527.244 rows=508 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                   ->  Parallel Hash Join  (cost=311072.34..343587.91 rows=1 width=64) (actual time=2307.860..2526.758 rows=508 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Hash Join  (cost=4723.09..37238.26 rows=106 width=4) (actual time=20.137..282.908 rows=605 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.037..157.393 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=15.551..15.552 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=1.212..15.500 rows=3 loops=3)
                                                                           Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                           Rows Removed by Filter: 78329
                                                         ->  Parallel Hash  (cost=306349.24..306349.24 rows=1 width=60) (actual time=2243.137..2243.137 rows=10505 loops=3)
                                                               Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2424kB
                                                               ->  Parallel Hash Join  (cost=291078.97..306349.24 rows=1 width=60) (actual time=2036.021..2220.927 rows=10505 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.130..162.377 rows=153308 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..78.078 rows=460012 loops=3)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.039..0.039 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.028 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'votes'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=291076.53..291076.53 rows=1 width=51) (actual time=2035.523..2035.523 rows=11309 loops=3)
                                                                           Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2808kB
                                                                           ->  Parallel Hash Join  (cost=51720.34..291076.53 rows=1 width=51) (actual time=1831.995..1988.732 rows=11309 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..239357.37 rows=330 width=47) (actual time=1265.825..1413.176 rows=24086 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=885.644..1404.874 rows=24349 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                                                             Rows Removed by Filter: 4920891
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.078..0.078 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.053 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=566.092..566.092 rows=25571 loops=3)
                                                                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                       ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=40.775..488.549 rows=25571 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..254.320 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=40.618..40.618 rows=7 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.165..40.592 rows=7 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                         Rows Removed by Filter: 134163
 Planning Time: 120.531 ms
 Execution Time: 6880.820 ms
(72 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31b.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                     
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=980989.91..980989.92 rows=1 width=128) (actual time=6136.709..6136.709 rows=1 loops=1)
   ->  Gather  (cost=980989.68..980989.89 rows=2 width=128) (actual time=6136.470..6143.266 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=979989.68..979989.69 rows=1 width=128) (actual time=6128.588..6128.589 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=899962.33..979989.67 rows=1 width=80) (actual time=5743.908..6128.541 rows=28 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=722307 width=19) (actual time=0.044..446.113 rows=579860 loops=3)
                           Filter: ((gender)::text = 'm'::text)
                           Rows Removed by Filter: 809304
                     ->  Parallel Hash  (cost=899962.31..899962.31 rows=1 width=69) (actual time=5624.480..5624.480 rows=28 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=400520.12..899962.31 rows=1 width=69) (actual time=4649.684..5624.346 rows=28 loops=3)
                                 Hash Cond: (t.id = mi.movie_id)
                                 ->  Parallel Hash Join  (cost=57069.28..556511.17 rows=79 width=29) (actual time=2180.077..3290.829 rows=212 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=255.530..2877.517 rows=414905 loops=3)
                                             Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                             Rows Removed by Filter: 11666543
                                       ->  Parallel Hash  (cost=57067.27..57067.27 rows=161 width=21) (actual time=365.844..365.844 rows=178 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=161 width=21) (actual time=4.053..365.569 rows=178 loops=3)
                                                   Filter: ((production_year > 2000) AND (((title)::text ~~ '%Freddy%'::text) OR ((title)::text ~~ '%Jason%'::text) OR ((title)::text ~~ 'Saw%'::text)))
                                                   Rows Removed by Filter: 842593
                                 ->  Parallel Hash  (cost=343450.83..343450.83 rows=1 width=64) (actual time=2333.366..2333.366 rows=87 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Parallel Hash Join  (cost=104094.63..343450.83 rows=1 width=64) (actual time=2203.980..2333.260 rows=87 loops=3)
                                             Hash Cond: (mi.movie_id = mi_idx.movie_id)
                                             ->  Hash Join  (cost=2.43..239357.37 rows=330 width=47) (actual time=1263.265..1411.130 rows=24086 loops=3)
                                                   Hash Cond: (mi.info_type_id = it1.id)
                                                   ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=37295 width=51) (actual time=882.552..1403.027 rows=24349 loops=3)
                                                         Filter: ((info)::text = ANY ('{Horror,Thriller}'::text[]))
                                                         Rows Removed by Filter: 4920891
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.016..0.029 rows=1 loops=3)
                                                               Filter: ((info)::text = 'genres'::text)
                                                               Rows Removed by Filter: 112
                                             ->  Parallel Hash  (cost=104092.19..104092.19 rows=1 width=17) (actual time=918.716..918.716 rows=105 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                   ->  Parallel Hash Join  (cost=88821.93..104092.19 rows=1 width=17) (actual time=804.157..918.578 rows=105 loops=3)
                                                         Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                                         ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.267..159.956 rows=153308 loops=3)
                                                               Hash Cond: (mi_idx.info_type_id = it2.id)
                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.122..76.865 rows=460012 loops=3)
                                                               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.074..0.074 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.048..0.051 rows=1 loops=3)
                                                                           Filter: ((info)::text = 'votes'::text)
                                                                           Rows Removed by Filter: 112
                                                         ->  Parallel Hash  (cost=88819.49..88819.49 rows=1 width=8) (actual time=742.756..742.756 rows=105 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                               ->  Parallel Hash Join  (cost=40567.20..88819.49 rows=1 width=8) (actual time=372.813..742.622 rows=105 loops=3)
                                                                     Hash Cond: (mk.movie_id = mc.movie_id)
                                                                     ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=38.223..480.679 rows=25571 loops=3)
                                                                           Hash Cond: (mk.keyword_id = k.id)
                                                                           ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.013..250.488 rows=1507977 loops=3)
                                                                           ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=38.082..38.082 rows=7 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.126..38.065 rows=7 loops=3)
                                                                                       Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                       Rows Removed by Filter: 134163
                                                                     ->  Parallel Hash  (cost=37102.41..37102.41 rows=1 width=4) (actual time=257.555..257.555 rows=45 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=4723.09..37102.41 rows=1 width=4) (actual time=64.731..257.415 rows=45 loops=3)
                                                                                 Hash Cond: (mc.company_id = cn.id)
                                                                                 ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..32379.21 rows=39 width=8) (actual time=1.044..234.157 rows=2654 loops=3)
                                                                                       Filter: ((note)::text ~~ '%(Blu-ray)%'::text)
                                                                                       Rows Removed by Filter: 867055
                                                                                 ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=22.402..22.402 rows=3 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                                       ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=1.682..22.341 rows=3 loops=3)
                                                                                             Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                                             Rows Removed by Filter: 78329
 Planning Time: 121.021 ms
 Execution Time: 6144.414 ms
(76 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/31c.sql_explained.sql
SET
SET
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=1005633.28..1005633.29 rows=1 width=128) (actual time=7733.314..7733.314 rows=1 loops=1)
   ->  Gather  (cost=1005633.05..1005633.26 rows=2 width=128) (actual time=7731.636..7740.617 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=1004633.05..1004633.06 rows=1 width=128) (actual time=7723.446..7723.446 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=954149.91..1004633.04 rows=1 width=80) (actual time=7567.427..7722.894 rows=942 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.006..238.525 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=954149.90..954149.90 rows=1 width=83) (actual time=7373.451..7373.451 rows=942 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 344kB
                           ->  Parallel Hash Join  (cost=874660.64..954149.90 rows=1 width=83) (actual time=6715.847..7271.286 rows=942 loops=3)
                                 Hash Cond: (n.id = ci.person_id)
                                 ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.045..380.338 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=874660.62..874660.62 rows=1 width=72) (actual time=6709.395..6709.395 rows=942 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                       ->  Parallel Hash Join  (cost=374639.95..874660.62 rows=1 width=72) (actual time=5080.680..6216.409 rows=942 loops=3)
                                             Hash Cond: (ci.movie_id = mi.movie_id)
                                             ->  Parallel Seq Scan on cast_info ci  (cost=0.00..498091.41 rows=514468 width=8) (actual time=273.904..2957.517 rows=414905 loops=3)
                                                   Filter: ((note)::text = ANY ('{(writer),"(head writer)","(written by)",(story),"(story editor)"}'::text[]))
                                                   Rows Removed by Filter: 11666543
                                             ->  Parallel Hash  (cost=374639.93..374639.93 rows=1 width=64) (actual time=3211.944..3211.944 rows=947 loops=3)
                                                   Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                                   ->  Parallel Hash Join  (cost=342124.37..374639.93 rows=1 width=64) (actual time=2879.375..3113.628 rows=947 loops=3)
                                                         Hash Cond: (mc.movie_id = mi.movie_id)
                                                         ->  Parallel Hash Join  (cost=4723.09..37238.26 rows=106 width=4) (actual time=20.773..290.782 rows=605 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.031..164.780 rows=869710 loops=3)
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=14 width=4) (actual time=15.930..15.930 rows=3 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=14 width=4) (actual time=0.944..15.846 rows=3 loops=3)
                                                                           Filter: ((name)::text ~~ 'Lionsgate%'::text)
                                                                           Rows Removed by Filter: 78329
                                                         ->  Parallel Hash  (cost=337401.26..337401.26 rows=1 width=60) (actual time=2821.776..2821.776 rows=21129 loops=3)
                                                               Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 4824kB
                                                               ->  Parallel Hash Join  (cost=322130.99..337401.26 rows=1 width=60) (actual time=2566.104..2762.021 rows=21129 loops=3)
                                                                     Hash Cond: (mi_idx.movie_id = mi.movie_id)
                                                                     ->  Hash Join  (cost=2.43..15253.60 rows=5089 width=9) (actual time=0.148..166.266 rows=153308 loops=3)
                                                                           Hash Cond: (mi_idx.info_type_id = it2.id)
                                                                           ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..13685.15 rows=575015 width=13) (actual time=0.028..81.578 rows=460012 loops=3)
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.043..0.043 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.026..0.029 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'votes'::text)
                                                                                       Rows Removed by Filter: 112
                                                                     ->  Parallel Hash  (cost=322128.55..322128.55 rows=1 width=51) (actual time=2565.647..2565.647 rows=22680 loops=3)
                                                                           Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5432kB
                                                                           ->  Parallel Hash Join  (cost=51720.34..322128.55 rows=1 width=51) (actual time=2282.956..2522.067 rows=22680 loops=3)
                                                                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                                                                 ->  Hash Join  (cost=2.43..270407.66 rows=793 width=47) (actual time=1710.857..1931.411 rows=62198 loops=3)
                                                                                       Hash Cond: (mi.info_type_id = it1.id)
                                                                                       ->  Parallel Seq Scan on movie_info mi  (cost=0.00..270161.12 rows=89632 width=51) (actual time=1078.698..1913.929 rows=62990 loops=3)
                                                                                             Filter: ((info)::text = ANY ('{Horror,Action,Sci-Fi,Thriller,Crime,War}'::text[]))
                                                                                             Rows Removed by Filter: 4882250
                                                                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.081..0.081 rows=1 loops=3)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.053 rows=1 loops=3)
                                                                                                   Filter: ((info)::text = 'genres'::text)
                                                                                                   Rows Removed by Filter: 112
                                                                                 ->  Parallel Hash  (cost=51716.69..51716.69 rows=98 width=4) (actual time=572.009..572.009 rows=25571 loops=3)
                                                                                       Buckets: 131072 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 5080kB
                                                                                       ->  Hash Join  (cost=3464.78..51716.69 rows=98 width=4) (actual time=41.220..484.935 rows=25571 loops=3)
                                                                                             Hash Cond: (mk.keyword_id = k.id)
                                                                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..252.988 rows=1507977 loops=3)
                                                                                             ->  Hash  (cost=3464.69..3464.69 rows=7 width=4) (actual time=41.061..41.061 rows=7 loops=3)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                   ->  Seq Scan on keyword k  (cost=0.00..3464.69 rows=7 width=4) (actual time=1.178..41.034 rows=7 loops=3)
                                                                                                         Filter: ((keyword)::text = ANY ('{murder,violence,blood,gore,death,female-nudity,hospital}'::text[]))
                                                                                                         Rows Removed by Filter: 134163
 Planning Time: 117.689 ms
 Execution Time: 7741.601 ms
(70 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/32a.sql_explained.sql
SET
SET
                                                                                                       QUERY PLAN                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=75986.58..75986.59 rows=1 width=96) (actual time=348.627..348.627 rows=1 loops=1)
   ->  Gather  (cost=75986.36..75986.57 rows=2 width=96) (actual time=348.430..352.847 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=74986.36..74986.37 rows=1 width=96) (actual time=341.678..341.678 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=24503.19..74986.33 rows=4 width=116) (actual time=341.674..341.674 rows=0 loops=3)
                     Hash Cond: (t2.id = ml.linked_movie_id)
                     ->  Parallel Seq Scan on title t2  (cost=0.00..46532.63 rows=1053463 width=21) (never executed)
                     ->  Parallel Hash  (cost=24503.14..24503.14 rows=4 width=103) (actual time=341.152..341.153 rows=0 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 0kB
                           ->  Hash Join  (cost=2676.61..24503.14 rows=4 width=103) (actual time=339.579..339.579 rows=0 loops=3)
                                 Hash Cond: (ml.link_type_id = lt.id)
                                 ->  Hash Join  (cost=2675.20..24501.72 rows=4 width=25) (actual time=339.464..339.464 rows=0 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=49.07..20347.47 rows=582120 width=29) (actual time=11.334..309.161 rows=96064 loops=3)
                                             Merge Cond: (t1.id = ml.movie_id)
                                             ->  Merge Join  (cost=47.47..247535.04 rows=1884971 width=29) (actual time=10.982..255.785 rows=32619 loops=3)
                                                   Merge Cond: (mk.movie_id = t1.id)
                                                   ->  Parallel Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..115667.54 rows=1884971 width=8) (actual time=0.059..11.376 rows=32619 loops=3)
                                                   ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=21) (actual time=0.062..214.740 rows=187035 loops=3)
                                             ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=12) (actual time=0.042..27.411 rows=120321 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=21.391..21.391 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=20.880..21.373 rows=1 loops=3)
                                                   Filter: ((keyword)::text = '10,000-mile-club'::text)
                                                   Rows Removed by Filter: 134169
                                 ->  Hash  (cost=1.18..1.18 rows=18 width=86) (actual time=0.069..0.070 rows=18 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=86) (actual time=0.041..0.045 rows=18 loops=3)
 Planning Time: 5.398 ms
 Execution Time: 353.496 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/32b.sql_explained.sql
SET
SET
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=75986.58..75986.59 rows=1 width=96) (actual time=746.749..746.749 rows=1 loops=1)
   ->  Gather  (cost=75986.36..75986.57 rows=2 width=96) (actual time=746.455..751.808 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=74986.36..74986.37 rows=1 width=96) (actual time=739.707..739.707 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=24503.19..74986.33 rows=4 width=116) (actual time=382.741..738.154 rows=1463 loops=3)
                     Hash Cond: (t2.id = ml.linked_movie_id)
                     ->  Parallel Seq Scan on title t2  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.010..224.824 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=24503.14..24503.14 rows=4 width=103) (actual time=381.512..381.512 rows=1463 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 376kB
                           ->  Hash Join  (cost=2676.61..24503.14 rows=4 width=103) (actual time=40.420..309.758 rows=1463 loops=3)
                                 Hash Cond: (ml.link_type_id = lt.id)
                                 ->  Hash Join  (cost=2675.20..24501.72 rows=4 width=25) (actual time=40.310..309.195 rows=1463 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Merge Join  (cost=49.07..20347.47 rows=582120 width=29) (actual time=3.742..279.176 rows=96064 loops=3)
                                             Merge Cond: (t1.id = ml.movie_id)
                                             ->  Merge Join  (cost=47.47..247535.04 rows=1884971 width=29) (actual time=3.572..227.953 rows=32619 loops=3)
                                                   Merge Cond: (mk.movie_id = t1.id)
                                                   ->  Parallel Index Scan using movie_id_movie_keyword on movie_keyword mk  (cost=0.43..115667.54 rows=1884971 width=8) (actual time=0.030..7.755 rows=32619 loops=3)
                                                   ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=21) (actual time=0.063..191.162 rows=187035 loops=3)
                                             ->  Index Scan using movie_id_movie_link on movie_link ml  (cost=0.29..959.51 rows=29997 width=12) (actual time=0.039..25.419 rows=120366 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=1 width=4) (actual time=20.875..20.875 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=4) (actual time=0.827..20.858 rows=1 loops=3)
                                                   Filter: ((keyword)::text = 'character-name-in-title'::text)
                                                   Rows Removed by Filter: 134169
                                 ->  Hash  (cost=1.18..1.18 rows=18 width=86) (actual time=0.063..0.063 rows=18 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on link_type lt  (cost=0.00..1.18 rows=18 width=86) (actual time=0.035..0.039 rows=18 loops=3)
 Planning Time: 5.100 ms
 Execution Time: 752.434 ms
(31 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33a.sql_explained.sql
SET
SET
                                                                                                                           QUERY PLAN                                                                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=154593.22..154593.23 rows=1 width=192) (actual time=1439.535..1439.535 rows=1 loops=1)
   ->  Hash Join  (cost=144214.38..154593.20 rows=1 width=82) (actual time=1439.502..1439.514 rows=8 loops=1)
         Hash Cond: (t2.kind_id = kt2.id)
         ->  Hash Join  (cost=144213.28..154592.10 rows=1 width=86) (actual time=1439.396..1439.406 rows=8 loops=1)
               Hash Cond: (mi_idx1.info_type_id = it1.id)
               ->  Hash Join  (cost=144210.85..154589.67 rows=2 width=90) (actual time=1439.270..1439.297 rows=24 loops=1)
                     Hash Cond: (t1.kind_id = kt1.id)
                     ->  Merge Join  (cost=144209.75..154588.52 rows=12 width=94) (actual time=1439.189..1439.208 rows=24 loops=1)
                           Merge Cond: (ml.movie_id = t1.id)
                           ->  Merge Join  (cost=144209.32..146403.23 rows=12 width=85) (actual time=1418.413..1418.426 rows=24 loops=1)
                                 Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                 ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.033..2.513 rows=8479 loops=1)
                                 ->  Sort  (cost=144208.90..144208.91 rows=4 width=72) (actual time=1414.945..1414.947 rows=22 loops=1)
                                       Sort Key: ml.movie_id
                                       Sort Method: quicksort  Memory: 26kB
                                       ->  Hash Join  (cost=137529.19..144208.86 rows=4 width=72) (actual time=1376.526..1414.857 rows=8 loops=1)
                                             Hash Cond: (cn1.id = mc1.company_id)
                                             ->  Seq Scan on company_name cn1  (cost=0.00..5932.46 rows=85390 width=23) (actual time=0.026..46.269 rows=84843 loops=1)
                                                   Filter: ((country_code)::text = '[us]'::text)
                                                   Rows Removed by Filter: 150154
                                             ->  Hash  (cost=137529.07..137529.07 rows=10 width=57) (actual time=1361.224..1361.224 rows=29 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                   ->  Merge Join  (cost=132176.15..137529.07 rows=10 width=57) (actual time=1336.245..1361.202 rows=29 loops=1)
                                                         Merge Cond: (mc1.movie_id = ml.movie_id)
                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..131550.35 rows=2609129 width=8) (actual time=0.023..24.742 rows=61895 loops=1)
                                                         ->  Sort  (cost=132175.72..132175.73 rows=2 width=49) (actual time=1329.116..1329.119 rows=29 loops=1)
                                                               Sort Key: ml.movie_id
                                                               Sort Method: quicksort  Memory: 26kB
                                                               ->  Gather  (cost=127279.79..132175.71 rows=2 width=49) (actual time=1293.361..1329.456 rows=11 loops=1)
                                                                     Workers Planned: 1
                                                                     Workers Launched: 1
                                                                     ->  Parallel Hash Join  (cost=126279.79..131175.51 rows=1 width=49) (actual time=1286.781..1320.623 rows=6 loops=2)
                                                                           Hash Cond: (cn2.id = mc2.company_id)
                                                                           ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.006..21.376 rows=117498 loops=2)
                                                                           ->  Parallel Hash  (cost=126279.78..126279.78 rows=1 width=34) (actual time=1285.017..1285.017 rows=6 loops=2)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                                                                 ->  Parallel Hash Join  (cost=92541.63..126279.78 rows=1 width=34) (actual time=1089.857..1284.948 rows=6 loops=2)
                                                                                       Hash Cond: (mc2.movie_id = t2.id)
                                                                                       ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.028..232.760 rows=1304564 loops=2)
                                                                                       ->  Parallel Hash  (cost=92541.62..92541.62 rows=1 width=42) (actual time=893.124..893.124 rows=3 loops=2)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                             ->  Hash Join  (cost=76393.09..92541.62 rows=1 width=42) (actual time=677.238..893.064 rows=3 loops=2)
                                                                                                   Hash Cond: (mi_idx2.info_type_id = it2.id)
                                                                                                   ->  Parallel Hash Join  (cost=76390.66..92538.93 rows=96 width=46) (actual time=642.051..892.915 rows=153 loops=2)
                                                                                                         Hash Cond: (mi_idx2.movie_id = t2.id)
                                                                                                         ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=273383 width=13) (actual time=0.044..215.700 rows=327480 loops=2)
                                                                                                               Filter: ((info)::text < '3.0'::text)
                                                                                                               Rows Removed by Filter: 362537
                                                                                                         ->  Parallel Hash  (cost=76386.05..76386.05 rows=369 width=33) (actual time=641.720..641.720 rows=122 loops=2)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                                               ->  Hash Join  (cost=75275.92..76386.05 rows=369 width=33) (actual time=571.191..635.626 rows=122 loops=2)
                                                                                                                     Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                     ->  Merge Join  (cost=75274.64..76377.59 rows=2212 width=37) (actual time=570.982..635.257 rows=2166 loops=2)
                                                                                                                           Merge Cond: (t2.id = ml.linked_movie_id)
                                                                                                                           ->  Sort  (cost=72580.89..73046.92 rows=186410 width=25) (actual time=550.222..584.574 rows=222854 loops=2)
                                                                                                                                 Sort Key: t2.id
                                                                                                                                 Sort Method: external merge  Disk: 8080kB
                                                                                                                                 Worker 0:  Sort Method: external merge  Disk: 7904kB
                                                                                                                                 ->  Parallel Seq Scan on title t2  (cost=0.00..51799.95 rows=186410 width=25) (actual time=0.042..394.489 rows=222930 loops=2)
                                                                                                                                       Filter: ((production_year >= 2005) AND (production_year <= 2008))
                                                                                                                                       Rows Removed by Filter: 1041226
                                                                                                                           ->  Sort  (cost=2693.63..2768.62 rows=29997 width=12) (actual time=20.740..23.078 rows=29997 loops=2)
                                                                                                                                 Sort Key: ml.linked_movie_id
                                                                                                                                 Sort Method: quicksort  Memory: 2175kB
                                                                                                                                 Worker 0:  Sort Method: quicksort  Memory: 2175kB
                                                                                                                                 ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.039..6.473 rows=29997 loops=2)
                                                                                                                     ->  Hash  (cost=1.25..1.25 rows=3 width=4) (actual time=0.063..0.063 rows=2 loops=2)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                           ->  Seq Scan on link_type lt  (cost=0.00..1.25 rows=3 width=4) (actual time=0.046..0.051 rows=2 loops=2)
                                                                                                                                 Filter: ((link)::text = ANY ('{sequel,follows,"followed by"}'::text[]))
                                                                                                                                 Rows Removed by Filter: 16
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=2)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.043 rows=1 loops=2)
                                                                                                               Filter: ((info)::text = 'rating'::text)
                                                                                                               Rows Removed by Filter: 112
                           ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=25) (actual time=0.015..18.344 rows=22690 loops=1)
                     ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.019..0.020 rows=1 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=1 width=4) (actual time=0.008..0.010 rows=1 loops=1)
                                 Filter: ((kind)::text = 'tv series'::text)
                                 Rows Removed by Filter: 6
               ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.035..0.035 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.023..0.025 rows=1 loops=1)
                           Filter: ((info)::text = 'rating'::text)
                           Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.047..0.047 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=1 width=4) (actual time=0.027..0.029 rows=1 loops=1)
                     Filter: ((kind)::text = 'tv series'::text)
                     Rows Removed by Filter: 6
 Planning Time: 112.625 ms
 Execution Time: 1443.364 ms
(94 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33b.sql_explained.sql
SET
SET
                                                                                                                                    QUERY PLAN                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=126526.42..126526.43 rows=1 width=192) (actual time=1294.047..1294.047 rows=1 loops=1)
   ->  Hash Join  (cost=121630.57..126526.40 rows=1 width=82) (actual time=1263.893..1294.026 rows=4 loops=1)
         Hash Cond: (mi_idx2.info_type_id = it2.id)
         ->  Hash Join  (cost=121628.15..126523.97 rows=1 width=86) (actual time=1263.785..1293.918 rows=8 loops=1)
               Hash Cond: (t2.kind_id = kt2.id)
               ->  Gather  (cost=121627.05..126522.87 rows=1 width=90) (actual time=1263.704..1298.910 rows=42 loops=1)
                     Workers Planned: 1
                     Workers Launched: 1
                     ->  Parallel Hash Join  (cost=120627.05..125522.77 rows=1 width=90) (actual time=1257.875..1287.360 rows=21 loops=2)
                           Hash Cond: (cn2.id = mc2.company_id)
                           ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.007..16.514 rows=117498 loops=2)
                           ->  Parallel Hash  (cost=120627.03..120627.03 rows=1 width=75) (actual time=1256.795..1256.795 rows=21 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                 ->  Parallel Hash Join  (cost=86888.89..120627.03 rows=1 width=75) (actual time=899.609..1256.714 rows=21 loops=2)
                                       Hash Cond: (mc2.movie_id = t2.id)
                                       ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.006..237.809 rows=1304564 loops=2)
                                       ->  Parallel Hash  (cost=86888.88..86888.88 rows=1 width=83) (actual time=859.597..859.597 rows=6 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Hash Join  (cost=70741.00..86888.88 rows=1 width=83) (actual time=665.676..859.537 rows=6 loops=2)
                                                   Hash Cond: (mi_idx1.info_type_id = it1.id)
                                                   ->  Parallel Hash Join  (cost=70738.57..86886.45 rows=1 width=87) (actual time=665.558..859.416 rows=18 loops=2)
                                                         Hash Cond: (mi_idx2.movie_id = t2.id)
                                                         ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=273383 width=13) (actual time=0.020..215.426 rows=327480 loops=2)
                                                               Filter: ((info)::text < '3.0'::text)
                                                               Rows Removed by Filter: 362537
                                                         ->  Parallel Hash  (cost=70738.56..70738.56 rows=1 width=74) (actual time=610.241..610.241 rows=9 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=21387.24..70738.56 rows=1 width=74) (actual time=370.044..610.165 rows=9 loops=2)
                                                                     Hash Cond: (t2.id = ml.linked_movie_id)
                                                                     ->  Parallel Seq Scan on title t2  (cost=0.00..49166.29 rows=49337 width=25) (actual time=0.023..353.420 rows=59782 loops=2)
                                                                           Filter: (production_year = 2007)
                                                                           Rows Removed by Filter: 1204374
                                                                     ->  Parallel Hash  (cost=21387.06..21387.06 rows=15 width=49) (actual time=242.601..242.601 rows=590 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 168kB
                                                                           ->  Hash Join  (cost=14591.57..21387.06 rows=15 width=49) (actual time=148.590..242.032 rows=590 loops=2)
                                                                                 Hash Cond: (t1.kind_id = kt1.id)
                                                                                 ->  Merge Join  (cost=14590.47..21385.52 rows=102 width=53) (actual time=148.510..241.770 rows=716 loops=2)
                                                                                       Merge Cond: (t1.id = ml.movie_id)
                                                                                       ->  Parallel Index Scan using title_pkey on title t1  (cost=0.43..87333.68 rows=1053463 width=25) (actual time=0.027..84.207 rows=81444 loops=2)
                                                                                       ->  Sort  (cost=14590.04..14590.65 rows=246 width=44) (actual time=147.494..147.593 rows=1431 loops=2)
                                                                                             Sort Key: ml.movie_id
                                                                                             Sort Method: quicksort  Memory: 213kB
                                                                                             Worker 0:  Sort Method: quicksort  Memory: 213kB
                                                                                             ->  Hash Join  (cost=6611.72..14580.27 rows=246 width=44) (actual time=64.108..146.417 rows=1431 loops=2)
                                                                                                   Hash Cond: (mc1.company_id = cn1.id)
                                                                                                   ->  Merge Join  (cost=651.94..8551.02 rows=26465 width=29) (actual time=10.341..89.198 rows=29022 loops=2)
                                                                                                         Merge Cond: (ml.movie_id = mc1.movie_id)
                                                                                                         ->  Merge Join  (cost=651.06..2920.55 rows=5051 width=21) (actual time=10.207..38.583 rows=6192 loops=2)
                                                                                                               Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                                                                                               ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.051..19.051 rows=63901 loops=2)
                                                                                                               ->  Sort  (cost=650.63..654.80 rows=1666 width=8) (actual time=10.125..10.645 rows=6443 loops=2)
                                                                                                                     Sort Key: ml.movie_id
                                                                                                                     Sort Method: quicksort  Memory: 205kB
                                                                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                                     ->  Hash Join  (cost=1.24..561.48 rows=1666 width=8) (actual time=0.133..8.961 rows=2315 loops=2)
                                                                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.030..4.732 rows=29997 loops=2)
                                                                                                                           ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.039..0.040 rows=2 loops=2)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.024..0.029 rows=2 loops=2)
                                                                                                                                       Filter: ((link)::text ~~ '%follow%'::text)
                                                                                                                                       Rows Removed by Filter: 16
                                                                                                         ->  Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..131550.35 rows=2609129 width=8) (actual time=0.035..34.289 rows=111067 loops=2)
                                                                                                   ->  Hash  (cost=5932.46..5932.46 rows=2185 width=23) (actual time=53.743..53.743 rows=2340 loops=2)
                                                                                                         Buckets: 4096  Batches: 1  Memory Usage: 160kB
                                                                                                         ->  Seq Scan on company_name cn1  (cost=0.00..5932.46 rows=2185 width=23) (actual time=0.042..52.095 rows=2340 loops=2)
                                                                                                               Filter: ((country_code)::text = '[nl]'::text)
                                                                                                               Rows Removed by Filter: 232657
                                                                                 ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.028..0.028 rows=1 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=1 width=4) (actual time=0.016..0.018 rows=1 loops=2)
                                                                                             Filter: ((kind)::text = 'tv series'::text)
                                                                                             Rows Removed by Filter: 6
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.040..0.042 rows=1 loops=2)
                                                               Filter: ((info)::text = 'rating'::text)
                                                               Rows Removed by Filter: 112
               ->  Hash  (cost=1.09..1.09 rows=1 width=4) (actual time=0.029..0.029 rows=1 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                     ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=1 width=4) (actual time=0.017..0.019 rows=1 loops=1)
                           Filter: ((kind)::text = 'tv series'::text)
                           Rows Removed by Filter: 6
         ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.045..0.045 rows=1 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.024..0.027 rows=1 loops=1)
                     Filter: ((info)::text = 'rating'::text)
                     Rows Removed by Filter: 112
 Planning Time: 113.031 ms
 Execution Time: 1300.357 ms
(90 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/33c.sql_explained.sql
SET
SET
                                                                                                                                       QUERY PLAN                                                                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=141754.28..141754.29 rows=1 width=192) (actual time=1600.613..1600.613 rows=1 loops=1)
   ->  Hash Join  (cost=133569.54..141754.26 rows=1 width=82) (actual time=1489.994..1600.481 rows=114 loops=1)
         Hash Cond: (t1.kind_id = kt1.id)
         ->  Merge Join  (cost=133568.42..141753.15 rows=1 width=86) (actual time=1489.900..1600.345 rows=114 loops=1)
               Merge Cond: (t1.id = ml.movie_id)
               ->  Index Scan using title_pkey on title t1  (cost=0.43..102082.17 rows=2528312 width=25) (actual time=0.025..114.151 rows=152917 loops=1)
               ->  Sort  (cost=133567.99..133568.00 rows=1 width=77) (actual time=1468.931..1468.942 rows=114 loops=1)
                     Sort Key: mc1.movie_id
                     Sort Method: quicksort  Memory: 42kB
                     ->  Hash Join  (cost=131373.01..133567.98 rows=1 width=77) (actual time=1456.552..1468.804 rows=114 loops=1)
                           Hash Cond: (mi_idx1.info_type_id = it1.id)
                           ->  Merge Join  (cost=131370.59..133565.36 rows=70 width=81) (actual time=1456.467..1468.670 rows=342 loops=1)
                                 Merge Cond: (mi_idx1.movie_id = ml.movie_id)
                                 ->  Index Scan using movie_id_movie_info_idx on movie_info_idx mi_idx1  (cost=0.43..43826.36 rows=1380035 width=13) (actual time=0.036..9.157 rows=50698 loops=1)
                                 ->  Sort  (cost=131370.16..131370.22 rows=23 width=68) (actual time=1453.956..1453.984 rows=347 loops=1)
                                       Sort Key: mc1.movie_id
                                       Sort Method: quicksort  Memory: 42kB
                                       ->  Gather  (cost=124052.14..131369.64 rows=23 width=68) (actual time=1423.338..1471.655 rows=121 loops=1)
                                             Workers Planned: 1
                                             Workers Launched: 1
                                             ->  Hash Join  (cost=123052.14..130367.34 rows=14 width=68) (actual time=1419.355..1446.680 rows=60 loops=2)
                                                   Hash Cond: (t2.kind_id = kt2.id)
                                                   ->  Parallel Hash Join  (cost=123051.03..130366.03 rows=47 width=72) (actual time=1418.589..1446.466 rows=70 loops=2)
                                                         Hash Cond: (cn2.id = mc2.company_id)
                                                         ->  Parallel Seq Scan on company_name cn2  (cost=0.00..4377.34 rows=138234 width=23) (actual time=0.012..15.904 rows=117498 loops=2)
                                                         ->  Parallel Hash  (cost=123050.62..123050.62 rows=33 width=57) (actual time=1416.524..1416.525 rows=70 loops=2)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Parallel Hash Join  (cost=89312.34..123050.62 rows=33 width=57) (actual time=1025.121..1416.423 rows=70 loops=2)
                                                                     Hash Cond: (mc2.movie_id = t2.id)
                                                                     ->  Parallel Seq Scan on movie_companies mc2  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.008..233.163 rows=1304564 loops=2)
                                                                     ->  Parallel Hash  (cost=89311.94..89311.94 rows=32 width=65) (actual time=1022.197..1022.197 rows=38 loops=2)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Parallel Hash Join  (cost=33182.88..89311.94 rows=32 width=65) (actual time=555.240..1022.067 rows=38 loops=2)
                                                                                 Hash Cond: (t2.id = ml.linked_movie_id)
                                                                                 ->  Parallel Seq Scan on title t2  (cost=0.00..51799.95 rows=432897 width=25) (actual time=0.040..415.571 rows=521400 loops=2)
                                                                                       Filter: ((production_year >= 2000) AND (production_year <= 2010))
                                                                                       Rows Removed by Filter: 742756
                                                                                 ->  Parallel Hash  (cost=33181.88..33181.88 rows=80 width=40) (actual time=550.729..550.729 rows=49 loops=2)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                                       ->  Parallel Hash Join  (cost=26712.90..33181.88 rows=80 width=40) (actual time=478.594..550.506 rows=49 loops=2)
                                                                                             Hash Cond: (mc1.company_id = cn1.id)
                                                                                             ->  Hash Join  (cost=21066.29..27534.89 rows=149 width=25) (actual time=405.537..477.111 rows=63 loops=2)
                                                                                                   Hash Cond: (mi_idx2.info_type_id = it2.id)
                                                                                                   ->  Parallel Hash Join  (cost=21063.87..27486.73 rows=16791 width=29) (actual time=405.100..476.349 rows=6846 loops=2)
                                                                                                         Hash Cond: (ml.linked_movie_id = mi_idx2.movie_id)
                                                                                                         ->  Merge Join  (cost=869.16..5648.12 rows=10916 width=16) (actual time=8.818..38.294 rows=5049 loops=2)
                                                                                                               Merge Cond: (mc1.movie_id = ml.movie_id)
                                                                                                               ->  Parallel Index Scan using movie_id_movie_companies on movie_companies mc1  (cost=0.43..116330.44 rows=1087137 width=8) (actual time=0.029..22.207 rows=49939 loops=2)
                                                                                                               ->  Sort  (cost=868.72..881.22 rows=5000 width=8) (actual time=8.669..9.072 rows=6226 loops=2)
                                                                                                                     Sort Key: ml.movie_id
                                                                                                                     Sort Method: quicksort  Memory: 205kB
                                                                                                                     Worker 0:  Sort Method: quicksort  Memory: 205kB
                                                                                                                     ->  Hash Join  (cost=1.29..561.53 rows=5000 width=8) (actual time=0.087..7.714 rows=2315 loops=2)
                                                                                                                           Hash Cond: (ml.link_type_id = lt.id)
                                                                                                                           ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=12) (actual time=0.037..3.651 rows=29997 loops=2)
                                                                                                                           ->  Hash  (cost=1.25..1.25 rows=3 width=4) (actual time=0.032..0.032 rows=2 loops=2)
                                                                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                                                 ->  Seq Scan on link_type lt  (cost=0.00..1.25 rows=3 width=4) (actual time=0.025..0.029 rows=2 loops=2)
                                                                                                                                       Filter: ((link)::text = ANY ('{sequel,follows,"followed by"}'::text[]))
                                                                                                                                       Rows Removed by Filter: 16
                                                                                                         ->  Parallel Hash  (cost=15122.68..15122.68 rows=291762 width=13) (actual time=353.584..353.585 rows=351960 loops=2)
                                                                                                               Buckets: 131072  Batches: 16  Memory Usage: 3360kB
                                                                                                               ->  Parallel Seq Scan on movie_info_idx mi_idx2  (cost=0.00..15122.68 rows=291762 width=13) (actual time=0.026..228.192 rows=351960 loops=2)
                                                                                                                     Filter: ((info)::text < '3.5'::text)
                                                                                                                     Rows Removed by Filter: 338058
                                                                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.060..0.060 rows=1 loops=2)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                                         ->  Seq Scan on info_type it2  (cost=0.00..2.41 rows=1 width=4) (actual time=0.047..0.050 rows=1 loops=2)
                                                                                                               Filter: ((info)::text = 'rating'::text)
                                                                                                               Rows Removed by Filter: 112
                                                                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=73895 width=23) (actual time=71.816..71.816 rows=63115 loops=2)
                                                                                                   Buckets: 131072  Batches: 1  Memory Usage: 8256kB
                                                                                                   ->  Parallel Seq Scan on company_name cn1  (cost=0.00..4722.92 rows=73895 width=23) (actual time=0.028..38.511 rows=63115 loops=2)
                                                                                                         Filter: ((country_code)::text <> '[us]'::text)
                                                                                                         Rows Removed by Filter: 54384
                                                   ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.063..0.064 rows=2 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on kind_type kt2  (cost=0.00..1.09 rows=2 width=4) (actual time=0.041..0.043 rows=2 loops=2)
                                                               Filter: ((kind)::text = ANY ('{"tv series",episode}'::text[]))
                                                               Rows Removed by Filter: 5
                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.034..0.034 rows=1 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on info_type it1  (cost=0.00..2.41 rows=1 width=4) (actual time=0.022..0.024 rows=1 loops=1)
                                       Filter: ((info)::text = 'rating'::text)
                                       Rows Removed by Filter: 112
         ->  Hash  (cost=1.09..1.09 rows=2 width=4) (actual time=0.036..0.036 rows=2 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 9kB
               ->  Seq Scan on kind_type kt1  (cost=0.00..1.09 rows=2 width=4) (actual time=0.012..0.015 rows=2 loops=1)
                     Filter: ((kind)::text = ANY ('{"tv series",episode}'::text[]))
                     Rows Removed by Filter: 5
 Planning Time: 109.631 ms
 Execution Time: 1619.566 ms
(92 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=389853.80..389853.81 rows=1 width=32) (actual time=3025.114..3025.114 rows=1 loops=1)
   ->  Gather  (cost=389853.58..389853.79 rows=2 width=32) (actual time=3024.814..3030.661 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=388853.58..388853.59 rows=1 width=32) (actual time=3018.485..3018.486 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=337023.30..388853.51 rows=30 width=17) (actual time=2833.556..3018.403 rows=69 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.012..268.999 rows=337640 loops=3)
                           Filter: (production_year > 2005)
                           Rows Removed by Filter: 505131
                     ->  Parallel Hash  (cost=337022.38..337022.38 rows=74 width=8) (actual time=2700.162..2700.162 rows=589 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=50880.48..337022.38 rows=74 width=8) (actual time=607.748..2699.634 rows=589 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..285615.00 rows=60182 width=4) (actual time=0.940..2086.416 rows=51299 loops=3)
                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                                       Rows Removed by Filter: 4893941
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=603.126..603.126 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.770..476.596 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..256.325 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.690..33.690 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.868..33.636 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.769 ms
 Execution Time: 3031.055 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3b.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=340923.67..340923.68 rows=1 width=32) (actual time=2092.473..2092.473 rows=1 loops=1)
   ->  Gather  (cost=340923.45..340923.66 rows=2 width=32) (actual time=2092.164..2097.967 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=339923.45..339923.46 rows=1 width=32) (actual time=2085.882..2085.883 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=290135.26..339923.45 rows=1 width=17) (actual time=2054.044..2085.863 rows=2 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.015..248.437 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=290135.24..290135.24 rows=1 width=8) (actual time=1819.754..1819.754 rows=7 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=50880.48..290135.24 rows=1 width=8) (actual time=685.660..1819.639 rows=7 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=158 width=4) (actual time=71.462..1225.060 rows=762 loops=3)
                                       Filter: ((info)::text = 'Bulgaria'::text)
                                       Rows Removed by Filter: 4944478
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=593.988..593.988 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 792kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=33.826..471.826 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..253.094 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.333..33.333 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.850..33.282 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.472 ms
 Execution Time: 2098.418 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/3c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=409155.23..409155.24 rows=1 width=32) (actual time=4118.730..4118.731 rows=1 loops=1)
   ->  Gather  (cost=409155.02..409155.23 rows=2 width=32) (actual time=4118.275..4124.031 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=408155.02..408155.03 rows=1 width=32) (actual time=4112.000..4112.001 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=354417.68..408154.42 rows=241 width=17) (actual time=3758.062..4110.663 rows=2417 loops=3)
                     Hash Cond: (t.id = mi.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.015..282.993 rows=583011 loops=3)
                           Filter: (production_year > 1990)
                           Rows Removed by Filter: 259760
                     ->  Parallel Hash  (cost=354413.34..354413.34 rows=347 width=8) (actual time=3751.915..3751.915 rows=4054 loops=3)
                           Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                           ->  Parallel Hash Join  (cost=50880.48..354413.34 rows=347 width=8) (actual time=609.123..2857.743 rows=4054 loops=3)
                                 Hash Cond: (mi.movie_id = mk.movie_id)
                                 ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=4) (actual time=1.039..2219.052 rows=235558 loops=3)
                                       Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                       Rows Removed by Filter: 4709682
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=604.117..604.117 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=33.742..471.055 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.024..251.711 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.306..33.306 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.841..33.252 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 3.688 ms
 Execution Time: 4124.531 ms
(29 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4a.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=118372.74..118372.75 rows=1 width=64) (actual time=1186.629..1186.629 rows=1 loops=1)
   ->  Gather  (cost=67607.95..118372.73 rows=2 width=22) (actual time=930.475..1192.011 rows=740 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=66607.95..117372.53 rows=1 width=22) (actual time=929.431..1179.129 rows=247 loops=3)
               Hash Cond: (t.id = mi_idx.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (actual time=0.013..264.053 rows=337640 loops=3)
                     Filter: (production_year > 2005)
                     Rows Removed by Filter: 505131
               ->  Parallel Hash  (cost=66607.92..66607.92 rows=2 width=13) (actual time=868.583..868.584 rows=1940 loops=3)
                     Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                     ->  Parallel Hash Join  (cost=50882.90..66607.92 rows=2 width=13) (actual time=596.892..791.289 rows=1940 loops=3)
                           Hash Cond: (mi_idx.movie_id = mk.movie_id)
                           ->  Hash Join  (cost=2.43..15720.19 rows=1934 width=9) (actual time=0.181..178.598 rows=117663 loops=3)
                                 Hash Cond: (mi_idx.info_type_id = it.id)
                                 ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=218500 width=13) (actual time=0.037..144.378 rows=174440 loops=3)
                                       Filter: ((info)::text > '5.0'::text)
                                       Rows Removed by Filter: 285572
                                 ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.047 rows=1 loops=3)
                                             Filter: ((info)::text = 'rating'::text)
                                             Rows Removed by Filter: 112
                           ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=595.853..595.853 rows=4317 loops=3)
                                 Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                 ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.328..473.084 rows=4317 loops=3)
                                       Hash Cond: (mk.keyword_id = k.id)
                                       ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..253.983 rows=1507977 loops=3)
                                       ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.627..33.627 rows=30 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.871..33.572 rows=30 loops=3)
                                                   Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                   Rows Removed by Filter: 134140
 Planning Time: 4.322 ms
 Execution Time: 1193.024 ms
(35 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4b.sql_explained.sql
SET
SET
                                                                                  QUERY PLAN                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=116799.72..116799.73 rows=1 width=64) (actual time=877.664..877.664 rows=1 loops=1)
   ->  Gather  (cost=67011.42..116799.71 rows=1 width=22) (actual time=840.990..883.460 rows=6 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=66011.42..115799.61 rows=1 width=22) (actual time=813.658..871.146 rows=2 loops=3)
               Hash Cond: (t.id = mi_idx.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.015..248.586 rows=130555 loops=3)
                     Filter: (production_year > 2010)
                     Rows Removed by Filter: 712215
               ->  Parallel Hash  (cost=66011.41..66011.41 rows=1 width=13) (actual time=604.820..604.820 rows=7 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=17758.80..66011.41 rows=1 width=13) (actual time=298.794..604.701 rows=7 loops=3)
                           Hash Cond: (mk.movie_id = mi_idx.movie_id)
                           ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=34.765..475.717 rows=4317 loops=3)
                                 Hash Cond: (mk.keyword_id = k.id)
                                 ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.028..255.478 rows=1507977 loops=3)
                                 ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=34.303..34.304 rows=30 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.815..34.255 rows=30 loops=3)
                                             Filter: ((keyword)::text ~~ '%sequel%'::text)
                                             Rows Removed by Filter: 134140
                           ->  Parallel Hash  (cost=15132.23..15132.23 rows=23 width=9) (actual time=127.942..127.943 rows=102 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Hash Join  (cost=2.43..15132.23 rows=23 width=9) (actual time=1.664..127.811 rows=102 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=2615 width=13) (actual time=0.184..126.751 rows=2794 loops=3)
                                             Filter: ((info)::text > '9.0'::text)
                                             Rows Removed by Filter: 457218
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.068..0.068 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.045..0.048 rows=1 loops=3)
                                                   Filter: ((info)::text = 'rating'::text)
                                                   Rows Removed by Filter: 112
 Planning Time: 4.240 ms
 Execution Time: 883.914 ms
(35 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/4c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=119900.33..119900.34 rows=1 width=64) (actual time=1246.473..1246.473 rows=1 loops=1)
   ->  Gather  (cost=119900.11..119900.32 rows=2 width=64) (actual time=1246.071..1252.678 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=118900.11..118900.12 rows=1 width=64) (actual time=1239.476..1239.476 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=66992.13..118900.10 rows=2 width=22) (actual time=878.329..1238.087 rows=1567 loops=3)
                     Hash Cond: (t.id = mi_idx.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.012..282.038 rows=583011 loops=3)
                           Filter: (production_year > 1990)
                           Rows Removed by Filter: 259760
                     ->  Parallel Hash  (cost=66992.09..66992.09 rows=3 width=13) (actual time=876.687..876.688 rows=2697 loops=3)
                           Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 504kB
                           ->  Parallel Hash Join  (cost=50882.90..66992.09 rows=3 width=13) (actual time=613.600..834.475 rows=2697 loops=3)
                                 Hash Cond: (mi_idx.movie_id = mk.movie_id)
                                 ->  Hash Join  (cost=2.43..16099.73 rows=3167 width=9) (actual time=0.186..202.573 rows=149656 loops=3)
                                       Hash Cond: (mi_idx.info_type_id = it.id)
                                       ->  Parallel Seq Scan on movie_info_idx mi_idx  (cost=0.00..15122.68 rows=357862 width=13) (actual time=0.031..153.303 rows=287152 loops=3)
                                             Filter: ((info)::text > '2.0'::text)
                                             Rows Removed by Filter: 172860
                                       ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.075..0.076 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                             ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.056..0.058 rows=1 loops=3)
                                                   Filter: ((info)::text = 'rating'::text)
                                                   Rows Removed by Filter: 112
                                 ->  Parallel Hash  (cost=50878.20..50878.20 rows=182 width=4) (actual time=611.186..611.186 rows=4317 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 760kB
                                       ->  Hash Join  (cost=2626.29..50878.20 rows=182 width=4) (actual time=35.467..475.403 rows=4317 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..255.052 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=13 width=4) (actual time=33.713..33.713 rows=30 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=13 width=4) (actual time=1.884..33.661 rows=30 loops=3)
                                                         Filter: ((keyword)::text ~~ '%sequel%'::text)
                                                         Rows Removed by Filter: 134140
 Planning Time: 4.362 ms
 Execution Time: 1253.262 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5a.sql_explained.sql
SET
SET
                                                                                      QUERY PLAN                                                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=372724.06..372724.07 rows=1 width=32) (actual time=259.432..259.432 rows=1 loops=1)
   ->  Gather  (cost=372723.84..372724.05 rows=2 width=32) (actual time=259.321..261.245 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=371723.84..371723.85 rows=1 width=32) (actual time=252.900..252.900 rows=1 loops=3)
               ->  Hash Join  (cost=85882.87..371723.72 rows=48 width=17) (actual time=252.897..252.898 rows=0 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=85879.33..371720.05 rows=48 width=21) (actual time=252.585..252.586 rows=0 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..285615.00 rows=60182 width=8) (never executed)
                                 Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German}'::text[]))
                           ->  Parallel Hash  (cost=85877.27..85877.27 rows=165 width=25) (actual time=252.199..252.199 rows=0 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                 ->  Parallel Hash Join  (cost=35112.01..85877.27 rows=165 width=25) (actual time=252.135..252.135 rows=0 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=426207 width=21) (never executed)
                                             Filter: (production_year > 2005)
                                       ->  Parallel Hash  (cost=35106.92..35106.92 rows=407 width=4) (actual time=252.094..252.094 rows=0 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                             ->  Hash Join  (cost=1.06..35106.92 rows=407 width=4) (actual time=252.072..252.073 rows=0 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=1629 width=8) (actual time=6.529..250.325 rows=8008 loops=3)
                                                         Filter: (((note)::text ~~ '%(theatrical)%'::text) AND ((note)::text ~~ '%(France)%'::text))
                                                         Rows Removed by Filter: 861701
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.093..0.093 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.032..0.046 rows=113 loops=3)
 Planning Time: 4.567 ms
 Execution Time: 261.671 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5b.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=328691.22..328691.23 rows=1 width=32) (actual time=244.749..244.749 rows=1 loops=1)
   ->  Gather  (cost=328691.00..328691.21 rows=2 width=32) (actual time=244.576..246.640 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=327691.00..327691.01 rows=1 width=32) (actual time=238.247..238.247 rows=1 loops=3)
               ->  Hash Join  (cost=87607.92..327691.00 rows=1 width=17) (actual time=238.245..238.245 rows=0 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=87604.38..327687.46 rows=1 width=21) (actual time=237.925..237.925 rows=0 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..239253.38 rows=221252 width=8) (never executed)
                                 Filter: ((info)::text = ANY ('{USA,America}'::text[]))
                           ->  Parallel Hash  (cost=87604.36..87604.36 rows=1 width=25) (actual time=237.537..237.537 rows=0 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                 ->  Parallel Hash Join  (cost=37816.17..87604.36 rows=1 width=25) (actual time=237.471..237.471 rows=0 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (never executed)
                                             Filter: (production_year > 2010)
                                       ->  Parallel Hash  (cost=37816.09..37816.09 rows=6 width=4) (actual time=237.431..237.431 rows=0 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 0kB
                                             ->  Hash Join  (cost=1.06..37816.09 rows=6 width=4) (actual time=237.407..237.407 rows=0 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=25 width=8) (actual time=8.628..237.063 rows=473 loops=3)
                                                         Filter: (((note)::text ~~ '%(VHS)%'::text) AND ((note)::text ~~ '%(USA)%'::text) AND ((note)::text ~~ '%(1994)%'::text))
                                                         Rows Removed by Filter: 869237
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.058..0.059 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.047..0.048 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.092..0.092 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.029..0.043 rows=113 loops=3)
 Planning Time: 4.468 ms
 Execution Time: 247.078 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/5c.sql_explained.sql
SET
SET
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=391106.63..391106.64 rows=1 width=32) (actual time=2919.486..2919.486 rows=1 loops=1)
   ->  Gather  (cost=391106.42..391106.63 rows=2 width=32) (actual time=2919.048..2924.726 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=390106.42..390106.43 rows=1 width=32) (actual time=2912.665..2912.666 rows=1 loops=3)
               ->  Hash Join  (cost=87874.47..390061.87 rows=17818 width=17) (actual time=703.510..2912.430 rows=223 loops=3)
                     Hash Cond: (mi.info_type_id = it.id)
                     ->  Parallel Hash Join  (cost=87870.93..390009.80 rows=17818 width=21) (actual time=703.197..2911.984 rows=223 loops=3)
                           Hash Cond: (mi.movie_id = t.id)
                           ->  Parallel Seq Scan on movie_info mi  (cost=0.00..301068.88 rows=281434 width=8) (actual time=1.027..2251.835 rows=235558 loops=3)
                                 Filter: ((info)::text = ANY ('{Sweden,Norway,Germany,Denmark,Swedish,Denish,Norwegian,German,USA,American}'::text[]))
                                 Rows Removed by Filter: 4709682
                           ->  Parallel Hash  (cost=87706.73..87706.73 rows=13136 width=25) (actual time=632.601..632.601 rows=256 loops=3)
                                 Buckets: 32768  Batches: 1  Memory Usage: 352kB
                                 ->  Parallel Hash Join  (cost=35744.04..87706.73 rows=13136 width=25) (actual time=301.755..631.965 rows=256 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=731112 width=21) (actual time=0.020..279.221 rows=583011 loops=3)
                                             Filter: (production_year > 1990)
                                             Rows Removed by Filter: 259760
                                       ->  Parallel Hash  (cost=35507.44..35507.44 rows=18928 width=4) (actual time=288.980..288.980 rows=266 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 608kB
                                             ->  Hash Join  (cost=1.06..35507.44 rows=18928 width=4) (actual time=206.759..288.643 rows=266 loops=3)
                                                   Hash Cond: (mc.company_type_id = ct.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=75712 width=8) (actual time=0.030..278.255 rows=98543 loops=3)
                                                         Filter: (((note)::text !~~ '%(TV)%'::text) AND ((note)::text ~~ '%(USA)%'::text))
                                                         Rows Removed by Filter: 771167
                                                   ->  Hash  (cost=1.05..1.05 rows=1 width=4) (actual time=0.058..0.058 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on company_type ct  (cost=0.00..1.05 rows=1 width=4) (actual time=0.046..0.048 rows=1 loops=3)
                                                               Filter: ((kind)::text = 'production companies'::text)
                                                               Rows Removed by Filter: 3
                     ->  Hash  (cost=2.13..2.13 rows=113 width=4) (actual time=0.093..0.093 rows=113 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 12kB
                           ->  Seq Scan on info_type it  (cost=0.00..2.13 rows=113 width=4) (actual time=0.032..0.046 rows=113 loops=3)
 Planning Time: 4.400 ms
 Execution Time: 2925.166 ms
(36 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6a.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=622340.59..622340.60 rows=1 width=96) (actual time=4990.887..4990.887 rows=1 loops=1)
   ->  Gather  (cost=622340.37..622340.58 rows=2 width=96) (actual time=4990.595..4996.949 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=621340.37..621340.38 rows=1 width=96) (actual time=4983.786..4983.786 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=571552.17..621340.36 rows=1 width=48) (actual time=4957.644..4983.751 rows=2 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=165838 width=21) (actual time=0.024..256.634 rows=130555 loops=3)
                           Filter: (production_year > 2010)
                           Rows Removed by Filter: 712215
                     ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=39) (actual time=4709.406..4709.406 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=39) (actual time=3569.485..4709.263 rows=2 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=823.438..4242.805 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.039..2269.071 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=507.167..507.168 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=204.158..507.054 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=466.328..466.328 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=164.786..466.255 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..260.572 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=22.038..22.038 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.576..22.015 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.588 ms
 Execution Time: 4997.562 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6b.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=622719.90..622719.91 rows=1 width=96) (actual time=5126.106..5126.106 rows=1 loops=1)
   ->  Gather  (cost=622719.67..622719.88 rows=2 width=96) (actual time=5125.421..5131.836 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=621719.67..621719.68 rows=1 width=96) (actual time=5118.621..5118.622 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=544400.32..621719.67 rows=1 width=48) (actual time=4971.607..5118.599 rows=4 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=196.991..490.994 rows=1 loops=3)
                           Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                           Rows Removed by Filter: 1389163
                     ->  Parallel Hash  (cost=544400.31..544400.31 rows=1 width=37) (actual time=4626.879..4626.879 rows=128 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=101052.25..544400.31 rows=1 width=37) (actual time=963.709..4626.599 rows=128 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=49166.44..492513.86 rows=167 width=29) (actual time=260.777..4060.995 rows=1033 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.038..2214.687 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=49166.29..49166.29 rows=12 width=21) (actual time=241.895..241.895 rows=146 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=12 width=21) (actual time=109.066..241.596 rows=146 loops=3)
                                                   Filter: (production_year > 2014)
                                                   Rows Removed by Filter: 842625
                                 ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=564.910..564.910 rows=11849 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                       ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.590..494.714 rows=11849 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.027..261.842 rows=1507977 loops=3)
                                             ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=44.375..44.375 rows=8 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.174..44.349 rows=8 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                         Rows Removed by Filter: 134162
 Planning Time: 4.662 ms
 Execution Time: 5132.323 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6c.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=621712.31..621712.32 rows=1 width=96) (actual time=4977.329..4977.330 rows=1 loops=1)
   ->  Gather  (cost=621712.09..621712.30 rows=2 width=96) (actual time=4977.044..4982.816 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=620712.09..620712.10 rows=1 width=96) (actual time=4970.432..4970.433 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=543392.73..620712.08 rows=1 width=48) (actual time=4820.450..4970.421 rows=1 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=201.311..501.262 rows=1 loops=3)
                           Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                           Rows Removed by Filter: 1389163
                     ->  Parallel Hash  (cost=543392.72..543392.72 rows=1 width=37) (actual time=4468.451..4468.451 rows=11 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=100044.67..543392.72 rows=1 width=37) (actual time=1257.053..4468.316 rows=11 loops=3)
                                 Hash Cond: (t.id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=49166.44..492513.86 rows=167 width=29) (actual time=249.698..4010.288 rows=1033 loops=3)
                                       Hash Cond: (ci.movie_id = t.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.037..2168.058 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=49166.29..49166.29 rows=12 width=21) (actual time=234.274..234.274 rows=146 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=12 width=21) (actual time=83.955..233.967 rows=146 loops=3)
                                                   Filter: (production_year > 2014)
                                                   Rows Removed by Filter: 842625
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=457.741..457.742 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=98.398..457.680 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..252.704 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=21.709..21.709 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.578..21.683 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.415 ms
 Execution Time: 4983.522 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6d.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=624885.62..624885.63 rows=1 width=96) (actual time=5027.263..5027.263 rows=1 loops=1)
   ->  Gather  (cost=624885.39..624885.60 rows=2 width=96) (actual time=5026.667..5033.145 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=623885.39..623885.40 rows=1 width=96) (actual time=5020.022..5020.023 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=572559.75..623885.39 rows=1 width=48) (actual time=4855.797..5019.958 rows=29 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.013..275.715 rows=460484 loops=3)
                           Filter: (production_year > 2000)
                           Rows Removed by Filter: 382286
                     ->  Parallel Hash  (cost=572559.74..572559.74 rows=1 width=39) (actual time=4695.575..4695.575 rows=37 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=129206.67..572559.74 rows=1 width=39) (actual time=1364.699..4695.407 rows=37 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=812.687..4143.289 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.032..2170.206 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=503.979..503.979 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=202.561..503.911 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=551.905..551.906 rows=11849 loops=3)
                                       Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                       ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.307..488.491 rows=11849 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..255.165 rows=1507977 loops=3)
                                             ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=44.079..44.079 rows=8 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.169..44.053 rows=8 loops=3)
                                                         Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                         Rows Removed by Filter: 134162
 Planning Time: 4.754 ms
 Execution Time: 5033.637 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6e.sql_explained.sql
SET
SET
                                                                                     QUERY PLAN                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=623878.03..623878.04 rows=1 width=96) (actual time=4929.307..4929.307 rows=1 loops=1)
   ->  Gather  (cost=623877.81..623878.02 rows=2 width=96) (actual time=4929.118..4935.599 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=622877.81..622877.82 rows=1 width=96) (actual time=4922.532..4922.532 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=571552.17..622877.80 rows=1 width=48) (actual time=4881.282..4922.500 rows=2 loops=3)
                     Hash Cond: (t.id = mk.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.018..274.184 rows=460484 loops=3)
                           Filter: (production_year > 2000)
                           Rows Removed by Filter: 382286
                     ->  Parallel Hash  (cost=571552.15..571552.15 rows=1 width=39) (actual time=4601.306..4601.306 rows=2 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Parallel Hash Join  (cost=128199.08..571552.15 rows=1 width=39) (actual time=3490.553..4601.193 rows=2 loops=3)
                                 Hash Cond: (ci.movie_id = mk.movie_id)
                                 ->  Parallel Hash Join  (cost=77320.86..520668.25 rows=1511 width=19) (actual time=809.422..4141.343 rows=162 loops=3)
                                       Hash Cond: (ci.person_id = n.id)
                                       ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.032..2172.423 rows=12081448 loops=3)
                                       ->  Parallel Hash  (cost=77318.68..77318.68 rows=174 width=19) (actual time=500.901..500.902 rows=1 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=174 width=19) (actual time=201.300..500.807 rows=1 loops=3)
                                                   Filter: ((name)::text ~~ '%Downey%Robert%'::text)
                                                   Rows Removed by Filter: 1389163
                                 ->  Parallel Hash  (cost=50878.05..50878.05 rows=14 width=20) (actual time=459.758..459.758 rows=5 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                       ->  Hash Join  (cost=2626.14..50878.05 rows=14 width=20) (actual time=98.982..459.701 rows=5 loops=3)
                                             Hash Cond: (mk.keyword_id = k.id)
                                             ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.025..255.366 rows=1507977 loops=3)
                                             ->  Hash  (cost=2626.12..2626.12 rows=1 width=20) (actual time=21.679..21.679 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on keyword k  (cost=0.00..2626.12 rows=1 width=20) (actual time=0.592..21.658 rows=1 loops=3)
                                                         Filter: ((keyword)::text = 'marvel-cinematic-universe'::text)
                                                         Rows Removed by Filter: 134169
 Planning Time: 4.421 ms
 Execution Time: 4936.149 ms
(34 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/6f.sql_explained.sql
SET
SET
                                                                                              QUERY PLAN                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=652048.60..652048.61 rows=1 width=96) (actual time=6979.925..6979.925 rows=1 loops=1)
   ->  Gather  (cost=652048.38..652048.59 rows=2 width=96) (actual time=6975.868..7105.688 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=651048.38..651048.39 rows=1 width=96) (actual time=6969.012..6969.013 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=565020.96..651031.37 rows=2268 width=48) (actual time=6350.034..6860.968 rows=261826 loops=3)
                     Hash Cond: (n.id = ci.person_id)
                     ->  Parallel Seq Scan on name n  (cost=0.00..72977.55 rows=1736455 width=19) (actual time=0.049..380.065 rows=1389164 loops=3)
                     ->  Parallel Hash  (cost=564992.61..564992.61 rows=2268 width=37) (actual time=5433.538..5433.538 rows=261826 loops=3)
                           Buckets: 65536 (originally 8192)  Batches: 16 (originally 1)  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=104652.02..564992.61 rows=2268 width=37) (actual time=985.023..5188.039 rows=261826 loops=3)
                                 Hash Cond: (ci.movie_id = t.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.041..2197.448 rows=12081448 loops=3)
                                 ->  Parallel Hash  (cost=104651.25..104651.25 rows=62 width=41) (actual time=984.863..984.863 rows=4722 loops=3)
                                       Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 1304kB
                                       ->  Parallel Hash Join  (cost=51885.81..104651.25 rows=62 width=41) (actual time=588.045..925.454 rows=4722 loops=3)
                                             Hash Cond: (t.id = mk.movie_id)
                                             ->  Parallel Seq Scan on title t  (cost=0.00..49166.29 rows=575821 width=21) (actual time=0.013..273.192 rows=460484 loops=3)
                                                   Filter: (production_year > 2000)
                                                   Rows Removed by Filter: 382286
                                             ->  Parallel Hash  (cost=51884.41..51884.41 rows=112 width=20) (actual time=587.299..587.299 rows=11849 loops=3)
                                                   Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2744kB
                                                   ->  Hash Join  (cost=3632.50..51884.41 rows=112 width=20) (actual time=44.036..487.624 rows=11849 loops=3)
                                                         Hash Cond: (mk.keyword_id = k.id)
                                                         ->  Parallel Seq Scan on movie_keyword mk  (cost=0.00..43303.71 rows=1884971 width=8) (actual time=0.026..255.037 rows=1507977 loops=3)
                                                         ->  Hash  (cost=3632.40..3632.40 rows=8 width=20) (actual time=43.845..43.845 rows=8 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on keyword k  (cost=0.00..3632.40 rows=8 width=20) (actual time=0.171..43.820 rows=8 loops=3)
                                                                     Filter: ((keyword)::text = ANY ('{superhero,sequel,second-part,marvel-comics,based-on-comic,tv-special,fight,violence}'::text[]))
                                                                     Rows Removed by Filter: 134162
 Planning Time: 4.704 ms
 Execution Time: 7106.178 ms
(32 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7a.sql_explained.sql
SET
SET
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=693399.56..693399.57 rows=1 width=64) (actual time=7330.840..7330.840 rows=1 loops=1)
   ->  Gather  (cost=693399.34..693399.55 rows=2 width=64) (actual time=7330.557..7336.772 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=692399.34..692399.35 rows=1 width=64) (actual time=7323.110..7323.111 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=675186.31..692399.33 rows=1 width=32) (actual time=7230.650..7323.088 rows=11 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..16090.49 rows=299338 width=4) (actual time=0.044..121.305 rows=224897 loops=3)
                           Filter: ((name)::text ~~ '%a%'::text)
                           Rows Removed by Filter: 75550
                     ->  Parallel Hash  (cost=675186.30..675186.30 rows=1 width=44) (actual time=7179.469..7179.469 rows=5 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Hash Join  (cost=622849.52..675186.30 rows=1 width=44) (actual time=7132.451..7179.347 rows=5 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=622267.21..674603.97 rows=1 width=52) (actual time=6886.946..7168.085 rows=130 loops=3)
                                       Hash Cond: (t.id = ci.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=143147 width=21) (actual time=0.033..263.485 rows=113395 loops=3)
                                             Filter: ((production_year >= 1980) AND (production_year <= 1995))
                                             Rows Removed by Filter: 729375
                                       ->  Parallel Hash  (cost=622267.19..622267.19 rows=1 width=31) (actual time=6885.194..6885.194 rows=890 loops=3)
                                             Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 312kB
                                             ->  Parallel Hash Join  (cost=161930.27..622267.19 rows=1 width=31) (actual time=1082.790..4686.467 rows=890 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.035..2154.791 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=161930.25..161930.25 rows=1 width=23) (actual time=1047.730..1047.730 rows=6 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Parallel Hash Join  (cost=66488.22..161930.25 rows=1 width=23) (actual time=335.460..1047.631 rows=6 loops=3)
                                                               Hash Cond: (n.id = pi.person_id)
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..94683.23 rows=202346 width=19) (actual time=0.064..714.981 rows=181097 loops=3)
                                                                     Filter: (((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'B%'::text))))
                                                                     Rows Removed by Filter: 1208067
                                                               ->  Parallel Hash  (cost=66488.21..66488.21 rows=1 width=4) (actual time=313.049..313.049 rows=21 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                     ->  Hash Join  (cost=2.43..66488.21 rows=1 width=4) (actual time=13.850..312.969 rows=21 loops=3)
                                                                           Hash Cond: (pi.info_type_id = it.id)
                                                                           ->  Parallel Seq Scan on person_info pi  (cost=0.00..66485.75 rows=12 width=8) (actual time=13.734..312.823 rows=21 loops=3)
                                                                                 Filter: ((note)::text = 'Volker Boehm'::text)
                                                                                 Rows Removed by Filter: 987867
                                                                           ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.037..0.048 rows=1 loops=3)
                                                                                       Filter: ((info)::text = 'mini biography'::text)
                                                                                       Rows Removed by Filter: 112
                                 ->  Hash  (cost=561.48..561.48 rows=1666 width=4) (actual time=11.146..11.146 rows=5186 loops=3)
                                       Buckets: 8192 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 247kB
                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=4) (actual time=0.181..9.466 rows=5186 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.042..4.833 rows=29997 loops=3)
                                             ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.064..0.064 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.029..0.031 rows=1 loops=3)
                                                         Filter: ((link)::text = 'features'::text)
                                                         Rows Removed by Filter: 17
 Planning Time: 14.514 ms
 Execution Time: 7337.499 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7b.sql_explained.sql
SET
SET
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=663974.41..663974.42 rows=1 width=64) (actual time=5177.113..5177.114 rows=1 loops=1)
   ->  Gather  (cost=663974.19..663974.40 rows=2 width=64) (actual time=5175.462..5182.065 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=662974.19..662974.20 rows=1 width=64) (actual time=5168.509..5168.509 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=645761.16..662974.18 rows=1 width=32) (actual time=5130.552..5168.491 rows=5 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..16090.49 rows=299338 width=4) (actual time=0.044..114.983 rows=224897 loops=3)
                           Filter: ((name)::text ~~ '%a%'::text)
                           Rows Removed by Filter: 75550
                     ->  Parallel Hash  (cost=645761.15..645761.15 rows=1 width=44) (actual time=5031.072..5031.072 rows=3 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 40kB
                           ->  Hash Join  (cost=201453.00..645761.15 rows=1 width=44) (actual time=4610.140..5030.847 rows=3 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=200870.69..645178.82 rows=1 width=52) (actual time=2697.372..5019.819 rows=7 loops=3)
                                       Hash Cond: (n.id = pi.person_id)
                                       ->  Parallel Hash Join  (cost=134382.47..578648.77 rows=11153 width=48) (actual time=1019.983..4707.453 rows=11015 loops=3)
                                             Hash Cond: (ci.movie_id = t.id)
                                             ->  Parallel Hash Join  (cost=82162.96..525510.35 rows=350058 width=27) (actual time=469.845..4372.228 rows=304108 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.027..2142.326 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=81659.82..81659.82 rows=40251 width=19) (actual time=468.962..468.962 rows=30659 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 6080kB
                                                         ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40251 width=19) (actual time=0.107..448.185 rows=30659 loops=3)
                                                               Filter: (((name_pcode_cf)::text ~~ 'D%'::text) AND ((gender)::text = 'm'::text))
                                                               Rows Removed by Filter: 1358505
                                             ->  Parallel Hash  (cost=51799.95..51799.95 rows=33565 width=21) (actual time=277.431..277.431 rows=25355 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 5344kB
                                                   ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=33565 width=21) (actual time=0.032..253.374 rows=25355 loops=3)
                                                         Filter: ((production_year >= 1980) AND (production_year <= 1984))
                                                         Rows Removed by Filter: 817416
                                       ->  Parallel Hash  (cost=66488.21..66488.21 rows=1 width=4) (actual time=311.049..311.049 rows=21 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Hash Join  (cost=2.43..66488.21 rows=1 width=4) (actual time=6.553..310.979 rows=21 loops=3)
                                                   Hash Cond: (pi.info_type_id = it.id)
                                                   ->  Parallel Seq Scan on person_info pi  (cost=0.00..66485.75 rows=12 width=8) (actual time=6.432..310.833 rows=21 loops=3)
                                                         Filter: ((note)::text = 'Volker Boehm'::text)
                                                         Rows Removed by Filter: 987867
                                                   ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.065..0.065 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.039..0.050 rows=1 loops=3)
                                                               Filter: ((info)::text = 'mini biography'::text)
                                                               Rows Removed by Filter: 112
                                 ->  Hash  (cost=561.48..561.48 rows=1666 width=4) (actual time=10.971..10.971 rows=5186 loops=3)
                                       Buckets: 8192 (originally 2048)  Batches: 1 (originally 1)  Memory Usage: 247kB
                                       ->  Hash Join  (cost=1.24..561.48 rows=1666 width=4) (actual time=0.167..9.286 rows=5186 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.040..4.666 rows=29997 loops=3)
                                             ->  Hash  (cost=1.23..1.23 rows=1 width=4) (actual time=0.052..0.052 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.23 rows=1 width=4) (actual time=0.028..0.030 rows=1 loops=3)
                                                         Filter: ((link)::text = 'features'::text)
                                                         Rows Removed by Filter: 17
 Planning Time: 14.175 ms
 Execution Time: 5182.791 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/7c.sql_explained.sql
SET
SET
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=697422.31..697422.32 rows=1 width=64) (actual time=8784.030..8784.030 rows=1 loops=1)
   ->  Gather  (cost=697422.09..697422.30 rows=2 width=64) (actual time=8778.338..9454.754 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=696422.09..696422.10 rows=1 width=64) (actual time=8770.981..8770.981 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=678258.59..696422.08 rows=2 width=109) (actual time=8572.035..8643.083 rows=22728 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..17029.39 rows=302423 width=4) (actual time=0.042..122.783 rows=228698 loops=3)
                           Filter: ((name IS NOT NULL) AND (((name)::text ~~ '%a%'::text) OR ((name)::text ~~ 'A%'::text)))
                           Rows Removed by Filter: 71749
                     ->  Parallel Hash  (cost=678258.58..678258.58 rows=1 width=121) (actual time=8365.040..8365.040 rows=13386 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 16 (originally 1)  Memory Usage: 2592kB
                           ->  Hash Join  (cost=624016.03..678258.58 rows=1 width=121) (actual time=7635.629..8273.927 rows=13386 loops=3)
                                 Hash Cond: (t.id = ml.linked_movie_id)
                                 ->  Parallel Hash Join  (cost=623371.14..677606.36 rows=189 width=129) (actual time=7616.518..8225.406 rows=176455 loops=3)
                                       Hash Cond: (t.id = ci.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=649194 width=4) (actual time=0.042..295.461 rows=518532 loops=3)
                                             Filter: ((production_year >= 1980) AND (production_year <= 2010))
                                             Rows Removed by Filter: 324238
                                       ->  Parallel Hash  (cost=623367.30..623367.30 rows=307 width=125) (actual time=7059.226..7059.226 rows=305764 loops=3)
                                             Buckets: 8192 (originally 1024)  Batches: 256 (originally 1)  Memory Usage: 3232kB
                                             ->  Parallel Hash Join  (cost=163029.14..623367.30 rows=307 width=125) (actual time=1308.303..5214.936 rows=305764 loops=3)
                                                   Hash Cond: (ci.person_id = n.id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=8) (actual time=0.042..2178.720 rows=12081448 loops=3)
                                                   ->  Parallel Hash  (cost=163028.71..163028.71 rows=35 width=117) (actual time=1307.873..1307.873 rows=4354 loops=3)
                                                         Buckets: 16384 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 11384kB
                                                         ->  Parallel Hash Join  (cost=98354.03..163028.71 rows=35 width=117) (actual time=1203.984..1271.473 rows=4354 loops=3)
                                                               Hash Cond: (pi.person_id = n.id)
                                                               ->  Hash Join  (cost=2.43..63495.30 rows=306 width=98) (actual time=0.100..343.807 rows=28061 loops=3)
                                                                     Hash Cond: (pi.info_type_id = it.id)
                                                                     ->  Parallel Seq Scan on person_info pi  (cost=0.00..63398.60 rows=34617 width=102) (actual time=0.032..325.817 rows=28061 loops=3)
                                                                           Filter: (note IS NOT NULL)
                                                                           Rows Removed by Filter: 959827
                                                                     ->  Hash  (cost=2.41..2.41 rows=1 width=4) (actual time=0.055..0.055 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on info_type it  (cost=0.00..2.41 rows=1 width=4) (actual time=0.042..0.052 rows=1 loops=3)
                                                                                 Filter: ((info)::text = 'mini biography'::text)
                                                                                 Rows Removed by Filter: 112
                                                               ->  Parallel Hash  (cost=94683.23..94683.23 rows=199790 width=19) (actual time=771.136..771.136 rows=169207 loops=3)
                                                                     Buckets: 65536  Batches: 8  Memory Usage: 4032kB
                                                                     ->  Parallel Seq Scan on name n  (cost=0.00..94683.23 rows=199790 width=19) (actual time=0.069..709.938 rows=169207 loops=3)
                                                                           Filter: (((name_pcode_cf)::text >= 'A'::text) AND ((name_pcode_cf)::text <= 'F'::text) AND (((gender)::text = 'm'::text) OR (((gender)::text = 'f'::text) AND ((name)::text ~~ 'A%'::text))))
                                                                           Rows Removed by Filter: 1219957
                                 ->  Hash  (cost=561.57..561.57 rows=6666 width=4) (actual time=18.431..18.431 rows=21505 loops=3)
                                       Buckets: 32768 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 1013kB
                                       ->  Hash Join  (cost=1.32..561.57 rows=6666 width=4) (actual time=0.151..11.697 rows=21505 loops=3)
                                             Hash Cond: (ml.link_type_id = lt.id)
                                             ->  Seq Scan on movie_link ml  (cost=0.00..462.97 rows=29997 width=8) (actual time=0.040..4.845 rows=29997 loops=3)
                                             ->  Hash  (cost=1.27..1.27 rows=4 width=4) (actual time=0.060..0.060 rows=4 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on link_type lt  (cost=0.00..1.27 rows=4 width=4) (actual time=0.029..0.034 rows=4 loops=3)
                                                         Filter: ((link)::text = ANY ('{references,"referenced in",features,"featured in"}'::text[]))
                                                         Rows Removed by Filter: 14
 Planning Time: 14.643 ms
 Execution Time: 9455.723 ms
(55 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8a.sql_explained.sql
SET
SET
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=631023.55..631023.56 rows=1 width=64) (actual time=3662.857..3662.857 rows=1 loops=1)
   ->  Gather  (cost=631023.33..631023.54 rows=2 width=64) (actual time=3662.143..3668.986 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=630023.33..630023.34 rows=1 width=64) (actual time=3655.283..3655.284 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=579540.20..630023.33 rows=1 width=33) (actual time=3434.338..3655.226 rows=21 loops=3)
                     Hash Cond: (t.id = ci.movie_id)
                     ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.019..220.385 rows=842771 loops=3)
                     ->  Parallel Hash  (cost=579540.18..579540.18 rows=1 width=24) (actual time=3331.547..3331.548 rows=21 loops=3)
                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                           ->  Parallel Hash Join  (cost=563388.51..579540.18 rows=1 width=24) (actual time=3292.940..3331.434 rows=21 loops=3)
                                 Hash Cond: (an1.person_id = ci.person_id)
                                 ->  Parallel Hash Join  (cost=81879.04..98016.48 rows=3793 width=24) (actual time=499.420..617.620 rows=1344 loops=3)
                                       Hash Cond: (an1.person_id = n1.id)
                                       ->  Parallel Seq Scan on aka_name an1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.033..73.388 rows=300448 loops=3)
                                       ->  Parallel Hash  (cost=81659.82..81659.82 rows=17538 width=4) (actual time=498.744..498.744 rows=6970 loops=3)
                                             Buckets: 65536  Batches: 1  Memory Usage: 1376kB
                                             ->  Parallel Seq Scan on name n1  (cost=0.00..81659.82 rows=17538 width=4) (actual time=0.182..492.851 rows=6970 loops=3)
                                                   Filter: (((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))
                                                   Rows Removed by Filter: 1382193
                                 ->  Parallel Hash  (cost=481509.44..481509.44 rows=2 width=12) (actual time=2713.429..2713.429 rows=2479 loops=3)
                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 504kB
                                       ->  Hash Join  (cost=39896.72..481509.44 rows=2 width=12) (actual time=1084.848..2620.547 rows=2479 loops=3)
                                             Hash Cond: (ci.role_id = rt.id)
                                             ->  Parallel Hash Join  (cost=39895.56..481508.19 rows=25 width=16) (actual time=299.930..2619.026 rows=6533 loops=3)
                                                   Hash Cond: (ci.movie_id = mc.movie_id)
                                                   ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=40775 width=12) (actual time=0.903..2310.069 rows=31032 loops=3)
                                                         Filter: ((note)::text = '(voice: English version)'::text)
                                                         Rows Removed by Filter: 12050416
                                                   ->  Parallel Hash  (cost=39892.48..39892.48 rows=246 width=4) (actual time=298.570..298.570 rows=16109 loops=3)
                                                         Buckets: 65536 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2968kB
                                                         ->  Parallel Hash Join  (cost=4773.19..39892.48 rows=246 width=4) (actual time=24.748..267.210 rows=16109 loops=3)
                                                               Hash Cond: (mc.company_id = cn.id)
                                                               ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=8470 width=8) (actual time=0.070..236.037 rows=16299 loops=3)
                                                                     Filter: (((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text))
                                                                     Rows Removed by Filter: 853411
                                                               ->  Parallel Hash  (cost=4722.92..4722.92 rows=4022 width=4) (actual time=24.575..24.575 rows=2251 loops=3)
                                                                     Buckets: 8192  Batches: 1  Memory Usage: 384kB
                                                                     ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=4022 width=4) (actual time=0.030..23.099 rows=2251 loops=3)
                                                                           Filter: ((country_code)::text = '[jp]'::text)
                                                                           Rows Removed by Filter: 76082
                                             ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.063..0.063 rows=1 loops=3)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                   ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.043..0.045 rows=1 loops=3)
                                                         Filter: ((role)::text = 'actress'::text)
                                                         Rows Removed by Filter: 11
 Planning Time: 9.675 ms
 Execution Time: 3669.639 ms
(48 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8b.sql_explained.sql
SET
SET
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=642938.22..642938.23 rows=1 width=64) (actual time=5085.011..5085.011 rows=1 loops=1)
   ->  Gather  (cost=642938.11..642938.22 rows=1 width=64) (actual time=5084.717..5090.384 rows=2 loops=1)
         Workers Planned: 1
         Workers Launched: 1
         ->  Partial Aggregate  (cost=641938.11..641938.12 rows=1 width=64) (actual time=5079.473..5079.473 rows=1 loops=2)
               ->  Hash Join  (cost=637200.09..641938.10 rows=1 width=33) (actual time=5059.961..5079.437 rows=3 loops=2)
                     Hash Cond: (ci.role_id = rt.id)
                     ->  Parallel Hash Join  (cost=637198.93..641936.94 rows=1 width=37) (actual time=5059.724..5079.198 rows=3 loops=2)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=4022 width=4) (actual time=0.011..22.562 rows=3376 loops=2)
                                 Filter: ((country_code)::text = '[jp]'::text)
                                 Rows Removed by Filter: 114122
                           ->  Parallel Hash  (cost=637198.91..637198.91 rows=1 width=41) (actual time=5055.748..5055.748 rows=3 loops=2)
                                 Buckets: 1024  Batches: 1  Memory Usage: 40kB
                                 ->  Parallel Hash Join  (cost=596664.89..637198.91 rows=1 width=41) (actual time=4935.394..5055.699 rows=3 loops=2)
                                       Hash Cond: (mc.movie_id = ci.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..40532.74 rows=338 width=8) (actual time=0.084..354.238 rows=4284 loops=2)
                                             Filter: (((note)::text ~~ '%(Japan)%'::text) AND ((note)::text !~~ '%(USA)%'::text) AND (((note)::text ~~ '%(2006)%'::text) OR ((note)::text ~~ '%(2007)%'::text)))
                                             Rows Removed by Filter: 1300280
                                       ->  Parallel Hash  (cost=596664.88..596664.88 rows=1 width=45) (actual time=4700.417..4700.417 rows=4 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Parallel Hash Join  (cost=580513.21..596664.88 rows=1 width=45) (actual time=4662.657..4700.350 rows=4 loops=2)
                                                   Hash Cond: (an.person_id = ci.person_id)
                                                   ->  Parallel Hash Join  (cost=81879.04..98016.48 rows=3793 width=24) (actual time=727.210..898.879 rows=2016 loops=2)
                                                         Hash Cond: (an.person_id = n.id)
                                                         ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.025..106.737 rows=450672 loops=2)
                                                         ->  Parallel Hash  (cost=81659.82..81659.82 rows=17538 width=4) (actual time=726.315..726.316 rows=10456 loops=2)
                                                               Buckets: 65536  Batches: 1  Memory Usage: 1376kB
                                                               ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=17538 width=4) (actual time=0.145..718.120 rows=10456 loops=2)
                                                                     Filter: (((name)::text ~~ '%Yo%'::text) AND ((name)::text !~~ '%Yu%'::text))
                                                                     Rows Removed by Filter: 2073290
                                                   ->  Parallel Hash  (cost=498634.15..498634.15 rows=1 width=33) (actual time=3801.131..3801.131 rows=113 loops=2)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                         ->  Parallel Hash Join  (cost=57067.49..498634.15 rows=1 width=33) (actual time=423.082..3800.943 rows=113 loops=2)
                                                               Hash Cond: (ci.movie_id = t.id)
                                                               ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=40775 width=12) (actual time=0.850..3415.533 rows=46548 loops=2)
                                                                     Filter: ((note)::text = '(voice: English version)'::text)
                                                                     Rows Removed by Filter: 18075624
                                                               ->  Parallel Hash  (cost=57067.27..57067.27 rows=18 width=21) (actual time=378.631..378.631 rows=4 loops=2)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Parallel Seq Scan on title t  (cost=0.00..57067.27 rows=18 width=21) (actual time=287.883..378.573 rows=4 loops=2)
                                                                           Filter: ((production_year >= 2006) AND (production_year <= 2007) AND (((title)::text ~~ 'One Piece%'::text) OR ((title)::text ~~ 'Dragon Ball Z%'::text)))
                                                                           Rows Removed by Filter: 1264152
                     ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.049..0.049 rows=1 loops=2)
                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                           ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.031..0.033 rows=1 loops=2)
                                 Filter: ((role)::text = 'actress'::text)
                                 Rows Removed by Filter: 11
 Planning Time: 9.402 ms
 Execution Time: 5091.053 ms
(50 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8c.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=767932.80..767932.81 rows=1 width=64) (actual time=8111.457..8111.457 rows=1 loops=1)
   ->  Gather  (cost=767932.58..767932.79 rows=2 width=64) (actual time=8108.066..8269.687 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=766932.58..766932.59 rows=1 width=64) (actual time=8101.233..8101.233 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=243772.58..752972.57 rows=2792002 width=33) (actual time=7585.025..7869.146 rows=829204 loops=3)
                     Hash Cond: (ci.person_id = a1.person_id)
                     ->  Parallel Hash Join  (cost=118006.90..594573.48 rows=1215217 width=21) (actual time=5651.749..5966.553 rows=656886 loops=3)
                           Hash Cond: (ci.movie_id = t.id)
                           ->  Hash Join  (cost=1.16..457349.15 rows=1258484 width=8) (actual time=2552.580..3957.661 rows=909648 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.030..2155.907 rows=12081448 loops=3)
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.030..0.030 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.026..0.027 rows=1 loops=3)
                                             Filter: ((role)::text = 'writer'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=110366.87..110366.87 rows=395029 width=25) (actual time=1444.551..1444.551 rows=384599 loops=3)
                                 Buckets: 65536  Batches: 32  Memory Usage: 2784kB
                                 ->  Parallel Hash Join  (cost=44347.81..110366.87 rows=395029 width=25) (actual time=1040.700..1312.099 rows=384599 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.018..262.043 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=37865.94..37865.94 rows=395029 width=4) (actual time=509.181..509.181 rows=384599 loops=3)
                                             Buckets: 131072  Batches: 16  Memory Usage: 3872kB
                                             ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=4) (actual time=38.865..399.254 rows=384599 loops=3)
                                                   Hash Cond: (mc.company_id = cn.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.007..160.034 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=38.039..38.039 rows=28281 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.023..24.231 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                     ->  Parallel Hash  (cost=118870.18..118870.18 rows=375560 width=24) (actual time=1411.135..1411.135 rows=300448 loops=3)
                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=22047.10..118870.18 rows=375560 width=24) (actual time=954.342..1309.467 rows=300448 loops=3)
                                 Hash Cond: (n1.id = a1.person_id)
                                 ->  Parallel Seq Scan on name n1  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.048..417.307 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=15151.60..15151.60 rows=375560 width=20) (actual time=187.415..187.415 rows=300448 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 3680kB
                                       ->  Parallel Seq Scan on aka_name a1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.044..88.022 rows=300448 loops=3)
 Planning Time: 8.835 ms
 Execution Time: 8270.452 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/8d.sql_explained.sql
SET
SET
                                                                                         QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=767932.80..767932.81 rows=1 width=64) (actual time=7074.295..7074.295 rows=1 loops=1)
   ->  Gather  (cost=767932.58..767932.79 rows=2 width=64) (actual time=7070.482..7212.663 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=766932.58..766932.59 rows=1 width=64) (actual time=7063.611..7063.611 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=243772.58..752972.57 rows=2792002 width=33) (actual time=6963.072..7033.250 rows=107668 loops=3)
                     Hash Cond: (ci.person_id = an1.person_id)
                     ->  Parallel Hash Join  (cost=118006.90..594573.48 rows=1215217 width=21) (actual time=5412.937..5519.167 rows=95179 loops=3)
                           Hash Cond: (ci.movie_id = t.id)
                           ->  Hash Join  (cost=1.16..457349.15 rows=1258484 width=8) (actual time=3061.865..3903.666 rows=92134 loops=3)
                                 Hash Cond: (ci.role_id = rt.id)
                                 ->  Parallel Seq Scan on cast_info ci  (cost=0.00..403705.10 rows=15101810 width=12) (actual time=0.037..2218.503 rows=12081448 loops=3)
                                 ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.030..0.030 rows=1 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                       ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.027..0.028 rows=1 loops=3)
                                             Filter: ((role)::text = 'costume designer'::text)
                                             Rows Removed by Filter: 11
                           ->  Parallel Hash  (cost=110366.87..110366.87 rows=395029 width=25) (actual time=1473.579..1473.579 rows=384599 loops=3)
                                 Buckets: 65536  Batches: 32  Memory Usage: 2784kB
                                 ->  Parallel Hash Join  (cost=44347.81..110366.87 rows=395029 width=25) (actual time=1058.381..1340.970 rows=384599 loops=3)
                                       Hash Cond: (t.id = mc.movie_id)
                                       ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.021..266.147 rows=842771 loops=3)
                                       ->  Parallel Hash  (cost=37865.94..37865.94 rows=395029 width=4) (actual time=507.470..507.470 rows=384599 loops=3)
                                             Buckets: 131072  Batches: 16  Memory Usage: 3872kB
                                             ->  Parallel Hash Join  (cost=5350.78..37865.94 rows=395029 width=4) (actual time=36.703..398.352 rows=384599 loops=3)
                                                   Hash Cond: (mc.company_id = cn.id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.007..163.762 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=36.401..36.402 rows=28281 loops=3)
                                                         Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                         ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.023..23.864 rows=28281 loops=3)
                                                               Filter: ((country_code)::text = '[us]'::text)
                                                               Rows Removed by Filter: 50051
                     ->  Parallel Hash  (cost=118870.18..118870.18 rows=375560 width=24) (actual time=1404.681..1404.681 rows=300448 loops=3)
                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                           ->  Parallel Hash Join  (cost=22047.10..118870.18 rows=375560 width=24) (actual time=956.881..1303.162 rows=300448 loops=3)
                                 Hash Cond: (n1.id = an1.person_id)
                                 ->  Parallel Seq Scan on name n1  (cost=0.00..72977.55 rows=1736455 width=4) (actual time=0.047..419.782 rows=1389164 loops=3)
                                 ->  Parallel Hash  (cost=15151.60..15151.60 rows=375560 width=20) (actual time=187.527..187.528 rows=300448 loops=3)
                                       Buckets: 65536  Batches: 16  Memory Usage: 3712kB
                                       ->  Parallel Seq Scan on aka_name an1  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.049..88.459 rows=300448 loops=3)
 Planning Time: 8.727 ms
 Execution Time: 7213.344 ms
(42 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9a.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=727877.31..727877.32 rows=1 width=96) (actual time=4597.165..4597.165 rows=1 loops=1)
   ->  Gather  (cost=674329.47..727877.30 rows=1 width=49) (actual time=4394.338..4603.617 rows=121 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=673329.47..726877.20 rows=1 width=49) (actual time=4357.972..4589.884 rows=40 loops=3)
               Hash Cond: (t.id = ci.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=466073 width=21) (actual time=0.012..265.725 rows=369296 loops=3)
                     Filter: ((production_year >= 2005) AND (production_year <= 2015))
                     Rows Removed by Filter: 473475
               ->  Parallel Hash  (cost=673329.45..673329.45 rows=1 width=40) (actual time=4282.824..4282.824 rows=114 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=668418.17..673329.45 rows=1 width=40) (actual time=4259.031..4282.658 rows=114 loops=3)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.016..20.643 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
                           ->  Parallel Hash  (cost=668418.15..668418.15 rows=1 width=44) (actual time=4258.877..4258.877 rows=116 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=613978.62..668418.15 rows=1 width=44) (actual time=3889.964..4258.778 rows=116 loops=3)
                                       Hash Cond: (chn.id = ci.person_role_id)
                                       ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.033..239.959 rows=1046780 loops=3)
                                       ->  Parallel Hash  (cost=613978.60..613978.60 rows=1 width=32) (actual time=3886.775..3886.775 rows=124 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=578389.44..613978.60 rows=1 width=32) (actual time=3588.200..3886.646 rows=124 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..35097.06 rows=131225 width=8) (actual time=0.024..287.214 rows=196998 loops=3)
                                                         Filter: ((note IS NOT NULL) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                                         Rows Removed by Filter: 672712
                                                   ->  Parallel Hash  (cost=578389.42..578389.42 rows=2 width=24) (actual time=3577.984..3577.985 rows=142 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Hash Join  (cost=97799.03..578389.42 rows=2 width=24) (actual time=1625.661..3577.859 rows=142 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Hash Join  (cost=97797.87..578388.18 rows=19 width=28) (actual time=1625.547..3577.699 rows=142 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.081..2836.334 rows=289159 loops=3)
                                                                           Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                           Rows Removed by Filter: 11792289
                                                                     ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=24) (actual time=699.371..699.371 rows=519 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                                           ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=24) (actual time=580.113..698.860 rows=519 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.037..74.685 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=4) (actual time=578.601..578.601 rows=2256 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=4) (actual time=215.130..509.641 rows=2256 loops=3)
                                                                                             Filter: (((name)::text ~~ '%Ang%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1386908
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.058..0.059 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.039..0.042 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actress'::text)
                                                                           Rows Removed by Filter: 11
 Planning Time: 16.530 ms
 Execution Time: 4604.415 ms
(54 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9b.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=691306.83..691306.84 rows=1 width=128) (actual time=4074.338..4074.338 rows=1 loops=1)
   ->  Gather  (cost=638698.30..691306.82 rows=1 width=64) (actual time=4043.715..4081.145 rows=40 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Parallel Hash Join  (cost=637698.30..690306.72 rows=1 width=64) (actual time=3942.399..4067.092 rows=13 loops=3)
               Hash Cond: (t.id = ci.movie_id)
               ->  Parallel Seq Scan on title t  (cost=0.00..51799.95 rows=215591 width=21) (actual time=0.015..252.726 rows=170942 loops=3)
                     Filter: ((production_year >= 2007) AND (production_year <= 2010))
                     Rows Removed by Filter: 671829
               ->  Parallel Hash  (cost=637698.28..637698.28 rows=1 width=55) (actual time=3792.755..3792.755 rows=31 loops=3)
                     Buckets: 1024  Batches: 1  Memory Usage: 104kB
                     ->  Parallel Hash Join  (cost=632787.00..637698.28 rows=1 width=55) (actual time=3769.748..3792.634 rows=31 loops=3)
                           Hash Cond: (cn.id = mc.company_id)
                           ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.009..20.850 rows=28281 loops=3)
                                 Filter: ((country_code)::text = '[us]'::text)
                                 Rows Removed by Filter: 50051
                           ->  Parallel Hash  (cost=632786.98..632786.98 rows=1 width=59) (actual time=3768.805..3768.805 rows=31 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                 ->  Parallel Hash Join  (cost=594815.82..632786.98 rows=1 width=59) (actual time=3523.944..3768.730 rows=31 loops=3)
                                       Hash Cond: (mc.movie_id = ci.movie_id)
                                       ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..37814.90 rows=41669 width=8) (actual time=0.017..266.669 rows=66173 loops=3)
                                             Filter: (((note)::text ~~ '%(200%)%'::text) AND (((note)::text ~~ '%(USA)%'::text) OR ((note)::text ~~ '%(worldwide)%'::text)))
                                             Rows Removed by Filter: 803537
                                       ->  Parallel Hash  (cost=594815.80..594815.80 rows=1 width=51) (actual time=3493.807..3493.807 rows=79 loops=3)
                                             Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                             ->  Parallel Hash Join  (cost=540376.27..594815.80 rows=1 width=51) (actual time=3126.357..3493.705 rows=79 loops=3)
                                                   Hash Cond: (chn.id = ci.person_role_id)
                                                   ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.046..239.489 rows=1046780 loops=3)
                                                   ->  Parallel Hash  (cost=540376.25..540376.25 rows=1 width=39) (actual time=3124.004..3124.004 rows=88 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 104kB
                                                         ->  Hash Join  (cost=97799.03..540376.25 rows=1 width=39) (actual time=1597.327..3123.905 rows=88 loops=3)
                                                               Hash Cond: (ci.role_id = rt.id)
                                                               ->  Parallel Hash Join  (cost=97797.87..540375.04 rows=15 width=43) (actual time=1597.206..3123.753 rows=88 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Parallel Seq Scan on cast_info ci  (cost=0.00..441459.62 rows=298009 width=16) (actual time=0.070..2307.753 rows=237943 loops=3)
                                                                           Filter: ((note)::text = '(voice)'::text)
                                                                           Rows Removed by Filter: 11843505
                                                                     ->  Parallel Hash  (cost=97797.76..97797.76 rows=9 width=39) (actual time=780.914..780.914 rows=432 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 136kB
                                                                           ->  Parallel Hash Join  (cost=81660.32..97797.76 rows=9 width=39) (actual time=665.156..780.457 rows=432 loops=3)
                                                                                 Hash Cond: (an.person_id = n.id)
                                                                                 ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.036..72.266 rows=300448 loops=3)
                                                                                 ->  Parallel Hash  (cost=81659.82..81659.82 rows=40 width=19) (actual time=663.670..663.671 rows=1803 loops=3)
                                                                                       Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                                                                       ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=40 width=19) (actual time=215.052..506.861 rows=1803 loops=3)
                                                                                             Filter: (((name)::text ~~ '%Angel%'::text) AND ((gender)::text = 'f'::text))
                                                                                             Rows Removed by Filter: 1387361
                                                               ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.059..0.059 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.037..0.040 rows=1 loops=3)
                                                                           Filter: ((role)::text = 'actress'::text)
                                                                           Rows Removed by Filter: 11
 Planning Time: 15.746 ms
 Execution Time: 4081.946 ms
(54 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9c.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=750479.65..750479.66 rows=1 width=128) (actual time=5181.436..5181.437 rows=1 loops=1)
   ->  Gather  (cost=750479.42..750479.63 rows=2 width=128) (actual time=5177.235..5255.433 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=749479.42..749479.43 rows=1 width=128) (actual time=5170.045..5170.045 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=732915.55..749475.64 rows=378 width=64) (actual time=5053.622..5168.608 rows=2715 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.034..73.198 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=732913.48..732913.48 rows=165 width=56) (actual time=5051.212..5051.212 rows=1501 loops=3)
                           Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 536kB
                           ->  Parallel Hash Join  (cost=682429.67..732913.48 rows=165 width=56) (actual time=4699.525..5038.365 rows=1501 loops=3)
                                 Hash Cond: (t.id = ci.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.018..216.013 rows=842771 loops=3)
                                 ->  Parallel Hash  (cost=682427.61..682427.61 rows=165 width=47) (actual time=4697.819..4697.819 rows=1501 loops=3)
                                       Buckets: 4096 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 472kB
                                       ->  Parallel Hash Join  (cost=648686.41..682427.61 rows=165 width=47) (actual time=4368.434..4649.226 rows=1501 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=643335.63..677075.64 rows=453 width=51) (actual time=4327.354..4606.690 rows=4128 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.013..155.206 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=643333.50..643333.50 rows=170 width=43) (actual time=4326.278..4326.278 rows=1895 loops=3)
                                                         Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 600kB
                                                         ->  Parallel Hash Join  (cost=155467.08..643333.50 rows=170 width=43) (actual time=4054.198..4264.900 rows=1895 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Hash Join  (cost=81911.39..562103.89 rows=353 width=31) (actual time=1433.338..3373.455 rows=2184 loops=3)
                                                                     Hash Cond: (ci.role_id = rt.id)
                                                                     ->  Parallel Hash Join  (cost=81910.23..562087.69 rows=4234 width=35) (actual time=1433.266..3372.567 rows=2185 loops=3)
                                                                           Hash Cond: (ci.person_id = n.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.088..2794.122 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Parallel Hash  (cost=81659.82..81659.82 rows=20033 width=19) (actual time=532.422..532.423 rows=16670 loops=3)
                                                                                 Buckets: 65536  Batches: 1  Memory Usage: 3296kB
                                                                                 ->  Parallel Seq Scan on name n  (cost=0.00..81659.82 rows=20033 width=19) (actual time=219.993..519.442 rows=16670 loops=3)
                                                                                       Filter: (((name)::text ~~ '%An%'::text) AND ((gender)::text = 'f'::text))
                                                                                       Rows Removed by Filter: 1372493
                                                                     ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.057..0.058 rows=1 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.053..0.055 rows=1 loops=3)
                                                                                 Filter: ((role)::text = 'actress'::text)
                                                                                 Rows Removed by Filter: 11
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=638.065..638.065 rows=1046780 loops=3)
                                                                     Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.061..293.264 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.718..39.718 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4352kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.030..25.563 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 15.833 ms
 Execution Time: 5256.504 ms
(51 rows)

execute /home/pei/Project/benchmarks/imdb_job-postgres/skinner_explained/9d.sql_explained.sql
SET
SET
                                                                                                    QUERY PLAN                                                                                                    
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=756571.53..756571.54 rows=1 width=128) (actual time=6580.283..6580.284 rows=1 loops=1)
   ->  Gather  (cost=756571.30..756571.51 rows=2 width=128) (actual time=6565.904..6796.428 rows=3 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         ->  Partial Aggregate  (cost=755571.30..755571.31 rows=1 width=128) (actual time=6560.976..6560.976 rows=1 loops=3)
               ->  Parallel Hash Join  (cost=738933.47..755496.36 rows=7494 width=64) (actual time=6373.155..6487.540 rows=161027 loops=3)
                     Hash Cond: (an.person_id = n.id)
                     ->  Parallel Seq Scan on aka_name an  (cost=0.00..15151.60 rows=375560 width=20) (actual time=0.041..74.014 rows=300448 loops=3)
                     ->  Parallel Hash  (cost=738892.70..738892.70 rows=3262 width=56) (actual time=6184.046..6184.046 rows=57856 loops=3)
                           Buckets: 32768 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2848kB
                           ->  Parallel Hash Join  (cost=688395.99..738892.70 rows=3262 width=56) (actual time=5884.590..6127.381 rows=57856 loops=3)
                                 Hash Cond: (t.id = ci.movie_id)
                                 ->  Parallel Seq Scan on title t  (cost=0.00..46532.63 rows=1053463 width=21) (actual time=0.021..223.846 rows=842771 loops=3)
                                 ->  Parallel Hash  (cost=688355.22..688355.22 rows=3262 width=47) (actual time=5335.413..5335.413 rows=57856 loops=3)
                                       Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2432kB
                                       ->  Parallel Hash Join  (cost=654556.12..688355.22 rows=3262 width=47) (actual time=5043.254..5280.402 rows=57856 loops=3)
                                             Hash Cond: (mc.company_id = cn.id)
                                             ->  Parallel Hash Join  (cost=649205.34..682980.87 rows=8976 width=51) (actual time=5002.434..5209.751 rows=142133 loops=3)
                                                   Hash Cond: (mc.movie_id = ci.movie_id)
                                                   ->  Parallel Seq Scan on movie_companies mc  (cost=0.00..29661.37 rows=1087137 width=8) (actual time=0.028..156.762 rows=869710 loops=3)
                                                   ->  Parallel Hash  (cost=649163.11..649163.11 rows=3378 width=43) (actual time=4611.306..4611.307 rows=85164 loops=3)
                                                         Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2976kB
                                                         ->  Parallel Hash Join  (cost=158158.83..649163.11 rows=3378 width=43) (actual time=4299.100..4517.503 rows=85164 loops=3)
                                                               Hash Cond: (ci.person_role_id = chn.id)
                                                               ->  Parallel Hash Join  (cost=84603.14..567826.09 rows=6986 width=31) (actual time=3492.994..3601.541 rows=92002 loops=3)
                                                                     Hash Cond: (ci.person_id = n.id)
                                                                     ->  Hash Join  (cost=1.16..480518.83 rows=30581 width=12) (actual time=910.270..2891.302 rows=92055 loops=3)
                                                                           Hash Cond: (ci.role_id = rt.id)
                                                                           ->  Parallel Seq Scan on cast_info ci  (cost=0.00..479214.15 rows=366974 width=16) (actual time=0.053..2828.040 rows=289159 loops=3)
                                                                                 Filter: ((note)::text = ANY ('{(voice),"(voice: Japanese version)","(voice) (uncredited)","(voice: English version)"}'::text[]))
                                                                                 Rows Removed by Filter: 11792289
                                                                           ->  Hash  (cost=1.15..1.15 rows=1 width=4) (actual time=0.037..0.037 rows=1 loops=3)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Seq Scan on role_type rt  (cost=0.00..1.15 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=3)
                                                                                       Filter: ((role)::text = 'actress'::text)
                                                                                       Rows Removed by Filter: 11
                                                                     ->  Parallel Hash  (cost=77318.68..77318.68 rows=396664 width=19) (actual time=537.160..537.161 rows=320518 loops=3)
                                                                           Buckets: 65536  Batches: 16  Memory Usage: 3872kB
                                                                           ->  Parallel Seq Scan on name n  (cost=0.00..77318.68 rows=396664 width=19) (actual time=176.949..427.488 rows=320518 loops=3)
                                                                                 Filter: ((gender)::text = 'f'::text)
                                                                                 Rows Removed by Filter: 1068645
                                                               ->  Parallel Hash  (cost=49532.75..49532.75 rows=1308475 width=20) (actual time=638.046..638.046 rows=1046780 loops=3)
                                                                     Buckets: 65536  Batches: 64  Memory Usage: 3264kB
                                                                     ->  Parallel Seq Scan on char_name chn  (cost=0.00..49532.75 rows=1308475 width=20) (actual time=0.086..294.487 rows=1046780 loops=3)
                                             ->  Parallel Hash  (cost=4722.92..4722.92 rows=50229 width=4) (actual time=39.916..39.916 rows=28281 loops=3)
                                                   Buckets: 131072  Batches: 1  Memory Usage: 4384kB
                                                   ->  Parallel Seq Scan on company_name cn  (cost=0.00..4722.92 rows=50229 width=4) (actual time=0.032..25.452 rows=28281 loops=3)
                                                         Filter: ((country_code)::text = '[us]'::text)
                                                         Rows Removed by Filter: 50051
 Planning Time: 15.537 ms
 Execution Time: 6797.615 ms
(51 rows)

